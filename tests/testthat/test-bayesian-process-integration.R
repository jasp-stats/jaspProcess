# This code is automatically generated by 'generate-tests.R'


test_that("Test that model number 1 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1352.0630382411, 1335.61982756942, 48.1189295154574,
			 0.395, 1336.08730306982, 48.3670349052021))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(60, -1.46586632435312, 0.347696560904634, "contGamma:contcor1",
			 -0.521987994364563, -0.477626969365902, "<unicode>", 0.997829456944731,
			 "contGamma", 0.468424709342575, 71, 60, -0.570452870230063,
			 0.15751900153168, "contcor1", -0.209946399984571, -0.220625700094966,
			 "<unicode>", 1.01433319701686, "contGamma", 0.187117657465845,
			 41, 288, 1.82339506879708, 3.17238765695285, "contGamma", 2.44043999591352,
			 2.43517335336752, "<unicode>", 1.00269662477677, "contGamma",
			 0.380007794191031, 156, 237, 0.843668806238028, 1.56431418803789,
			 "contNormal", 1.14062654903094, 1.11117430022654, "<unicode>",
			 0.99685252085436, "contNormal", 0.173708245886299, 69, 61, 1.51692033552171,
			 2.82055332353363, "contGamma:contcor1", 2.10479352466896, 2.05725067077629,
			 "<unicode>", 1.02387105843217, "contcor1", 0.337757888248254,
			 123, 93, 0.809257892885492, 1.34730407880147, "contcor1", 1.03901051792597,
			 1.02139080540758, "<unicode>", 1.01807309842332, "contcor1",
			 0.145365432584125, 19, 116, 4.9843870844687, 9.0445572182295,
			 "contGamma:contcor1", 6.65053436396861, 6.43321544695945, "<unicode>",
			 1.00389497593569, "contGamma:contcor1", 1.01573861571848, 175
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(194, -0.148761762931716, 0.220904397150302, 16, "contGamma", "contNormal",
			 0.0248652177417471, 0.0254919048701737, "<unicode>", 1.00585507243614,
			 0.0985723063097909, 156, 242, -0.160870067657072, 0.118690586115277,
			 50, "contGamma", "contNormal", -0.0223874477600397, -0.0237420846464439,
			 "<unicode>", 1.0005227034402, 0.0747138843445569, 120, 122,
			 -0.329387694354776, 0.168354017494764, 84, "contGamma", "contNormal",
			 -0.0739577264963863, -0.0607958172254641, "<unicode>", 0.999598615918706,
			 0.120373862201764, 128))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(245, -0.160280250958836, 0.119004190264736, "contGamma", -0.0222108820688388,
			 -0.0236771988216731, "<unicode>", "Normal(0,10)", 1.00069549773746,
			 "contNormal", 0.0746707808661827, 120, 96, -0.138254092266992,
			 0.70746071705076, "contcor1", 0.263448970568757, 0.273012544658805,
			 "<unicode>", "Normal(0,10)", 1.0050864409716, "contNormal",
			 0.200792227072661, 95, 130, -0.200908406070418, 0.112427062706851,
			 "contGamma:contcor1", -0.048507058022242, -0.0446655735677554,
			 "<unicode>", "Normal(0,10)", 0.996704712545635, "contNormal",
			 0.0787135281238505, 133))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(194, -0.148761762931716, 0.220904397150302, 16, "Total", "contGamma",
			 "contNormal", 0.0248652177417471, 0.0254919048701737, "<unicode>",
			 1.00585507243614, 0.0985723063097909, 156, 242, -0.160870067657072,
			 0.118690586115277, 50, "Total", "contGamma", "contNormal", -0.0223874477600397,
			 -0.0237420846464439, "<unicode>", 1.0005227034402, 0.0747138843445569,
			 120, 122, -0.329387694354776, 0.168354017494764, 84, "Total",
			 "contGamma", "contNormal", -0.0739577264963863, -0.0607958172254641,
			 "<unicode>", 0.999598615918706, 0.120373862201764, 128))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")

})
test_that("Test that model number 1 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 627.015617356193, 599.950209022299, 20.744242089158,
			 0.485, 599.920098518199, 20.7718243792376))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(156, 0.0992358787182961, 0.203040817852728, "facGenderm:facExperimexperimental",
			 0.146920213468544, 0.142807888271392, "<unicode>", 1.01661739914052,
			 "facGenderm", 0.0288970093527396, 151, 128, -0.00488913303774954,
			 0.096894240109014, "facExperimexperimental", 0.0400665332201068,
			 0.0381121293225082, "<unicode>", 1.00315547960719, "facGenderm",
			 0.0264628731520974, 132, 222, 0.193041039188751, 0.347133776690736,
			 "facGenderm", 0.255976294566657, 0.252712043791227, "<unicode>",
			 1.00443229933302, "facGenderm", 0.0382321837371022, 161, 249,
			 0.798537231533674, 1.49272563465886, "contNormal", 1.12415347361608,
			 1.11594167174921, "<unicode>", 1.00135540161575, "contNormal",
			 0.178130041668853, 116, 166, 0.101172800243983, 0.215896584650131,
			 "facGenderm:facExperimexperimental", 0.148124720842717, 0.141394248198331,
			 "<unicode>", 1.00888986949111, "facExperimexperimental", 0.0308843950509755,
			 184, 243, 0.184740963887975, 0.34147414872119, "facExperimexperimental",
			 0.257677671546961, 0.254010917041487, "<unicode>", 0.996210804392714,
			 "facExperimexperimental", 0.0415473429690221, 150, 155, 0.157100114681033,
			 0.291324773841369, "facGenderm:facExperimexperimental", 0.213683984486177,
			 0.209283939047426, "<unicode>", 1.0241199622864, "facGenderm:facExperimexperimental",
			 0.034835496672044, 142))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(80, 0.100559806027885, 1.18372784950136, 0, "m", "facGender",
			 "contNormal", 0.611970830458675, 0.609224091323278, "<unicode>",
			 1.03662702260094, 0.279374192381148, 101, 164, -0.292491772769563,
			 0.894790959888719, 1, "m", "facGender", "contNormal", 0.346030487484946,
			 0.345392553307517, "<unicode>", 0.995498913625491, 0.303551478897168,
			 104))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(80, 0.100559806027885, 1.18372784950136, "facGenderm", 0.611970830458675,
			 0.609224091323278, "<unicode>", "Normal(0,10)", 1.03662702260094,
			 "contNormal", 0.279374192381148, 101, 132, -0.335919555816818,
			 0.701878657202629, "facExperimexperimental", 0.117885514435785,
			 0.122064918352914, "<unicode>", "Normal(0,10)", 1.00128129302979,
			 "contNormal", 0.275653188093826, 144, 88, -0.932268584286683,
			 0.366609541499328, "facGenderm:facExperimexperimental", -0.265940342973728,
			 -0.311391401911085, "<unicode>", "Normal(0,10)", 1.01825692640039,
			 "contNormal", 0.386479524143668, 128))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(80, 0.100559806027885, 1.18372784950136, 0, "m", "Total", "facGender",
			 "contNormal", 0.611970830458675, 0.609224091323278, "<unicode>",
			 1.03662702260094, 0.279374192381148, 101, 164, -0.292491772769563,
			 0.894790959888719, 1, "m", "Total", "facGender", "contNormal",
			 0.346030487484946, 0.345392553307517, "<unicode>", 0.995498913625491,
			 0.303551478897168, 104))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")

})
test_that("Test that model number 2 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1882.73954564907, 1838.31103288683, 65.0126887740874,
			 0.49, 1838.79596946716, 65.1486180697423))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(94, -1.09555595270558, 0.441884038233426, "contGamma:contcor2",
			 -0.28175900331675, -0.243845859941639, "<unicode>", 1.01459885968361,
			 "contGamma", 0.422909972561068, 119, 84, -0.421137907918085,
			 0.222050417196549, "contcor2", -0.0713331685121415, -0.0632814382117677,
			 "<unicode>", 1.01270571813584, "contGamma", 0.163456554643196,
			 132, 81, -1.31662010748512, 0.206547029796268, "contGamma:contcor1",
			 -0.550282250540638, -0.518588957462349, "<unicode>", 1.01128632024661,
			 "contGamma", 0.406222885275542, 83, 85, -0.581902677364808,
			 0.0746234920211265, "contcor1", -0.226642435575788, -0.210755144350795,
			 "<unicode>", 0.999010640375071, "contGamma", 0.174393359874298,
			 56, 264, 1.84956805564496, 3.52643973300107, "contGamma", 2.50473130471893,
			 2.47693653287072, "<unicode>", 1.00022842993792, "contGamma",
			 0.38380147899864, 150, 321, 0.877701638198157, 1.53018351697855,
			 "contNormal", 1.16197027775553, 1.14588887870518, "<unicode>",
			 0.998464001849654, "contNormal", 0.186963794834217, 106, 109,
			 0.945702046252441, 1.95483115913582, "contGamma:contcor2", 1.43098354366889,
			 1.40596437403413, "<unicode>", 0.99813617039451, "contcor1",
			 0.285047128321776, 133, 134, 0.429155730942114, 0.822670495989584,
			 "contcor2", 0.618105016828155, 0.612261374686394, "<unicode>",
			 0.996852660982284, "contcor1", 0.102174435884504, 183, 166,
			 1.46739566071989, 2.6457112149711, "contGamma:contcor1", 2.00066610180694,
			 1.99210427612673, "<unicode>", 0.99877586131246, "contcor1",
			 0.294975938237097, 155, 206, 0.799101298992661, 1.27771683209937,
			 "contcor1", 1.01613015436851, 1.00782254246604, "<unicode>",
			 0.997901890615485, "contcor1", 0.129638671089606, 189, 146,
			 3.92907875781379, 7.11932283009971, "contGamma:contcor2", 5.26823617951998,
			 5.18455216022633, "<unicode>", 1.00581946096371, "contGamma:contcor1",
			 0.816913271524618, 153, 118, 1.03009226580083, 1.97945152629062,
			 "contcor2", 1.44840014086965, 1.41285982798491, "<unicode>",
			 1.00014416486208, "contGamma:contcor1", 0.244180354436087, 154,
			 221, 4.97085273309802, 8.29182358301264, "contGamma:contcor1",
			 6.34052049966068, 6.30164473325139, "<unicode>", 0.998641408971007,
			 "contGamma:contcor1", 0.856299142220577, 193, 125, 1.75090639273239,
			 2.83924147940833, "contGamma:contcor2", 2.20776341393288, 2.18353887206396,
			 "<unicode>", 1.00306143668393, "contcor2", 0.304508630499208,
			 153, 155, 0.766446159607251, 1.24777674324007, "contcor2", 0.979499409500142,
			 0.983032484951102, "<unicode>", 1.00055122696755, "contcor2",
			 0.127361715852708, 153, 146, 5.90633939454236, 9.27587508197934,
			 "contGamma:contcor2", 7.4708654645013, 7.30481562518887, "<unicode>",
			 1.01146421326523, "contGamma:contcor2", 0.921456762108893, 140
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(303, -0.189978976254917, 0.189669143223265, 16, 16, "contGamma",
			 "contNormal", 0.0140213467774352, 0.0185243662639024, "<unicode>",
			 0.999781511697571, 0.0971596414674428, 177, 114, -0.256101074786454,
			 0.25663449254364, 50, 16, "contGamma", "contNormal", 0.0200005361726124,
			 0.0255818534720135, "<unicode>", 1.01626725358202, 0.13491838381588,
			 132, 84, -0.45620953930189, 0.53887809391124, 84, 16, "contGamma",
			 "contNormal", 0.0265260614620807, 0.0163501849271578, "<unicode>",
			 1.00969050512453, 0.252275235646323, 113, 90, -0.337149886227827,
			 0.217798071919345, 16, 50, "contGamma", "contNormal", -0.0280216325655505,
			 -0.031174332143386, "<unicode>", 0.998626650126419, 0.140137121866695,
			 119, 398, -0.140565532312333, 0.117858407936413, 50, 50, "contGamma",
			 "contNormal", -0.0220424431703732, -0.020916685846287, "<unicode>",
			 0.997437649380595, 0.0658579742741465, 105, 96, -0.317833559252466,
			 0.266744067557327, 84, 50, "contGamma", "contNormal", -0.0155169178809049,
			 -0.00476322909150684, "<unicode>", 1.01248567007592, 0.153343322272984,
			 98, 82, -0.652890331986574, 0.412109522182589, 16, 84, "contGamma",
			 "contNormal", -0.0773024575869993, -0.0651602104509691, "<unicode>",
			 1.00320146935669, 0.256188705748524, 100, 98, -0.376543911244741,
			 0.192419474886833, 50, 84, "contGamma", "contNormal", -0.0713232681918221,
			 -0.065824975109168, "<unicode>", 1.00479519878557, 0.14874366193039,
			 117, 249, -0.257442894191134, 0.156585623458713, 84, 84, "contGamma",
			 "contNormal", -0.0647977429023538, -0.0685629651790813, "<unicode>",
			 0.996473360372523, 0.102554387291359, 219))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(412, -0.139740714766438, 0.117046525952765, "contGamma", -0.0207468096313513,
			 -0.0201842046086537, "<unicode>", "Normal(0,10)", 0.998420030460247,
			 "contNormal", 0.066043982606596, 106, 76, -0.27873572683076,
			 0.737375059248732, "contcor1", 0.24082814607815, 0.259998483246137,
			 "<unicode>", "Normal(0,10)", 1.0268690896616, "contNormal",
			 0.265372146397047, 83, 78, -0.236083576098035, 0.272729275419973,
			 "contGamma:contcor1", 0.00613791590036056, 0.00709321851792286,
			 "<unicode>", "Normal(0,10)", 1.01668631492736, "contNormal",
			 0.128700201219192, 104, 90, -0.559579971660258, 0.513591599404623,
			 "contcor2", -0.0361921815699167, -0.063005702147679, "<unicode>",
			 "Normal(0,10)", 1.0097689070552, "contNormal", 0.268802332735275,
			 117, 91, -0.298424943558097, 0.198807169354041, "contGamma:contcor2",
			 -0.0440794499297396, -0.0413906543844607, "<unicode>", "Normal(0,10)",
			 1.00940655263089, "contNormal", 0.121227399347972, 73))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(303, -0.189978976254917, 0.189669143223265, 16, 16, "Total", "contGamma",
			 "contNormal", 0.0140213467774352, 0.0185243662639024, "<unicode>",
			 0.999781511697571, 0.0971596414674428, 177, 114, -0.256101074786454,
			 0.25663449254364, 50, 16, "Total", "contGamma", "contNormal",
			 0.0200005361726124, 0.0255818534720135, "<unicode>", 1.01626725358202,
			 0.13491838381588, 132, 84, -0.45620953930189, 0.53887809391124,
			 84, 16, "Total", "contGamma", "contNormal", 0.0265260614620807,
			 0.0163501849271578, "<unicode>", 1.00969050512453, 0.252275235646323,
			 113, 90, -0.337149886227827, 0.217798071919345, 16, 50, "Total",
			 "contGamma", "contNormal", -0.0280216325655505, -0.031174332143386,
			 "<unicode>", 0.998626650126419, 0.140137121866695, 119, 398,
			 -0.140565532312333, 0.117858407936413, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0220424431703732, -0.020916685846287, "<unicode>",
			 0.997437649380595, 0.0658579742741465, 105, 96, -0.317833559252466,
			 0.266744067557327, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0155169178809049, -0.00476322909150684, "<unicode>", 1.01248567007592,
			 0.153343322272984, 98, 82, -0.652890331986574, 0.412109522182589,
			 16, 84, "Total", "contGamma", "contNormal", -0.0773024575869993,
			 -0.0651602104509691, "<unicode>", 1.00320146935669, 0.256188705748524,
			 100, 98, -0.376543911244741, 0.192419474886833, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0713232681918221, -0.065824975109168,
			 "<unicode>", 1.00479519878557, 0.14874366193039, 117, 249, -0.257442894191134,
			 0.156585623458713, 84, 84, "Total", "contGamma", "contNormal",
			 -0.0647977429023538, -0.0685629651790813, "<unicode>", 0.996473360372523,
			 0.102554387291359, 219))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")

})
test_that("Test that model number 2 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, "Model 1", 100, 1095.26722131135, 1040.80746811761, 32.7434126928874,
			 0.43, 1040.7432153938, 32.8114298966381))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(122, -0.0669963772974446, 0.0699942581418846, "facGenderm:contcor2",
			 -0.00829529832681165, -0.011161562945925, "<unicode>", 1.02623744901061,
			 "facGenderm", 0.03394069868484, 80, 136, -0.155888106352876,
			 0.053670394344622, "contcor2", -0.0556405824529179, -0.0555293633279328,
			 "<unicode>", 1.00400751775748, "facGenderm", 0.0536936065709416,
			 139, 221, 0.0967910871958399, 0.205583326364665, "facGenderm:facExperimexperimental",
			 0.144468863286551, 0.142208915647376, "<unicode>", 0.999147059264664,
			 "facGenderm", 0.0291709816477252, 213, 172, -0.0107913896779855,
			 0.0870329447208902, "facExperimexperimental", 0.0307208239920557,
			 0.028740751143878, "<unicode>", 0.997535591644365, "facGenderm",
			 0.0267921618552093, 116, 231, 0.196187533876978, 0.347825695870638,
			 "facGenderm", 0.261454208813003, 0.255001310494891, "<unicode>",
			 1.00263691032687, "facGenderm", 0.0414594559649378, 172, 306,
			 0.822981602375035, 1.56130005998621, "contNormal", 1.14504076946389,
			 1.1215282864363, "<unicode>", 0.996696181637104, "contNormal",
			 0.188634827165903, 119, 208, -0.123938889621334, -0.000278407072079363,
			 "facGenderm:contcor2", -0.0623601886383732, -0.0624015055907501,
			 "<unicode>", 1.00549119186023, "facExperimexperimental", 0.0334426387548672,
			 91, 158, -0.155955514857135, 0.0274051960154527, "contcor2",
			 -0.0620813088255259, -0.0582712537092684, "<unicode>", 1.01254424492432,
			 "facExperimexperimental", 0.0466782574434827, 148, 168, 0.0972222624050317,
			 0.2039830097475, "facGenderm:facExperimexperimental", 0.142607206794673,
			 0.13754659130793, "<unicode>", 1.00348917564146, "facExperimexperimental",
			 0.0301117923549721, 157, 240, 0.197088562705868, 0.338273737324361,
			 "facExperimexperimental", 0.26115852023302, 0.257445937659954,
			 "<unicode>", 1.00647738041545, "facExperimexperimental", 0.0406264772843818,
			 146, 143, -0.125343724395395, -0.0113170150521823, "facGenderm:contcor2",
			 -0.0690165570763685, -0.0675253792728928, "<unicode>", 1.01150551596194,
			 "facGenderm:facExperimexperimental", 0.0296830926343842, 73,
			 88, -0.168290152490021, -0.00374450384027753, "contcor2", -0.0919302851896212,
			 -0.0947269476115124, "<unicode>", 1.03750873596693, "facGenderm:facExperimexperimental",
			 0.0431354912967048, 113, 178, 0.160185489963513, 0.297631124481304,
			 "facGenderm:facExperimexperimental", 0.209367090797727, 0.205259550900107,
			 "<unicode>", 0.996729175865402, "facGenderm:facExperimexperimental",
			 0.033534564569361, 189, 269, 0.296488484469695, 0.622048934279058,
			 "facGenderm:contcor2", 0.453169282701632, 0.443971344263545,
			 "<unicode>", 1.00140108746581, "contcor2", 0.0867109116065845,
			 163, 253, 0.775224908827958, 1.39160712109222, "contcor2", 1.04097139191079,
			 1.02798793933631, "<unicode>", 1.00430851573012, "contcor2",
			 0.153720531198363, 178, 236, 0.346456028295377, 0.614461471669573,
			 "facGenderm:contcor2", 0.468582221478299, 0.465044552856692,
			 "<unicode>", 1.00217742775624, "facGenderm:contcor2", 0.0719940364140039,
			 148))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(90, -0.109300849151694, 1.26447934094005, 16, 0, "m", "facGender",
			 "contNormal", 0.560361426484462, 0.56169483341188, "<unicode>",
			 1.01400663089144, 0.34961604405405, 137, 130, -0.389255099765267,
			 0.866071828197714, 16, 1, "m", "facGender", "contNormal", 0.31131962862755,
			 0.304250004896349, "<unicode>", 1.00989417822315, 0.34390274764718,
			 117, 51, 0.0764254464762188, 1.23984132572015, 50, 0, "m", "facGender",
			 "contNormal", 0.594086562124718, 0.589644758503932, "<unicode>",
			 1.03807230335667, 0.291335316360619, 105, 142, -0.290701090642354,
			 0.891869829497465, 50, 1, "m", "facGender", "contNormal", 0.345044764267806,
			 0.368071669914182, "<unicode>", 1.00543988000724, 0.29113047271028,
			 104, 55, -0.0112659420698312, 1.40752646880616, 84, 0, "m",
			 "facGender", "contNormal", 0.633617597609943, 0.616163316012164,
			 "<unicode>", 1.03598943811997, 0.378425731293135, 110, 197,
			 -0.326847031741223, 1.11699257022507, 84, 1, "m", "facGender",
			 "contNormal", 0.384575799753031, 0.379694977126927, "<unicode>",
			 0.9976047606714, 0.384176083793009, 116))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(52, 0.0648904605959025, 1.24060983328329, "facGenderm", 0.59302933675709,
			 0.588945967188796, "<unicode>", "Normal(0,10)", 1.03703489863697,
			 "contNormal", 0.291254907028375, 105, 84, -0.306164271006159,
			 0.798371971452618, "facExperimexperimental", 0.143165341710009,
			 0.116700506640701, "<unicode>", "Normal(0,10)", 1.02924274755097,
			 "contNormal", 0.286552604667263, 28, 49, -1.20281721457704,
			 0.460510277810452, "facGenderm:facExperimexperimental", -0.249041797856912,
			 -0.231109870611231, "<unicode>", "Normal(0,10)", 1.04265053973111,
			 "contNormal", 0.385133166736488, 36, 260, -0.230236584112068,
			 0.310268913821003, "contcor2", 0.0456269513108213, 0.0457172400626986,
			 "<unicode>", "Normal(0,10)", 1.00122861442659, "contNormal",
			 0.143911231368503, 119, 225, -0.341896161027439, 0.452768693553954,
			 "facGenderm:contcor2", 0.035358707947428, 0.0148888795659381,
			 "<unicode>", "Normal(0,10)", 1.01063254273322, "contNormal",
			 0.209967185381324, 100))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(90, -0.109300849151694, 1.26447934094005, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.560361426484462, 0.56169483341188,
			 "<unicode>", 1.01400663089144, 0.34961604405405, 137, 130, -0.389255099765267,
			 0.866071828197714, 16, 1, "m", "Total", "facGender", "contNormal",
			 0.31131962862755, 0.304250004896349, "<unicode>", 1.00989417822315,
			 0.34390274764718, 117, 51, 0.0764254464762188, 1.23984132572015,
			 50, 0, "m", "Total", "facGender", "contNormal", 0.594086562124718,
			 0.589644758503932, "<unicode>", 1.03807230335667, 0.291335316360619,
			 105, 142, -0.290701090642354, 0.891869829497465, 50, 1, "m",
			 "Total", "facGender", "contNormal", 0.345044764267806, 0.368071669914182,
			 "<unicode>", 1.00543988000724, 0.29113047271028, 104, 55, -0.0112659420698312,
			 1.40752646880616, 84, 0, "m", "Total", "facGender", "contNormal",
			 0.633617597609943, 0.616163316012164, "<unicode>", 1.03598943811997,
			 0.378425731293135, 110, 197, -0.326847031741223, 1.11699257022507,
			 84, 1, "m", "Total", "facGender", "contNormal", 0.384575799753031,
			 0.379694977126927, "<unicode>", 0.9976047606714, 0.384176083793009,
			 116))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")

})
test_that("Test that model number 3 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contcor1",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 2572.34230033384, 2503.69838667665, 96.2695929195617,
			 0.47, 2508.61559768168, 98.0057253946339))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(166, -0.149419559529433, 0.536903016012526, "contcor1:contcor2",
			 0.215921235573074, 0.208588149268201, "<unicode>", 1.03228495744729,
			 "contGamma", 0.166051357775745, 113, 192, 1.48461029419318,
			 3.40393758827913, "contGamma:contcor1:contcor2", 2.39344617114833,
			 2.36932162037951, "<unicode>", 1.01101361631755, "contGamma",
			 0.52815870042157, 128, 112, -1.29848197404081, 0.391316750288293,
			 "contGamma:contcor2", -0.350500491514534, -0.327202967716366,
			 "<unicode>", 1.00398377967254, "contGamma", 0.447465299908567,
			 149, 94, -0.403954096983847, 0.162611736573865, "contcor2",
			 -0.0952505489443087, -0.0869730154785844, "<unicode>", 1.01073365060689,
			 "contGamma", 0.146888457190684, 131, 36, -1.40738284730613,
			 0.0911368658369147, "contGamma:contcor1", -0.589907755263306,
			 -0.574612749384804, "<unicode>", 1.02389761705725, "contGamma",
			 0.395258175287566, 177, 34, -0.568031662602012, -0.0076254409083889,
			 "contcor1", -0.247539390995983, -0.230282619874319, "<unicode>",
			 1.00469459451857, "contGamma", 0.147607358604536, 92, 206, 1.86962376250784,
			 3.13690385102933, "contGamma", 2.45587427331311, 2.42853967925431,
			 "<unicode>", 1.00453346481674, "contGamma", 0.345013489478634,
			 133, 212, 0.893411707851628, 1.44416419099017, "contNormal",
			 1.14703990140396, 1.13672381873438, "<unicode>", 1.00072432919424,
			 "contNormal", 0.149940429399468, 130, 141, -0.000312545724401144,
			 0.385966091716906, "contcor1:contcor2", 0.199089558455435, 0.207884826766354,
			 "<unicode>", 1.00114373770369, "contcor1", 0.101801806911023,
			 131, 133, -0.562394139156735, 0.610037574766408, "contGamma:contcor1:contcor2",
			 0.126427055362021, 0.147369680806889, "<unicode>", 1.00233752974244,
			 "contcor1", 0.304571898049222, 174, 34, 0.873244359561934, 2.04314883517698,
			 "contGamma:contcor2", 1.39837637562561, 1.36640630000888, "<unicode>",
			 1.05377399406258, "contcor1", 0.329137210045056, 73, 41, 0.424513750701548,
			 0.865780321933671, "contcor2", 0.605594486749991, 0.589832754720486,
			 "<unicode>", 1.0479614229634, "contcor1", 0.122046084396122,
			 91, 111, 1.32192140378797, 2.71201608512838, "contGamma:contcor1",
			 1.96860316272315, 1.9581701802209, "<unicode>", 1.02247296454381,
			 "contcor1", 0.338985216231766, 111, 132, 0.775695459422527,
			 1.32744813383937, "contcor1", 1.00008080726394, 0.985543402697101,
			 "<unicode>", 1.01066829368484, "contcor1", 0.151641149298386,
			 73, 151, -0.183724277398086, 0.805782492312682, "contcor1:contcor2",
			 0.305958309647108, 0.287457597835297, "<unicode>", 1.00443008929925,
			 "contGamma:contcor1", 0.246472769240675, 88, 110, -0.512880131422579,
			 2.24791153780157, "contGamma:contcor1:contcor2", 0.955773008347161,
			 0.967167294327961, "<unicode>", 1.00159121325203, "contGamma:contcor1",
			 0.701111466936265, 133, 37, 3.8499420523033, 7.05549973832323,
			 "contGamma:contcor2", 5.3093459924793, 5.23896559278582, "<unicode>",
			 1.04332639966708, "contGamma:contcor1", 0.857350147967485, 30,
			 76, 0.976363887010287, 2.05262888613652, "contcor2", 1.45040290046136,
			 1.40395666182043, "<unicode>", 1.03531532570776, "contGamma:contcor1",
			 0.292099003040896, 92, 125, 4.8791068733944, 8.20861377940378,
			 "contGamma:contcor1", 6.33260063098852, 6.2784526246993, "<unicode>",
			 1.01977959809659, "contGamma:contcor1", 0.874793254959078, 178,
			 146, 0.0100862078292589, 0.387705125700125, "contcor1:contcor2",
			 0.193865584128528, 0.187140180979378, "<unicode>", 0.997101111398458,
			 "contcor2", 0.100126760587461, 182, 131, -0.168015503933464,
			 0.905293791112729, "contGamma:contcor1:contcor2", 0.33759340994574,
			 0.335405333808585, "<unicode>", 0.998794586019226, "contcor2",
			 0.281963328540587, 150, 52, 1.6256377777602, 3.03390168940742,
			 "contGamma:contcor2", 2.23395082145603, 2.17194641745036, "<unicode>",
			 1.044387941757, "contcor2", 0.385445431944612, 81, 48, 0.740067737161116,
			 1.28683938957657, "contcor2", 0.987395226025277, 0.97117217649271,
			 "<unicode>", 1.05050112207496, "contcor2", 0.147992875609791,
			 94, 150, -0.0643109181486361, 0.92767123938806, "contcor1:contcor2",
			 0.392784029895433, 0.380730178125946, "<unicode>", 1.00105310516472,
			 "contGamma:contcor2", 0.267378169308068, 154, 150, 0.416395205371031,
			 3.54360904130892, "contGamma:contcor1:contcor2", 1.87322642572983,
			 1.80808390644978, "<unicode>", 0.996761405551021, "contGamma:contcor2",
			 0.781743855237158, 133, 83, 5.84154470171244, 10.0463385990272,
			 "contGamma:contcor2", 7.61915914866829, 7.4646424401172, "<unicode>",
			 1.03069242231358, "contGamma:contcor2", 1.15301531777088, 137,
			 214, 1.742712376465, 3.28246208898912, "contcor1:contcor2",
			 2.43021739425842, 2.38346304304547, "<unicode>", 0.997542649337407,
			 "contGamma:contcor1:contcor2", 0.430407095969617, 221, 201,
			 7.23915415666068, 12.8920834012303, "contGamma:contcor1:contcor2",
			 9.59216394921649, 9.59790696424517, "<unicode>", 0.995815749077017,
			 "contGamma:contcor1:contcor2", 1.41991434478441, 226, 199, 0.84209161954029,
			 1.46551201025961, "contcor1:contcor2", 1.09904996777547, 1.07178144866571,
			 "<unicode>", 0.998137746688678, "contcor1:contcor2", 0.165309642340122,
			 179))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(253, -0.229786565972954, 0.175255758278247, 16, 16, "contGamma",
			 "contNormal", -0.0142457098687457, -0.0112972248100879, "<unicode>",
			 1.0027457275831, 0.104848387751827, 134, 90, -0.265229317221966,
			 0.237289011290647, 50, 16, "contGamma", "contNormal", -0.00527094667413847,
			 -0.0109042341688807, "<unicode>", 1.01243758677967, 0.134987610597255,
			 68, 101, -0.533341933005301, 0.515000407329439, 84, 16, "contGamma",
			 "contNormal", 0.00452386668979963, 0.00595720295866416, "<unicode>",
			 1.01148679634286, 0.275942627196507, 84, 141, -0.305430175407747,
			 0.307861723366019, 16, 50, "contGamma", "contNormal", -0.0166835276284784,
			 -0.0111146994327662, "<unicode>", 0.998421050114882, 0.165937330114917,
			 150, 152, -0.205766955385071, 0.137177295598045, 50, 50, "contGamma",
			 "contNormal", -0.022915478935626, -0.0189965344481456, "<unicode>",
			 1.00240864625072, 0.0918497094309353, 187, 118, -0.352953495464871,
			 0.295213416055165, 84, 50, "contGamma", "contNormal", -0.0297168617267998,
			 -0.0325844147368804, "<unicode>", 1.00989688970663, 0.164858603940175,
			 127, 122, -0.626308709644592, 0.652082306370499, 16, 84, "contGamma",
			 "contNormal", -0.0195410242266973, -0.0283875112133646, "<unicode>",
			 0.997060807225101, 0.331414482141233, 150, 116, -0.387276056329772,
			 0.344167565871988, 50, 84, "contGamma", "contNormal", -0.0435975790282483,
			 -0.0357248376735129, "<unicode>", 0.99565632775322, 0.189019233534553,
			 149, 189, -0.280639739686209, 0.141861703546494, 84, 84, "contGamma",
			 "contNormal", -0.0698522510849023, -0.0706716109818085, "<unicode>",
			 0.998324160947099, 0.111921371869557, 185))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(152, -0.208584609676445, 0.135800058096815, "contGamma", -0.0223408477795048,
			 -0.0179001674216182, "<unicode>", "Normal(0,10)", 1.00354367383703,
			 "contNormal", 0.0910139165445177, 187, 99, -0.399208819344235,
			 0.761984043747577, "contcor1", 0.228481812076641, 0.205762460007176,
			 "<unicode>", "Normal(0,10)", 1.00335869358362, "contNormal",
			 0.288631708908114, 100, 153, -0.275660014067355, 0.267382962546468,
			 "contGamma:contcor1", -0.00590802840976452, -0.0153451068856285,
			 "<unicode>", "Normal(0,10)", 1.00380755785275, "contNormal",
			 0.135132110823261, 98, 136, -0.708762188926496, 0.430836284502093,
			 "contcor2", -0.0954154960757048, -0.0999924590925324, "<unicode>",
			 "Normal(0,10)", 1.0192883680044, "contNormal", 0.303840335256385,
			 92, 122, -0.237677760779633, 0.269037961576023, "contGamma:contcor2",
			 -0.0184396208928062, -0.0142822360937962, "<unicode>", "Normal(0,10)",
			 1.00265691308161, "contNormal", 0.129430049356111, 128, 170,
			 -0.170580504183327, 0.120640468746681, "contGamma:contcor1:contcor2",
			 -0.0163665332680243, -0.0135817352353761, "<unicode>", "Normal(0,10)",
			 0.995237067628037, "contNormal", 0.0777624343921667, 154, 153,
			 -0.240981166812888, 0.519751389951519, "contcor1:contcor2",
			 0.151456863124726, 0.1645257744369, "<unicode>", "Normal(0,10)",
			 0.999006030586488, "contNormal", 0.197457897360596, 154))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(253, -0.229786565972954, 0.175255758278247, 16, 16, "Total", "contGamma",
			 "contNormal", -0.0142457098687457, -0.0112972248100879, "<unicode>",
			 1.0027457275831, 0.104848387751827, 134, 90, -0.265229317221966,
			 0.237289011290647, 50, 16, "Total", "contGamma", "contNormal",
			 -0.00527094667413847, -0.0109042341688807, "<unicode>", 1.01243758677967,
			 0.134987610597255, 68, 101, -0.533341933005301, 0.515000407329439,
			 84, 16, "Total", "contGamma", "contNormal", 0.00452386668979963,
			 0.00595720295866416, "<unicode>", 1.01148679634286, 0.275942627196507,
			 84, 141, -0.305430175407747, 0.307861723366019, 16, 50, "Total",
			 "contGamma", "contNormal", -0.0166835276284784, -0.0111146994327662,
			 "<unicode>", 0.998421050114882, 0.165937330114917, 150, 152,
			 -0.205766955385071, 0.137177295598045, 50, 50, "Total", "contGamma",
			 "contNormal", -0.022915478935626, -0.0189965344481456, "<unicode>",
			 1.00240864625072, 0.0918497094309353, 187, 118, -0.352953495464871,
			 0.295213416055165, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0297168617267998, -0.0325844147368804, "<unicode>", 1.00989688970663,
			 0.164858603940175, 127, 122, -0.626308709644592, 0.652082306370499,
			 16, 84, "Total", "contGamma", "contNormal", -0.0195410242266973,
			 -0.0283875112133646, "<unicode>", 0.997060807225101, 0.331414482141233,
			 150, 116, -0.387276056329772, 0.344167565871988, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0435975790282483, -0.0357248376735129,
			 "<unicode>", 0.99565632775322, 0.189019233534553, 149, 189,
			 -0.280639739686209, 0.141861703546494, 84, 84, "Total", "contGamma",
			 "contNormal", -0.0698522510849023, -0.0706716109818085, "<unicode>",
			 0.998324160947099, 0.111921371869557, 185))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")

})
test_that("Test that model number 3 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facExperim",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1271.98908384386, 1179.44244011666, 58.8903993364881,
			 0.54, 1180.50744645348, 59.3008391169297))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(166, -0.128670599934832, 0.0068783153698209, "facExperimexperimental:contcor2",
			 -0.0558704546111141, -0.0547846497137879, "<unicode>", 1.01353649386898,
			 "facGenderm", 0.0336117340906604, 159, 138, -0.0917533049514064,
			 0.00914176675042242, "facGenderm:facExperimexperimental:contcor2",
			 -0.0345749736106362, -0.030951492418953, "<unicode>", 0.999544970836205,
			 "facGenderm", 0.0266647821733042, 160, 143, -0.0755320224902202,
			 0.0571881952454857, "facGenderm:contcor2", -0.00577809489808812,
			 -0.00645304809703546, "<unicode>", 0.997899255777013, "facGenderm",
			 0.0340759173784998, 116, 190, -0.132819015606433, 0.0360503872872672,
			 "contcor2", -0.0525479019753422, -0.0557214582352107, "<unicode>",
			 1.00203134978856, "facGenderm", 0.0466841039161213, 181, 233,
			 0.0994559550254804, 0.204753738496413, "facGenderm:facExperimexperimental",
			 0.144628900905382, 0.141800551223199, "<unicode>", 1.02152308527485,
			 "facGenderm", 0.0273059834727119, 119, 173, -0.0123827419067239,
			 0.0922874547342403, "facExperimexperimental", 0.034964972854957,
			 0.0309009160110916, "<unicode>", 1.01134490841039, "facGenderm",
			 0.0273005910374994, 122, 208, 0.202479269173341, 0.332751173819483,
			 "facGenderm", 0.263491643450115, 0.262862084048871, "<unicode>",
			 1.0024718815443, "facGenderm", 0.0380072448412495, 178, 154,
			 0.85938135313477, 1.42055041313553, "contNormal", 1.10167289801315,
			 1.08703527238908, "<unicode>", 0.998960561632335, "contNormal",
			 0.149924697124749, 111, 193, -0.07609658375295, 0.0463879757342605,
			 "facExperimexperimental:contcor2", -0.0128282792101974, -0.0110832623296693,
			 "<unicode>", 1.00082402095534, "facExperimexperimental", 0.0330883080756927,
			 154, 177, -0.0805409821952956, 0.0114140001331945, "facGenderm:facExperimexperimental:contcor2",
			 -0.0360400551330019, -0.0374425225486865, "<unicode>", 1.00089353500198,
			 "facExperimexperimental", 0.025852465163038, 154, 184, -0.118855669477018,
			 0.0180442293410572, "facGenderm:contcor2", -0.0614793982684098,
			 -0.0667588384435468, "<unicode>", 1.00709775859149, "facExperimexperimental",
			 0.0324281403387969, 153, 194, -0.169351727259221, 0.0491578378658628,
			 "contcor2", -0.0628338673934863, -0.063778531768622, "<unicode>",
			 0.995536027197299, "facExperimexperimental", 0.0515336594641899,
			 154, 265, 0.0936650141231762, 0.206580480472296, "facGenderm:facExperimexperimental",
			 0.145023572884348, 0.14114507818096, "<unicode>", 0.996203598332344,
			 "facExperimexperimental", 0.0296128722529358, 149, 168, 0.197763815737003,
			 0.344775316082479, "facExperimexperimental", 0.263049970387354,
			 0.260313702005706, "<unicode>", 1.00037059067384, "facExperimexperimental",
			 0.0374498070469138, 132, 117, -0.118898989285385, -0.00157638504058864,
			 "facExperimexperimental:contcor2", -0.0598174608805795, -0.0617061650635571,
			 "<unicode>", 1.00253951925556, "facGenderm:facExperimexperimental",
			 0.0287136300031744, 149, 104, -0.0925344836393631, -0.000535664396487743,
			 "facGenderm:facExperimexperimental:contcor2", -0.0470972558783238,
			 -0.0469904558187835, "<unicode>", 0.996607975883507, "facGenderm:facExperimexperimental",
			 0.0241878005269939, 154, 163, -0.124119834996483, -0.0074181122806541,
			 "facGenderm:contcor2", -0.0622336570903058, -0.0616061885109902,
			 "<unicode>", 0.996237432113462, "facGenderm:facExperimexperimental",
			 0.0304508300946412, 154, 168, -0.165603706586333, -0.00709178591986044,
			 "contcor2", -0.0857873295579502, -0.0893935654023841, "<unicode>",
			 1.00305420297441, "facGenderm:facExperimexperimental", 0.0422018993214753,
			 217, 203, 0.161321174539904, 0.28833306616661, "facGenderm:facExperimexperimental",
			 0.212219504633051, 0.206733484113301, "<unicode>", 1.00458847303225,
			 "facGenderm:facExperimexperimental", 0.0319124183036193, 182,
			 119, 0.288202768229022, 0.564243268921327, "facExperimexperimental:contcor2",
			 0.404855413239496, 0.394497765116499, "<unicode>", 0.996798424878923,
			 "contcor2", 0.0706046274387341, 154, 143, 0.171484210565972,
			 0.366339340666742, "facGenderm:facExperimexperimental:contcor2",
			 0.251403631919162, 0.242626922574977, "<unicode>", 0.997747734836334,
			 "contcor2", 0.0528792049817381, 177, 165, 0.304581182729957,
			 0.544793612190114, "facGenderm:contcor2", 0.411923055970299,
			 0.40927028542135, "<unicode>", 0.996474401932058, "contcor2",
			 0.0656354005740812, 177, 153, 0.780456807303855, 1.25701104811108,
			 "contcor2", 0.998495426628416, 1.00525511166016, "<unicode>",
			 0.996367159990137, "contcor2", 0.127655580341805, 184, 125,
			 0.186796791085209, 0.335453875156393, "facExperimexperimental:contcor2",
			 0.251668586624106, 0.245689404849939, "<unicode>", 1.00440069284911,
			 "facGenderm:contcor2", 0.0392111269032207, 105, 142, 0.201250676331191,
			 0.33364880355534, "facGenderm:facExperimexperimental:contcor2",
			 0.263119893899144, 0.260907940653121, "<unicode>", 0.995532862839681,
			 "facGenderm:contcor2", 0.0350872184922524, 134, 117, 0.349513494220643,
			 0.542290993065799, "facGenderm:contcor2", 0.434144351352921,
			 0.433199074163397, "<unicode>", 1.0026849404407, "facGenderm:contcor2",
			 0.0487172299076491, 159, 167, 0.203790383106477, 0.339048170432236,
			 "facExperimexperimental:contcor2", 0.260948974845777, 0.255337475141142,
			 "<unicode>", 0.996058841722275, "facGenderm:facExperimexperimental:contcor2",
			 0.035899277315651, 144, 208, 0.211388149464085, 0.338323030531347,
			 "facGenderm:facExperimexperimental:contcor2", 0.269344575137063,
			 0.269357229348804, "<unicode>", 1.00579215632061, "facGenderm:facExperimexperimental:contcor2",
			 0.0335392247121275, 221, 121, 0.329157738526402, 0.536094766937151,
			 "facExperimexperimental:contcor2", 0.427114749269356, 0.419886542860825,
			 "<unicode>", 0.995475350799218, "facExperimexperimental:contcor2",
			 0.0526468306293666, 124))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(155, -0.861216911425807, 0.791635059104094, 16, 0, "m", "facGender",
			 "contNormal", -0.0206280397674707, -0.0262219191753438, "<unicode>",
			 1.00576654204458, 0.443312668770989, 182, 168, -0.33370230360486,
			 1.44940040327834, 16, 1, "m", "facGender", "contNormal", 0.605564109372416,
			 0.638267771215127, "<unicode>", 0.996003403682383, 0.487551396581087,
			 219, 148, -0.100125722487181, 1.05964920001984, 50, 0, "m",
			 "facGender", "contNormal", 0.478689147792807, 0.504467703085895,
			 "<unicode>", 1.01941677520375, 0.308726965964481, 136, 163,
			 -0.317334491111856, 0.992868233865051, 50, 1, "m", "facGender",
			 "contNormal", 0.301217342222763, 0.278648808095533, "<unicode>",
			 0.999479136524306, 0.340313049659664, 106, 151, 0.290929445249424,
			 1.79561411689342, 84, 0, "m", "facGender", "contNormal", 1.06396553245667,
			 1.09058888375947, "<unicode>", 1.00898238451344, 0.415190405703404,
			 154, 169, -1.01823280952062, 1.06262353156413, 84, 1, "m", "facGender",
			 "contNormal", -0.0555237834569534, -0.0836340478871561, "<unicode>",
			 0.997467739472907, 0.534839729019104, 133))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(145, -0.10979283870703, 1.04733917665389, "facGenderm", 0.463036407272727,
			 0.488841914271049, "<unicode>", "Normal(0,10)", 1.01957331930555,
			 "contNormal", 0.310082460390014, 115, 119, -0.541248700201927,
			 0.644196250938594, "facExperimexperimental", 0.106149606844167,
			 0.114475189528848, "<unicode>", "Normal(0,10)", 1.00361823372149,
			 "contNormal", 0.306064096035121, 114, 96, -0.936921819699504,
			 0.853253418542405, "facGenderm:facExperimexperimental", -0.152278314014344,
			 -0.130984165440088, "<unicode>", "Normal(0,10)", 1.00892845093902,
			 "contNormal", 0.439340958982701, 114, 208, -0.279467882566421,
			 0.32176263878029, "contcor2", 0.0281865893811962, 0.0273685657300179,
			 "<unicode>", "Normal(0,10)", 0.998741647565854, "contNormal",
			 0.169757613218141, 134, 153, -0.0286851357674103, 1.1286110065819,
			 "facGenderm:contcor2", 0.523503027427425, 0.531961230348687,
			 "<unicode>", "Normal(0,10)", 0.995806687044889, "contNormal",
			 0.290676810148738, 119, 117, -1.7212710730029, -0.0238524625064028,
			 "facGenderm:facExperimexperimental:contcor2", -0.842591690826098,
			 -0.82506684399836, "<unicode>", "Normal(0,10)", 0.996521318290767,
			 "contNormal", 0.46317699560633, 213, 118, -0.464715328493826,
			 0.767595008588203, "facExperimexperimental:contcor2", 0.12908458927085,
			 0.138168932724938, "<unicode>", "Normal(0,10)", 0.997687472597358,
			 "contNormal", 0.337642513678399, 124))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(155, -0.861216911425807, 0.791635059104094, 16, 0, "m", "Total",
			 "facGender", "contNormal", -0.0206280397674707, -0.0262219191753438,
			 "<unicode>", 1.00576654204458, 0.443312668770989, 182, 168,
			 -0.33370230360486, 1.44940040327834, 16, 1, "m", "Total", "facGender",
			 "contNormal", 0.605564109372416, 0.638267771215127, "<unicode>",
			 0.996003403682383, 0.487551396581087, 219, 148, -0.100125722487181,
			 1.05964920001984, 50, 0, "m", "Total", "facGender", "contNormal",
			 0.478689147792807, 0.504467703085895, "<unicode>", 1.01941677520375,
			 0.308726965964481, 136, 163, -0.317334491111856, 0.992868233865051,
			 50, 1, "m", "Total", "facGender", "contNormal", 0.301217342222763,
			 0.278648808095533, "<unicode>", 0.999479136524306, 0.340313049659664,
			 106, 151, 0.290929445249424, 1.79561411689342, 84, 0, "m", "Total",
			 "facGender", "contNormal", 1.06396553245667, 1.09058888375947,
			 "<unicode>", 1.00898238451344, 0.415190405703404, 154, 169,
			 -1.01823280952062, 1.06262353156413, 84, 1, "m", "Total", "facGender",
			 "contNormal", -0.0555237834569534, -0.0836340478871561, "<unicode>",
			 0.997467739472907, 0.534839729019104, 133))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")

})
test_that("Test that model number 4 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 469.527823892241, 456.250562086862, 32.626931371398,
			 0.48, 456.494010579777, 32.809324497651))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(228, 1.74856548474601, 3.04393943721089, "contGamma", 2.32381190834546,
			 2.30092750692382, "<unicode>", 1.01024200971301, "contGamma",
			 0.346174807238624, 153, 224, 0.902530107157511, 1.54442089757232,
			 "contNormal", 1.14410855334364, 1.12132080426958, "<unicode>",
			 1.06539385981061, "contNormal", 0.157775215820895, 149, 241,
			 0.0050580726467018, 0.00891674067948193, "debCollin1", 0.00685219357363188,
			 0.00674261704601236, "<unicode>", 1.00338699718214, "debCollin1",
			 0.00101036827336606, 150))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(215, -0.191929730779594, 0.0974329517311504, "contGamma", "contNormal",
			 "", -0.0439515287039537, -0.0415417548815569, "<unicode>", "",
			 1.00017783377472, 0.0798354052630434, 153, 17, -0.0287278949342709,
			 0.033611431009088, "contGamma", "debCollin1", "contNormal",
			 -0.000252668024395932, -0.00234231371300954, "<unicode>", "<unicode>",
			 1.04780355087961, 0.0147174699474759, 14))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(215, -0.191929730779594, 0.0974329517311504, "contGamma", -0.0439515287039537,
			 -0.0415417548815569, "<unicode>", "Normal(0,10)", 1.00017783377472,
			 "contNormal", 0.0798354052630434, 153, 11, -2.65168463795952,
			 2.83975094217281, "debCollin1", -0.0385734461852831, 0.330915287226148,
			 "<unicode>", "Normal(0,10)", 1.10263531582785, "contNormal",
			 1.433942523607, 13, 186, -0.0179174256877942, -0.000108067188096465,
			 "contGamma", -0.00896560406797794, -0.00898011210188691, "<unicode>",
			 "Normal(0,10)", 0.995438867710705, "debCollin1", 0.00468230865823426,
			 133))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(215, -0.198670197847176, 0.0987955698199101, "Total", "contGamma",
			 "contNormal", -0.0442041967283497, -0.0458181626013741, "<unicode>",
			 0.996883061285561, 0.0802420261734484, 153, 17, -0.0287278949342709,
			 0.033611431009088, "Total indirect", "contGamma", "contNormal",
			 -0.000252668024395932, -0.00234231371300954, "<unicode>", 1.04780355087961,
			 0.0147174699474759, 14))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")

})
test_that("Test that model number 4 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 244.884117305418, 230.415201244415, 23.6654876142211,
			 0.39, 230.349890563148, 23.6615681401644))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(292, 0.193763695222757, 0.338164163419624, "facGenderm", 0.259587170703392,
			 0.256699534203881, "<unicode>", 0.99808162266972, "facGenderm",
			 0.0369278881748382, 115, 179, 0.849911484021162, 1.46406981265165,
			 "contNormal", 1.11973317344843, 1.12013423554629, "<unicode>",
			 1.00287671891394, "contNormal", 0.15548593528484, 110, 159,
			 0.00528704747910845, 0.00909799460255634, "debCollin1", 0.00706335264614362,
			 0.00699660017704521, "<unicode>", 1.00684814979254, "debCollin1",
			 0.00104352725048693, 114))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(66, -0.047567054352194, 0.914135163176607, "m", "facGender", "contNormal",
			 "", 0.429342717987511, 0.436904229811381, "<unicode>", "", 1.02933483343427,
			 0.2496816365287, 65, 79, -0.0606032656742931, 0.0568426159331521,
			 "m", "facGender", "debCollin1", "contNormal", -0.0016327460164708,
			 0.000262270038631504, "<unicode>", "<unicode>", 1.0295171882211,
			 0.0275098001425599, 104))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(66, -0.047567054352194, 0.914135163176607, "facGenderm", 0.429342717987511,
			 0.436904229811381, "<unicode>", "Normal(0,10)", 1.02933483343427,
			 "contNormal", 0.2496816365287, 65, 5, -1.97169591418546, 3.22599677407753,
			 "debCollin1", 0.420009356543194, 0.226325204065384, "<unicode>",
			 "Normal(0,10)", 1.1783426376068, "contNormal", 1.53059863840366,
			 24, 242, -0.0352012652811309, 0.0189180789682228, "facGenderm",
			 -0.00895995645571275, -0.00883250937557945, "<unicode>", "Normal(0,10)",
			 0.999984991957326, "debCollin1", 0.0154736164749783, 183))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(64, -0.0716688358123485, 0.923851145302375, "m", "Total", "facGender",
			 "contNormal", 0.42770997197104, 0.435762949988974, "<unicode>",
			 1.01589601631067, 0.251154418266489, 78, 79, -0.0606032656742931,
			 0.0568426159331521, "m", "Total indirect", "facGender", "contNormal",
			 -0.0016327460164708, 0.000262270038631504, "<unicode>", 1.0295171882211,
			 0.0275098001425599, 104))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")

})
test_that("Test that model number 10 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1693.88260031122, 1632.86723418505, 67.9275906700579,
			 0.465, 1636.31599817375, 69.3355304267227))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(45, -0.885168747707604, 0.625430831124942, "contGamma:contcor2",
			 -0.219553590152097, -0.230269720437678, "<unicode>", 1.05795107867048,
			 "contGamma", 0.378177043981694, 123, 91, -0.316602731429726,
			 0.21286920769974, "contcor2", -0.0666336565095742, -0.0769905612286634,
			 "<unicode>", 1.03397000104479, "contGamma", 0.137001357224387,
			 152, 46, -1.03526279972627, 0.243143328922419, "contGamma:contcor1",
			 -0.460339893571114, -0.478721028708414, "<unicode>", 1.06593051693427,
			 "contGamma", 0.335601504293455, 87, 97, -0.469988419468367,
			 0.0746093042059677, "contcor1", -0.199622732463874, -0.209814367683135,
			 "<unicode>", 1.03640946241839, "contGamma", 0.143545061678427,
			 142, 240, 1.87677738297063, 3.28449903122417, "contGamma", 2.44295892434202,
			 2.41512858694355, "<unicode>", 0.998622543990974, "contGamma",
			 0.370559679640126, 154, 345, 0.879565040265933, 1.47572931066781,
			 "contNormal", 1.15483860984863, 1.13697489479729, "<unicode>",
			 0.998113606243024, "contNormal", 0.162253809723869, 128, 246,
			 0.00508510959389389, 0.00910426727223025, "debCollin1", 0.00694861489864511,
			 0.00683114167606393, "<unicode>", 1.00191239253525, "debCollin1",
			 0.00115356760513749, 59, 137, 0.892245160772145, 2.01312863588454,
			 "contGamma:contcor2", 1.3658943229803, 1.33811869909893, "<unicode>",
			 0.999733784403841, "contcor1", 0.286011628561343, 136, 152,
			 0.396853714698446, 0.811209693072039, "contcor2", 0.586735166231396,
			 0.573007791240514, "<unicode>", 0.996539812113422, "contcor1",
			 0.105497477696515, 149, 173, 1.41581990859101, 2.68247119606349,
			 "contGamma:contcor1", 1.92544589591245, 1.87778041481434, "<unicode>",
			 0.999347361326645, "contcor1", 0.325832850023924, 177, 217,
			 0.75046649849926, 1.28367794497817, "contcor1", 0.98378630679107,
			 0.973186864229037, "<unicode>", 0.998050266826371, "contcor1",
			 0.145063924309979, 119, 157, 3.84765384850534, 6.9300082763826,
			 "contGamma:contcor2", 5.20913952529649, 5.14221887539153, "<unicode>",
			 0.99680656527911, "contGamma:contcor1", 0.811476891342496, 136,
			 127, 0.919382279040402, 1.94224156207244, "contcor2", 1.39486895079107,
			 1.38988156602726, "<unicode>", 0.996492185536707, "contGamma:contcor1",
			 0.247617224229215, 178, 187, 4.79167636397877, 8.21328130949028,
			 "contGamma:contcor1", 6.20034786831106, 6.13050301194565, "<unicode>",
			 1.00050918573346, "contGamma:contcor1", 0.856585663679661, 136,
			 189, 1.61511535629968, 2.87788378218962, "contGamma:contcor2",
			 2.16139263963472, 2.1532550019279, "<unicode>", 0.995622680907419,
			 "contcor2", 0.313978731355725, 160, 213, 0.742518100574356,
			 1.20813590057775, "contcor2", 0.953312276500601, 0.942070104182187,
			 "<unicode>", 0.999018886748944, "contcor2", 0.122383608910217,
			 184, 209, 5.73590972653956, 9.79445532187602, "contGamma:contcor2",
			 7.45258493545337, 7.32461271952026, "<unicode>", 1.00071263279837,
			 "contGamma:contcor2", 1.05713090602244, 224))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(307, -0.188669540315957, 0.202486686268963, 16, 16, "contGamma",
			 "contNormal", "", 0.00749018290917236, 0.0144278959646038, "<unicode>",
			 "", 0.998135799904837, 0.104934619099936, 123, 140, -0.248688371798228,
			 0.261460438080268, 50, 16, "contGamma", "contNormal", "", 0.00303365158521731,
			 -0.00404987051556581, "<unicode>", "", 1.02737545008015, 0.141312331152505,
			 91, 119, -0.469400166595205, 0.473458495339232, 84, 16, "contGamma",
			 "contNormal", "", -0.00183008594436037, -0.0194988202361919,
			 "<unicode>", "", 1.02718297220105, 0.251857877830088, 133, 143,
			 -0.312495308369241, 0.229206484971263, 16, 50, "contGamma",
			 "contNormal", "", -0.0231669734059629, -0.0150599506626698,
			 "<unicode>", "", 0.999933840577688, 0.141195225157368, 154,
			 249, -0.183592224018822, 0.132612669528619, 50, 50, "contGamma",
			 "contNormal", "", -0.0276235047299179, -0.0342877462386111,
			 "<unicode>", "", 1.01177094472853, 0.0828893435404553, 94, 159,
			 -0.356417227837563, 0.28387811908538, 84, 50, "contGamma", "contNormal",
			 "", -0.0324872422594956, -0.051751229801094, "<unicode>", "",
			 0.998829141193406, 0.162167113313545, 132, 109, -0.547602214168433,
			 0.382258300681511, 16, 84, "contGamma", "contNormal", "", -0.0591018662140162,
			 -0.0368781028340815, "<unicode>", "", 1.01829491326104, 0.250736681827064,
			 149, 132, -0.356650232532961, 0.234512726775368, 50, 84, "contGamma",
			 "contNormal", "", -0.0635583975379712, -0.0601854671622412,
			 "<unicode>", "", 1.00453558254495, 0.154882826279715, 106, 278,
			 -0.315119863128293, 0.153051906772908, 84, 84, "contGamma",
			 "contNormal", "", -0.0684221350675489, -0.0594528914320812,
			 "<unicode>", "", 0.995445990012524, 0.123461352685181, 176,
			 43, -0.0152952621794681, 0.0215423308913949, 16, 16, "contGamma",
			 "debCollin1", "contNormal", -0.000214107005112738, -0.00051263544337043,
			 "<unicode>", "<unicode>", 1.05822570102487, 0.0081130931602452,
			 74, 25, -0.0220825979604282, 0.0287082205765807, 50, 16, "contGamma",
			 "debCollin1", "contNormal", 0.000580773053904673, -0.00020297214505798,
			 "<unicode>", "<unicode>", 1.07570804006284, 0.0137749260556264,
			 56, 34, -0.0399396665027727, 0.0503554350775574, 84, 16, "contGamma",
			 "debCollin1", "contNormal", 0.00144828361167292, 2.61129463047005e-05,
			 "<unicode>", "<unicode>", 1.11364975620362, 0.0242257011483933,
			 26, 117, -0.027306470459483, 0.0240893922108478, 16, 50, "contGamma",
			 "debCollin1", "contNormal", -0.00086181218991136, -0.00055096027347334,
			 "<unicode>", "<unicode>", 1.04269494004589, 0.0107135876766881,
			 78, 11, -0.0191599025315226, 0.0203886890329687, 50, 50, "contGamma",
			 "debCollin1", "contNormal", -6.69321308939488e-05, -0.000660484729887418,
			 "<unicode>", "<unicode>", 1.07323923971697, 0.00957992714424063,
			 44, 17, -0.0335908070431854, 0.0438423492315112, 84, 50, "contGamma",
			 "debCollin1", "contNormal", 0.000800578426874298, -0.000158872542340148,
			 "<unicode>", "<unicode>", 1.05993490065789, 0.018126034337504,
			 36, 239, -0.0438244556273897, 0.0350910587172413, 16, 84, "contGamma",
			 "debCollin1", "contNormal", -0.00162102208360486, 5.15104614036599e-05,
			 "<unicode>", "<unicode>", 1.13881385180338, 0.019791385647694,
			 78, 25, -0.0337776801902121, 0.026543850618179, 50, 84, "contGamma",
			 "debCollin1", "contNormal", -0.000826142024587448, 6.90039092068023e-05,
			 "<unicode>", "<unicode>", 1.0910551909834, 0.0140166266545684,
			 66, 13, -0.0311419331603541, 0.0416179990991053, 84, 84, "contGamma",
			 "debCollin1", "contNormal", 4.13685331807994e-05, -0.000869995394784464,
			 "<unicode>", "<unicode>", 1.05874489707151, 0.0156614136341134,
			 35))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(246, -0.183490445962476, 0.132344876475697, "contGamma", -0.0266458028658798,
			 -0.0317821577101966, "<unicode>", "Normal(0,10)", 1.01582084859807,
			 "contNormal", 0.0829776610589483, 94, 9, -1.9564082169687, 1.52049236965893,
			 "debCollin1", 0.033945852541184, 0.117406854676949, "<unicode>",
			 "Normal(0,10)", 1.08976201587582, "contNormal", 0.921602072497242,
			 38, 87, -0.222260648260115, 0.679455503273811, "contcor1", 0.256717814903876,
			 0.268791779637957, "<unicode>", "Normal(0,10)", 1.00576095093203,
			 "contNormal", 0.249020742253008, 148, 132, -0.206565303636633,
			 0.247054052253864, "contGamma:contcor1", -0.00457483659838939,
			 -0.0190853326214751, "<unicode>", "Normal(0,10)", 1.01162873472259,
			 "contNormal", 0.12471141791399, 159, 90, -0.668302467428991,
			 0.411906973834213, "contcor2", -0.0628048781018564, -0.0677796156643763,
			 "<unicode>", "Normal(0,10)", 1.0048952675736, "contNormal",
			 0.272256268198261, 62, 101, -0.24355630007616, 0.165673251861614,
			 "contGamma:contcor2", -0.0321421223685629, -0.0220918423943299,
			 "<unicode>", "Normal(0,10)", 1.00573365432076, "contNormal",
			 0.118401335665951, 77, 190, -0.0202335298170693, 0.000372265003397012,
			 "contGamma", -0.00922942679792268, -0.00916497142456824, "<unicode>",
			 "Normal(0,10)", 1.00189912080224, "debCollin1", 0.00515713978323704,
			 119, 224, -0.0358287650112377, 0.0438419813800073, "contcor1",
			 0.0036669379918549, 0.00230450129628918, "<unicode>", "Normal(0,10)",
			 1.0175454654568, "debCollin1", 0.0194208935193997, 148, 231,
			 -0.0259351448437645, 0.0144545600673061, "contGamma:contcor1",
			 -0.0044279292704997, -0.00499365232693072, "<unicode>", "Normal(0,10)",
			 1.0418552510323, "debCollin1", 0.0107030830724991, 133, 261,
			 -0.0387786015680496, 0.0548764699787518, "contcor2", 0.00960638214577899,
			 0.00949525493418033, "<unicode>", "Normal(0,10)", 1.02387626163503,
			 "debCollin1", 0.0226761090153798, 88, 244, -0.0203879124032356,
			 0.022299507672297, "contGamma:contcor2", -0.000550085739554588,
			 -0.0001305736635382, "<unicode>", "Normal(0,10)", 1.03179540213882,
			 "debCollin1", 0.0106661189541282, 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(313, -0.185476090814365, 0.198103441321015, 16, 16, "Total", "contGamma",
			 "contNormal", 0.00727607590405962, 0.0140926901040084, "<unicode>",
			 1.00092888264072, 0.105590401020841, 217, 147, -0.248137286036721,
			 0.258636303554057, 50, 16, "Total", "contGamma", "contNormal",
			 0.00361442463912199, -0.00456296754429335, "<unicode>", 1.0263607709691,
			 0.141408061798132, 133, 126, -0.453874085856998, 0.471528650650359,
			 84, 16, "Total", "contGamma", "contNormal", -0.000381802332687447,
			 -0.0164318007006024, "<unicode>", 1.03763684489043, 0.251248568240989,
			 123, 141, -0.321432799916981, 0.235178686587972, 16, 50, "Total",
			 "contGamma", "contNormal", -0.0240287855958743, -0.0178051424943584,
			 "<unicode>", 1.00311832296467, 0.141235068695648, 133, 231,
			 -0.183913183960015, 0.136716234456311, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0276904368608119, -0.0342117707472141, "<unicode>",
			 1.0125314413239, 0.0831247971630496, 117, 174, -0.345189420072553,
			 0.277713169390516, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0316866638326213, -0.0513213676148126, "<unicode>", 1.0016942579605,
			 0.161725579321669, 132, 107, -0.553690839585425, 0.379394267172329,
			 16, 84, "Total", "contGamma", "contNormal", -0.060722888297621,
			 -0.0424213394443304, "<unicode>", 1.02060155551177, 0.250600592458637,
			 149, 125, -0.361528290650153, 0.231012719336032, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0643845395625587, -0.0626556758702685,
			 "<unicode>", 1.00222655307852, 0.155277261155754, 106, 268,
			 -0.320059859181102, 0.158288088640901, 84, 84, "Total", "contGamma",
			 "contNormal", -0.0683807665343681, -0.0629555682835576, "<unicode>",
			 0.995267453794695, 0.123937659092047, 176, 43, -0.0152952621794681,
			 0.0215423308913949, 16, 16, "Total indirect", "contGamma", "contNormal",
			 -0.000214107005112738, -0.00051263544337043, "<unicode>", 1.05822570102487,
			 0.0081130931602452, 74, 25, -0.0220825979604282, 0.0287082205765807,
			 50, 16, "Total indirect", "contGamma", "contNormal", 0.000580773053904673,
			 -0.00020297214505798, "<unicode>", 1.07570804006284, 0.0137749260556264,
			 56, 34, -0.0399396665027727, 0.0503554350775574, 84, 16, "Total indirect",
			 "contGamma", "contNormal", 0.00144828361167292, 2.61129463047005e-05,
			 "<unicode>", 1.11364975620362, 0.0242257011483933, 26, 117,
			 -0.027306470459483, 0.0240893922108478, 16, 50, "Total indirect",
			 "contGamma", "contNormal", -0.00086181218991136, -0.00055096027347334,
			 "<unicode>", 1.04269494004589, 0.0107135876766881, 78, 11, -0.0191599025315226,
			 0.0203886890329687, 50, 50, "Total indirect", "contGamma", "contNormal",
			 -6.69321308939488e-05, -0.000660484729887418, "<unicode>", 1.07323923971697,
			 0.00957992714424063, 44, 17, -0.0335908070431854, 0.0438423492315112,
			 84, 50, "Total indirect", "contGamma", "contNormal", 0.000800578426874298,
			 -0.000158872542340148, "<unicode>", 1.05993490065789, 0.018126034337504,
			 36, 239, -0.0438244556273897, 0.0350910587172413, 16, 84, "Total indirect",
			 "contGamma", "contNormal", -0.00162102208360486, 5.15104614036599e-05,
			 "<unicode>", 1.13881385180338, 0.019791385647694, 78, 25, -0.0337776801902121,
			 0.026543850618179, 50, 84, "Total indirect", "contGamma", "contNormal",
			 -0.000826142024587448, 6.90039092068023e-05, "<unicode>", 1.0910551909834,
			 0.0140166266545684, 66, 13, -0.0311419331603541, 0.0416179990991053,
			 84, 84, "Total indirect", "contGamma", "contNormal", 4.13685331807994e-05,
			 -0.000869995394784464, "<unicode>", 1.05874489707151, 0.0156614136341134,
			 35))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")

})
test_that("Test that model number 10 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, "Model 1", 100, 908.379502987101, 837.054948520311, 37.5715961341654,
			 0.505, 837.10505009496, 37.6458950376805))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(149, -0.0878264582708607, 0.0574181928465572, "facGenderm:contcor2",
			 -0.0119291431579528, -0.0111752294452088, "<unicode>", 1.02462936932578,
			 "facGenderm", 0.037078333873103, 154, 183, -0.174787765559707,
			 0.0319628900785731, "contcor2", -0.0659119039224007, -0.0651395588581757,
			 "<unicode>", 1.01476329980239, "facGenderm", 0.0524453906196101,
			 151, 126, 0.0966041300153888, 0.218230550893158, "facGenderm:facExperimexperimental",
			 0.145493829193565, 0.141720547878087, "<unicode>", 1.01768415683898,
			 "facGenderm", 0.0294719460180874, 103, 123, -0.0183737555085446,
			 0.0802870373386364, "facExperimexperimental", 0.0319702879760442,
			 0.0306890361926727, "<unicode>", 1.00574407120415, "facGenderm",
			 0.0250668268420779, 187, 220, 0.204362354255883, 0.344833832406139,
			 "facGenderm", 0.261866781213744, 0.258194041519331, "<unicode>",
			 1.00095026923957, "facGenderm", 0.0381860309712157, 184, 189,
			 0.874649777780373, 1.45598486149904, "contNormal", 1.12940777494684,
			 1.11225294041573, "<unicode>", 1.01502914522781, "contNormal",
			 0.155813922874818, 113, 173, 0.00526404970378658, 0.00954664910727312,
			 "debCollin1", 0.00700233060496868, 0.00690102226520605, "<unicode>",
			 1.00454371901994, "debCollin1", 0.00117666421869689, 128, 99,
			 -0.132162799548134, 0.0134234238405744, "facGenderm:contcor2",
			 -0.0617884470559486, -0.0589011163912722, "<unicode>", 1.02669728494907,
			 "facExperimexperimental", 0.0380940846938676, 92, 111, -0.169207207587078,
			 0.0619942996575033, "contcor2", -0.0619592394383841, -0.0639652370825915,
			 "<unicode>", 1.01439208168756, "facExperimexperimental", 0.0579483367175774,
			 88, 182, 0.085809876717022, 0.20077219426747, "facGenderm:facExperimexperimental",
			 0.141211259150287, 0.139748346059743, "<unicode>", 0.995611014810487,
			 "facExperimexperimental", 0.0274045063714921, 137, 192, 0.195285864072829,
			 0.348904707605432, "facExperimexperimental", 0.257969136511641,
			 0.252099087325592, "<unicode>", 1.01323430440787, "facExperimexperimental",
			 0.0400011553062738, 117, 130, -0.132644551951953, -0.0118897336888057,
			 "facGenderm:contcor2", -0.067721145088408, -0.0643510841192186,
			 "<unicode>", 1.00775484081566, "facGenderm:facExperimexperimental",
			 0.0325943093657454, 119, 136, -0.199721979272525, -0.00317600831396258,
			 "contcor2", -0.0979435690047188, -0.0982180275946558, "<unicode>",
			 1.00310972484603, "facGenderm:facExperimexperimental", 0.0490783154295092,
			 149, 127, 0.161920752523989, 0.273867089987722, "facGenderm:facExperimexperimental",
			 0.208708820055188, 0.205678883688542, "<unicode>", 1.00499021224209,
			 "facGenderm:facExperimexperimental", 0.0290345547531297, 154,
			 196, 0.320271789086385, 0.62802746400748, "facGenderm:contcor2",
			 0.45163698744274, 0.442795277225392, "<unicode>", 1.00891728230456,
			 "contcor2", 0.0843636523012948, 124, 280, 0.779682931473384,
			 1.35577550503959, "contcor2", 1.03999018613318, 1.03871916280008,
			 "<unicode>", 0.996210270884215, "contcor2", 0.147074517592364,
			 190, 189, 0.347459670535931, 0.605912452334483, "facGenderm:contcor2",
			 0.462613519853469, 0.450706371553051, "<unicode>", 1.00605638750001,
			 "facGenderm:contcor2", 0.0686479622776512, 77))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(91, -0.0308222166673888, 1.33297726748127, 16, 0, "m", "facGender",
			 "contNormal", "", 0.643422680171056, 0.636649716832649, "<unicode>",
			 "", 0.995865950151234, 0.371287944123946, 129, 179, -0.345399912816708,
			 0.95098061116262, 16, 1, "m", "facGender", "contNormal", "",
			 0.300250744856184, 0.292089380140781, "<unicode>", "", 0.998078856716628,
			 0.351492431340534, 118, 73, 0.0314548634079995, 1.20305356455964,
			 50, 0, "m", "facGender", "contNormal", "", 0.667039886083316,
			 0.653378594214011, "<unicode>", "", 0.998899903339505, 0.31791742751806,
			 135, 170, -0.239775994376128, 0.915888748260414, 50, 1, "m",
			 "facGender", "contNormal", "", 0.323867950768444, 0.31270978126407,
			 "<unicode>", "", 1.01150001690484, 0.308874826647898, 71, 88,
			 -0.0999109438389718, 1.42323262328424, 84, 0, "m", "facGender",
			 "contNormal", "", 0.694722876448075, 0.713008563274001, "<unicode>",
			 "", 1.00136112592399, 0.393669407416919, 154, 182, -0.386685653380872,
			 1.16945323896638, 84, 1, "m", "facGender", "contNormal", "",
			 0.351550941133203, 0.344777217775529, "<unicode>", "", 0.995913395612326,
			 0.399293310940437, 182, 148, -0.092231909398831, 0.108988147812938,
			 16, 0, "m", "facGender", "debCollin1", "contNormal", 0.00168246997534331,
			 0.000203788416738848, "<unicode>", "<unicode>", 0.995687999872206,
			 0.0450554768080737, 95, 127, -0.0947530739933411, 0.107748130715604,
			 16, 1, "m", "facGender", "debCollin1", "contNormal", -0.000462842617739146,
			 -6.03294069311237e-05, "<unicode>", "<unicode>", 1.01532939562941,
			 0.0397841345229523, 109, 172, -0.0700619800228681, 0.0718484153556314,
			 50, 0, "m", "facGender", "debCollin1", "contNormal", 0.00061543716191704,
			 -0.00016671779858396, "<unicode>", "<unicode>", 0.998679620415044,
			 0.035541839486557, 177, 68, -0.101701509809194, 0.0780890063339251,
			 50, 1, "m", "facGender", "debCollin1", "contNormal", -0.00152987543116542,
			 -0.000869530422608744, "<unicode>", "<unicode>", 1.00615242823247,
			 0.039800950612487, 79, 156, -0.0818347387761178, 0.087266565844922,
			 84, 0, "m", "facGender", "debCollin1", "contNormal", -0.000635289075670056,
			 -0.00184162919249391, "<unicode>", "<unicode>", 0.998752131445755,
			 0.0447950625846985, 81, 60, -0.142413619246665, 0.0931776440739214,
			 84, 1, "m", "facGender", "debCollin1", "contNormal", -0.00278060166875251,
			 -0.000388491253456553, "<unicode>", "<unicode>", 1.00755576417128,
			 0.0568140479724862, 60))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(74, 0.0352389878607084, 1.19949777807893, "facGenderm", 0.666299527038677,
			 0.650037106845177, "<unicode>", "Normal(0,10)", 0.998819954019244,
			 "contNormal", 0.317911142004924, 135, 29, -2.5328775509367,
			 2.12985247492647, "debCollin1", 0.0813677371550508, 0.161887859132249,
			 "<unicode>", "Normal(0,10)", 1.00004955443149, "contNormal",
			 1.24907440650875, 35, 102, -0.341726681426165, 0.710436852121081,
			 "facExperimexperimental", 0.170109112143137, 0.164715505264282,
			 "<unicode>", "Normal(0,10)", 1.02092481891764, "contNormal",
			 0.294158966113943, 128, 67, -1.03701234474511, 0.582824387676881,
			 "facGenderm:facExperimexperimental", -0.343171935314872, -0.349139918237323,
			 "<unicode>", "Normal(0,10)", 1.00221024351586, "contNormal",
			 0.436130611901006, 68, 214, -0.231705375966188, 0.322965708295445,
			 "contcor2", 0.0294739140011524, 0.0200082363393759, "<unicode>",
			 "Normal(0,10)", 1.00480250589557, "contNormal", 0.130002076346379,
			 182, 185, -0.362005269943408, 0.413977000885584, "facGenderm:contcor2",
			 0.0247611720615016, 0.0486083953658786, "<unicode>", "Normal(0,10)",
			 0.99736317321125, "contNormal", 0.204661050202556, 102, 203,
			 -0.0419129406100798, 0.0508459891719134, "facGenderm", 0.00441637317528133,
			 0.00549801968886568, "<unicode>", "Normal(0,10)", 0.997119497123947,
			 "debCollin1", 0.0242098944724125, 174, 248, -0.0557810270918361,
			 0.0440568965153834, "facExperimexperimental", -0.00526884875161124,
			 -0.00335580742456994, "<unicode>", "Normal(0,10)", 0.996255153124268,
			 "debCollin1", 0.0253355749595093, 155, 233, -0.0838441213362,
			 0.04296079248709, "facGenderm:facExperimexperimental", -0.0205657400016268,
			 -0.0188885869199413, "<unicode>", "Normal(0,10)", 1.00126492524283,
			 "debCollin1", 0.0353203135708011, 194, 174, -0.0172789249324869,
			 0.0297170180284028, "contcor2", 0.00458052666615456, 0.00387467125809977,
			 "<unicode>", "Normal(0,10)", 1.00803796197633, "debCollin1",
			 0.0116423446307899, 154, 164, -0.0360299407988242, 0.0318833244611129,
			 "facGenderm:contcor2", -0.00494895519229771, -0.00687560857889518,
			 "<unicode>", "Normal(0,10)", 1.00029870330911, "debCollin1",
			 0.0182616104214829, 153))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(85, -0.04524248047005, 1.36214497816508, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.645105150146399, 0.623852343451058,
			 "<unicode>", 0.995774095654789, 0.373233926083581, 116, 165,
			 -0.347967531753056, 0.938245335160996, 16, 1, "m", "Total",
			 "facGender", "contNormal", 0.299787902238445, 0.294812394691939,
			 "<unicode>", 0.999704501228114, 0.352208399596248, 105, 72,
			 0.0252763611796879, 1.25375802548736, 50, 0, "m", "Total", "facGender",
			 "contNormal", 0.667655323245233, 0.658944473626575, "<unicode>",
			 1.00005909801369, 0.319875910150552, 116, 156, -0.233800126541866,
			 0.91483442144449, 50, 1, "m", "Total", "facGender", "contNormal",
			 0.322338075337279, 0.300814903919506, "<unicode>", 1.00975083335342,
			 0.312500982919399, 71, 86, -0.0328353112573338, 1.45195440040172,
			 84, 0, "m", "Total", "facGender", "contNormal", 0.694087587372405,
			 0.699353712419102, "<unicode>", 1.00419454725477, 0.397784491034907,
			 136, 157, -0.396183337600816, 1.17602271130958, 84, 1, "m",
			 "Total", "facGender", "contNormal", 0.34877033946445, 0.366230144209851,
			 "<unicode>", 0.998216868723833, 0.407407396760921, 184, 148,
			 -0.092231909398831, 0.108988147812938, 16, 0, "m", "Total indirect",
			 "facGender", "contNormal", 0.00168246997534331, 0.000203788416738848,
			 "<unicode>", 0.995687999872206, 0.0450554768080737, 95, 127,
			 -0.0947530739933411, 0.107748130715604, 16, 1, "m", "Total indirect",
			 "facGender", "contNormal", -0.000462842617739146, -6.03294069311237e-05,
			 "<unicode>", 1.01532939562941, 0.0397841345229523, 109, 172,
			 -0.0700619800228681, 0.0718484153556314, 50, 0, "m", "Total indirect",
			 "facGender", "contNormal", 0.00061543716191704, -0.00016671779858396,
			 "<unicode>", 0.998679620415044, 0.035541839486557, 177, 68,
			 -0.101701509809194, 0.0780890063339251, 50, 1, "m", "Total indirect",
			 "facGender", "contNormal", -0.00152987543116542, -0.000869530422608744,
			 "<unicode>", 1.00615242823247, 0.039800950612487, 79, 156, -0.0818347387761178,
			 0.087266565844922, 84, 0, "m", "Total indirect", "facGender",
			 "contNormal", -0.000635289075670056, -0.00184162919249391, "<unicode>",
			 0.998752131445755, 0.0447950625846985, 81, 60, -0.142413619246665,
			 0.0931776440739214, 84, 1, "m", "Total indirect", "facGender",
			 "contNormal", -0.00278060166875251, -0.000388491253456553, "<unicode>",
			 1.00755576417128, 0.0568140479724862, 60))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")

})
test_that("Test that model number 29 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1514.87003686779, 1435.41358919647, 78.5485010510322,
			 0.465, 1439.40338391239, 80.0450790865036))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(186, -0.967848096100411, 0.452154510978089, "contGamma:contcor2",
			 -0.291849310417618, -0.265593501461195, "<unicode>", 0.998698780313565,
			 "contGamma", 0.378043185912242, 160, 195, -0.243916870680855,
			 0.101892544658346, "debCollin1:contcor2", -0.0654658519351403,
			 -0.0564620323780599, "<unicode>", 0.996703862725458, "contGamma",
			 0.0859392430547605, 177, 195, -0.321166755477516, 0.168147690951242,
			 "contcor2", -0.0879968912077502, -0.0805521575938974, "<unicode>",
			 0.99688349128046, "contGamma", 0.131233053659272, 154, 176,
			 -1.27994709692854, 0.121878868210805, "contGamma:contcor1",
			 -0.568960442023387, -0.586796627276147, "<unicode>", 0.999156254261465,
			 "contGamma", 0.375010412223508, 154, 223, -0.524667093185427,
			 0.0151594937834765, "contcor1", -0.244274722810504, -0.242699500824352,
			 "<unicode>", 0.997906531037764, "contGamma", 0.152077206830925,
			 179, 216, 1.89477837580123, 3.25947407587647, "contGamma", 2.47346186128706,
			 2.43221439654675, "<unicode>", 1.00611706276886, "contGamma",
			 0.339430202703855, 142, 228, 0.925400623112082, 1.49792535713845,
			 "contNormal", 1.17479684021402, 1.16168069400592, "<unicode>",
			 1.00275989562406, "contNormal", 0.156599456762649, 79, 100,
			 -0.00273101500795134, 0.00778484747507056, "debCollin1:contcor2",
			 0.00190334982557727, 0.00176694745100292, "<unicode>", 1.02702319831274,
			 "debCollin1", 0.00258713125552547, 45, 131, -0.0041925124670287,
			 0.00908548732875236, "contcor2", 0.00194987335815836, 0.00166282966914761,
			 "<unicode>", 1.0287472278256, "debCollin1", 0.00376140331353312,
			 33, 205, 0.00527397794556418, 0.00894453715425886, "debCollin1",
			 0.00706118164878434, 0.00699935173185482, "<unicode>", 0.995048608818748,
			 "debCollin1", 0.00100705324494508, 185, 185, 0.815179309656192,
			 1.92740631892334, "contGamma:contcor2", 1.29762815853328, 1.2675619203747,
			 "<unicode>", 0.997205858197067, "contcor1", 0.283560110425948,
			 178, 145, 0.243605578538569, 0.525581670149204, "debCollin1:contcor2",
			 0.369142650248544, 0.366281047340895, "<unicode>", 1.01101824338123,
			 "contcor1", 0.0717902337962814, 153, 147, 0.362811870441262,
			 0.786797923134051, "contcor2", 0.554967031977021, 0.552212135004252,
			 "<unicode>", 1.00572322826346, "contcor1", 0.109198222993391,
			 153, 222, 1.4310757443469, 2.56889961305553, "contGamma:contcor1",
			 1.90556769169618, 1.91217259932086, "<unicode>", 0.99843907594399,
			 "contcor1", 0.292774047823114, 184, 206, 0.747756053821225,
			 1.23972722137325, "contcor1", 0.969898599206049, 0.960503609919364,
			 "<unicode>", 0.995548458860276, "contcor1", 0.126902279401376,
			 160, 234, 3.78714559474255, 6.61299362691532, "contGamma:contcor2",
			 5.01207964771345, 4.94447192944299, "<unicode>", 0.997705772473177,
			 "contGamma:contcor1", 0.746015024651628, 176, 151, 0.551810797631053,
			 1.2005084879244, "debCollin1:contcor2", 0.840596828649912, 0.830874601214724,
			 "<unicode>", 0.997201315955331, "contGamma:contcor1", 0.170958656579991,
			 133, 150, 0.819917903594644, 1.86159194496644, "contcor2", 1.31234325724369,
			 1.29581844440331, "<unicode>", 0.999880655569851, "contGamma:contcor1",
			 0.261643682765752, 133, 231, 4.82933493548085, 7.98151764799835,
			 "contGamma:contcor1", 6.16271814360574, 6.11418793264639, "<unicode>",
			 0.996588671678595, "contGamma:contcor1", 0.807768826245581,
			 191, 186, 1.53026533405438, 2.65228322769487, "contGamma:contcor2",
			 2.02021345512251, 1.9857881379037, "<unicode>", 1.03242073342196,
			 "contcor2", 0.29798977440268, 177, 208, 0.45830059441587, 0.780218774835199,
			 "debCollin1:contcor2", 0.591293447050261, 0.585297857526917,
			 "<unicode>", 1.00265880450603, "contcor2", 0.0798418519991171,
			 184, 208, 0.702823335217526, 1.18327631599917, "contcor2", 0.896875537970978,
			 0.88552053394341, "<unicode>", 1.00374189181122, "contcor2",
			 0.120578175907394, 217, 181, 0.983537680135603, 1.72182502025179,
			 "contGamma:contcor2", 1.30469491580709, 1.28904263048765, "<unicode>",
			 1.02648487675619, "debCollin1:contcor2", 0.195006687133574,
			 177, 205, 0.311937354017, 0.524110887722339, "debCollin1:contcor2",
			 0.398442628825154, 0.393001180515182, "<unicode>", 1.00083042509454,
			 "debCollin1:contcor2", 0.0534853770920226, 184, 217, 5.62143137719152,
			 8.96350316961484, "contGamma:contcor2", 7.11910816536832, 7.00624900401281,
			 "<unicode>", 1.02947803287847, "contGamma:contcor2", 0.906228573233291,
			 169))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(226, -0.211235322353988, 0.20485685286793, 16, 16, "contGamma",
			 "contNormal", "", 0.0026450400537627, 0.00295046601091923, "<unicode>",
			 "", 0.999199312777294, 0.107625584847666, 175, 200, -0.276175663297331,
			 0.196288695985021, 50, 16, "contGamma", "contNormal", "", -0.00950021158799605,
			 -0.00366810510229419, "<unicode>", "", 1.00826654313853, 0.121787515228725,
			 103, 214, -0.464382193282467, 0.39933686059236, 84, 16, "contGamma",
			 "contNormal", "", -0.0227552101333138, -0.010295707569624, "<unicode>",
			 "", 1.01155413936903, 0.225088270928815, 136, 232, -0.279857456021867,
			 0.249528391725531, 16, 50, "contGamma", "contNormal", "", -0.0169663568245788,
			 -0.00643288314090814, "<unicode>", "", 1.00918204612905, 0.149078957101945,
			 133, 160, -0.173263150538744, 0.108544822326018, 50, 50, "contGamma",
			 "contNormal", "", -0.0291116084663375, -0.0293286346140294,
			 "<unicode>", "", 0.996605763765039, 0.074773668974788, 132,
			 168, -0.318162194465189, 0.219080609211756, 84, 50, "contGamma",
			 "contNormal", "", -0.0423666070116553, -0.0337289196787228,
			 "<unicode>", "", 1.00275659668733, 0.140444140707697, 134, 204,
			 -0.509249517587178, 0.46787875521715, 16, 84, "contGamma", "contNormal",
			 "", -0.0399539241447568, -0.0344295524636766, "<unicode>", "",
			 1.01066587624973, 0.255914597131365, 119, 170, -0.354987908744378,
			 0.269280897722199, 50, 84, "contGamma", "contNormal", "", -0.0520991757865155,
			 -0.0481615214568656, "<unicode>", "", 1.01636642964748, 0.15985512864461,
			 134, 122, -0.277506659558911, 0.176724094219542, 84, 84, "contGamma",
			 "contNormal", "", -0.0653541743318333, -0.0663270206696344,
			 "<unicode>", "", 1.00308453235988, 0.119383708414055, 91, 53,
			 -0.0567540291611996, 0.0588179960652577, 16, 16, "contGamma",
			 "debCollin1", "contNormal", 0.0019097196939958, -6.95009438953995e-05,
			 "<unicode>", "<unicode>", 1.01845105780858, 0.0262419654827735,
			 151, 24, -0.0289806790011725, 0.0413250358465178, 50, 16, "contGamma",
			 "debCollin1", "contNormal", 0.00275679763945262, 0.000121366735003373,
			 "<unicode>", "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 16, "contGamma",
			 "debCollin1", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", "<unicode>", 1.03295996048861, 0.0312848604862771,
			 43, 53, -0.0567540291611996, 0.0588179960652577, 16, 50, "contGamma",
			 "debCollin1", "contNormal", 0.0019097196939958, -6.95009438953995e-05,
			 "<unicode>", "<unicode>", 1.01845105780858, 0.0262419654827735,
			 151, 24, -0.0289806790011725, 0.0413250358465178, 50, 50, "contGamma",
			 "debCollin1", "contNormal", 0.00275679763945262, 0.000121366735003373,
			 "<unicode>", "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 50, "contGamma",
			 "debCollin1", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", "<unicode>", 1.03295996048861, 0.0312848604862771,
			 43, 53, -0.0567540291611996, 0.0588179960652577, 16, 84, "contGamma",
			 "debCollin1", "contNormal", 0.0019097196939958, -6.95009438953995e-05,
			 "<unicode>", "<unicode>", 1.01845105780858, 0.0262419654827735,
			 151, 24, -0.0289806790011725, 0.0413250358465178, 50, 84, "contGamma",
			 "debCollin1", "contNormal", 0.00275679763945262, 0.000121366735003373,
			 "<unicode>", "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 84, "contGamma",
			 "debCollin1", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", "<unicode>", 1.03295996048861, 0.0312848604862771,
			 43))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(162, -0.169148347053718, 0.109650773267931, "contGamma", -0.0284514423868562,
			 -0.0283154214945671, "<unicode>", "Normal(0,10)", 0.995937212540696,
			 "contNormal", 0.0743013688704592, 132, 20, -2.92454535596738,
			 2.70367085914263, "debCollin1", -0.265665580043069, -0.0446993258072853,
			 "<unicode>", "Normal(0,10)", 1.04980278291634, "contNormal",
			 1.5266665287454, 30, 287, -0.253538463824643, 0.771686164057181,
			 "contcor1", 0.267665704442911, 0.249880071038108, "<unicode>",
			 "Normal(0,10)", 1.02274534012217, "contNormal", 0.262477158625659,
			 183, 227, -0.246807461545567, 0.216120403235101, "contGamma:contcor1",
			 -0.0124676654708345, -0.0226650275518569, "<unicode>", "Normal(0,10)",
			 1.01575272033334, "contNormal", 0.1220923238853, 104, 23, -2.46311066706142,
			 1.32436988187948, "contcor2", -0.267369335194508, -0.179701165400594,
			 "<unicode>", "Normal(0,10)", 1.0085500884679, "contNormal",
			 0.996463886346075, 13, 21, -2.04889992848186, 3.53391172216178,
			 "debCollin1:contcor2", 0.291529022066606, 0.150385671020831,
			 "<unicode>", "Normal(0,10)", 1.0060901476249, "contNormal",
			 1.49951906666609, 13, 196, -0.238201654824301, 0.211348033574,
			 "contGamma:contcor2", -0.0205613303400519, -0.0241504462891098,
			 "<unicode>", "Normal(0,10)", 1.0102451057099, "contNormal",
			 0.115303391034488, 86, 274, -0.0197988603362958, 0.00367153564658347,
			 "contGamma", -0.00887876505147753, -0.00924265303199208, "<unicode>",
			 "Normal(0,10)", 1.00657019396147, "debCollin1", 0.00602203828093703,
			 86, 250, -0.0223744001752562, 0.0393540725486445, "contcor1",
			 0.00803054672695127, 0.00770652377631902, "<unicode>", "Normal(0,10)",
			 0.995546491255803, "debCollin1", 0.0159091622333735, 126, 193,
			 -0.0178145608423293, 0.0073467633805491, "contGamma:contcor1",
			 -0.004024547539228, -0.00413699401983555, "<unicode>", "Normal(0,10)",
			 0.99559497883206, "debCollin1", 0.00634146302053905, 184))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(225, -0.213377044045091, 0.215292897374503, 16, 16, "Total", "contGamma",
			 "contNormal", 0.0045547597477585, 0.0013237345418609, "<unicode>",
			 1.00278877165063, 0.111438845334626, 175, 202, -0.249163454124692,
			 0.199288596489708, 50, 16, "Total", "contGamma", "contNormal",
			 -0.00674341394854343, 0.00744611190633767, "<unicode>", 1.00678260517845,
			 0.122367185826286, 217, 230, -0.463428481735223, 0.393900898172427,
			 84, 16, "Total", "contGamma", "contNormal", -0.0213797512196498,
			 -0.00995068022883562, "<unicode>", 1.00993095408234, 0.22234227404389,
			 134, 229, -0.299399380565484, 0.260251852135597, 16, 50, "Total",
			 "contGamma", "contNormal", -0.015056637130583, -0.00387320652523213,
			 "<unicode>", 1.02352918946767, 0.152156559995489, 128, 173,
			 -0.170944859061989, 0.12238894624019, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0263548108268849, -0.0251619837212906, "<unicode>",
			 1.00034691626754, 0.0758785716227424, 152, 225, -0.302954854902849,
			 0.214971353153595, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0409911480979913, -0.0338596933237264, "<unicode>", 1.00036812485011,
			 0.137152501639466, 117, 205, -0.506470809274242, 0.47298773689398,
			 16, 84, "Total", "contGamma", "contNormal", -0.038044204450761,
			 -0.0285198471683904, "<unicode>", 1.01003640637295, 0.257928071641126,
			 119, 176, -0.354044651234213, 0.272192422998454, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0493423781470629, -0.0589437213083554,
			 "<unicode>", 1.02183572727633, 0.160465997021403, 134, 144,
			 -0.265325690629341, 0.166346597652936, 84, 84, "Total", "contGamma",
			 "contNormal", -0.0639787154181693, -0.0630914283884021, "<unicode>",
			 1.0043229879559, 0.117080429930041, 100, 53, -0.0567540291611996,
			 0.0588179960652577, 16, 16, "Total indirect", "contGamma", "contNormal",
			 0.0019097196939958, -6.95009438953995e-05, "<unicode>", 1.01845105780858,
			 0.0262419654827735, 151, 24, -0.0289806790011725, 0.0413250358465178,
			 50, 16, "Total indirect", "contGamma", "contNormal", 0.00275679763945262,
			 0.000121366735003373, "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 16, "Total indirect",
			 "contGamma", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", 1.03295996048861, 0.0312848604862771, 43, 53, -0.0567540291611996,
			 0.0588179960652577, 16, 50, "Total indirect", "contGamma", "contNormal",
			 0.0019097196939958, -6.95009438953995e-05, "<unicode>", 1.01845105780858,
			 0.0262419654827735, 151, 24, -0.0289806790011725, 0.0413250358465178,
			 50, 50, "Total indirect", "contGamma", "contNormal", 0.00275679763945262,
			 0.000121366735003373, "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 50, "Total indirect",
			 "contGamma", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", 1.03295996048861, 0.0312848604862771, 43, 53, -0.0567540291611996,
			 0.0588179960652577, 16, 84, "Total indirect", "contGamma", "contNormal",
			 0.0019097196939958, -6.95009438953995e-05, "<unicode>", 1.01845105780858,
			 0.0262419654827735, 151, 24, -0.0289806790011725, 0.0413250358465178,
			 50, 84, "Total indirect", "contGamma", "contNormal", 0.00275679763945262,
			 0.000121366735003373, "<unicode>", 1.04155200761383, 0.016988914671621,
			 56, 43, -0.0718716919394875, 0.0662491991321909, 84, 84, "Total indirect",
			 "contGamma", "contNormal", 0.00137545891366395, 0.00112470970487851,
			 "<unicode>", 1.03295996048861, 0.0312848604862771, 43))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")

})
test_that("Test that model number 29 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 731.359546388991, 645.8056846991, 58.3996916303873,
			 0.525, 646.98757460132, 58.8260096151457))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(241, -0.0746451831450821, 0.0502234956915626, "facGenderm:contcor2",
			 -0.00832520225558574, -0.00437781118017214, "<unicode>", 0.998504746554132,
			 "facGenderm", 0.0332010096129145, 154, 177, -0.0999915840792191,
			 0.0219743507936758, "debCollin1:contcor2", -0.0379824013619546,
			 -0.0376714616786428, "<unicode>", 1.00909755381405, "facGenderm",
			 0.0310130508696496, 182, 175, -0.149964058059188, 0.0305187224526979,
			 "contcor2", -0.056768325956088, -0.0534131895683898, "<unicode>",
			 1.00892451797801, "facGenderm", 0.0456654716060211, 182, 205,
			 0.0884580744459537, 0.197111259489546, "facGenderm:facExperimexperimental",
			 0.140368396024403, 0.138362525863965, "<unicode>", 0.995398174212653,
			 "facGenderm", 0.0264544669392856, 117, 220, -0.0137393628331704,
			 0.0775454207849518, "facExperimexperimental", 0.0307152841150368,
			 0.0301095168289081, "<unicode>", 0.997296824074449, "facGenderm",
			 0.0230857249778274, 185, 227, 0.193634677669007, 0.31980529375488,
			 "facGenderm", 0.256227193176836, 0.25727544860178, "<unicode>",
			 0.999922394629188, "facGenderm", 0.033992237725518, 136, 190,
			 0.839079176063182, 1.50762434784184, "contNormal", 1.17367641347273,
			 1.1804460610379, "<unicode>", 1.01849685698889, "contNormal",
			 0.184345841542205, 117, 317, -0.00654425292009215, 0.0117007177232505,
			 "debCollin1:contcor2", 0.00228901794364224, 0.00255131031871066,
			 "<unicode>", 0.997630920421229, "debCollin1", 0.00458645780164262,
			 130, 307, -0.0116189055116468, 0.0152007792592874, "contcor2",
			 0.00201170159707835, 0.00220262916408171, "<unicode>", 0.999314167971064,
			 "debCollin1", 0.00678007028403503, 133, 262, 0.00542615190945864,
			 0.0101963577213013, "debCollin1", 0.00728383372384728, 0.00718047939374418,
			 "<unicode>", 1.00653303717038, "debCollin1", 0.00128368924036243,
			 79, 320, -0.128548090255178, 0.000474157475909235, "facGenderm:contcor2",
			 -0.0576971329556637, -0.0557450210263286, "<unicode>", 1.01107327179948,
			 "facExperimexperimental", 0.032676840185757, 137, 124, -0.0881587900445014,
			 0.027104717169706, "debCollin1:contcor2", -0.0342585656078025,
			 -0.0337431032024428, "<unicode>", 1.01035082390336, "facExperimexperimental",
			 0.0302140711396316, 153, 126, -0.133652030868069, 0.0348369691645394,
			 "contcor2", -0.0548448485370788, -0.0550385326939737, "<unicode>",
			 1.00522122017271, "facExperimexperimental", 0.0449875135360988,
			 153, 199, 0.100486961756555, 0.191153482219212, "facGenderm:facExperimexperimental",
			 0.14201351525698, 0.141076020425158, "<unicode>", 0.995638527022524,
			 "facExperimexperimental", 0.02384707112062, 225, 214, 0.190549646921053,
			 0.332668504184267, "facExperimexperimental", 0.26149138357993,
			 0.257064326794506, "<unicode>", 0.998071448342639, "facExperimexperimental",
			 0.0387012037423149, 222, 253, -0.13395476854117, -0.00878760531034042,
			 "facGenderm:contcor2", -0.0637198202996492, -0.0624573271762934,
			 "<unicode>", 1.0014123805017, "facGenderm:facExperimexperimental",
			 0.0287421057876865, 102, 135, -0.106933538123783, -0.00242315837062337,
			 "debCollin1:contcor2", -0.0565944923515169, -0.0552052997802393,
			 "<unicode>", 1.0161976730147, "facGenderm:facExperimexperimental",
			 0.0265201641260104, 106, 125, -0.155588634995081, -0.00221463269027901,
			 "contcor2", -0.0846307671277741, -0.082877735172881, "<unicode>",
			 1.02370923659697, "facGenderm:facExperimexperimental", 0.0388305262341575,
			 141, 193, 0.159190701019729, 0.259838418484752, "facGenderm:facExperimexperimental",
			 0.204700173884768, 0.202195129560471, "<unicode>", 1.00506514552951,
			 "facGenderm:facExperimexperimental", 0.0255207283329373, 217,
			 156, 0.286528735869816, 0.554906694348558, "facGenderm:contcor2",
			 0.411297005806922, 0.406045613072605, "<unicode>", 0.999961655630952,
			 "contcor2", 0.0696755973984426, 153, 157, 0.484815692319744,
			 0.80263302255104, "debCollin1:contcor2", 0.629810445271512,
			 0.627633860760066, "<unicode>", 1.0176527436337, "contcor2",
			 0.0832287900751149, 133, 158, 0.739792389436844, 1.22050408429854,
			 "contcor2", 0.956757701426148, 0.949740234399035, "<unicode>",
			 1.00301651487826, "contcor2", 0.125069331844637, 116, 148, 0.177747629607738,
			 0.359252492176676, "facGenderm:contcor2", 0.265268579228906,
			 0.261770174968985, "<unicode>", 0.999498356511425, "debCollin1:contcor2",
			 0.0457151511079725, 178, 158, 0.325931598057632, 0.54575616245294,
			 "debCollin1:contcor2", 0.423233777836142, 0.421887803797946,
			 "<unicode>", 1.018205224852, "debCollin1:contcor2", 0.0562384569334748,
			 106, 176, 0.342158033000056, 0.571233565580918, "facGenderm:contcor2",
			 0.446776624213619, 0.445621703941599, "<unicode>", 1.003408740847,
			 "facGenderm:contcor2", 0.0592933052170072, 124))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(149, -0.144704500563756, 1.32098077878504, 16, 0, "m", "facGender",
			 "contNormal", "", 0.624225557394106, 0.634135763937585, "<unicode>",
			 "", 1.02777422746446, 0.388904745815951, 151, 233, -0.26838591650852,
			 1.02986218316475, 16, 1, "m", "facGender", "contNormal", "",
			 0.311123512912014, 0.3052954516356, "<unicode>", "", 0.999470976648911,
			 0.347298884859838, 118, 109, -0.00216701528526491, 1.22924322076998,
			 50, 0, "m", "facGender", "contNormal", "", 0.642113459681268,
			 0.646636232427554, "<unicode>", "", 1.00494285994835, 0.306986312326027,
			 111, 168, -0.22580980220303, 0.987077113907107, 50, 1, "m",
			 "facGender", "contNormal", "", 0.329011415199177, 0.304435700888774,
			 "<unicode>", "", 0.996398102203239, 0.308393426440225, 119,
			 157, -0.0619029033631641, 1.41182433465849, 84, 0, "m", "facGender",
			 "contNormal", "", 0.663080826799162, 0.653689462730074, "<unicode>",
			 "", 0.99756689628488, 0.369961252743493, 137, 188, -0.415414823523148,
			 1.22351211003845, 84, 1, "m", "facGender", "contNormal", "",
			 0.349978782317071, 0.325061356418673, "<unicode>", "", 0.995155544384551,
			 0.417918330148963, 106, 297, -0.0807573895271611, 0.0852116916899411,
			 16, 0, "m", "facGender", "debCollin1", "contNormal", -0.00344350129792696,
			 -0.00166405281246374, "<unicode>", "<unicode>", 1.03484741257072,
			 0.0376555835946196, 96, 72, -0.0895605749303458, 0.0992148956587091,
			 16, 1, "m", "facGender", "debCollin1", "contNormal", 0.00520122458859883,
			 0.0018746635738845, "<unicode>", "<unicode>", 1.00722025049757,
			 0.0435551193543653, 68, 217, -0.0823521339093048, 0.112466661299673,
			 50, 0, "m", "facGender", "debCollin1", "contNormal", 0.00197877762873138,
			 0.000260951334917937, "<unicode>", "<unicode>", 1.01235500544801,
			 0.0509285458267952, 120, 297, -0.0807573895271611, 0.0852116916899411,
			 50, 1, "m", "facGender", "debCollin1", "contNormal", -0.00344350129792696,
			 -0.00166405281246374, "<unicode>", "<unicode>", 1.03484741257072,
			 0.0376555835946196, 96, 72, -0.0895605749303458, 0.0992148956587091,
			 84, 0, "m", "facGender", "debCollin1", "contNormal", 0.00520122458859883,
			 0.0018746635738845, "<unicode>", "<unicode>", 1.00722025049757,
			 0.0435551193543653, 68, 217, -0.0823521339093048, 0.112466661299673,
			 84, 1, "m", "facGender", "debCollin1", "contNormal", 0.00197877762873138,
			 0.000260951334917937, "<unicode>", "<unicode>", 1.01235500544801,
			 0.0509285458267952, 120))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(109, -0.00961075040549836, 1.22451696821391, "facGenderm", 0.641552704514161,
			 0.650812430003023, "<unicode>", "Normal(0,10)", 1.00864931998442,
			 "contNormal", 0.307769881376466, 111, 27, -2.44037811046002,
			 2.59991499598334, "debCollin1", -0.190946236307051, -0.219310012881871,
			 "<unicode>", "Normal(0,10)", 1.03519560935041, "contNormal",
			 1.30462489690997, 25, 140, -0.436301202428193, 0.741714663745257,
			 "facExperimexperimental", 0.178041008845372, 0.180820033103813,
			 "<unicode>", "Normal(0,10)", 1.00425692608519, "contNormal",
			 0.306688675575824, 123, 92, -1.24467892510125, 0.62176822833761,
			 "facGenderm:facExperimexperimental", -0.313102044482091, -0.315075320068183,
			 "<unicode>", "Normal(0,10)", 0.998650552088939, "contNormal",
			 0.469857478026137, 73, 40, -1.31699804758293, 1.09170120838115,
			 "contcor2", -0.196247077045609, -0.27381699054239, "<unicode>",
			 "Normal(0,10)", 1.02286587085605, "contNormal", 0.678933050391959,
			 72, 42, -1.3595037559196, 1.98725010579819, "debCollin1:contcor2",
			 0.36107759576336, 0.445151343479714, "<unicode>", "Normal(0,10)",
			 1.02048219515772, "contNormal", 1.01330948716885, 71, 243, -0.386356587854826,
			 0.405321353306158, "facGenderm:contcor2", 0.0187543534149321,
			 0.0301476258156968, "<unicode>", "Normal(0,10)", 1.00986605054796,
			 "contNormal", 0.217377604087483, 153, 264, -0.0444626263868906,
			 0.0520133151232381, "facGenderm", 0.00354635401422761, 0.00361365106573406,
			 "<unicode>", "Normal(0,10)", 1.001106633708, "debCollin1", 0.0238110781042999,
			 182, 211, -0.049495046614904, 0.0436604683218336, "facExperimexperimental",
			 -0.00327251403399092, -0.00237091854039422, "<unicode>", "Normal(0,10)",
			 1.0154775149608, "debCollin1", 0.0248444467104582, 94, 272,
			 -0.0843913992753997, 0.0443769552063012, "facGenderm:facExperimexperimental",
			 -0.0198431180297766, -0.0176634804031246, "<unicode>", "Normal(0,10)",
			 1.00735535453422, "debCollin1", 0.0355299570404682, 148))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(152, -0.159580629472071, 1.34493534116526, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.620782056096179, 0.630109203688978,
			 "<unicode>", 1.02173274567078, 0.394469129165213, 179, 240,
			 -0.267871226657804, 1.0547273201281, 16, 1, "m", "Total", "facGender",
			 "contNormal", 0.316324737500613, 0.32832794701651, "<unicode>",
			 0.998072442646029, 0.345765041086445, 102, 101, -0.0126867149527099,
			 1.22624631024753, 50, 0, "m", "Total", "facGender", "contNormal",
			 0.644092237309999, 0.647271110025539, "<unicode>", 1.00414710783305,
			 0.307068042696567, 109, 162, -0.269480201203377, 0.98455603889098,
			 50, 1, "m", "Total", "facGender", "contNormal", 0.32556791390125,
			 0.304185105476884, "<unicode>", 0.99545064839372, 0.315742832116852,
			 118, 156, -0.0273403956692369, 1.40635630110114, 84, 0, "m",
			 "Total", "facGender", "contNormal", 0.668282051387761, 0.639929436607751,
			 "<unicode>", 0.996598897967956, 0.370382281677833, 137, 186,
			 -0.42434688938339, 1.22487311824166, 84, 1, "m", "Total", "facGender",
			 "contNormal", 0.351957559945802, 0.319930032399487, "<unicode>",
			 0.995137459895551, 0.424014055865528, 106, 297, -0.0807573895271611,
			 0.0852116916899411, 16, 0, "m", "Total indirect", "facGender",
			 "contNormal", -0.00344350129792696, -0.00166405281246374, "<unicode>",
			 1.03484741257072, 0.0376555835946196, 96, 72, -0.0895605749303458,
			 0.0992148956587091, 16, 1, "m", "Total indirect", "facGender",
			 "contNormal", 0.00520122458859883, 0.0018746635738845, "<unicode>",
			 1.00722025049757, 0.0435551193543653, 68, 217, -0.0823521339093048,
			 0.112466661299673, 50, 0, "m", "Total indirect", "facGender",
			 "contNormal", 0.00197877762873138, 0.000260951334917937, "<unicode>",
			 1.01235500544801, 0.0509285458267952, 120, 297, -0.0807573895271611,
			 0.0852116916899411, 50, 1, "m", "Total indirect", "facGender",
			 "contNormal", -0.00344350129792696, -0.00166405281246374, "<unicode>",
			 1.03484741257072, 0.0376555835946196, 96, 72, -0.0895605749303458,
			 0.0992148956587091, 84, 0, "m", "Total indirect", "facGender",
			 "contNormal", 0.00520122458859883, 0.0018746635738845, "<unicode>",
			 1.00722025049757, 0.0435551193543653, 68, 217, -0.0823521339093048,
			 0.112466661299673, 84, 1, "m", "Total indirect", "facGender",
			 "contNormal", 0.00197877762873138, 0.000260951334917937, "<unicode>",
			 1.01235500544801, 0.0509285458267952, 120))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")

})
test_that("Test that model number 82 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debMiss1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debMiss1",
            processType = "mediators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, "Model 1", 100, 1991.82981098232, 1921.39749401163, 43.7656209415639,
			 0.51, 1921.71024912143, 43.886643896619))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(203, 1.90642719987883, 3.03053781522594, "contGamma", 2.40190677423612,
			 2.38014794617076, "<unicode>", 1.00837709012527, "contGamma",
			 0.305682263223236, 177, 202, 0.800113031781696, 1.44262333701207,
			 "contNormal", 1.10497233582178, 1.10231996012808, "<unicode>",
			 1.02064795329441, "contNormal", 0.168944769260865, 113, 61,
			 -0.0145265189351747, 0.0186189837616608, "contcor1", 0.000124543449702645,
			 -0.000224708816586981, "<unicode>", 1.00560864500058, "debCollin1",
			 0.00793296786661549, 131, 169, -0.718292410858538, 0.0731016474884206,
			 "debMiss1", -0.309923509695275, -0.307659150372356, "<unicode>",
			 1.00592140284258, "debCollin1", 0.200213086572084, 103, 130,
			 0.00537578752016841, 0.00853481998178648, "debCollin1", 0.00681609141935656,
			 0.00676813822287065, "<unicode>", 1.00253414820757, "debCollin1",
			 0.000882911839141666, 154, 161, 0.46664085718509, 0.958169401529664,
			 "contcor1", 0.664816128282971, 0.641721366131304, "<unicode>",
			 1.00473145189248, "contcor2", 0.12376388148257, 148, 233, -7.31651955845134,
			 4.92917473743537, "debMiss1", -1.39951111175119, -1.26915379644216,
			 "<unicode>", 1.05511546604898, "contcor2", 3.05434396909494,
			 86, 215, 0.806073196850762, 1.38338328827474, "contcor2", 1.05729428488807,
			 1.05013602021433, "<unicode>", 1.00039688280298, "contcor2",
			 0.145970398620968, 184, 228, 508.145488451033, 798.860758564405,
			 "debMiss1", 662.617366527694, 666.584596743502, "<unicode>",
			 0.996197671756162, "debMiss1", 76.6303066726738, 129, 185, 0.787874583707424,
			 1.37113516648351, "contcor1", 1.02592039603185, 1.01459224012485,
			 "<unicode>", 1.00019378942855, "contcor1", 0.150038958456058,
			 154))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(204, -0.15509832440875, 0.116171206503196, "contGamma", "contNormal",
			 "", "", -0.013298247481988, -0.0167992533390762, "<unicode>",
			 "", "", 0.996189869777424, 0.0742599225958462, 150, 43, -0.037948135468151,
			 0.0240023458052261, "contGamma", "debCollin1", "contNormal",
			 "", -0.00734039129550858, -0.00646446600123332, "<unicode>",
			 "<unicode>", "", 1.02317759453439, 0.0146974813780712, 43, 216,
			 -0.0189359741914068, 0.0389295294860932, "contGamma", "contcor2",
			 "contNormal", "", 0.00574498231842633, 0.00189387883685823,
			 "<unicode>", "<unicode>", "", 1.01430800523162, 0.0148403585684256,
			 215, 8, -0.0226201920482097, 0.0367704489962939, "contGamma",
			 "debMiss1", "contNormal", "", 0.0055217924462944, 0.0040451887970299,
			 "<unicode>", "<unicode>", "", 1.12633684185741, 0.0149330515153239,
			 44, 227, -0.0883886259964834, 0.00749445546940055, "contGamma",
			 "contcor1", "contNormal", "", -0.032153494629172, -0.0284283738174753,
			 "<unicode>", "<unicode>", "", 1.00104729873088, 0.025919934460161,
			 181, 51, -0.00270214810091143, 0.00785434586040285, "contGamma",
			 "debCollin1", "contcor2", "contNormal", 0.00146473429277049,
			 0.000772215480053248, "<unicode>", "<unicode>", "<unicode>",
			 0.99919785176014, 0.0027777988696531, 133, 35, -0.00831508982121828,
			 0.00496432701366761, "contGamma", "debMiss1", "contcor1", "contNormal",
			 -0.000803916198722889, -0.00037263408933146, "<unicode>", "<unicode>",
			 "<unicode>", 1.01204880860945, 0.0030048622094844, 117))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(204, -0.15509832440875, 0.116171206503196, "contGamma", -0.013298247481988,
			 -0.0167992533390762, "<unicode>", "Normal(0,10)", 0.996189869777424,
			 "contNormal", 0.0742599225958462, 150, 33, -1.58157860383651,
			 3.11672460121676, "debCollin1", 0.854453293989082, 0.889678271996342,
			 "<unicode>", "Normal(0,10)", 1.02838881447703, "contNormal",
			 1.29318207375828, 58, 215, -0.421184667688229, 0.0483296955792794,
			 "contcor2", -0.167543339144499, -0.159140814759807, "<unicode>",
			 "Normal(0,10)", 0.99523121798314, "contNormal", 0.126398404244328,
			 152, 130, 0.00241920711241859, 0.0192616293635404, "debMiss1",
			 0.0104344093422732, 0.0102137344206655, "<unicode>", "Normal(0,10)",
			 0.997497209458322, "contNormal", 0.00453154353528756, 91, 188,
			 0.0433257925917844, 0.551919473800955, "contcor1", 0.307646554501049,
			 0.319778502318144, "<unicode>", "Normal(0,10)", 0.996008462379064,
			 "contNormal", 0.131096156027054, 154, 154, -0.0189461813271177,
			 -7.03161764164025e-08, "contGamma", -0.00944490156000865, -0.00951414694304789,
			 "<unicode>", "Normal(0,10)", 1.0007381663538, "debCollin1",
			 0.00509095388797855, 86, 241, -0.173108276979367, 0.0803964692517737,
			 "contGamma", -0.0316511083056591, -0.02992939483773, "<unicode>",
			 "Normal(0,10)", 1.01272288577075, "contcor2", 0.0625543196086499,
			 153, 24, -0.893742980589647, 3.50487174182113, "debCollin1",
			 0.933186999412727, 0.99224996742739, "<unicode>", "Normal(0,10)",
			 1.00237747582017, "contcor2", 1.12609778566427, 63, 5, -1.8395999891537,
			 2.99741697593229, "contGamma", 0.518516235463991, 0.595896355934742,
			 "<unicode>", "Normal(0,10)", 1.16090518042919, "debMiss1", 1.26039450771684,
			 58, 251, -0.215713884466454, 0.033787086600209, "contGamma",
			 -0.101553157575165, -0.101219336818596, "<unicode>", "Normal(0,10)",
			 0.996415728278414, "contcor1", 0.0633023295223813, 153, 199,
			 -0.0136705620522119, 0.0027724413144761, "debMiss1", -0.0055768337993183,
			 -0.00560394690573582, "<unicode>", "Normal(0,10)", 1.00136210243894,
			 "contcor1", 0.00450305442892005, 184))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(184, -0.178149469131519, 0.0921982064221133, "Total", "contGamma",
			 "contNormal", -0.0408645405479003, -0.0440595613490397, "<unicode>",
			 0.999104147611735, 0.077496951512393, 177, 85, -0.0828127074756613,
			 0.0310029629615736, "Total indirect", "contGamma", "contNormal",
			 -0.0275662930659123, -0.0278989714057188, "<unicode>", 0.998652375743116,
			 0.0292880438072068, 122))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")

})
test_that("Test that model number 82 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debMiss1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debMiss1",
            processType = "mediators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, "Model 1", 100, 1766.92598271592, 1692.99583660705, 36.1812665309644,
			 0.5, 1692.95116790229, 36.2183926821657))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(152, 0.203662417279042, 0.321899718362259, "facGenderm", 0.256903485662058,
			 0.254234912053829, "<unicode>", 0.997172527470592, "facGenderm",
			 0.03392656966195, 75, 186, 0.778435867827837, 1.36681462731455,
			 "contNormal", 1.02005811393159, 0.99768312765222, "<unicode>",
			 0.998227737934929, "contNormal", 0.155545603682245, 136, 131,
			 -0.0178284257842603, 0.0167632634252347, "contcor1", -0.000251250848533798,
			 -0.000212504792890602, "<unicode>", 1.00564709838031, "debCollin1",
			 0.00850185167138954, 154, 411, -0.714765018879551, 0.0945101831100578,
			 "debMiss1", -0.29781813472317, -0.290427540431863, "<unicode>",
			 1.03205605633833, "debCollin1", 0.216443122553166, 139, 208,
			 0.00554102645502596, 0.00923848523509, "debCollin1", 0.00718366101225155,
			 0.00707045227762765, "<unicode>", 0.995616383637986, "debCollin1",
			 0.000930796964718845, 174, 253, 0.467810682702155, 0.905436457216301,
			 "contcor1", 0.65877300371295, 0.646572632858524, "<unicode>",
			 1.00905683223083, "contcor2", 0.115997716909286, 184, 300, -6.23998319842419,
			 3.48232215585116, "debMiss1", -1.007368539502, -1.06793046729502,
			 "<unicode>", 0.995116257523136, "contcor2", 2.47649715217457,
			 184, 311, 0.778760248302458, 1.336377535774, "contcor2", 1.03701828192126,
			 1.0241015153476, "<unicode>", 1.00573533492613, "contcor2",
			 0.143067433111664, 136, 222, 501.69425163089, 813.702939093812,
			 "debMiss1", 647.666482946395, 645.252783836982, "<unicode>",
			 0.995004067918001, "debMiss1", 81.1907551407851, 108, 194, 0.748818647265854,
			 1.34528047362153, "contcor1", 1.03695908841627, 1.02010009852641,
			 "<unicode>", 1.03694535871927, "contcor1", 0.145088832660301,
			 153))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(239, 0.0987024639192022, 0.799822871963888, "m", "facGender",
			 "contNormal", "", "", 0.461418094319496, 0.463878660018239,
			 "<unicode>", "", "", 0.999492172726375, 0.182262825655493, 159,
			 164, -0.0729190081037063, 0.0454451919996114, "m", "facGender",
			 "debCollin1", "contNormal", "", -0.00635888368473421, -0.00158635423425511,
			 "<unicode>", "<unicode>", "", 1.01737340776325, 0.0334413480392083,
			 132, 272, -0.0525253926427509, 0.149544906922232, "m", "facGender",
			 "contcor2", "contNormal", "", 0.0284812117202024, 0.0194592020021947,
			 "<unicode>", "<unicode>", "", 0.995807556757835, 0.0476286584920221,
			 178, 10, -0.070830401613709, 0.131191046012679, "m", "facGender",
			 "debMiss1", "contNormal", "", 0.0193395386583075, 0.0133040445245075,
			 "<unicode>", "<unicode>", "", 1.02604811979201, 0.0474140867663485,
			 15, 200, -0.148938390379768, 0.0768117550164555, "m", "facGender",
			 "contcor1", "contNormal", "", -0.0188879277321729, -0.0119174530944475,
			 "<unicode>", "<unicode>", "", 0.995850504642209, 0.06014125219793,
			 225, 181, -0.00763715972319801, 0.0105487090629636, "m", "facGender",
			 "debCollin1", "contcor2", "contNormal", 0.000487092687546589,
			 8.62775738418785e-05, "<unicode>", "<unicode>", "<unicode>",
			 1.00093160269066, 0.00407196012045655, 184, 15, -0.0199811295214636,
			 0.0105254231842816, "m", "facGender", "debMiss1", "contcor1",
			 "contNormal", -0.00240815861915362, -0.000604752544185747, "<unicode>",
			 "<unicode>", "<unicode>", 1.00960176427719, 0.00698189714204165,
			 32))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(239, 0.0987024639192022, 0.799822871963888, "facGenderm", 0.461418094319496,
			 0.463878660018239, "<unicode>", "Normal(0,10)", 0.999492172726375,
			 "contNormal", 0.182262825655493, 159, 30, -1.78916692298737,
			 2.8144135284813, "debCollin1", 0.341601847863469, 0.268433824048312,
			 "<unicode>", "Normal(0,10)", 1.00347513042273, "contNormal",
			 1.26607083240438, 72, 288, -0.376141175481364, 0.136023205422777,
			 "contcor2", -0.107860948162905, -0.107683917679714, "<unicode>",
			 "Normal(0,10)", 0.996008265409078, "contNormal", 0.133027101258033,
			 154, 173, 0.00166534210968227, 0.0190119371823441, "debMiss1",
			 0.0109434842507458, 0.0109456181893303, "<unicode>", "Normal(0,10)",
			 0.997158486563131, "contNormal", 0.00428482653125347, 93, 272,
			 0.0336774886913093, 0.531897327189347, "contcor1", 0.275552858109019,
			 0.275625096649587, "<unicode>", "Normal(0,10)", 1.00042058216273,
			 "contNormal", 0.129829143023197, 154, 178, -0.046889265205992,
			 0.0270257952255515, "facGenderm", -0.00943064430110565, -0.00866755126687673,
			 "<unicode>", "Normal(0,10)", 0.998205363826256, "debCollin1",
			 0.0205106412261396, 149, 223, -0.688134770525897, 0.129285745240344,
			 "facGenderm", -0.267198691041439, -0.277521022003342, "<unicode>",
			 "Normal(0,10)", 1.00059277934324, "contcor2", 0.196133704738055,
			 156, 71, -2.03554509350095, 2.54753713007461, "debCollin1",
			 0.544620471660167, 0.564467953770032, "<unicode>", "Normal(0,10)",
			 1.0199491791046, "contcor2", 1.1306838499601, 32, 9, -5.5713141242212,
			 9.66933229723409, "facGenderm", 1.82192919473925, 1.49173313964258,
			 "<unicode>", "Normal(0,10)", 1.03349449970317, "debMiss1", 3.75797807368446,
			 12, 244, -0.49536598766148, 0.278759817963822, "facGenderm",
			 -0.0706619295872077, -0.0605068910770124, "<unicode>", "Normal(0,10)",
			 0.995099185900459, "contcor1", 0.194643392968867, 181, 250,
			 -0.0112257656422624, 0.00175972146008198, "debMiss1", -0.0048796566116696,
			 -0.00496387968329374, "<unicode>", "Normal(0,10)", 1.0293857150681,
			 "contcor1", 0.0034436244425278, 182))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(210, 0.148623816155826, 0.854484327264898, "m", "Total", "facGender",
			 "contNormal", 0.482070967349492, 0.482479625634768, "<unicode>",
			 1.00019153007748, 0.187067675022501, 159, 41, -0.130804123039286,
			 0.173045212180964, "m", "Total indirect", "facGender", "contNormal",
			 0.0206528730299958, 0.0171572083760146, "<unicode>", 1.00800238230172,
			 0.0806922861460013, 72))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")

})
test_that("Test that model number 92 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contcor2", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contcor2", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contcor2",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1509.4081221673, 1427.93034695324, 75.9563088297265,
			 0.54, 1430.4230136147, 76.7696291198449))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(249, -0.0141224704359682, 0.559559485593777, "contcor2:contcor1",
			 0.282483571721746, 0.277296818419984, "<unicode>", 0.99732421896119,
			 "contGamma", 0.153610275234232, 217, 245, -0.357965842154607,
			 0.0208748294944375, "debCollin1:contcor1", -0.153545797862243,
			 -0.155395105509668, "<unicode>", 1.0096862950607, "contGamma",
			 0.0973675329646515, 136, 229, -1.24212905942403, 0.148968501996304,
			 "contGamma:contcor1", -0.562284889051613, -0.5645106275695,
			 "<unicode>", 0.995533472399793, "contGamma", 0.358679200462127,
			 160, 264, -0.505585299694469, 0.0619505738711594, "contcor1",
			 -0.219412713885479, -0.224561651247936, "<unicode>", 1.00402055375166,
			 "contGamma", 0.14550702161608, 116, 208, 1.91488171968624, 3.15138215048319,
			 "contGamma", 2.45386882456755, 2.43699579427566, "<unicode>",
			 0.996701555964598, "contGamma", 0.334286647951655, 215, 79,
			 0.87935300546061, 1.54096409463474, "contNormal", 1.14646461847463,
			 1.12968282877454, "<unicode>", 1.02989157124789, "contNormal",
			 0.17453812921808, 94, 299, -0.00194699575905194, 0.000862703580811491,
			 "debCollin1:contcor1", -0.000495423146105486, -0.000433111865862728,
			 "<unicode>", 0.999192442684726, "debCollin1", 0.000687680617539654,
			 177, 232, 0.00484666438048039, 0.0086105343425965, "debCollin1",
			 0.00669465349206438, 0.00680911534609088, "<unicode>", 0.999544859251074,
			 "debCollin1", 0.000985973860701228, 63, 344, -0.0415873721544575,
			 0.237344738732115, "contcor2:contcor1", 0.0905593863999854,
			 0.0848533320530367, "<unicode>", 0.995822970223422, "contcor2",
			 0.0735033211380138, 150, 283, 0.430072668754918, 0.738667993819185,
			 "contcor2", 0.568189803077602, 0.564958637542894, "<unicode>",
			 1.00397724238216, "contcor2", 0.0786167797332904, 159, 159,
			 0.0369498302521868, 0.416033970048654, "contcor2:contcor1",
			 0.212276577924415, 0.211892322789671, "<unicode>", 0.999369910665318,
			 "contcor1", 0.100201496117683, 110, 287, 0.475998043218433,
			 0.821962046086976, "debCollin1:contcor1", 0.634219598717363,
			 0.632487076711467, "<unicode>", 1.00018501685985, "contcor1",
			 0.0928799033523055, 182, 229, 1.39300603911673, 2.61523255025888,
			 "contGamma:contcor1", 1.94126226913055, 1.94464078217211, "<unicode>",
			 0.996561182777886, "contcor1", 0.316070806313258, 178, 293,
			 0.725181670501345, 1.23887782330936, "contcor1", 0.961625218928511,
			 0.962334086729721, "<unicode>", 1.00021587596813, "contcor1",
			 0.137142825007694, 228, 130, -0.0841380651236273, 0.78478833904497,
			 "contcor2:contcor1", 0.346447463257537, 0.344584727909432, "<unicode>",
			 1.00557101325904, "contGamma:contcor1", 0.23640621173762, 129,
			 274, 0.880001591343445, 1.68200059347663, "debCollin1:contcor1",
			 1.23167025393756, 1.23010286453588, "<unicode>", 0.995739448949812,
			 "contGamma:contcor1", 0.209110844167531, 216, 330, 4.87212640897552,
			 8.07748152819793, "contGamma:contcor1", 6.37097863552707, 6.35144942981579,
			 "<unicode>", 1.01494804692798, "contGamma:contcor1", 0.878264112541198,
			 175, 175, 0.00711611484597156, 0.261747544076876, "contcor2:contcor1",
			 0.126520703752068, 0.124988093221392, "<unicode>", 0.998336974876548,
			 "debCollin1:contcor1", 0.0674687202956117, 110, 281, 0.321516734790842,
			 0.55550555116611, "debCollin1:contcor1", 0.426130659659176,
			 0.42519332977504, "<unicode>", 1.00039779814883, "debCollin1:contcor1",
			 0.0634998808284432, 179, 202, 0.878837350470287, 1.52698842756482,
			 "contcor2:contcor1", 1.16256863210384, 1.15417801191011, "<unicode>",
			 0.997788195614373, "contcor2:contcor1", 0.170872458409033, 158
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(23, -0.22779803764534, 0.139501727650411, 16, "contGamma", "contNormal",
			 "", "", -0.0477759765832691, -0.0526147297968646, "<unicode>",
			 "", "", 1.06134041231891, 0.0963946848374217, 174, 17, -0.14233480078234,
			 0.126119100404354, 50, "contGamma", "contNormal", "", "", -0.0301777349991917,
			 -0.0356425186281407, "<unicode>", "", "", 1.06658234433966,
			 0.0694228971700882, 49, 110, -0.214376172653788, 0.262487126013663,
			 84, "contGamma", "contNormal", "", "", -0.0114371736497042,
			 -0.0237388699709659, "<unicode>", "", "", 1.00595601731773,
			 0.122154520659497, 118, 53, -0.0293963773656859, 0.0637966358019965,
			 16, "contGamma", "debCollin1", "contNormal", "", 0.0113622958818142,
			 0.00644985054868677, "<unicode>", "<unicode>", "", 1.01539196748597,
			 0.0253878474501624, 136, 5, -0.0366539526404105, 0.0281359263354306,
			 50, "contGamma", "debCollin1", "contNormal", "", -0.000620026919581818,
			 0.000694355907100357, "<unicode>", "<unicode>", "", 1.16619499513352,
			 0.015318364608032, 52, 40, -0.100771992906177, 0.0106140932090591,
			 84, "contGamma", "debCollin1", "contNormal", "", -0.0301313762075276,
			 -0.0238516612678875, "<unicode>", "<unicode>", "", 1.02958212374753,
			 0.0325227843303702, 90, 111, -0.00837421141273609, 0.0885855127441876,
			 16, "contGamma", "contcor2", "contNormal", "", 0.0287007444486973,
			 0.023708258975468, "<unicode>", "<unicode>", "", 0.996635201808749,
			 0.0273591928042665, 130, 201, -0.0391276612773665, 0.0140337821025339,
			 50, "contGamma", "contcor2", "contNormal", "", -0.00756200387347583,
			 -0.00452734942599824, "<unicode>", "<unicode>", "", 0.997354330159562,
			 0.0140348694125886, 151, 232, -0.0906779455937817, 0.0753838796686833,
			 84, "contGamma", "contcor2", "contNormal", "", -0.00416591465132017,
			 -0.00190983087305278, "<unicode>", "<unicode>", "", 1.00630731202892,
			 0.041274862553351, 134, 149, -0.0109662733923056, 0.00600707118656797,
			 16, "contGamma", "debCollin1", "contcor2", "contNormal", -0.0011024608384426,
			 -0.000207069537649072, "<unicode>", "<unicode>", "<unicode>",
			 0.996317283975052, 0.00444687500802256, 177, 69, -0.0036321423404726,
			 0.00811276912462817, 50, "contGamma", "debCollin1", "contcor2",
			 "contNormal", 0.00110257331911234, 0.000395604651429835, "<unicode>",
			 "<unicode>", "<unicode>", 0.995964275801898, 0.00305759150512678,
			 149, 190, -0.0207834052404224, 0.0164736393654226, 84, "contGamma",
			 "debCollin1", "contcor2", "contNormal", 9.18834730675488e-05,
			 9.96476934193941e-06, "<unicode>", "<unicode>", "<unicode>",
			 1.00421393271831, 0.00802388373921618, 140))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(15, -0.138610555175328, 0.125924000412536, "contGamma", -0.0308131616832789,
			 -0.0365655304560217, "<unicode>", "Normal(0,10)", 1.07041700336964,
			 "contNormal", 0.0688894210399512, 49, 3, -2.59581050194293,
			 3.36081468231038, "debCollin1", 0.070569035830716, -0.210320683627171,
			 "<unicode>", "Normal(0,10)", 1.25257176405769, "contNormal",
			 1.55001903835589, 18, 179, -0.422249993243401, 0.121545484467458,
			 "contcor2", -0.159814973896218, -0.176251177002328, "<unicode>",
			 "Normal(0,10)", 1.0017429712312, "contNormal", 0.156990976585045,
			 185, 17, -3.07968027584079, 0.569429479070661, "contcor1", -1.19064946067493,
			 -1.04146265945472, "<unicode>", "Normal(0,10)", 1.04164614916693,
			 "contNormal", 0.944006782967279, 30, 101, -0.134333444438172,
			 0.174982103116829, "contGamma:contcor1", 0.0181033243329671,
			 0.0147539824589151, "<unicode>", "Normal(0,10)", 1.00030863239129,
			 "contNormal", 0.0845790134800079, 148, 18, -0.352875948616229,
			 4.7919711272058, "debCollin1:contcor1", 2.10349406684715, 1.87001983458005,
			 "<unicode>", "Normal(0,10)", 1.01506117530828, "contNormal",
			 1.30663582673351, 30, 147, -0.0888892414311432, 0.350312794299558,
			 "contcor2:contcor1", 0.136268022611908, 0.148264173687985, "<unicode>",
			 "Normal(0,10)", 1.01800226779529, "contNormal", 0.11276900995387,
			 153, 189, -0.0194175682409706, 0.0018262190683702, "contGamma",
			 -0.00923734478255283, -0.00929108420645958, "<unicode>", "Normal(0,10)",
			 1.02737785240693, "debCollin1", 0.00519464686982422, 104, 190,
			 -0.0188202872765503, 0.0369104456403046, "contcor1", 0.00786143402127229,
			 0.00668018164228849, "<unicode>", "Normal(0,10)", 1.02060112324403,
			 "debCollin1", 0.0131414241947372, 153, 180, -0.0147078450478364,
			 0.00656185696031104, "contGamma:contcor1", -0.00382451709982948,
			 -0.00362998492965175, "<unicode>", "Normal(0,10)", 1.00389933997485,
			 "debCollin1", 0.00533215426473668, 179, 105, -0.068694109941646,
			 0.124440510196181, "contGamma", 0.0404479472672816, 0.0417321563677475,
			 "<unicode>", "Normal(0,10)", 1.01206830566401, "contcor2", 0.05042123984965,
			 38, 40, -1.40177019867693, 2.33011862965162, "debCollin1", 0.718550849801864,
			 0.799436527393836, "<unicode>", "Normal(0,10)", 0.9995705929665,
			 "contcor2", 0.969695913005268, 87, 29, -1.93702412821572, 0.56778312615161,
			 "contcor1", -0.673299538790005, -0.608810192885408, "<unicode>",
			 "Normal(0,10)", 1.0178095604389, "contcor2", 0.646791059661887,
			 36, 56, 0.0488228999129925, 0.240036704689375, "contGamma:contcor1",
			 0.147590326440194, 0.144239785149153, "<unicode>", "Normal(0,10)",
			 1.02177345211743, "contcor2", 0.0497191223879898, 78, 29, -0.11487687537086,
			 3.4476350085149, "debCollin1:contcor1", 1.55730378507322, 1.4687604355063,
			 "<unicode>", "Normal(0,10)", 1.01808935695452, "contcor2", 0.911080215909735,
			 39))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(35, -0.208139962965086, 0.166232414624719, 16, "Total", "contGamma",
			 "contNormal", -0.00881539709120017, -0.00760633340844328, "<unicode>",
			 1.03960661836441, 0.0945646657934744, 217, 111, -0.159419721023247,
			 0.123904351871948, 50, "Total", "contGamma", "contNormal", -0.0372571924731371,
			 -0.0425120498377052, "<unicode>", 1.02885875840688, 0.0685227271940059,
			 72, 269, -0.252166603825218, 0.205338593018443, 84, "Total",
			 "contGamma", "contNormal", -0.0456425810354845, -0.0490546344875803,
			 "<unicode>", 1.00891659756375, 0.115182931356464, 182, 38, -0.0302100536426284,
			 0.111926983897554, 16, "Total indirect", "contGamma", "contNormal",
			 0.0389605794920689, 0.0331253536259868, "<unicode>", 1.01289520182092,
			 0.0371023343939504, 95, 18, -0.0462672803421977, 0.0280928982729336,
			 50, "Total indirect", "contGamma", "contNormal", -0.00707945747394531,
			 -0.00481563867132748, "<unicode>", 1.06780818437064, 0.0202255600891246,
			 96, 70, -0.147833548351303, 0.0547440304561277, 84, "Total indirect",
			 "contGamma", "contNormal", -0.0342054073857803, -0.0323686114270013,
			 "<unicode>", 1.01661774769845, 0.0496704146751874, 132))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")

})
test_that("Test that model number 92 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$setSeed <- TRUE
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contcor2", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contcor2", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "contcor2",
            processType = "moderators", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 583.588277611184, 491.812975376083, 45.0661077992824,
			 0.5, 492.088888664432, 45.1644850983589))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(236, -0.161884649545696, -0.00663866789881456, "contcor2:facExperimexperimental",
			 -0.0640922104438835, -0.0615818661647348, "<unicode>", 0.996593824396459,
			 "facGenderm", 0.0362699901331405, 153, 205, -0.0122151537743024,
			 0.0557827552083831, "debCollin1:facExperimexperimental", 0.019721922424833,
			 0.0177402113167004, "<unicode>", 0.997459998014476, "facGenderm",
			 0.0185899958199912, 176, 183, 0.0958747065163089, 0.209421749281531,
			 "facGenderm:facExperimexperimental", 0.145148010920312, 0.140767183481824,
			 "<unicode>", 0.997087526418477, "facGenderm", 0.0306495891499689,
			 133, 203, -0.00845915334996603, 0.0855348715106171, "facExperimexperimental",
			 0.0329243999115816, 0.0313520977593316, "<unicode>", 0.996084818406636,
			 "facGenderm", 0.0270875579063568, 176, 202, 0.194337200490036,
			 0.360526181967489, "facGenderm", 0.257893584283646, 0.254103289901275,
			 "<unicode>", 0.995230039556493, "facGenderm", 0.0414587162036308,
			 185, 201, 0.86627772062808, 1.48565215799676, "contNormal",
			 1.1496279590021, 1.13226293879452, "<unicode>", 1.00672222816775,
			 "contNormal", 0.173010496443987, 138, 122, 0.00242066363551218,
			 0.00520718547019404, "debCollin1:facExperimexperimental", 0.00342744938932662,
			 0.0033463134469428, "<unicode>", 1.02215455470983, "debCollin1",
			 0.000680357897162416, 151, 123, 0.00532598658100209, 0.00974867918020371,
			 "debCollin1", 0.00699991668774672, 0.00686256367606785, "<unicode>",
			 1.01628088118403, "debCollin1", 0.001142787472853, 182, 231,
			 0.296624660570524, 0.549553507563915, "contcor2:facExperimexperimental",
			 0.408338953243195, 0.406139892089643, "<unicode>", 1.0015770019032,
			 "contcor2", 0.0719766687032783, 154, 266, 0.729137083084224,
			 1.27131068756536, "contcor2", 0.981682790347075, 0.980730494612634,
			 "<unicode>", 0.996938974964518, "contcor2", 0.140141878861963,
			 217, 198, -0.0874241523436688, 0.0538631618018253, "contcor2:facExperimexperimental",
			 -0.0135974981212892, -0.0146234445619009, "<unicode>", 0.997812536264044,
			 "facExperimexperimental", 0.0325317547762204, 126, 182, 0.120773845886872,
			 0.212060253683648, "debCollin1:facExperimexperimental", 0.161028321912007,
			 0.1608283165366, "<unicode>", 0.996569241801762, "facExperimexperimental",
			 0.0238896019082733, 217, 156, 0.0907772227283762, 0.196398050467556,
			 "facGenderm:facExperimexperimental", 0.136694774797728, 0.132399827621405,
			 "<unicode>", 1.004152470607, "facExperimexperimental", 0.0297303610444542,
			 160, 182, 0.186182926960311, 0.323251616160604, "facExperimexperimental",
			 0.245854951099954, 0.245026108717536, "<unicode>", 0.996689204958602,
			 "facExperimexperimental", 0.0362421360745029, 217, 266, -0.133533878152778,
			 -0.00873759816864159, "contcor2:facExperimexperimental", -0.0692245447225506,
			 -0.0658338070721062, "<unicode>", 1.01205060356198, "facGenderm:facExperimexperimental",
			 0.0319160637627805, 145, 154, 0.0558995587767747, 0.129234783621395,
			 "debCollin1:facExperimexperimental", 0.0872936761319122, 0.0852471707130414,
			 "<unicode>", 1.00362904316108, "facGenderm:facExperimexperimental",
			 0.0197308203556995, 117, 173, 0.158244756848166, 0.271157899477022,
			 "facGenderm:facExperimexperimental", 0.206193714657109, 0.200600199216703,
			 "<unicode>", 1.00571895259636, "facGenderm:facExperimexperimental",
			 0.031898706761886, 164, 201, -0.0537100931874911, 0.04150940769009,
			 "contcor2:facExperimexperimental", -0.00647397129493812, -0.00671859152022724,
			 "<unicode>", 0.996831957057899, "debCollin1:facExperimexperimental",
			 0.0214838623584908, 126, 185, 0.0815569336522531, 0.144877093438739,
			 "debCollin1:facExperimexperimental", 0.109137986806714, 0.108893754638513,
			 "<unicode>", 0.997750048289165, "debCollin1:facExperimexperimental",
			 0.0160672097106267, 177, 197, 0.351377017898288, 0.590664179564503,
			 "contcor2:facExperimexperimental", 0.467787367243854, 0.467880813855043,
			 "<unicode>", 1.01505859295816, "contcor2:facExperimexperimental",
			 0.0677684712084432, 224))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(210, 0.0379959292902793, 1.24536666954703, 0, "m", "facGender",
			 "contNormal", "", "", 0.609439325337338, 0.631700896528871,
			 "<unicode>", "", "", 1.0005954696501, 0.328182009613759, 137,
			 244, -0.248095995680893, 0.943944149781222, 1, "m", "facGender",
			 "contNormal", "", "", 0.294538817532923, 0.259206893696811,
			 "<unicode>", "", "", 1.00087870694394, 0.333933798224144, 170,
			 125, -0.0784245548651849, 0.0860301387015778, 0, "m", "facGender",
			 "debCollin1", "contNormal", "", 1.31455224848037e-05, -0.000839201909555193,
			 "<unicode>", "<unicode>", "", 1.01615965562794, 0.0378656787849001,
			 81, 160, -0.150235162696224, 0.097915283933915, 1, "m", "facGender",
			 "debCollin1", "contNormal", "", -0.0154067270426795, -0.00320021130548154,
			 "<unicode>", "<unicode>", "", 0.996167732701333, 0.0630762610604594,
			 117, 223, -0.110618041554633, 0.122641048083517, 0, "m", "facGender",
			 "contcor2", "contNormal", "", 0.00415338901484075, 0.00274048046493178,
			 "<unicode>", "<unicode>", "", 1.00236165062493, 0.0587075268514418,
			 225, 205, -0.137626271489993, 0.220066665261157, 1, "m", "facGender",
			 "contcor2", "contNormal", "", 0.0329510429757087, 0.0206981582193382,
			 "<unicode>", "<unicode>", "", 0.99769726057495, 0.0920199100085853,
			 154, 260, -0.0152171323805346, 0.0191332280298288, 0, "m", "facGender",
			 "debCollin1", "contcor2", "contNormal", 0.000287010208234824,
			 2.59929870754761e-05, "<unicode>", "<unicode>", "<unicode>",
			 1.00079919874331, 0.00863289022439046, 120, 175, -0.010649190418381,
			 0.0195830178863324, 1, "m", "facGender", "debCollin1", "contcor2",
			 "contNormal", 0.000795522329074699, 4.8943038519763e-05, "<unicode>",
			 "<unicode>", "<unicode>", 1.00780783108918, 0.00654431048440458,
			 182))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(210, 0.0379959292902793, 1.24536666954703, "facGenderm", 0.609439325337338,
			 0.631700896528871, "<unicode>", "Normal(0,10)", 1.0005954696501,
			 "contNormal", 0.328182009613759, 137, 97, -3.83415209451033,
			 3.21143099877292, "debCollin1", -0.298940617186692, -0.251032557434374,
			 "<unicode>", "Normal(0,10)", 1.01206213634153, "contNormal",
			 1.72718885434869, 77, 85, -0.12788941893834, 0.424964199556703,
			 "contcor2", 0.161593830718479, 0.151325636345195, "<unicode>",
			 "Normal(0,10)", 1.01986696983015, "contNormal", 0.149610756217899,
			 125, 72, -4.72125260190951, 2.43275935791625, "facExperimexperimental",
			 -0.456826032307723, -0.481606817690319, "<unicode>", "Normal(0,10)",
			 1.01394194750721, "contNormal", 1.7656016003781, 52, 232, -1.15272826478036,
			 0.483096065484815, "facGenderm:facExperimexperimental", -0.314900507804415,
			 -0.321513620447472, "<unicode>", "Normal(0,10)", 1.00769579511684,
			 "contNormal", 0.473485955432651, 154, 72, -3.50890445006059,
			 6.82021222658658, "debCollin1:facExperimexperimental", 0.950578880102361,
			 1.04626672530418, "<unicode>", "Normal(0,10)", 1.01470463404233,
			 "contNormal", 2.64833807870824, 49, 141, -0.70507903964386,
			 0.228301685625988, "contcor2:facExperimexperimental", -0.227820922124542,
			 -0.222928831407847, "<unicode>", "Normal(0,10)", 1.01173975001031,
			 "contNormal", 0.235245182613408, 105, 211, -0.0407834394580679,
			 0.0482156202854714, "facGenderm", 0.00651833659706526, 0.0084318763249654,
			 "<unicode>", "Normal(0,10)", 1.00199121294506, "debCollin1",
			 0.0253698209691526, 153, 264, -0.0498460979813534, 0.0418694300244289,
			 "facExperimexperimental", -0.0017149963132128, 5.05186303974812e-05,
			 "<unicode>", "Normal(0,10)", 0.995275863542198, "debCollin1",
			 0.0241904630481068, 158, 221, -0.0832042846062075, 0.0395493093804231,
			 "facGenderm:facExperimexperimental", -0.0229475187034073, -0.0239981181777559,
			 "<unicode>", "Normal(0,10)", 0.996016463663476, "debCollin1",
			 0.0345285115303114, 190, 246, -0.477034885370841, 0.499519970844209,
			 "facGenderm", 0.0218050114114668, 0.042278199360408, "<unicode>",
			 "Normal(0,10)", 1.00046556151918, "contcor2", 0.270867378519502,
			 145, 57, -3.67779405879003, 1.84918236280924, "debCollin1",
			 -0.647722916274956, -0.661474114272543, "<unicode>", "Normal(0,10)",
			 1.02917839375071, "contcor2", 1.42772732486848, 69, 40, -3.69763902165038,
			 1.87950518460624, "facExperimexperimental", -0.586720228184839,
			 -0.371085914729111, "<unicode>", "Normal(0,10)", 1.01343610602288,
			 "contcor2", 1.35506020530315, 84, 251, -1.19055020555751, 0.319588483605957,
			 "facGenderm:facExperimexperimental", -0.496418731739447, -0.507034598944295,
			 "<unicode>", "Normal(0,10)", 1.00048388177209, "contcor2", 0.384273247436718,
			 97, 38, -2.66423442503738, 5.12397327883781, "debCollin1:facExperimexperimental",
			 0.939170332816332, 0.576652917315848, "<unicode>", "Normal(0,10)",
			 1.03058136165165, "contcor2", 1.95321940703091, 84))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(221, -0.0698230674752029, 1.21290666181896, 0, "m", "Total", "facGender",
			 "contNormal", 0.613892870082898, 0.618675855016009, "<unicode>",
			 1.00802786155038, 0.335922900061578, 185, 280, -0.281264457482771,
			 0.924473469287478, 1, "m", "Total", "facGender", "contNormal",
			 0.312878655795027, 0.293714501497918, "<unicode>", 0.997998723870871,
			 0.323301141669434, 140, 192, -0.14585421863753, 0.172673647497274,
			 0, "m", "Total indirect", "facGender", "contNormal", 0.00445354474556038,
			 0.00384926002400363, "<unicode>", 1.00921140944853, 0.0749881001783724,
			 221, 163, -0.186228697312007, 0.240645480265093, 1, "m", "Total indirect",
			 "facGender", "contNormal", 0.0183398382621039, 0.0162312373152428,
			 "<unicode>", 1.00079461376583, 0.111559578922075, 217))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")

})
