# This code is automatically generated by 'generate-tests.R'


test_that("Test that model number 1 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1352.14509885669, 1331.38216933618, 47.1031145165521,
			 0.54, 1331.25439423415, 47.0861584003708))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(114, -1.38657287508528, 0.00889838143884347, "contGamma:contcor1",
			 -0.621151145130191, -0.57565492213818, "<unicode>", 0.995359428821732,
			 "contGamma", 0.368222024829412, 98, 132, -0.578347112073847,
			 -0.00611319287632406, "contcor1", -0.262885018885688, -0.24768432084045,
			 "<unicode>", 0.996724768002939, "contGamma", 0.151467059197271,
			 135, 186, 1.88667694692864, 3.48346464133584, "contGamma", 2.44887718190229,
			 2.39281707271163, "<unicode>", 1.00915968001228, "contGamma",
			 0.387043479711959, 105, 209, 0.872653208637433, 1.48190602457314,
			 "contNormal", 1.13123739559055, 1.12108882431946, "<unicode>",
			 1.00404257333747, "contNormal", 0.155213163469578, 136, 143,
			 1.55662093332248, 2.76087929179999, "contGamma:contcor1", 2.05936316308485,
			 2.00475753787518, "<unicode>", 1.00518849295993, "contcor1",
			 0.326345684829293, 120, 213, 0.816195871972649, 1.34945814383958,
			 "contcor1", 1.02173489226544, 1.00114480373756, "<unicode>",
			 1.01935236231038, "contcor1", 0.1378778913283, 177, 137, 5.0316674153746,
			 8.60182437022689, "contGamma:contcor1", 6.58901672257129, 6.4870269053034,
			 "<unicode>", 1.00440868212647, "contGamma:contcor1", 0.931061081415668,
			 128))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(171, -0.162181511075522, 0.221801468988619, 16, "contGamma", "contNormal",
			 0.0238863381647963, 0.0295420003094439, "<unicode>", 0.996258422911101,
			 0.0938826723583838, 178, 282, -0.155527528278469, 0.103239852744504,
			 50, "contGamma", "contNormal", -0.024218477589291, -0.0244559509643063,
			 "<unicode>", 1.02462942825419, 0.0679689907359393, 102, 151,
			 -0.276250258285653, 0.129001281817763, 84, "contGamma", "contNormal",
			 -0.0767187700205205, -0.0772504590800705, "<unicode>", 1.00135458785726,
			 0.104600554033041, 137))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(283, -0.155502154036762, 0.103151651077921, "contGamma", -0.0240387277285473,
			 -0.0244569212203342, "<unicode>", "Normal(0,10)", 1.02661339681357,
			 "contNormal", 0.067953512398962, 102, 71, -0.0599080196296081,
			 0.606619192757541, "contcor1", 0.278280267730633, 0.28201864850272,
			 "<unicode>", "Normal(0,10)", 0.996412785543848, "contNormal",
			 0.175975140948044, 133, 105, -0.173937113972626, 0.0982467417462468,
			 "contGamma:contcor1", -0.0493818298746456, -0.053351154485668,
			 "<unicode>", "Normal(0,10)", 0.995223854779564, "contNormal",
			 0.0709361482761115, 133))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(171, -0.162181511075522, 0.221801468988619, 16, "Total", "contGamma",
			 "contNormal", 0.0238863381647963, 0.0295420003094439, "<unicode>",
			 0.996258422911101, 0.0938826723583838, 178, 282, -0.155527528278469,
			 0.103239852744504, 50, "Total", "contGamma", "contNormal", -0.024218477589291,
			 -0.0244559509643063, "<unicode>", 1.02462942825419, 0.0679689907359393,
			 102, 151, -0.276250258285653, 0.129001281817763, 84, "Total",
			 "contGamma", "contNormal", -0.0767187700205205, -0.0772504590800705,
			 "<unicode>", 1.00135458785726, 0.104600554033041, 137))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")

})
test_that("Test that model number 1 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 626.781297032531, 598.86150760843, 20.8746431902007,
			 0.525, 598.820393421961, 20.9053015671423))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(198, 0.0978594957469122, 0.201969874985253, "facGenderm:facExperimexperimental",
			 0.145683854498541, 0.144285745018705, "<unicode>", 1.0090568501117,
			 "facGenderm", 0.0272100743632577, 151, 159, -0.0107194317943731,
			 0.0868881362484183, "facExperimexperimental", 0.0384380207286774,
			 0.0371093583039592, "<unicode>", 1.00557154756575, "facGenderm",
			 0.0270788576181267, 181, 241, 0.198554854072213, 0.327054610995039,
			 "facGenderm", 0.25844547743144, 0.25517016097026, "<unicode>",
			 0.995821559908034, "facGenderm", 0.0332858691607806, 184, 193,
			 0.830228600925986, 1.46941570669016, "contNormal", 1.10464224206462,
			 1.10717841654417, "<unicode>", 1.00084010699167, "contNormal",
			 0.164764149704695, 116, 175, 0.107022670213868, 0.201397211130628,
			 "facGenderm:facExperimexperimental", 0.149421037442583, 0.147312171802139,
			 "<unicode>", 1.01161635165858, "facExperimexperimental", 0.0262411063452088,
			 151, 238, 0.192654491181459, 0.35608754898707, "facExperimexperimental",
			 0.261422152789835, 0.257645112476042, "<unicode>", 1.04042401571562,
			 "facExperimexperimental", 0.0400266170995588, 188, 193, 0.160401454027461,
			 0.27308909806089, "facGenderm:facExperimexperimental", 0.210655509668376,
			 0.207863682753765, "<unicode>", 1.00694485304281, "facGenderm:facExperimexperimental",
			 0.0292633976606879, 191))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(86, 0.114344794962399, 1.19110033591231, 0, "m", "facGender",
			 "contNormal", 0.632794962391321, 0.631386140386287, "<unicode>",
			 0.997689928445767, 0.280358581003185, 86, 152, -0.305642375685427,
			 0.921244770455128, 1, "m", "facGender", "contNormal", 0.310398685322932,
			 0.331681947010068, "<unicode>", 1.00545006253921, 0.304202009479146,
			 119))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(86, 0.114344794962399, 1.19110033591231, "facGenderm", 0.632794962391321,
			 0.631386140386287, "<unicode>", "Normal(0,10)", 0.997689928445767,
			 "contNormal", 0.280358581003185, 86, 120, -0.497092076465097,
			 0.725298384082293, "facExperimexperimental", 0.139875659128099,
			 0.150478889523309, "<unicode>", "Normal(0,10)", 1.00261684064236,
			 "contNormal", 0.283799879061275, 63, 75, -1.03265862316115,
			 0.333863580008087, "facGenderm:facExperimexperimental", -0.32239627706839,
			 -0.34398928267286, "<unicode>", "Normal(0,10)", 0.995289685382198,
			 "contNormal", 0.376805003211918, 117))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(86, 0.114344794962399, 1.19110033591231, 0, "m", "Total", "facGender",
			 "contNormal", 0.632794962391321, 0.631386140386287, "<unicode>",
			 0.997689928445767, 0.280358581003185, 86, 152, -0.305642375685427,
			 0.921244770455128, 1, "m", "Total", "facGender", "contNormal",
			 0.310398685322932, 0.331681947010068, "<unicode>", 1.00545006253921,
			 0.304202009479146, 119))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")

})
test_that("Test that model number 2 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1882.40461016181, 1839.53934951515, 65.2603091050946,
			 0.485, 1840.59073649265, 65.696049713234))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(77, -1.05806260799665, 0.549791475361491, "contGamma:contcor2",
			 -0.240378440538734, -0.258523914017539, "<unicode>", 1.02409282790735,
			 "contGamma", 0.400491313178989, 87, 75, -0.326668326332836,
			 0.187924240940491, "contcor2", -0.0704345601724729, -0.0781709536378458,
			 "<unicode>", 0.99915181361466, "contGamma", 0.143983690069555,
			 114, 81, -1.22175396149458, 0.182677967382682, "contGamma:contcor1",
			 -0.481250079923848, -0.46331060457089, "<unicode>", 0.997993522881296,
			 "contGamma", 0.363418009665164, 103, 98, -0.528923386343235,
			 0.0772717811884883, "contcor1", -0.211017448314952, -0.207216447940312,
			 "<unicode>", 0.996132246847484, "contGamma", 0.143519883413429,
			 150, 324, 1.80255148127151, 3.42424769638775, "contGamma", 2.4910176228593,
			 2.44676414755213, "<unicode>", 1.00564693189439, "contGamma",
			 0.40579463341468, 119, 205, 0.87599182429695, 1.46383209525307,
			 "contNormal", 1.13463959360579, 1.12426241821664, "<unicode>",
			 1.0100586486038, "contNormal", 0.155958208242682, 62, 100, 0.902835470613023,
			 2.05630688940056, "contGamma:contcor2", 1.38462109233708, 1.36908983235705,
			 "<unicode>", 1.01353292415493, "contcor1", 0.293272155071379,
			 114, 118, 0.421615599957967, 0.835864079159834, "contcor2",
			 0.592664421445194, 0.583699472190631, "<unicode>", 1.00797672499458,
			 "contcor1", 0.112425928477934, 84, 147, 1.48332251751935, 2.64509737128527,
			 "contGamma:contcor1", 1.94888163542095, 1.95865395153293, "<unicode>",
			 0.997804181868199, "contcor1", 0.284619285176173, 223, 199,
			 0.760697511499979, 1.28764966144014, "contcor1", 0.985354228749717,
			 0.976169599966631, "<unicode>", 1.0041838964638, "contcor1",
			 0.131349029165588, 178, 111, 3.73419150083078, 7.24164237232001,
			 "contGamma:contcor2", 5.23670048065777, 5.16426953617716, "<unicode>",
			 1.01044975777077, "contGamma:contcor1", 0.914503919439085, 85,
			 110, 0.930792036423264, 2.15543650523214, "contcor2", 1.42090579555478,
			 1.39133050266403, "<unicode>", 1.00545931513219, "contGamma:contcor1",
			 0.306508559588244, 106, 145, 4.76846193424202, 8.05782173925705,
			 "contGamma:contcor1", 6.25449556660914, 6.18208572860476, "<unicode>",
			 0.995505598555541, "contGamma:contcor1", 0.834928700750592,
			 140, 139, 1.5560196519949, 3.02348234867843, "contGamma:contcor2",
			 2.1895350426065, 2.14472333003277, "<unicode>", 0.995150082200522,
			 "contcor2", 0.379462480542419, 85, 183, 0.716695332811558, 1.26326084950419,
			 "contcor2", 0.960462056107524, 0.952191216809544, "<unicode>",
			 0.996547225387738, "contcor2", 0.141604594013111, 153, 126,
			 5.57854553537542, 10.2175486018416, "contGamma:contcor2", 7.49180198475503,
			 7.34093756426577, "<unicode>", 0.997093127089974, "contGamma:contcor2",
			 1.18596878821838, 72))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(258, -0.150189183028609, 0.221328866301801, 16, 16, "contGamma",
			 "contNormal", 0.0234623273367829, 0.0269097193571447, "<unicode>",
			 1.00366373267, 0.0940675566740726, 184, 112, -0.20962806466863,
			 0.285661517063193, 50, 16, "contGamma", "contNormal", 0.0112467976872203,
			 0.0112253674639493, "<unicode>", 1.03403103451887, 0.130922543262115,
			 105, 96, -0.454256147903536, 0.450003014543773, 84, 16, "contGamma",
			 "contNormal", -0.00208490037151105, -0.00863918728249558, "<unicode>",
			 1.03558625284831, 0.252625556408806, 142, 118, -0.301245195666943,
			 0.26009320376009, 16, 50, "contGamma", "contNormal", -0.00684274319738916,
			 -0.0178938908583131, "<unicode>", 1.01675715417421, 0.144910972742067,
			 134, 278, -0.131011419894964, 0.0914452451906227, 50, 50, "contGamma",
			 "contNormal", -0.0190582728469518, -0.0209316079291844, "<unicode>",
			 0.997072894229531, 0.0638524137050322, 154, 104, -0.315526056945796,
			 0.273772813347132, 84, 50, "contGamma", "contNormal", -0.0323899709056831,
			 -0.021272152998746, "<unicode>", 1.01047774582044, 0.152440615655469,
			 154, 101, -0.562425092800361, 0.424660183054431, 16, 84, "contGamma",
			 "contNormal", -0.04236493742805, -0.0431338411019875, "<unicode>",
			 1.04948223987433, 0.265748044413635, 117, 114, -0.343353304431747,
			 0.223833081739412, 50, 84, "contGamma", "contNormal", -0.0545804670776127,
			 -0.0538907555908992, "<unicode>", 1.02342632291955, 0.155387283466818,
			 184, 184, -0.251323120735556, 0.130607265450809, 84, 84, "contGamma",
			 "contNormal", -0.067912165136344, -0.077831534588265, "<unicode>",
			 1.01088993767892, 0.10512353974914, 190))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(280, -0.130612773755064, 0.0985391087963377, "contGamma", -0.0180626157704945,
			 -0.0194507246927296, "<unicode>", "Normal(0,10)", 0.998560688562326,
			 "contNormal", 0.063746344960643, 154, 97, -0.220576549939806,
			 0.713121056337794, "contcor1", 0.280759393661937, 0.276580599616044,
			 "<unicode>", "Normal(0,10)", 1.0271923424813, "contNormal",
			 0.263939852716445, 128, 98, -0.237055260032762, 0.232811426823414,
			 "contGamma:contcor1", -0.0125398091132308, -0.0161628495529641,
			 "<unicode>", "Normal(0,10)", 1.01630612709922, "contNormal",
			 0.131807250061625, 132, 83, -0.562466275362661, 0.443902454450959,
			 "contcor2", -0.060319703979902, -0.0561827092038471, "<unicode>",
			 "Normal(0,10)", 1.01539003561765, "contNormal", 0.261049399873856,
			 94, 102, -0.277197627766735, 0.185506126600592, "contGamma:contcor2",
			 -0.031772982317228, -0.0222753295240094, "<unicode>", "Normal(0,10)",
			 1.04883502252512, "contNormal", 0.123591265758589, 113))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(258, -0.150189183028609, 0.221328866301801, 16, 16, "Total", "contGamma",
			 "contNormal", 0.0234623273367829, 0.0269097193571447, "<unicode>",
			 1.00366373267, 0.0940675566740726, 184, 112, -0.20962806466863,
			 0.285661517063193, 50, 16, "Total", "contGamma", "contNormal",
			 0.0112467976872203, 0.0112253674639493, "<unicode>", 1.03403103451887,
			 0.130922543262115, 105, 96, -0.454256147903536, 0.450003014543773,
			 84, 16, "Total", "contGamma", "contNormal", -0.00208490037151105,
			 -0.00863918728249558, "<unicode>", 1.03558625284831, 0.252625556408806,
			 142, 118, -0.301245195666943, 0.26009320376009, 16, 50, "Total",
			 "contGamma", "contNormal", -0.00684274319738916, -0.0178938908583131,
			 "<unicode>", 1.01675715417421, 0.144910972742067, 134, 278,
			 -0.131011419894964, 0.0914452451906227, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0190582728469518, -0.0209316079291844, "<unicode>",
			 0.997072894229531, 0.0638524137050322, 154, 104, -0.315526056945796,
			 0.273772813347132, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0323899709056831, -0.021272152998746, "<unicode>", 1.01047774582044,
			 0.152440615655469, 154, 101, -0.562425092800361, 0.424660183054431,
			 16, 84, "Total", "contGamma", "contNormal", -0.04236493742805,
			 -0.0431338411019875, "<unicode>", 1.04948223987433, 0.265748044413635,
			 117, 114, -0.343353304431747, 0.223833081739412, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0545804670776127, -0.0538907555908992,
			 "<unicode>", 1.02342632291955, 0.155387283466818, 184, 184,
			 -0.251323120735556, 0.130607265450809, 84, 84, "Total", "contGamma",
			 "contNormal", -0.067912165136344, -0.077831534588265, "<unicode>",
			 1.01088993767892, 0.10512353974914, 190))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")

})
test_that("Test that model number 2 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, "Model 1", 100, 1095.07232884951, 1037.03350147771, 32.6449110748457,
			 0.495, 1036.95504351832, 32.6628671116197))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(134, -0.0793182868329793, 0.0494436255080693, "facGenderm:contcor2",
			 -0.012271505205347, -0.0103351173468533, "<unicode>", 0.99860946199161,
			 "facGenderm", 0.0323498033876519, 133, 175, -0.143998043837048,
			 0.0382532923874599, "contcor2", -0.0586871185998529, -0.0599377632413085,
			 "<unicode>", 0.996519762768325, "facGenderm", 0.0490063173878442,
			 131, 184, 0.10403123368516, 0.193798941941395, "facGenderm:facExperimexperimental",
			 0.147424600967952, 0.146819556239949, "<unicode>", 1.02034330763045,
			 "facGenderm", 0.0241626903772674, 153, 183, -0.00763949741222216,
			 0.0793695623616134, "facExperimexperimental", 0.0359607927727044,
			 0.0337761248640933, "<unicode>", 1.00641045688213, "facGenderm",
			 0.0220540445685176, 153, 255, 0.196584782833054, 0.335577909159136,
			 "facGenderm", 0.261949983212561, 0.261715946310578, "<unicode>",
			 1.01572082276871, "facGenderm", 0.0358773556129387, 174, 200,
			 0.840170193710169, 1.49965269400949, "contNormal", 1.13795329146099,
			 1.12893614354042, "<unicode>", 1.01212044126332, "contNormal",
			 0.168767998094007, 154, 208, -0.129995130907206, -0.00711906567008234,
			 "facGenderm:contcor2", -0.0665287335464001, -0.0632504444287693,
			 "<unicode>", 1.00206382439991, "facExperimexperimental", 0.0320946347116331,
			 182, 163, -0.166414157466239, 0.0145234408087347, "contcor2",
			 -0.0665617340845312, -0.066814496236737, "<unicode>", 0.999254542785394,
			 "facExperimexperimental", 0.0477371545925544, 115, 197, 0.0963536136157875,
			 0.209250664036113, "facGenderm:facExperimexperimental", 0.147153726683949,
			 0.145192398691445, "<unicode>", 1.00319061786637, "facExperimexperimental",
			 0.0271763876902115, 177, 206, 0.197065772014572, 0.359173886582713,
			 "facExperimexperimental", 0.263094122138343, 0.261108898085585,
			 "<unicode>", 1.02591904464883, "facExperimexperimental", 0.0409956197785212,
			 182, 174, -0.12948563864209, -0.0176381826311432, "facGenderm:contcor2",
			 -0.0710074663161584, -0.0704563042193341, "<unicode>", 0.999308788502585,
			 "facGenderm:facExperimexperimental", 0.030485011695122, 136,
			 153, -0.179650351554241, 0.000252931702713451, "contcor2", -0.0926648089917326,
			 -0.0933599540152899, "<unicode>", 1.00997593944107, "facGenderm:facExperimexperimental",
			 0.0464196277761882, 134, 165, 0.161946177109979, 0.285726749358639,
			 "facGenderm:facExperimexperimental", 0.213736814512354, 0.211691584371837,
			 "<unicode>", 0.999940791483787, "facGenderm:facExperimexperimental",
			 0.029217731912799, 145, 279, 0.308105943565027, 0.629463729794242,
			 "facGenderm:contcor2", 0.4541735753089, 0.447079929307849, "<unicode>",
			 0.998833110688345, "contcor2", 0.0846677295842512, 177, 224,
			 0.770414549680086, 1.38899499407026, "contcor2", 1.03710665826924,
			 1.03113168471827, "<unicode>", 0.998756715112528, "contcor2",
			 0.156010592847462, 137, 248, 0.350115779748304, 0.621308356063242,
			 "facGenderm:contcor2", 0.468865516150295, 0.465552034493703,
			 "<unicode>", 1.00546606109603, "facGenderm:contcor2", 0.0704988933177402,
			 154))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(89, -0.236923880382554, 1.32134171830979, 16, 0, "m", "facGender",
			 "contNormal", 0.546999739495602, 0.551626607201157, "<unicode>",
			 0.999775200644097, 0.390853237371086, 77, 200, -0.445154184514827,
			 1.01943553646364, 16, 1, "m", "facGender", "contNormal", 0.325368932462048,
			 0.335435949855262, "<unicode>", 0.99635505519704, 0.367388771564902,
			 146, 68, 0.0423457152428285, 1.22575776667547, 50, 0, "m", "facGender",
			 "contNormal", 0.600405428214249, 0.592802875812824, "<unicode>",
			 0.998083201629897, 0.3039046579604, 49, 158, -0.239038897164913,
			 0.96105302519665, 50, 1, "m", "facGender", "contNormal", 0.378774621180695,
			 0.407397708011439, "<unicode>", 1.00010062760353, 0.318204490903276,
			 157, 82, -0.0355724729598695, 1.37032454417544, 84, 0, "m",
			 "facGender", "contNormal", 0.663005092700983, 0.667436881977838,
			 "<unicode>", 1.01495875246409, 0.380431139627185, 106, 88, -0.308240205578281,
			 1.24358276419579, 84, 1, "m", "facGender", "contNormal", 0.441374285667429,
			 0.44982292692588, "<unicode>", 1.01837605710218, 0.430007101730376,
			 122))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(68, 0.0441763874100074, 1.22743156469552, "facGenderm", 0.598731251140766,
			 0.590187806965661, "<unicode>", "Normal(0,10)", 0.997538454453251,
			 "contNormal", 0.304602496297067, 52, 108, -0.377934461465131,
			 0.589095941953372, "facExperimexperimental", 0.12999901914856,
			 0.144921797263148, "<unicode>", "Normal(0,10)", 0.996696781061084,
			 "contNormal", 0.280208811028487, 125, 68, -0.931923037131341,
			 0.582698503781194, "facGenderm:facExperimexperimental", -0.221630807033554,
			 -0.228780754564207, "<unicode>", "Normal(0,10)", 1.01317024764159,
			 "contNormal", 0.400746138035468, 67, 213, -0.258514035483114,
			 0.361740587346922, "contcor2", 0.0317200051811163, 0.0306265011298771,
			 "<unicode>", "Normal(0,10)", 0.999742088959162, "contNormal",
			 0.163278923766448, 119, 174, -0.330610819250737, 0.577545423011712,
			 "facGenderm:contcor2", 0.0559925442636267, 0.0706764241438798,
			 "<unicode>", "Normal(0,10)", 1.02282411914903, "contNormal",
			 0.230606152423757, 77))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(89, -0.236923880382554, 1.32134171830979, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.546999739495602, 0.551626607201157,
			 "<unicode>", 0.999775200644097, 0.390853237371086, 77, 200,
			 -0.445154184514827, 1.01943553646364, 16, 1, "m", "Total", "facGender",
			 "contNormal", 0.325368932462048, 0.335435949855262, "<unicode>",
			 0.99635505519704, 0.367388771564902, 146, 68, 0.0423457152428285,
			 1.22575776667547, 50, 0, "m", "Total", "facGender", "contNormal",
			 0.600405428214249, 0.592802875812824, "<unicode>", 0.998083201629897,
			 0.3039046579604, 49, 158, -0.239038897164913, 0.96105302519665,
			 50, 1, "m", "Total", "facGender", "contNormal", 0.378774621180695,
			 0.407397708011439, "<unicode>", 1.00010062760353, 0.318204490903276,
			 157, 82, -0.0355724729598695, 1.37032454417544, 84, 0, "m",
			 "Total", "facGender", "contNormal", 0.663005092700983, 0.667436881977838,
			 "<unicode>", 1.01495875246409, 0.380431139627185, 106, 88, -0.308240205578281,
			 1.24358276419579, 84, 1, "m", "Total", "facGender", "contNormal",
			 0.441374285667429, 0.44982292692588, "<unicode>", 1.01837605710218,
			 0.430007101730376, 122))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")

})
test_that("Test that model number 3 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contcor1",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 2573.57093885934, 2500.63428038786, 94.1787512396595,
			 0.465, 2508.87227018962, 97.171034497995))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(110, -0.246903489590423, 0.554930752496427, "contcor1:contcor2",
			 0.205573584802847, 0.205635721977907, "<unicode>", 1.01379097037079,
			 "contGamma", 0.18778196695649, 94, 111, 1.46996269938081, 3.48769758455049,
			 "contGamma:contcor1:contcor2", 2.39387069776578, 2.37473438406364,
			 "<unicode>", 1.02421565803018, "contGamma", 0.561493485283347,
			 141, 136, -1.24716176244963, 0.508437357106838, "contGamma:contcor2",
			 -0.36497869685765, -0.358031034939413, "<unicode>", 1.01651915415114,
			 "contGamma", 0.436937466383485, 154, 111, -0.368972500414613,
			 0.15856471060882, "contcor2", -0.104186441547687, -0.0987263725775414,
			 "<unicode>", 0.999547260545974, "contGamma", 0.15721356860327,
			 95, 164, -1.43136552790745, 0.176855769885885, "contGamma:contcor1",
			 -0.592457960723043, -0.603277676094027, "<unicode>", 0.996470136983534,
			 "contGamma", 0.402520086247204, 154, 146, -0.586502360661771,
			 0.0883673780949027, "contcor1", -0.233679358181959, -0.23298727295077,
			 "<unicode>", 0.996286480386005, "contGamma", 0.172733572157768,
			 127, 255, 1.83680044314643, 3.28327545918285, "contGamma", 2.46619629418416,
			 2.45368354797099, "<unicode>", 0.997240000832341, "contGamma",
			 0.347526696277736, 190, 260, 0.870048503285375, 1.52499168851759,
			 "contNormal", 1.16510023753152, 1.15644695920619, "<unicode>",
			 1.01222652182732, "contNormal", 0.1797192577339, 153, 93, 0.0332580240278899,
			 0.426176792661592, "contcor1:contcor2", 0.210655670949294, 0.199750176764558,
			 "<unicode>", 1.01420649916207, "contcor1", 0.107609880805472,
			 76, 101, -0.327978981568579, 0.756707432376852, "contGamma:contcor1:contcor2",
			 0.161582442097202, 0.139367378757414, "<unicode>", 1.01355326152962,
			 "contcor1", 0.298104441268721, 92, 102, 0.887314450290947, 1.92352000593593,
			 "contGamma:contcor2", 1.37260926860039, 1.34587836611961, "<unicode>",
			 1.00008376778888, "contcor1", 0.290389800750065, 80, 116, 0.406177851199791,
			 0.814825040346675, "contcor2", 0.597003813420135, 0.600407785184853,
			 "<unicode>", 0.996221618434047, "contcor1", 0.107129027324996,
			 149, 123, 1.38808297432295, 2.5307953237676, "contGamma:contcor1",
			 1.94427246528755, 1.9017966070132, "<unicode>", 1.00269694382663,
			 "contcor1", 0.304934436275605, 136, 136, 0.763752047796588,
			 1.27321434477585, "contcor1", 0.998687581360437, 0.976648850636008,
			 "<unicode>", 1.01314357912308, "contcor1", 0.135259792499411,
			 144, 74, -0.079892232334171, 0.992410296872833, "contcor1:contcor2",
			 0.357462092209052, 0.304647238368848, "<unicode>", 1.02568227041916,
			 "contGamma:contcor1", 0.275881707807078, 29, 42, -0.268970459717482,
			 2.85662258631467, "contGamma:contcor1:contcor2", 1.11121769046288,
			 1.02630510642945, "<unicode>", 1.02228102929032, "contGamma:contcor1",
			 0.771049363647686, 44, 152, 3.75732327930603, 7.1173263945324,
			 "contGamma:contcor2", 5.24513075109073, 5.17698795742795, "<unicode>",
			 0.997251346745803, "contGamma:contcor1", 0.835226367889012,
			 113, 132, 0.935759623679536, 1.88726958254567, "contcor2", 1.40634046923354,
			 1.39827748528087, "<unicode>", 0.995953991306568, "contGamma:contcor1",
			 0.258877278570441, 150, 179, 4.70225137198606, 8.30382387780447,
			 "contGamma:contcor1", 6.28276748757526, 6.26593660747371, "<unicode>",
			 0.996555862450763, "contGamma:contcor1", 0.895257874023549,
			 190, 88, 0.0210361683805936, 0.440714236431123, "contcor1:contcor2",
			 0.195686243503065, 0.187880594407151, "<unicode>", 1.02063004698396,
			 "contcor2", 0.110236323809541, 70, 84, -0.165477327729955, 0.898462860771833,
			 "contGamma:contcor1:contcor2", 0.337996355830814, 0.341424011900641,
			 "<unicode>", 1.01889807541337, "contcor2", 0.297126358623079,
			 79, 155, 1.58046393781086, 2.89489965905146, "contGamma:contcor2",
			 2.19660797410969, 2.16731479199262, "<unicode>", 1.00629591729006,
			 "contcor2", 0.326961186421964, 154, 161, 0.74302305276036, 1.24549689538059,
			 "contcor2", 0.977019791391922, 0.965553611548035, "<unicode>",
			 1.00160656027825, "contcor2", 0.131127487316014, 153, 69, -0.0641313992012435,
			 1.02745241218156, "contcor1:contcor2", 0.451524388654824, 0.418239227794978,
			 "<unicode>", 1.03562073836649, "contGamma:contcor2", 0.292078420051147,
			 30, 71, 0.514759400226181, 3.85326650895625, "contGamma:contcor1:contcor2",
			 2.04865131251839, 1.98200348781882, "<unicode>", 1.05791390578024,
			 "contGamma:contcor2", 0.829908325024249, 91, 182, 5.72098544106146,
			 9.79213648010362, "contGamma:contcor2", 7.56281777014467, 7.49769060024362,
			 "<unicode>", 1.00730681068535, "contGamma:contcor2", 1.02601649563994,
			 181, 172, 1.77676958203057, 3.48357848440381, "contcor1:contcor2",
			 2.50868829965143, 2.47627779906668, "<unicode>", 0.99594053865712,
			 "contGamma:contcor1:contcor2", 0.422573494665845, 137, 202,
			 7.47038049237409, 12.985013935614, "contGamma:contcor1:contcor2",
			 9.87555219355979, 9.67763533524717, "<unicode>", 0.999253450695261,
			 "contGamma:contcor1:contcor2", 1.5005941374205, 120, 224, 0.856828639292196,
			 1.48265051483434, "contcor1:contcor2", 1.13350101633976, 1.11869961991161,
			 "<unicode>", 1.00104863237459, "contcor1:contcor2", 0.163124317507254,
			 184))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(70, -0.203383838469118, 0.196029063721289, 16, 16, "contGamma",
			 "contNormal", -0.0154003207587972, -0.0242007073313241, "<unicode>",
			 1.03892822348589, 0.105959180429329, 182, 201, -0.201076712831374,
			 0.278842531410991, 50, 16, "contGamma", "contNormal", 0.0233157254889842,
			 0.0184921495276536, "<unicode>", 1.00993202410991, 0.131964219067674,
			 154, 195, -0.470429967207275, 0.558887882743652, 84, 16, "contGamma",
			 "contNormal", 0.0655693692859011, 0.0445187872111659, "<unicode>",
			 1.03488482612841, 0.260051548873678, 154, 139, -0.360328492904454,
			 0.281887992207275, 16, 50, "contGamma", "contNormal", -0.0500037471906963,
			 -0.0545015672917087, "<unicode>", 0.998892341953387, 0.164517768813558,
			 190, 231, -0.20217147838592, 0.178522975173533, 50, 50, "contGamma",
			 "contNormal", -0.0243930885722796, -0.0261417303018595, "<unicode>",
			 1.00095516160347, 0.100448792141398, 108, 217, -0.298974279477672,
			 0.327177287552941, 84, 50, "contGamma", "contNormal", 0.00355769027898365,
			 -0.00699579069563431, "<unicode>", 1.02128989594664, 0.162709172900969,
			 177, 123, -0.746086908912966, 0.551795852550956, 16, 84, "contGamma",
			 "contNormal", -0.0905642742937191, -0.0990788792720174, "<unicode>",
			 0.997808146833238, 0.339063008127182, 217, 115, -0.429344737643879,
			 0.308029182021661, 50, 84, "contGamma", "contNormal", -0.0803151415398755,
			 -0.0735370980477964, "<unicode>", 1.00770156411971, 0.197425731022805,
			 133, 64, -0.29227798186759, 0.183034247540311, 84, 84, "contGamma",
			 "contNormal", -0.0691295157702235, -0.0587489560410383, "<unicode>",
			 1.0443163604438, 0.119252142382318, 133))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(242, -0.197248781977835, 0.180676258105709, "contGamma", -0.0229947314442677,
			 -0.0232977952118171, "<unicode>", "Normal(0,10)", 1.00004027501835,
			 "contNormal", 0.0993742155192408, 108, 122, -0.27876887160319,
			 0.662735447706575, "contcor1", 0.169917578506759, 0.171759991687867,
			 "<unicode>", "Normal(0,10)", 1.00857459470629, "contNormal",
			 0.240630502661771, 101, 147, -0.240677405120848, 0.26236585313675,
			 "contGamma:contcor1", 0.0267122694110673, 0.0221353865625546,
			 "<unicode>", "Normal(0,10)", 1.00868934729563, "contNormal",
			 0.126723629174486, 163, 100, -0.648409474444417, 0.573042480363432,
			 "contcor2", -0.0256295897449596, -0.0313602584244093, "<unicode>",
			 "Normal(0,10)", 1.00339635812302, "contNormal", 0.27520756860591,
			 128, 115, -0.262572353261754, 0.251450031374086, "contGamma:contcor2",
			 -0.0499683833998239, -0.0611183124725119, "<unicode>", "Normal(0,10)",
			 1.00373302788167, "contNormal", 0.127302388432834, 153, 213,
			 -0.170596973451103, 0.138130046741192, "contGamma:contcor1:contcor2",
			 -0.0141049378287203, -0.0100592173817883, "<unicode>", "Normal(0,10)",
			 1.011109312881, "contNormal", 0.0814492766792575, 147, 233,
			 -0.267512084924564, 0.587635641512374, "contcor1:contcor2",
			 0.13344611836927, 0.125933747441205, "<unicode>", "Normal(0,10)",
			 1.00190079773243, "contNormal", 0.202957236714519, 150))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(70, -0.203383838469118, 0.196029063721289, 16, 16, "Total", "contGamma",
			 "contNormal", -0.0154003207587972, -0.0242007073313241, "<unicode>",
			 1.03892822348589, 0.105959180429329, 182, 201, -0.201076712831374,
			 0.278842531410991, 50, 16, "Total", "contGamma", "contNormal",
			 0.0233157254889842, 0.0184921495276536, "<unicode>", 1.00993202410991,
			 0.131964219067674, 154, 195, -0.470429967207275, 0.558887882743652,
			 84, 16, "Total", "contGamma", "contNormal", 0.0655693692859011,
			 0.0445187872111659, "<unicode>", 1.03488482612841, 0.260051548873678,
			 154, 139, -0.360328492904454, 0.281887992207275, 16, 50, "Total",
			 "contGamma", "contNormal", -0.0500037471906963, -0.0545015672917087,
			 "<unicode>", 0.998892341953387, 0.164517768813558, 190, 231,
			 -0.20217147838592, 0.178522975173533, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0243930885722796, -0.0261417303018595, "<unicode>",
			 1.00095516160347, 0.100448792141398, 108, 217, -0.298974279477672,
			 0.327177287552941, 84, 50, "Total", "contGamma", "contNormal",
			 0.00355769027898365, -0.00699579069563431, "<unicode>", 1.02128989594664,
			 0.162709172900969, 177, 123, -0.746086908912966, 0.551795852550956,
			 16, 84, "Total", "contGamma", "contNormal", -0.0905642742937191,
			 -0.0990788792720174, "<unicode>", 0.997808146833238, 0.339063008127182,
			 217, 115, -0.429344737643879, 0.308029182021661, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0803151415398755, -0.0735370980477964,
			 "<unicode>", 1.00770156411971, 0.197425731022805, 133, 64, -0.29227798186759,
			 0.183034247540311, 84, 84, "Total", "contGamma", "contNormal",
			 -0.0691295157702235, -0.0587489560410383, "<unicode>", 1.0443163604438,
			 0.119252142382318, 133))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")

})
test_that("Test that model number 3 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facExperim",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1271.85404244279, 1183.53320338922, 59.2906044689608,
			 0.48, 1185.94547603006, 60.1313998459769))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(166, -0.115340509837489, -0.00847289151695627, "facExperimexperimental:contcor2",
			 -0.057977822732251, -0.0556768347706659, "<unicode>", 1.00087416626847,
			 "facGenderm", 0.0298764870025755, 174, 129, -0.0798324690672064,
			 0.0102837801159562, "facGenderm:facExperimexperimental:contcor2",
			 -0.0370694533061372, -0.0382279556433553, "<unicode>", 1.00465031575206,
			 "facGenderm", 0.0232589868003441, 130, 102, -0.0659936367467227,
			 0.0500936446525634, "facGenderm:contcor2", -0.0102470197058556,
			 -0.00730709374928866, "<unicode>", 1.01596813144408, "facGenderm",
			 0.030322327106667, 148, 138, -0.180794051656852, 0.0377901061556886,
			 "contcor2", -0.0570486453668071, -0.0529447869469861, "<unicode>",
			 1.00931110124975, "facGenderm", 0.0513766066934243, 137, 191,
			 0.100712665036805, 0.205815052496658, "facGenderm:facExperimexperimental",
			 0.145371934884571, 0.142738711547315, "<unicode>", 1.01720880638974,
			 "facGenderm", 0.0272516990787003, 136, 152, -0.00594320217113195,
			 0.0914149499576005, "facExperimexperimental", 0.0339878337948849,
			 0.0312912191425139, "<unicode>", 1.00120586529046, "facGenderm",
			 0.0263354972555312, 131, 187, 0.203709881494455, 0.343663425970754,
			 "facGenderm", 0.265329105134956, 0.261989352599576, "<unicode>",
			 0.999229064860676, "facGenderm", 0.0358616212922058, 156, 231,
			 0.818366451749706, 1.50201877344259, "contNormal", 1.10805913356077,
			 1.08063166075476, "<unicode>", 0.998235693827533, "contNormal",
			 0.178984899557397, 112, 143, -0.0608531423939222, 0.0657081653889846,
			 "facExperimexperimental:contcor2", -0.00473903676445244, -0.00519915362301094,
			 "<unicode>", 1.02961559728299, "facExperimexperimental", 0.0304694269882441,
			 154, 157, -0.080630744705009, 0.0269077948019532, "facGenderm:facExperimexperimental:contcor2",
			 -0.0317117727409489, -0.0315980875285712, "<unicode>", 0.995622052960214,
			 "facExperimexperimental", 0.0264373689373924, 147, 170, -0.121571884827988,
			 0.00306855435345751, "facGenderm:contcor2", -0.0581399787861296,
			 -0.0580586353966767, "<unicode>", 0.996215349394412, "facExperimexperimental",
			 0.0324996035559765, 131, 189, -0.143842590936771, 0.0340007515293697,
			 "contcor2", -0.0574404482052676, -0.0551529672454734, "<unicode>",
			 1.02326845270662, "facExperimexperimental", 0.0478138783443181,
			 129, 191, 0.104388624991037, 0.198687090859714, "facGenderm:facExperimexperimental",
			 0.144598561826238, 0.142090189278978, "<unicode>", 1.00139916413201,
			 "facExperimexperimental", 0.0258698593337503, 116, 212, 0.204396561061635,
			 0.343793488617128, "facExperimexperimental", 0.263745105148325,
			 0.258383815207823, "<unicode>", 0.998936978752185, "facExperimexperimental",
			 0.0362494504025328, 160, 151, -0.11774560951952, 0.0011257647964232,
			 "facExperimexperimental:contcor2", -0.0580061421569551, -0.0549201186910846,
			 "<unicode>", 1.0043383514449, "facGenderm:facExperimexperimental",
			 0.0302693726036932, 148, 117, -0.0924987527344703, -0.00277261748122086,
			 "facGenderm:facExperimexperimental:contcor2", -0.0471884463864351,
			 -0.0478450571882819, "<unicode>", 1.00141332274963, "facGenderm:facExperimexperimental",
			 0.0221584726931194, 153, 119, -0.111958101923277, -0.00774179489455392,
			 "facGenderm:contcor2", -0.0625802439247891, -0.063840962803749,
			 "<unicode>", 1.00355263253382, "facGenderm:facExperimexperimental",
			 0.0265010121004953, 102, 149, -0.160184482000512, -0.0137933220544923,
			 "contcor2", -0.0849266476091343, -0.0828517783608578, "<unicode>",
			 1.01818570792109, "facGenderm:facExperimexperimental", 0.0417932832270193,
			 118, 188, 0.164213007946663, 0.264066214034352, "facGenderm:facExperimexperimental",
			 0.209576893263608, 0.206094487566224, "<unicode>", 1.00356404557387,
			 "facGenderm:facExperimexperimental", 0.0271687970567068, 217,
			 158, 0.297337077897523, 0.600986403835139, "facExperimexperimental:contcor2",
			 0.411988944568373, 0.403763989141551, "<unicode>", 0.998323221207732,
			 "contcor2", 0.0709184705261333, 148, 152, 0.17039821680827,
			 0.356382476233364, "facGenderm:facExperimexperimental:contcor2",
			 0.251878076834911, 0.249733051053245, "<unicode>", 0.995531479216121,
			 "contcor2", 0.0484348200955251, 140, 188, 0.286439206792217,
			 0.575409665404299, "facGenderm:contcor2", 0.411547435335173,
			 0.409251432422392, "<unicode>", 1.00140430535498, "contcor2",
			 0.0694848035036694, 184, 211, 0.785978565264228, 1.29524511221942,
			 "contcor2", 0.997679923123335, 0.989357622384361, "<unicode>",
			 1.00028829410727, "contcor2", 0.136845928876366, 182, 166, 0.176341736432991,
			 0.351296572419364, "facExperimexperimental:contcor2", 0.252830253242284,
			 0.248774806649597, "<unicode>", 1.0004538054479, "facGenderm:contcor2",
			 0.0459820882967379, 219, 213, 0.201086338618644, 0.348053148026992,
			 "facGenderm:facExperimexperimental:contcor2", 0.263668923773756,
			 0.257811165564666, "<unicode>", 1.00331006387857, "facGenderm:contcor2",
			 0.0406822355760973, 182, 237, 0.334654212835934, 0.572834151186876,
			 "facGenderm:contcor2", 0.436576596822603, 0.42796451914057,
			 "<unicode>", 1.01126737690553, "facGenderm:contcor2", 0.059920382961241,
			 178, 184, 0.19194967189969, 0.35471792431923, "facExperimexperimental:contcor2",
			 0.26646297389643, 0.2659308952646, "<unicode>", 1.00334559559026,
			 "facGenderm:facExperimexperimental:contcor2", 0.0402385072581668,
			 179, 228, 0.212870122682065, 0.343361542129988, "facGenderm:facExperimexperimental:contcor2",
			 0.271948597515451, 0.268605829198712, "<unicode>", 0.99530366680681,
			 "facGenderm:facExperimexperimental:contcor2", 0.0354777442350463,
			 224, 182, 0.347244648997237, 0.570159928413525, "facExperimexperimental:contcor2",
			 0.439147129782892, 0.429896991784576, "<unicode>", 1.03052414810587,
			 "facExperimexperimental:contcor2", 0.0623571079972149, 179
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(95, -1.05849564563382, 0.848229864384574, 16, 0, "m", "facGender",
			 "contNormal", -0.0173193223784736, 0.0113728515725793, "<unicode>",
			 1.00628666215335, 0.502308578195855, 92, 103, -0.367629793407945,
			 1.38464199516876, 16, 1, "m", "facGender", "contNormal", 0.577358360830071,
			 0.585815919145797, "<unicode>", 1.03129232619097, 0.480219751993925,
			 125, 94, -0.172232536006026, 1.09517314555311, 50, 0, "m", "facGender",
			 "contNormal", 0.503227111572902, 0.49504223723096, "<unicode>",
			 1.01861022292366, 0.313926961303859, 181, 163, -0.485241972878095,
			 0.837956403020993, 50, 1, "m", "facGender", "contNormal", 0.236428277490184,
			 0.246678059934824, "<unicode>", 1.00267160855955, 0.33940096551755,
			 153, 60, 0.244858302768796, 2.0445038231385, 84, 0, "m", "facGender",
			 "contNormal", 1.11338743151171, 1.12770007959637, "<unicode>",
			 1.0344409921558, 0.447993247117065, 109, 147, -1.19836703147395,
			 0.871300031311594, 84, 1, "m", "facGender", "contNormal", -0.16319410998517,
			 -0.144738415898557, "<unicode>", 1.03166818459177, 0.568390026441233,
			 151))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(96, -0.198150828652656, 1.07016415083426, "facGenderm", 0.486908870458259,
			 0.476006871696691, "<unicode>", "Normal(0,10)", 1.0149800302982,
			 "contNormal", 0.316231850503908, 181, 87, -0.426602341065425,
			 0.684552896052049, "facExperimexperimental", 0.156325182857179,
			 0.156405363559768, "<unicode>", "Normal(0,10)", 1.01674832727109,
			 "contNormal", 0.290734269723872, 182, 67, -1.01037686420309,
			 0.555841278908693, "facGenderm:facExperimexperimental", -0.239793017489083,
			 -0.259099679361892, "<unicode>", "Normal(0,10)", 1.00725468239043,
			 "contNormal", 0.408194642368, 77, 167, -0.329433975111045, 0.329353597218673,
			 "contcor2", 0.00390657113021071, -0.00470198767002912, "<unicode>",
			 "Normal(0,10)", 0.997703216955743, "contNormal", 0.170619375324329,
			 101, 91, -0.0810771892868877, 1.18972072234146, "facGenderm:contcor2",
			 0.545760572396074, 0.556142674683517, "<unicode>", "Normal(0,10)",
			 1.03049877635117, "contNormal", 0.349159701943787, 98, 51, -1.76985773756871,
			 0.0934516424633222, "facGenderm:facExperimexperimental:contcor2",
			 -0.903204568348985, -0.937809740886444, "<unicode>", "Normal(0,10)",
			 1.05951574870243, "contNormal", 0.483209165722759, 76, 128,
			 -0.5745016379183, 0.899116283181183, "facExperimexperimental:contcor2",
			 0.164665301807581, 0.167584869264018, "<unicode>", "Normal(0,10)",
			 1.00577666742974, "contNormal", 0.35382681589845, 71))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(95, -1.05849564563382, 0.848229864384574, 16, 0, "m", "Total",
			 "facGender", "contNormal", -0.0173193223784736, 0.0113728515725793,
			 "<unicode>", 1.00628666215335, 0.502308578195855, 92, 103, -0.367629793407945,
			 1.38464199516876, 16, 1, "m", "Total", "facGender", "contNormal",
			 0.577358360830071, 0.585815919145797, "<unicode>", 1.03129232619097,
			 0.480219751993925, 125, 94, -0.172232536006026, 1.09517314555311,
			 50, 0, "m", "Total", "facGender", "contNormal", 0.503227111572902,
			 0.49504223723096, "<unicode>", 1.01861022292366, 0.313926961303859,
			 181, 163, -0.485241972878095, 0.837956403020993, 50, 1, "m",
			 "Total", "facGender", "contNormal", 0.236428277490184, 0.246678059934824,
			 "<unicode>", 1.00267160855955, 0.33940096551755, 153, 60, 0.244858302768796,
			 2.0445038231385, 84, 0, "m", "Total", "facGender", "contNormal",
			 1.11338743151171, 1.12770007959637, "<unicode>", 1.0344409921558,
			 0.447993247117065, 109, 147, -1.19836703147395, 0.871300031311594,
			 84, 1, "m", "Total", "facGender", "contNormal", -0.16319410998517,
			 -0.144738415898557, "<unicode>", 1.03166818459177, 0.568390026441233,
			 151))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")

})
test_that("Test that model number 4 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 469.538285387414, 456.123337022894, 32.9334795219421,
			 0.53, 456.356143632577, 33.1244251222527))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(254, 1.7802052153621, 3.07737579537302, "contGamma", 2.33825847982445,
			 2.3197464243584, "<unicode>", 0.996620121789014, "contGamma",
			 0.343538337932232, 185, 151, 0.829556045663928, 1.40623606182781,
			 "contNormal", 1.1170791528742, 1.11268065236357, "<unicode>",
			 1.00142085296878, "contNormal", 0.162575788555024, 136, 176,
			 0.00523707353263797, 0.00917941660172575, "debCollin1", 0.00675968909421064,
			 0.00660069043767573, "<unicode>", 1.01747818012614, "debCollin1",
			 0.00104222678825747, 93))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(157, -0.169224997441984, 0.0949482786467097, "contGamma", "contNormal",
			 "", -0.0398449003377529, -0.0445128384092886, "<unicode>", "",
			 1.00187220524864, 0.0657877765213113, 153, 15, -0.0296181305415067,
			 0.0238958370850949, "contGamma", "debCollin1", "contNormal",
			 -0.00194881304136483, -0.00187123088742655, "<unicode>", "<unicode>",
			 1.17797001857256, 0.0121764958263165, 26))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(157, -0.169224997441984, 0.0949482786467097, "contGamma", -0.0398449003377529,
			 -0.0445128384092886, "<unicode>", "Normal(0,10)", 1.00187220524864,
			 "contNormal", 0.0657877765213113, 153, 11, -1.92160911013867,
			 1.98950734749397, "debCollin1", 0.246003873070595, 0.394308859298178,
			 "<unicode>", "Normal(0,10)", 1.13930114303622, "contNormal",
			 1.12085833511402, 51, 241, -0.0192866528192409, 0.00209638884705115,
			 "contGamma", -0.00856599833706247, -0.00834727906947711, "<unicode>",
			 "Normal(0,10)", 1.00669309813996, "debCollin1", 0.00530808591239107,
			 153))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(166, -0.169607158055558, 0.0914888864972958, "Total", "contGamma",
			 "contNormal", -0.0417937133791178, -0.0474543116544007, "<unicode>",
			 1.00316010939539, 0.0664053004529001, 153, 15, -0.0296181305415067,
			 0.0238958370850949, "Total indirect", "contGamma", "contNormal",
			 -0.00194881304136483, -0.00187123088742655, "<unicode>", 1.17797001857256,
			 0.0121764958263165, 26))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")

})
test_that("Test that model number 4 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 244.506348896893, 228.840063544232, 23.7012552475682,
			 0.525, 228.832119299519, 23.7139773210212))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(170, 0.192690713236365, 0.332716114081119, "facGenderm", 0.256665047436379,
			 0.252573658169657, "<unicode>", 1.00651851702661, "facGenderm",
			 0.0369344162510908, 117, 215, 0.849904298698399, 1.4485221636208,
			 "contNormal", 1.10414353123148, 1.0749535577831, "<unicode>",
			 0.998374247107333, "contNormal", 0.163206698188806, 119, 224,
			 0.00521450871607119, 0.00874515053297134, "debCollin1", 0.00680281277439346,
			 0.00682235599318878, "<unicode>", 0.998583991105624, "debCollin1",
			 0.000899371997026587, 148))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(106, 0.0692847081305899, 0.881347328806218, "m", "facGender",
			 "contNormal", "", 0.477749606989121, 0.48661802817718, "<unicode>",
			 "", 1.0043489372347, 0.205718463477278, 110, 85, -0.0552129454098452,
			 0.0654135357775469, "m", "facGender", "debCollin1", "contNormal",
			 -0.00035689108315855, -0.00201986123964137, "<unicode>", "<unicode>",
			 1.08145679012665, 0.028445935710846, 79))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(106, 0.0692847081305899, 0.881347328806218, "facGenderm", 0.477749606989121,
			 0.48661802817718, "<unicode>", "Normal(0,10)", 1.0043489372347,
			 "contNormal", 0.205718463477278, 110, 23, -1.98214417698132,
			 2.08694985886864, "debCollin1", -0.0388451592757688, -0.00200456054177827,
			 "<unicode>", "Normal(0,10)", 1.20439683156234, "contNormal",
			 1.20063534527575, 44, 169, -0.0437286791987138, 0.031919006694258,
			 "facGenderm", -0.008409953837071, -0.00855881981948636, "<unicode>",
			 "Normal(0,10)", 1.00176169856262, "debCollin1", 0.0203389082611248,
			 129))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(102, 0.0346319573772812, 0.932172607263327, "m", "Total", "facGender",
			 "contNormal", 0.477392715905962, 0.486125219369157, "<unicode>",
			 0.998786670892225, 0.2123125324555, 81, 85, -0.0552129454098452,
			 0.0654135357775469, "m", "Total indirect", "facGender", "contNormal",
			 -0.00035689108315855, -0.00201986123964137, "<unicode>", 1.08145679012665,
			 0.028445935710846, 79))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")

})
test_that("Test that model number 10 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1693.74841683567, 1630.98490949652, 68.2428636180832,
			 0.48, 1634.29406633395, 69.5907814035664))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(84, -1.08780837058513, 0.444892008133035, "contGamma:contcor2",
			 -0.31429838501265, -0.347580856685222, "<unicode>", 0.997553677788106,
			 "contGamma", 0.409569217204443, 116, 72, -0.361925987693434,
			 0.198484534320128, "contcor2", -0.0953321763415223, -0.104667424867711,
			 "<unicode>", 0.998897748814641, "contGamma", 0.143510887807331,
			 34, 79, -1.32196063857345, 0.228738535885471, "contGamma:contcor1",
			 -0.545489100117622, -0.546252493827473, "<unicode>", 1.0124953996304,
			 "contGamma", 0.392682695674967, 92, 74, -0.546465843994136,
			 0.0350084663488182, "contcor1", -0.228011558957014, -0.224859669802729,
			 "<unicode>", 1.03777392331034, "contGamma", 0.150477260107013,
			 36, 260, 1.97557917774796, 3.1844519386756, "contGamma", 2.48756779840287,
			 2.48292384791118, "<unicode>", 1.00043648640734, "contGamma",
			 0.319213611082227, 108, 269, 0.884284539411602, 1.50510837657005,
			 "contNormal", 1.16919282223187, 1.15011235235305, "<unicode>",
			 0.996912675443361, "contNormal", 0.168761413555454, 83, 260,
			 0.00523403030905342, 0.00874112575643145, "debCollin1", 0.00691805460530817,
			 0.00684811559750774, "<unicode>", 0.997111503223091, "debCollin1",
			 0.000890069207220041, 119, 65, 0.838155941968979, 1.99432197704643,
			 "contGamma:contcor2", 1.38214938974641, 1.37863069976333, "<unicode>",
			 1.00365179052819, "contcor1", 0.292982650024561, 90, 71, 0.430339150453365,
			 0.851858599307909, "contcor2", 0.595934308395456, 0.588950202387506,
			 "<unicode>", 1.02966305427429, "contcor1", 0.1053686464232,
			 94, 80, 1.46578779493675, 2.60979661463315, "contGamma:contcor1",
			 1.9462140498914, 1.92464668286809, "<unicode>", 1.00054135876292,
			 "contcor1", 0.291188582799995, 123, 126, 0.743027306189647,
			 1.24740745358677, "contcor1", 0.985088655820929, 0.972266765518447,
			 "<unicode>", 1.00875320761931, "contcor1", 0.130652878395581,
			 112, 88, 3.74865240683581, 6.94704520423387, "contGamma:contcor2",
			 5.19986006441501, 5.21552381999573, "<unicode>", 1.03858110171959,
			 "contGamma:contcor1", 0.814487456059054, 126, 75, 0.931686493368172,
			 1.93069867457803, "contcor2", 1.4245853061525, 1.41793147287304,
			 "<unicode>", 1.0203143218499, "contGamma:contcor1", 0.270594566161332,
			 121, 96, 4.8440882402332, 8.05451721076978, "contGamma:contcor1",
			 6.21398785421105, 6.18517836923241, "<unicode>", 1.01719465766939,
			 "contGamma:contcor1", 0.82041206775135, 110, 110, 1.60667769479656,
			 2.91385282662139, "contGamma:contcor2", 2.19839613035256, 2.17394857195586,
			 "<unicode>", 1.0175136249628, "contcor2", 0.330832182720236,
			 165, 171, 0.748922855111384, 1.2380670457567, "contcor2", 0.972572368993212,
			 0.95663055118192, "<unicode>", 1.01125108041636, "contcor2",
			 0.127569012888569, 228, 125, 5.66166615688471, 9.61802521200354,
			 "contGamma:contcor2", 7.44101472210393, 7.28787322950922, "<unicode>",
			 1.0268774735452, "contGamma:contcor2", 1.00614899147723, 133
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(199, -0.189306623601003, 0.192574039552031, 16, 16, "contGamma",
			 "contNormal", "", 0.00864336067392098, 0.0168344009737326, "<unicode>",
			 "", 0.996388078842448, 0.106138520271447, 163, 69, -0.284213506097082,
			 0.238195421130855, 50, 16, "contGamma", "contNormal", "", -0.0129842189883548,
			 -0.0148155835061876, "<unicode>", "", 1.0146693881917, 0.144375022038567,
			 182, 28, -0.576296402954404, 0.406665597567114, 84, 16, "contGamma",
			 "contNormal", "", -0.036587973395266, -0.0411694730186903, "<unicode>",
			 "", 1.02850414235978, 0.271668452183566, 83, 36, -0.266761520968584,
			 0.332969655905201, 16, 50, "contGamma", "contNormal", "", -0.00019288819279559,
			 -0.00994221330144666, "<unicode>", "", 1.03482490566262, 0.150462988827345,
			 181, 423, -0.167787995822965, 0.109433923580036, 50, 50, "contGamma",
			 "contNormal", "", -0.0218204678550714, -0.0208497627962371,
			 "<unicode>", "", 0.996037575538375, 0.0783076262680538, 184,
			 38, -0.403379133639609, 0.279561753136526, 84, 50, "contGamma",
			 "contNormal", "", -0.0454242222619825, -0.0494568749898987,
			 "<unicode>", "", 1.01587327257571, 0.174992465198932, 92, 23,
			 -0.493099576192004, 0.545806867854464, 16, 84, "contGamma",
			 "contNormal", "", -0.0105503281518951, -0.0371415934818141,
			 "<unicode>", "", 1.04518072339792, 0.265058380185614, 127, 29,
			 -0.305290100753812, 0.309810629249915, 50, 84, "contGamma",
			 "contNormal", "", -0.0321779078141709, -0.0442079605877599,
			 "<unicode>", "", 1.03915301967775, 0.152224736968058, 145, 177,
			 -0.298328446913119, 0.15130072681283, 84, 84, "contGamma", "contNormal",
			 "", -0.0557816622210821, -0.0610824437455442, "<unicode>", "",
			 0.995785751233602, 0.119550129522272, 133, 51, -0.0178570785006919,
			 0.0311592191140577, 16, 16, "contGamma", "debCollin1", "contNormal",
			 0.00287759681097762, 0.00134521040227877, "<unicode>", "<unicode>",
			 1.01360758199059, 0.0111405591329965, 24, 19, -0.0399174244862696,
			 0.0435574110390176, 50, 16, "contGamma", "debCollin1", "contNormal",
			 0.00575949479089307, 0.00365914814192436, "<unicode>", "<unicode>",
			 1.02281378899202, 0.0184523186616139, 87, 27, -0.0688992753370914,
			 0.0798297284946625, 84, 16, "contGamma", "debCollin1", "contNormal",
			 0.00890472015618668, 0.00552167103544374, "<unicode>", "<unicode>",
			 1.01254963535616, 0.0341023185433728, 50, 110, -0.0319586091851905,
			 0.0487304903821718, 16, 50, "contGamma", "debCollin1", "contNormal",
			 0.00320114019443445, 0.00149596144660121, "<unicode>", "<unicode>",
			 1.00233755077707, 0.0186396037060033, 140, 11, -0.0258689079447298,
			 0.040782819674208, 50, 50, "contGamma", "debCollin1", "contNormal",
			 0.0060830381743499, 0.00465650143283832, "<unicode>", "<unicode>",
			 1.03431502767827, 0.0155692336754609, 20, 14, -0.0490348659177825,
			 0.0695665619889581, 84, 50, "contGamma", "debCollin1", "contNormal",
			 0.0092282635396435, 0.00700297109443455, "<unicode>", "<unicode>",
			 1.02224520219852, 0.0267227087302035, 45, 252, -0.0545788203868869,
			 0.0866200949408396, 16, 84, "contGamma", "debCollin1", "contNormal",
			 0.00358038270093972, 0.00153365616076336, "<unicode>", "<unicode>",
			 0.99799825217605, 0.0329446394333886, 122, 28, -0.0382564117604839,
			 0.0690402511423526, 50, 84, "contGamma", "debCollin1", "contNormal",
			 0.00646228068085517, 0.00324651131357571, "<unicode>", "<unicode>",
			 1.01758115537334, 0.0245677403246105, 42, 11, -0.047925760775598,
			 0.0596706512554509, 84, 84, "contGamma", "debCollin1", "contNormal",
			 0.00960750604614878, 0.00954429205798349, "<unicode>", "<unicode>",
			 1.02455226059237, 0.0257703395516365, 23))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(396, -0.171672180476475, 0.107628171469336, "contGamma", -0.0214626523074575,
			 -0.0219724389523347, "<unicode>", "Normal(0,10)", 0.996101796632018,
			 "contNormal", 0.0785728104266977, 184, 7, -3.43119232565655,
			 2.18802617746102, "debCollin1", -0.752892790465468, -0.817645127842289,
			 "<unicode>", "Normal(0,10)", 1.07057940955083, "contNormal",
			 1.3977759273697, 17, 20, -0.214321785477037, 0.954973133758198,
			 "contcor1", 0.319004548561953, 0.27823464120828, "<unicode>",
			 "Normal(0,10)", 1.04874211463713, "contNormal", 0.283374246812095,
			 40, 30, -0.306080616995521, 0.260928228412066, "contGamma:contcor1",
			 -0.0222017160390455, -0.0167772450279433, "<unicode>", "Normal(0,10)",
			 1.03123389727381, "contNormal", 0.140087497717399, 77, 19, -0.621464011725552,
			 0.361423628267109, "contcor2", -0.111474772439072, -0.103749385867394,
			 "<unicode>", "Normal(0,10)", 1.04549075042096, "contNormal",
			 0.273850010540723, 79, 28, -0.21111782820148, 0.243816352972928,
			 "contGamma:contcor2", -0.00926425756627865, -0.0192118842774053,
			 "<unicode>", "Normal(0,10)", 1.03593052331937, "contNormal",
			 0.12166279207086, 103, 187, -0.019232515729347, 0.00217468805649185,
			 "contGamma", -0.00866189229636245, -0.00865867170601955, "<unicode>",
			 "Normal(0,10)", 0.996324662872015, "debCollin1", 0.00563265629405982,
			 183, 222, -0.0307844060376173, 0.0435111038059488, "contcor1",
			 0.00373895424215095, 0.00264607539253078, "<unicode>", "Normal(0,10)",
			 0.997417714578844, "debCollin1", 0.0189624273879647, 178, 210,
			 -0.02288681594193, 0.0124598312347124, "contGamma:contcor1",
			 -0.00491869027481671, -0.00511063236295453, "<unicode>", "Normal(0,10)",
			 0.998300929567972, "debCollin1", 0.00981774104920348, 147, 238,
			 -0.0244168853302587, 0.0450871992359527, "contcor2", 0.0110924168328118,
			 0.0118442771074821, "<unicode>", "Normal(0,10)", 0.995169173762694,
			 "debCollin1", 0.019002899840854, 97, 278, -0.017667539654879,
			 0.0165523413690772, "contGamma:contcor2", -0.000598338947760681,
			 -0.000670764867278313, "<unicode>", "Normal(0,10)", 0.997491012149178,
			 "debCollin1", 0.00902536207098274, 183))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(204, -0.185962729251692, 0.19048990409992, 16, 16, "Total", "contGamma",
			 "contNormal", 0.0115209574848986, 0.0240965161179787, "<unicode>",
			 0.995211083308991, 0.105701834822021, 163, 96, -0.273666553416271,
			 0.215008368380694, 50, 16, "Total", "contGamma", "contNormal",
			 -0.00722472419746171, -0.00463416128517333, "<unicode>", 1.02193852794241,
			 0.142791194180501, 145, 33, -0.558421073534636, 0.427935804695756,
			 84, 16, "Total", "contGamma", "contNormal", -0.0276832532390793,
			 -0.0285416699203039, "<unicode>", 1.03470043469843, 0.267403518507222,
			 83, 36, -0.262159802385943, 0.327745663505953, 16, 50, "Total",
			 "contGamma", "contNormal", 0.00300825200163886, -0.00455572202763894,
			 "<unicode>", 1.02592604845979, 0.14931113249782, 139, 449, -0.162863851687343,
			 0.110048353034608, 50, 50, "Total", "contGamma", "contNormal",
			 -0.0157374296807215, -0.00780370727350577, "<unicode>", 0.996648823852427,
			 0.0779569171985518, 184, 47, -0.391234622904834, 0.280216757769798,
			 84, 50, "Total", "contGamma", "contNormal", -0.036195958722339,
			 -0.0410558885637795, "<unicode>", 1.02680649710593, 0.171568445927028,
			 132, 22, -0.475177199883954, 0.553134561785808, 16, 84, "Total",
			 "contGamma", "contNormal", -0.00696994545095539, -0.0265586668870119,
			 "<unicode>", 1.04167727071614, 0.26320522318409, 131, 30, -0.309718379918414,
			 0.297189921148634, 50, 84, "Total", "contGamma", "contNormal",
			 -0.0257156271333157, -0.0359117168241136, "<unicode>", 1.02901116560594,
			 0.152476552817048, 176, 228, -0.290567212739624, 0.16452289823591,
			 84, 84, "Total", "contGamma", "contNormal", -0.0461741561749333,
			 -0.0444531015506942, "<unicode>", 0.995442044983929, 0.118626483610679,
			 128, 51, -0.0178570785006919, 0.0311592191140577, 16, 16, "Total indirect",
			 "contGamma", "contNormal", 0.00287759681097762, 0.00134521040227877,
			 "<unicode>", 1.01360758199059, 0.0111405591329965, 24, 19, -0.0399174244862696,
			 0.0435574110390176, 50, 16, "Total indirect", "contGamma", "contNormal",
			 0.00575949479089307, 0.00365914814192436, "<unicode>", 1.02281378899202,
			 0.0184523186616139, 87, 27, -0.0688992753370914, 0.0798297284946625,
			 84, 16, "Total indirect", "contGamma", "contNormal", 0.00890472015618668,
			 0.00552167103544374, "<unicode>", 1.01254963535616, 0.0341023185433728,
			 50, 110, -0.0319586091851905, 0.0487304903821718, 16, 50, "Total indirect",
			 "contGamma", "contNormal", 0.00320114019443445, 0.00149596144660121,
			 "<unicode>", 1.00233755077707, 0.0186396037060033, 140, 11,
			 -0.0258689079447298, 0.040782819674208, 50, 50, "Total indirect",
			 "contGamma", "contNormal", 0.0060830381743499, 0.00465650143283832,
			 "<unicode>", 1.03431502767827, 0.0155692336754609, 20, 14, -0.0490348659177825,
			 0.0695665619889581, 84, 50, "Total indirect", "contGamma", "contNormal",
			 0.0092282635396435, 0.00700297109443455, "<unicode>", 1.02224520219852,
			 0.0267227087302035, 45, 252, -0.0545788203868869, 0.0866200949408396,
			 16, 84, "Total indirect", "contGamma", "contNormal", 0.00358038270093972,
			 0.00153365616076336, "<unicode>", 0.99799825217605, 0.0329446394333886,
			 122, 28, -0.0382564117604839, 0.0690402511423526, 50, 84, "Total indirect",
			 "contGamma", "contNormal", 0.00646228068085517, 0.00324651131357571,
			 "<unicode>", 1.01758115537334, 0.0245677403246105, 42, 11, -0.047925760775598,
			 0.0596706512554509, 84, 84, "Total indirect", "contGamma", "contNormal",
			 0.00960750604614878, 0.00954429205798349, "<unicode>", 1.02455226059237,
			 0.0257703395516365, 23))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")

})
test_that("Test that model number 10 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 908.308820320059, 834.041034547592, 36.9611278042716,
			 0.495, 834.013477491186, 36.9993582703883))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(176, -0.0920879056600723, 0.0417436114792747, "facGenderm:contcor2",
			 -0.0147294592753772, -0.0119209597717952, "<unicode>", 1.03580107373472,
			 "facGenderm", 0.0344286039118265, 40, 199, -0.181021287295236,
			 0.0370010627856664, "contcor2", -0.062555911294437, -0.0634492871406153,
			 "<unicode>", 1.03544074218572, "facGenderm", 0.0553422467381988,
			 132, 233, 0.0985580362071342, 0.20207226216877, "facGenderm:facExperimexperimental",
			 0.145072414338326, 0.143610696801027, "<unicode>", 1.00872014729652,
			 "facGenderm", 0.0269629409893511, 179, 143, -0.0142888653367041,
			 0.0830867391896233, "facExperimexperimental", 0.0354960732775807,
			 0.0341601295846137, "<unicode>", 0.995370623288418, "facGenderm",
			 0.0249460534552265, 97, 271, 0.199802761856632, 0.342213552979899,
			 "facGenderm", 0.259370906105372, 0.258522085312986, "<unicode>",
			 0.996117581311605, "facGenderm", 0.0354846372210462, 154, 204,
			 0.863914529540416, 1.49469284411954, "contNormal", 1.15054020386266,
			 1.13726353832683, "<unicode>", 1.00992043865442, "contNormal",
			 0.150913920489505, 154, 181, 0.00557063423918937, 0.00888349633547639,
			 "debCollin1", 0.00707958558449082, 0.0070267467135566, "<unicode>",
			 1.01728679637641, "debCollin1", 0.000873354346740089, 112, 221,
			 -0.129631711707946, 0.0103313843657469, "facGenderm:contcor2",
			 -0.063253245742919, -0.0623935874822124, "<unicode>", 1.00982193963839,
			 "facExperimexperimental", 0.0361660651782522, 132, 178, -0.175424708931302,
			 0.0372781051800333, "contcor2", -0.0639922039951968, -0.0578839496614697,
			 "<unicode>", 1.01601623488345, "facExperimexperimental", 0.0518004460000155,
			 153, 164, 0.0996334658441067, 0.210251190668055, "facGenderm:facExperimexperimental",
			 0.146460197050742, 0.14503240364483, "<unicode>", 0.99670716691786,
			 "facExperimexperimental", 0.0277425722483068, 91, 221, 0.1935780429674,
			 0.340164514066493, "facExperimexperimental", 0.262619208303472,
			 0.261175574478356, "<unicode>", 0.997470202491758, "facExperimexperimental",
			 0.0374605300946634, 178, 10, -0.139387667883523, -0.0149739735509158,
			 "facGenderm:contcor2", -0.0724644276386073, -0.0721341134069046,
			 "<unicode>", 1.10186245599831, "facGenderm:facExperimexperimental",
			 0.0302020065721787, 115, 146, -0.193442857158467, -0.010414354645934,
			 "contcor2", -0.0981589054453098, -0.0959179154925809, "<unicode>",
			 1.03554913540573, "facGenderm:facExperimexperimental", 0.0452306075704725,
			 141, 151, 0.158699254272775, 0.274209253832684, "facGenderm:facExperimexperimental",
			 0.210287129500772, 0.208194682631385, "<unicode>", 0.995779360300025,
			 "facGenderm:facExperimexperimental", 0.0304847638901246, 226,
			 70, 0.29940678424676, 0.63682177300448, "facGenderm:contcor2",
			 0.448643715053458, 0.437634997933462, "<unicode>", 1.04626266203948,
			 "contcor2", 0.0864433194093921, 151, 69, 0.761371030280929,
			 1.42614410021761, "contcor2", 1.0402862320274, 1.03566499402637,
			 "<unicode>", 1.0432265432625, "contcor2", 0.166818849410963,
			 154, 180, 0.334167707964043, 0.615507820467014, "facGenderm:contcor2",
			 0.459253405460136, 0.447615186615774, "<unicode>", 1.0153990874364,
			 "facGenderm:contcor2", 0.0682806147372035, 184))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(24, -0.235056277275053, 1.48496741282368, 16, 0, "m", "facGender",
			 "contNormal", "", 0.594248279204477, 0.588633371846074, "<unicode>",
			 "", 1.08747150363942, 0.460719172774695, 76, 75, -0.28028843870912,
			 0.975980970057592, 16, 1, "m", "facGender", "contNormal", "",
			 0.33709808563084, 0.316976095237047, "<unicode>", "", 1.00620180480913,
			 0.356669529823695, 129, 23, -0.0475343035249172, 1.29050929052996,
			 50, 0, "m", "facGender", "contNormal", "", 0.624751367260185,
			 0.642798305672956, "<unicode>", "", 1.08815329573598, 0.374062948809917,
			 58, 43, -0.25066331143262, 1.03790650762612, 50, 1, "m", "facGender",
			 "contNormal", "", 0.367601173686547, 0.371647527634242, "<unicode>",
			 "", 1.03163893047041, 0.328700895721063, 78, 47, -0.0985518073620793,
			 1.33373892285106, 84, 0, "m", "facGender", "contNormal", "",
			 0.660505668420051, 0.686361713099851, "<unicode>", "", 1.04527330021775,
			 0.403657671743983, 174, 39, -0.445010686809762, 1.23774352843787,
			 84, 1, "m", "facGender", "contNormal", "", 0.403355474846414,
			 0.389435881847915, "<unicode>", "", 1.03694934767473, 0.439754853439128,
			 134, 107, -0.0771596834739974, 0.0956545011674434, 16, 0, "m",
			 "facGender", "debCollin1", "contNormal", 0.00420496917988296,
			 0.00147571317941618, "<unicode>", "<unicode>", 1.00611451327009,
			 0.0386971797392942, 122, 37, -0.0913727116123401, 0.0792345016413655,
			 16, 1, "m", "facGender", "debCollin1", "contNormal", 0.0014007532771661,
			 2.77691390168519e-06, "<unicode>", "<unicode>", 1.02675399066016,
			 0.0382817235017575, 129, 206, -0.0690994546462284, 0.0660850017988253,
			 50, 0, "m", "facGender", "debCollin1", "contNormal", 0.000985934595142159,
			 -0.000163498539424829, "<unicode>", "<unicode>", 0.999201169728315,
			 0.0322576875324544, 87, 40, -0.101985556398019, 0.0928009126636705,
			 50, 1, "m", "facGender", "debCollin1", "contNormal", -0.00181828130757471,
			 -0.00162627694116246, "<unicode>", "<unicode>", 1.00106441448269,
			 0.0413696062990148, 97, 222, -0.0987764232548382, 0.0804294193196866,
			 84, 0, "m", "facGender", "debCollin1", "contNormal", -0.00278726803197067,
			 -0.00198338418001544, "<unicode>", "<unicode>", 1.00501894217369,
			 0.040005280779074, 34, 55, -0.150120617290966, 0.110737509705867,
			 84, 1, "m", "facGender", "debCollin1", "contNormal", -0.00559148393468753,
			 -0.00457248537725512, "<unicode>", "<unicode>", 1.00464522074559,
			 0.0556343127368206, 65))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(23, -0.0588235399140318, 1.28712953599214, "facGenderm", 0.623795147578002,
			 0.637005894753508, "<unicode>", "Normal(0,10)", 1.08804701718006,
			 "contNormal", 0.375373190255904, 58, 16, -2.55870047387706,
			 2.66061480554854, "debCollin1", 0.0333884631392281, 0.0253039927681869,
			 "<unicode>", "Normal(0,10)", 0.998575305684853, "contNormal",
			 1.33637163786115, 13, 24, -0.641287877648963, 0.778449253232097,
			 "facExperimexperimental", 0.13844718181719, 0.140830508856922,
			 "<unicode>", "Normal(0,10)", 1.07318326468264, "contNormal",
			 0.364884462411327, 57, 12, -1.1136348381509, 0.826370299066022,
			 "facGenderm:facExperimexperimental", -0.257150193573637, -0.256061788669944,
			 "<unicode>", "Normal(0,10)", 1.0999132029762, "contNormal",
			 0.55410448529052, 41, 212, -0.243765481177135, 0.306951118057987,
			 "contcor2", 0.0379843519328178, 0.0392794656359322, "<unicode>",
			 "Normal(0,10)", 1.01367586629951, "contNormal", 0.143474192649759,
			 174, 184, -0.411250913977361, 0.394380117245906, "facGenderm:contcor2",
			 0.0319805913773404, 0.0365760079398183, "<unicode>", "Normal(0,10)",
			 1.01048440894748, "contNormal", 0.215740918196058, 184, 240,
			 -0.039284400891444, 0.0479516146486874, "facGenderm", 0.00762451999944184,
			 0.00842378063352386, "<unicode>", "Normal(0,10)", 1.03524215056009,
			 "debCollin1", 0.0237904348597199, 217, 201, -0.0513762473345235,
			 0.0481710948504608, "facExperimexperimental", -0.00315451513509291,
			 -0.00187220757070019, "<unicode>", "Normal(0,10)", 0.999007292261657,
			 "debCollin1", 0.0248012831482743, 123, 203, -0.0974220846431813,
			 0.040440063849004, "facGenderm:facExperimexperimental", -0.0257774231795813,
			 -0.0269777493511534, "<unicode>", "Normal(0,10)", 1.01375902518175,
			 "debCollin1", 0.0345992757746133, 107, 220, -0.0176464175195501,
			 0.0263138628517773, "contcor2", 0.00416736797071519, 0.00430129985688187,
			 "<unicode>", "Normal(0,10)", 1.00558062051763, "debCollin1",
			 0.0119294284694812, 153, 175, -0.0386807435358417, 0.0304018471357658,
			 "facGenderm:contcor2", -0.0047454605153239, -0.00396040840422676,
			 "<unicode>", "Normal(0,10)", 1.00165467565603, "debCollin1",
			 0.0189548064886804, 153))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(25, -0.237499572758498, 1.46875138220312, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.59845324838436, 0.589693438331217,
			 "<unicode>", 1.08623570410455, 0.459056533508929, 76, 81, -0.250608034108827,
			 1.02757416070082, 16, 1, "m", "Total", "facGender", "contNormal",
			 0.338498838908006, 0.329124385973428, "<unicode>", 1.01146031815179,
			 0.35656299203894, 186, 20, -0.0535101449953112, 1.28236821418632,
			 50, 0, "m", "Total", "facGender", "contNormal", 0.625737301855327,
			 0.627561415657919, "<unicode>", 1.09051951505555, 0.374694186198417,
			 106, 42, -0.242190523609415, 1.04210582158963, 50, 1, "m", "Total",
			 "facGender", "contNormal", 0.365782892378972, 0.369097876119367,
			 "<unicode>", 1.03895522390235, 0.325599276222907, 78, 32, -0.124432231086919,
			 1.33197030859881, 84, 0, "m", "Total", "facGender", "contNormal",
			 0.65771840038808, 0.685941808783054, "<unicode>", 1.04692390525715,
			 0.407390998025293, 151, 32, -0.421581441735336, 1.22517893710081,
			 84, 1, "m", "Total", "facGender", "contNormal", 0.397763990911726,
			 0.380740339686194, "<unicode>", 1.03846135899553, 0.435056300890127,
			 69, 107, -0.0771596834739974, 0.0956545011674434, 16, 0, "m",
			 "Total indirect", "facGender", "contNormal", 0.00420496917988296,
			 0.00147571317941618, "<unicode>", 1.00611451327009, 0.0386971797392942,
			 122, 37, -0.0913727116123401, 0.0792345016413655, 16, 1, "m",
			 "Total indirect", "facGender", "contNormal", 0.0014007532771661,
			 2.77691390168519e-06, "<unicode>", 1.02675399066016, 0.0382817235017575,
			 129, 206, -0.0690994546462284, 0.0660850017988253, 50, 0, "m",
			 "Total indirect", "facGender", "contNormal", 0.000985934595142159,
			 -0.000163498539424829, "<unicode>", 0.999201169728315, 0.0322576875324544,
			 87, 40, -0.101985556398019, 0.0928009126636705, 50, 1, "m",
			 "Total indirect", "facGender", "contNormal", -0.00181828130757471,
			 -0.00162627694116246, "<unicode>", 1.00106441448269, 0.0413696062990148,
			 97, 222, -0.0987764232548382, 0.0804294193196866, 84, 0, "m",
			 "Total indirect", "facGender", "contNormal", -0.00278726803197067,
			 -0.00198338418001544, "<unicode>", 1.00501894217369, 0.040005280779074,
			 34, 55, -0.150120617290966, 0.110737509705867, 84, 1, "m", "Total indirect",
			 "facGender", "contNormal", -0.00559148393468753, -0.00457248537725512,
			 "<unicode>", 1.00464522074559, 0.0556343127368206, 65))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")

})
test_that("Test that model number 29 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1515.7193785406, 1437.99394841418, 78.8132508158778,
			 0.525, 1442.82099189019, 80.4669301463091))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(230, -1.05000527463844, 0.550152610883655, "contGamma:contcor2",
			 -0.258792467867314, -0.227524026224909, "<unicode>", 0.999387213254085,
			 "contGamma", 0.419777181711789, 154, 243, -0.244253238061305,
			 0.120890037096549, "debCollin1:contcor2", -0.0556155342176597,
			 -0.0525956593212109, "<unicode>", 1.00048290385339, "contGamma",
			 0.094548237179267, 153, 249, -0.347702233255442, 0.178949770756188,
			 "contcor2", -0.0726897222144539, -0.0685459645016945, "<unicode>",
			 0.996671539809662, "contGamma", 0.14216802492733, 148, 191,
			 -1.21562594228857, 0.237274908098616, "contGamma:contcor1",
			 -0.509178314018531, -0.501974195095627, "<unicode>", 0.996185010776,
			 "contGamma", 0.37317788632117, 133, 282, -0.531042249194886,
			 0.063699793684783, "contcor1", -0.217721540171097, -0.211726831642756,
			 "<unicode>", 0.999661222423281, "contGamma", 0.163316381343723,
			 174, 237, 1.93556999150937, 3.30500592542641, "contGamma", 2.51580153671216,
			 2.52666589619949, "<unicode>", 1.00071449300583, "contGamma",
			 0.34233462421454, 147, 162, 0.90309119355658, 1.50609689429345,
			 "contNormal", 1.17680593595281, 1.15785839045211, "<unicode>",
			 0.996216014722904, "contNormal", 0.153742971073881, 154, 186,
			 -0.00234574122697647, 0.00659724482434155, "debCollin1:contcor2",
			 0.00194330959444845, 0.00194095451861332, "<unicode>", 1.00783313257601,
			 "debCollin1", 0.00216765451006323, 79, 189, -0.0036001728926109,
			 0.00876592783260693, "contcor2", 0.00174249493511708, 0.00158037193497395,
			 "<unicode>", 1.00127863076416, "debCollin1", 0.00308349722694441,
			 55, 115, 0.00527569872429699, 0.00933011411759039, "debCollin1",
			 0.00696965264125631, 0.00689788660676431, "<unicode>", 1.03223984702772,
			 "debCollin1", 0.00101668605690358, 59, 157, 0.844428247295034,
			 1.8901613125362, "contGamma:contcor2", 1.28963525672772, 1.29593584222804,
			 "<unicode>", 1.02463785182105, "contcor1", 0.258780222150717,
			 45, 195, 0.259314136916632, 0.521205320303357, "debCollin1:contcor2",
			 0.371070065516232, 0.364422783820257, "<unicode>", 1.01313780889457,
			 "contcor1", 0.0648226297279967, 174, 194, 0.396777860637289,
			 0.790667402860497, "contcor2", 0.556868778587721, 0.551135658574047,
			 "<unicode>", 1.00978288341741, "contcor1", 0.0984046964374091,
			 182, 223, 1.41839148185644, 2.54101270553494, "contGamma:contcor1",
			 1.89066682390437, 1.85813891571057, "<unicode>", 0.997889312478845,
			 "contcor1", 0.29338703546468, 85, 240, 0.756467755960562, 1.27830486705817,
			 "contcor1", 0.972347478216366, 0.9575412625357, "<unicode>",
			 1.00027588634478, "contcor1", 0.133846614728697, 60, 182, 3.81348717427116,
			 6.47757213275889, "contGamma:contcor2", 5.00952484448624, 4.99520657242641,
			 "<unicode>", 1.01863754936305, "contGamma:contcor1", 0.718407762949097,
			 153, 159, 0.581899047023693, 1.177483777383, "debCollin1:contcor2",
			 0.840612392656118, 0.818257525828799, "<unicode>", 1.02570027000178,
			 "contGamma:contcor1", 0.155603529070878, 33, 162, 0.906012714244702,
			 1.84102958358187, "contcor2", 1.31093274275503, 1.2874620606115,
			 "<unicode>", 1.02903305259292, "contGamma:contcor1", 0.239178773620528,
			 135, 218, 4.79013885014463, 7.91758644231221, "contGamma:contcor1",
			 6.12773362247563, 6.06566580541259, "<unicode>", 1.00656116212141,
			 "contGamma:contcor1", 0.817911461550389, 167, 201, 1.53174422335926,
			 2.67342347841314, "contGamma:contcor2", 2.01969979365111, 1.99640967635098,
			 "<unicode>", 1.04823820906767, "contcor2", 0.292093374585541,
			 148, 241, 0.461609597863197, 0.769475971990038, "debCollin1:contcor2",
			 0.590740706448343, 0.593178219020486, "<unicode>", 1.01627189757098,
			 "contcor2", 0.0797860633863459, 182, 233, 0.708228613994342,
			 1.17667249797133, "contcor2", 0.896596204928774, 0.892134678596562,
			 "<unicode>", 1.01262964879936, "contcor2", 0.122397379317598,
			 182, 193, 0.985965322421987, 1.72811427218521, "contGamma:contcor2",
			 1.30367838184542, 1.28761847295699, "<unicode>", 1.06910738362054,
			 "debCollin1:contcor2", 0.191206610614161, 148, 240, 0.313740872835234,
			 0.511315592831002, "debCollin1:contcor2", 0.397950378548395,
			 0.398588879166704, "<unicode>", 1.01868641634598, "debCollin1:contcor2",
			 0.0527398077849184, 184, 209, 5.68677907631832, 9.00290570649245,
			 "contGamma:contcor2", 7.15357988923991, 7.08240382634183, "<unicode>",
			 1.01950955139421, "contGamma:contcor2", 0.880165181872694, 186
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(302, -0.180351420924137, 0.209919736237427, 16, 16, "contGamma",
			 "contNormal", "", 0.0143410524505479, 0.013206023253512, "<unicode>",
			 "", 0.998381440056773, 0.0962467219865076, 187, 225, -0.229325938443297,
			 0.278581550214239, 50, 16, "contGamma", "contNormal", "", 0.010627664745999,
			 0.0121783425056143, "<unicode>", "", 0.998447491156959, 0.134332403249299,
			 125, 205, -0.440664881645016, 0.493853440921998, 84, 16, "contGamma",
			 "contNormal", "", 0.00657497402588567, 0.0229759977437361, "<unicode>",
			 "", 0.999407018365631, 0.24774279217153, 117, 202, -0.312564249082775,
			 0.250455657248631, 16, 50, "contGamma", "contNormal", "", -0.0216584122889584,
			 -0.0231718088010025, "<unicode>", "", 1.00388711050649, 0.147897427143413,
			 177, 256, -0.212483062214621, 0.119659461515013, 50, 50, "contGamma",
			 "contNormal", "", -0.0253717999935074, -0.0185313477939375,
			 "<unicode>", "", 0.998821371184577, 0.0790550651096228, 153,
			 223, -0.288386705949744, 0.30235664741192, 84, 50, "contGamma",
			 "contNormal", "", -0.0294244907136207, -0.0346323064598546,
			 "<unicode>", "", 0.995933847330234, 0.151476964132972, 134,
			 188, -0.55781402576618, 0.415308886501071, 16, 84, "contGamma",
			 "contNormal", "", -0.0638553105682288, -0.0558776759871299,
			 "<unicode>", "", 1.00529837918548, 0.269604736261637, 112, 191,
			 -0.379388393497111, 0.247965727671833, 50, 84, "contGamma",
			 "contNormal", "", -0.0675686982727777, -0.0675380689804269,
			 "<unicode>", "", 1.00900334093484, 0.168687674450505, 129, 174,
			 -0.284160952810942, 0.140361875629268, 84, 84, "contGamma",
			 "contNormal", "", -0.071621388992891, -0.083062995844082, "<unicode>",
			 "", 1.00649497990078, 0.118025149518615, 153, 125, -0.0316248397645484,
			 0.0426722489854389, 16, 16, "contGamma", "debCollin1", "contNormal",
			 0.00174105218011738, 0.000134841029976155, "<unicode>", "<unicode>",
			 1.03982819520647, 0.0179608247986724, 184, 36, -0.0195231614406236,
			 0.0371286084408532, 50, 16, "contGamma", "debCollin1", "contNormal",
			 0.00562289053398013, 0.00490065094631053, "<unicode>", "<unicode>",
			 0.996136996101336, 0.0152562998281353, 101, 26, -0.0433490079603684,
			 0.0659417989609902, 84, 16, "contGamma", "debCollin1", "contNormal",
			 0.00920558674682805, 0.00597705895839905, "<unicode>", "<unicode>",
			 1.04700030656461, 0.0305182575793293, 89, 125, -0.0316248397645484,
			 0.0426722489854389, 16, 50, "contGamma", "debCollin1", "contNormal",
			 0.00174105218011738, 0.000134841029976155, "<unicode>", "<unicode>",
			 1.03982819520647, 0.0179608247986724, 184, 36, -0.0195231614406236,
			 0.0371286084408532, 50, 50, "contGamma", "debCollin1", "contNormal",
			 0.00562289053398013, 0.00490065094631053, "<unicode>", "<unicode>",
			 0.996136996101336, 0.0152562998281353, 101, 26, -0.0433490079603684,
			 0.0659417989609902, 84, 50, "contGamma", "debCollin1", "contNormal",
			 0.00920558674682805, 0.00597705895839905, "<unicode>", "<unicode>",
			 1.04700030656461, 0.0305182575793293, 89, 125, -0.0316248397645484,
			 0.0426722489854389, 16, 84, "contGamma", "debCollin1", "contNormal",
			 0.00174105218011738, 0.000134841029976155, "<unicode>", "<unicode>",
			 1.03982819520647, 0.0179608247986724, 184, 36, -0.0195231614406236,
			 0.0371286084408532, 50, 84, "contGamma", "debCollin1", "contNormal",
			 0.00562289053398013, 0.00490065094631053, "<unicode>", "<unicode>",
			 0.996136996101336, 0.0152562998281353, 101, 26, -0.0433490079603684,
			 0.0659417989609902, 84, 84, "contGamma", "debCollin1", "contNormal",
			 0.00920558674682805, 0.00597705895839905, "<unicode>", "<unicode>",
			 1.04700030656461, 0.0305182575793293, 89))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(258, -0.214178132532738, 0.123713121709831, "contGamma", -0.0242294027422945,
			 -0.0172885487327395, "<unicode>", "Normal(0,10)", 0.99826076264956,
			 "contNormal", 0.0786779780035976, 153, 31, -3.37815076960923,
			 2.0434174883043, "debCollin1", -0.728155490248979, -0.884895051788835,
			 "<unicode>", "Normal(0,10)", 0.995128627059064, "contNormal",
			 1.4279023640313, 56, 157, -0.225525795426946, 0.739407279607946,
			 "contcor1", 0.260127360578551, 0.272728475852514, "<unicode>",
			 "Normal(0,10)", 1.00382866530551, "contNormal", 0.269260401816081,
			 149, 214, -0.218412918608497, 0.229258137687764, "contGamma:contcor1",
			 -0.00381196512261986, -0.00508438037673752, "<unicode>", "Normal(0,10)",
			 0.998054148717835, "contNormal", 0.124823009180714, 120, 27,
			 -1.68874555098574, 1.59606569352248, "contcor2", -0.0359633986874085,
			 -0.0979830749112368, "<unicode>", "Normal(0,10)", 1.04270358053503,
			 "contNormal", 0.854870146836108, 49, 30, -2.25747224907655,
			 2.41226861990795, "debCollin1:contcor2", 0.0139063620601587,
			 0.104049960058018, "<unicode>", "Normal(0,10)", 1.02729168111494,
			 "contNormal", 1.23237594932534, 54, 140, -0.274103127118684,
			 0.200639521606569, "contGamma:contcor2", -0.0377432006075764,
			 -0.0351967077100015, "<unicode>", "Normal(0,10)", 1.00849880176709,
			 "contNormal", 0.124723730932196, 112, 174, -0.0196265573042827,
			 0.00232616791550997, "contGamma", -0.00903201192823695, -0.00926088904926669,
			 "<unicode>", "Normal(0,10)", 1.00415398173829, "debCollin1",
			 0.00582204342017546, 137, 259, -0.0189775500544607, 0.0340156317423595,
			 "contcor1", 0.00800353347430625, 0.00815151593047556, "<unicode>",
			 "Normal(0,10)", 1.03492092402306, "debCollin1", 0.0140482449501568,
			 183, 261, -0.0143063460108907, 0.00416118796418173, "contGamma:contcor1",
			 -0.00410441937872973, -0.0038798707389002, "<unicode>", "Normal(0,10)",
			 1.03085101008724, "debCollin1", 0.00498277854422888, 183))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(308, -0.186188737820623, 0.219925924795383, 16, 16, "Total", "contGamma",
			 "contNormal", 0.0160821046306653, 0.0178558485066399, "<unicode>",
			 0.995922799389098, 0.09743455305893, 215, 210, -0.226328156924815,
			 0.278870983485652, 50, 16, "Total", "contGamma", "contNormal",
			 0.0162505552799791, 0.010214269118074, "<unicode>", 0.99784642830015,
			 0.134413220164454, 130, 175, -0.415828797687845, 0.522913050015579,
			 84, 16, "Total", "contGamma", "contNormal", 0.0157805607727137,
			 0.0192278413692395, "<unicode>", 1.00064975125526, 0.247681335455374,
			 103, 205, -0.340469642663674, 0.244983431820678, 16, 50, "Total",
			 "contGamma", "contNormal", -0.0199173601088411, -0.0190057088261701,
			 "<unicode>", 0.999736555301949, 0.148278612322338, 174, 274,
			 -0.176796287636358, 0.124577380035348, 50, 50, "Total", "contGamma",
			 "contNormal", -0.0197489094595272, -0.0202481519700379, "<unicode>",
			 0.999687528238379, 0.0777146346778691, 126, 209, -0.279273622498525,
			 0.308362244477325, 84, 50, "Total", "contGamma", "contNormal",
			 -0.0202189039667926, -0.0325451714987974, "<unicode>", 0.995941800900307,
			 0.149835858489614, 176, 189, -0.567970959332588, 0.429653466661266,
			 16, 84, "Total", "contGamma", "contNormal", -0.0621142583881114,
			 -0.0445484704660213, "<unicode>", 1.00649961937972, 0.269559416529917,
			 154, 195, -0.358952365732074, 0.247839350515092, 50, 84, "Total",
			 "contGamma", "contNormal", -0.0619458077387976, -0.0579156622232515,
			 "<unicode>", 1.01002505744219, 0.167253159583105, 154, 282,
			 -0.258678224041389, 0.149754287781012, 84, 84, "Total", "contGamma",
			 "contNormal", -0.062415802246063, -0.0685127704856283, "<unicode>",
			 1.0028483400014, 0.113540850674536, 152, 125, -0.0316248397645484,
			 0.0426722489854389, 16, 16, "Total indirect", "contGamma", "contNormal",
			 0.00174105218011738, 0.000134841029976155, "<unicode>", 1.03982819520647,
			 0.0179608247986724, 184, 36, -0.0195231614406236, 0.0371286084408532,
			 50, 16, "Total indirect", "contGamma", "contNormal", 0.00562289053398013,
			 0.00490065094631053, "<unicode>", 0.996136996101336, 0.0152562998281353,
			 101, 26, -0.0433490079603684, 0.0659417989609902, 84, 16, "Total indirect",
			 "contGamma", "contNormal", 0.00920558674682805, 0.00597705895839905,
			 "<unicode>", 1.04700030656461, 0.0305182575793293, 89, 125,
			 -0.0316248397645484, 0.0426722489854389, 16, 50, "Total indirect",
			 "contGamma", "contNormal", 0.00174105218011738, 0.000134841029976155,
			 "<unicode>", 1.03982819520647, 0.0179608247986724, 184, 36,
			 -0.0195231614406236, 0.0371286084408532, 50, 50, "Total indirect",
			 "contGamma", "contNormal", 0.00562289053398013, 0.00490065094631053,
			 "<unicode>", 0.996136996101336, 0.0152562998281353, 101, 26,
			 -0.0433490079603684, 0.0659417989609902, 84, 50, "Total indirect",
			 "contGamma", "contNormal", 0.00920558674682805, 0.00597705895839905,
			 "<unicode>", 1.04700030656461, 0.0305182575793293, 89, 125,
			 -0.0316248397645484, 0.0426722489854389, 16, 84, "Total indirect",
			 "contGamma", "contNormal", 0.00174105218011738, 0.000134841029976155,
			 "<unicode>", 1.03982819520647, 0.0179608247986724, 184, 36,
			 -0.0195231614406236, 0.0371286084408532, 50, 84, "Total indirect",
			 "contGamma", "contNormal", 0.00562289053398013, 0.00490065094631053,
			 "<unicode>", 0.996136996101336, 0.0152562998281353, 101, 26,
			 -0.0433490079603684, 0.0659417989609902, 84, 84, "Total indirect",
			 "contGamma", "contNormal", 0.00920558674682805, 0.00597705895839905,
			 "<unicode>", 1.04700030656461, 0.0305182575793293, 89))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")

})
test_that("Test that model number 29 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 731.560238825911, 640.671457564969, 56.6180680006015,
			 0.56, 641.834570054082, 57.120835256975))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(231, -0.0789333018847456, 0.0444946594645542, "facGenderm:contcor2",
			 -0.0107343158304044, -0.0113925515700787, "<unicode>", 0.998428463535231,
			 "facGenderm", 0.0325858037333743, 178, 178, -0.0930122385233292,
			 0.0199680933514816, "debCollin1:contcor2", -0.0361680007848935,
			 -0.0345197241229341, "<unicode>", 0.995000356638702, "facGenderm",
			 0.0315174535780834, 134, 168, -0.148270748387598, 0.027925444274335,
			 "contcor2", -0.0538931409527994, -0.0509809083141478, "<unicode>",
			 0.99550104687131, "facGenderm", 0.047267339964686, 182, 275,
			 0.101785505661363, 0.191098592967904, "facGenderm:facExperimexperimental",
			 0.144780423186267, 0.142353350435363, "<unicode>", 1.00596698279549,
			 "facGenderm", 0.0237401105441021, 223, 240, -0.0136034767622424,
			 0.0840805516161191, "facExperimexperimental", 0.0330840602284047,
			 0.0326500274062878, "<unicode>", 1.00098629630244, "facGenderm",
			 0.023852799091438, 106, 196, 0.201657691313615, 0.337915370989533,
			 "facGenderm", 0.263904082083243, 0.265167409300188, "<unicode>",
			 1.00135911633548, "facGenderm", 0.0367401365846657, 159, 125,
			 0.796613252803585, 1.55272909949092, "contNormal", 1.15034579975497,
			 1.135768023775, "<unicode>", 1.04586955853264, "contNormal",
			 0.185585375015121, 34, 363, -0.00493147499923502, 0.0109594899511869,
			 "debCollin1:contcor2", 0.00246214140464191, 0.00222294298009994,
			 "<unicode>", 1.01653038931792, "debCollin1", 0.00424392862944546,
			 100, 377, -0.00780592325182131, 0.0141139135942428, "contcor2",
			 0.00238464840876822, 0.00231844680218547, "<unicode>", 1.00789113136871,
			 "debCollin1", 0.00627525716884948, 126, 284, 0.0054032546132557,
			 0.00929742354451356, "debCollin1", 0.00702292711661815, 0.00688806550530343,
			 "<unicode>", 1.00267455823073, "debCollin1", 0.00100803078533036,
			 134, 225, -0.118332861987069, -0.00881279530456, "facGenderm:contcor2",
			 -0.0627782682608396, -0.0629887211976249, "<unicode>", 0.9975037221496,
			 "facExperimexperimental", 0.0291432705258115, 154, 136, -0.101061169243022,
			 0.00986078584230771, "debCollin1:contcor2", -0.0376091676734224,
			 -0.0357098465846833, "<unicode>", 0.995070991119694, "facExperimexperimental",
			 0.028482546792613, 177, 145, -0.154768864723538, 0.00966355817362044,
			 "contcor2", -0.0599339392279624, -0.0582989364880808, "<unicode>",
			 0.999036412554591, "facExperimexperimental", 0.0423615662914728,
			 177, 229, 0.0980640977274163, 0.192607202359225, "facGenderm:facExperimexperimental",
			 0.143506332710311, 0.140818482405451, "<unicode>", 0.996745702558763,
			 "facExperimexperimental", 0.0256893990355567, 149, 173, 0.200968438780666,
			 0.333185050906449, "facExperimexperimental", 0.260208765928904,
			 0.257818146635082, "<unicode>", 1.00347386530271, "facExperimexperimental",
			 0.036364407773456, 182, 196, -0.124345738800296, -0.0144703998129053,
			 "facGenderm:contcor2", -0.0681282783407949, -0.0719507593391221,
			 "<unicode>", 0.996041262825394, "facGenderm:facExperimexperimental",
			 0.0310335823366294, 182, 134, -0.117657420700581, -0.00777793230104807,
			 "debCollin1:contcor2", -0.0570289311222949, -0.0562331085235085,
			 "<unicode>", 1.0022489933408, "facGenderm:facExperimexperimental",
			 0.0295857455843122, 153, 136, -0.176088643196524, -0.00802148990125818,
			 "contcor2", -0.0851329328402587, -0.082646110781255, "<unicode>",
			 1.00335050284293, "facGenderm:facExperimexperimental", 0.0447782460329523,
			 158, 219, 0.159192037725429, 0.277587007976119, "facGenderm:facExperimexperimental",
			 0.209362805383224, 0.205284542843847, "<unicode>", 0.998012948134857,
			 "facGenderm:facExperimexperimental", 0.0288204927038349, 152,
			 207, 0.298683409227985, 0.609914104095007, "facGenderm:contcor2",
			 0.421425631678473, 0.415670609211807, "<unicode>", 0.996441800820118,
			 "contcor2", 0.0779925349951295, 182, 184, 0.466176276153053,
			 0.876950896345417, "debCollin1:contcor2", 0.645543111440023,
			 0.642149677264643, "<unicode>", 0.995483290890483, "contcor2",
			 0.097069462368677, 184, 190, 0.708638511365997, 1.30921856442993,
			 "contcor2", 0.980513900476185, 0.976362784276676, "<unicode>",
			 0.995506401136333, "contcor2", 0.145315022497997, 184, 201,
			 0.189661948935743, 0.384529436573652, "facGenderm:contcor2",
			 0.271357995762729, 0.266763598588278, "<unicode>", 0.997063763216449,
			 "debCollin1:contcor2", 0.0517368561426944, 184, 185, 0.315426335623944,
			 0.59699192291081, "debCollin1:contcor2", 0.433754215320037,
			 0.432142769411339, "<unicode>", 0.997376537796738, "debCollin1:contcor2",
			 0.0655378819594869, 177, 155, 0.344913163420355, 0.643219151773386,
			 "facGenderm:contcor2", 0.457034519540437, 0.445836360210624,
			 "<unicode>", 0.996915810574663, "facGenderm:contcor2", 0.0697863442214593,
			 149))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(142, -0.0984860907720234, 1.37875705760676, 16, 0, "m", "facGender",
			 "contNormal", "", 0.605979724456924, 0.562487585526916, "<unicode>",
			 "", 1.002153128014, 0.373850334380475, 133, 284, -0.300107945561192,
			 1.02316858841181, 16, 1, "m", "facGender", "contNormal", "",
			 0.308768738576441, 0.297825088876457, "<unicode>", "", 1.00662728059309,
			 0.348611945493389, 177, 146, 0.103457063550504, 1.18868648716109,
			 50, 0, "m", "facGender", "contNormal", "", 0.626700017219808,
			 0.618154183784969, "<unicode>", "", 1.00456015315223, 0.289541305531667,
			 153, 209, -0.270404115124601, 0.850230979288033, 50, 1, "m",
			 "facGender", "contNormal", "", 0.329489031339325, 0.343602166994001,
			 "<unicode>", "", 1.00577769955644, 0.302883383252251, 149, 283,
			 -0.109051973112909, 1.33611090270824, 84, 0, "m", "facGender",
			 "contNormal", "", 0.650987380722538, 0.646974190899825, "<unicode>",
			 "", 1.00208014803759, 0.362364205044031, 150, 233, -0.548677687545121,
			 1.0688685490322, 84, 1, "m", "facGender", "contNormal", "",
			 0.353776394842055, 0.391910399975932, "<unicode>", "", 0.996027973488735,
			 0.41212825026, 130, 198, -0.0893065119986361, 0.143798374803256,
			 16, 0, "m", "facGender", "debCollin1", "contNormal", 0.00434702621087129,
			 -0.000233023674832664, "<unicode>", "<unicode>", 1.00107169353482,
			 0.0538731487252675, 68, 102, -0.077550190386162, 0.0820337923783146,
			 16, 1, "m", "facGender", "debCollin1", "contNormal", -0.000771491544588757,
			 -0.000986389155088593, "<unicode>", "<unicode>", 0.999158412507034,
			 0.0391664538539065, 102, 183, -0.0739205544301501, 0.0889868979073884,
			 50, 0, "m", "facGender", "debCollin1", "contNormal", 0.0001242769771895,
			 -0.000150431495280361, "<unicode>", "<unicode>", 0.999163238153643,
			 0.0419136100363283, 113, 198, -0.0893065119986361, 0.143798374803256,
			 50, 1, "m", "facGender", "debCollin1", "contNormal", 0.00434702621087129,
			 -0.000233023674832664, "<unicode>", "<unicode>", 1.00107169353482,
			 0.0538731487252675, 68, 102, -0.077550190386162, 0.0820337923783146,
			 84, 0, "m", "facGender", "debCollin1", "contNormal", -0.000771491544588757,
			 -0.000986389155088593, "<unicode>", "<unicode>", 0.999158412507034,
			 0.0391664538539065, 102, 183, -0.0739205544301501, 0.0889868979073884,
			 84, 1, "m", "facGender", "debCollin1", "contNormal", 0.0001242769771895,
			 -0.000150431495280361, "<unicode>", "<unicode>", 0.999163238153643,
			 0.0419136100363283, 113))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(143, 0.0989680374237607, 1.17984746505994, "facGenderm", 0.626050471451712,
			 0.615366298875028, "<unicode>", "Normal(0,10)", 1.00376571645312,
			 "contNormal", 0.290240275554609, 148, 44, -2.91326488556805,
			 2.46143680628015, "debCollin1", 0.209319317932082, 0.367246982403164,
			 "<unicode>", "Normal(0,10)", 1.01899679373915, "contNormal",
			 1.3589237428732, 37, 75, -0.382748732137095, 0.658568039862908,
			 "facExperimexperimental", 0.156143245262024, 0.179091095593961,
			 "<unicode>", "Normal(0,10)", 1.0082976862808, "contNormal",
			 0.27726840052908, 95, 98, -1.03495599607317, 0.473721004092913,
			 "facGenderm:facExperimexperimental", -0.297210985880483, -0.291817128741975,
			 "<unicode>", "Normal(0,10)", 1.01686037376619, "contNormal",
			 0.409731850810531, 83, 24, -1.41501197412026, 2.05672684816289,
			 "contcor2", -0.0420352723747479, -0.160718438932018, "<unicode>",
			 "Normal(0,10)", 1.03389266477371, "contNormal", 0.876327674297576,
			 24, 24, -3.10546129477046, 2.13926922694471, "debCollin1:contcor2",
			 0.124770770867781, 0.279184557011817, "<unicode>", "Normal(0,10)",
			 1.02303074628778, "contNormal", 1.30736202479796, 24, 317, -0.410944343535381,
			 0.439350162280924, "facGenderm:contcor2", 0.0217239387323167,
			 0.0335508654902908, "<unicode>", "Normal(0,10)", 0.997938967738253,
			 "contNormal", 0.220905255902644, 182, 182, -0.0434083229157136,
			 0.0491402616844119, "facGenderm", 0.00324390556657903, 0.00164358370568899,
			 "<unicode>", "Normal(0,10)", 1.00046341426546, "debCollin1",
			 0.0233382804477507, 102, 221, -0.0495221285751406, 0.0402216770971577,
			 "facExperimexperimental", -0.00257037602509971, -0.00159447077272046,
			 "<unicode>", "Normal(0,10)", 0.997895635770778, "debCollin1",
			 0.0239200774703656, 184, 211, -0.0823094860181953, 0.0411018869325409,
			 "facGenderm:facExperimexperimental", -0.019634449170025, -0.0181969619879599,
			 "<unicode>", "Normal(0,10)", 1.00259036198339, "debCollin1",
			 0.0326158942843216, 80))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(138, -0.082748753545577, 1.40656801163204, 16, 0, "m", "Total",
			 "facGender", "contNormal", 0.610326750667796, 0.568749882165249,
			 "<unicode>", 0.995986091009985, 0.380753201425413, 134, 300,
			 -0.343272111243354, 0.998510837585647, 16, 1, "m", "Total",
			 "facGender", "contNormal", 0.307997247031852, 0.309199133405757,
			 "<unicode>", 1.00331154227558, 0.350539679475325, 177, 148,
			 0.072820043354792, 1.17269351628493, 50, 0, "m", "Total", "facGender",
			 "contNormal", 0.626824294196997, 0.613850963279132, "<unicode>",
			 1.01288386487684, 0.291137337784941, 156, 233, -0.288079539090859,
			 0.85597814723967, 50, 1, "m", "Total", "facGender", "contNormal",
			 0.333836057550196, 0.330955307404556, "<unicode>", 1.01556718480718,
			 0.307609394402828, 149, 283, -0.0886845539353604, 1.29890746725663,
			 84, 0, "m", "Total", "facGender", "contNormal", 0.650215889177949,
			 0.652685239202861, "<unicode>", 1.00403318320351, 0.361364408476125,
			 150, 228, -0.545758813602449, 1.0678675094106, 84, 1, "m", "Total",
			 "facGender", "contNormal", 0.353900671819244, 0.37357810909115,
			 "<unicode>", 0.996096879960773, 0.413428342567194, 177, 198,
			 -0.0893065119986361, 0.143798374803256, 16, 0, "m", "Total indirect",
			 "facGender", "contNormal", 0.00434702621087129, -0.000233023674832664,
			 "<unicode>", 1.00107169353482, 0.0538731487252675, 68, 102,
			 -0.077550190386162, 0.0820337923783146, 16, 1, "m", "Total indirect",
			 "facGender", "contNormal", -0.000771491544588757, -0.000986389155088593,
			 "<unicode>", 0.999158412507034, 0.0391664538539065, 102, 183,
			 -0.0739205544301501, 0.0889868979073884, 50, 0, "m", "Total indirect",
			 "facGender", "contNormal", 0.0001242769771895, -0.000150431495280361,
			 "<unicode>", 0.999163238153643, 0.0419136100363283, 113, 198,
			 -0.0893065119986361, 0.143798374803256, 50, 1, "m", "Total indirect",
			 "facGender", "contNormal", 0.00434702621087129, -0.000233023674832664,
			 "<unicode>", 1.00107169353482, 0.0538731487252675, 68, 102,
			 -0.077550190386162, 0.0820337923783146, 84, 0, "m", "Total indirect",
			 "facGender", "contNormal", -0.000771491544588757, -0.000986389155088593,
			 "<unicode>", 0.999158412507034, 0.0391664538539065, 102, 183,
			 -0.0739205544301501, 0.0889868979073884, 84, 1, "m", "Total indirect",
			 "facGender", "contNormal", 0.0001242769771895, -0.000150431495280361,
			 "<unicode>", 0.999163238153643, 0.0419136100363283, 113))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")

})
test_that("Test that model number 82 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debMiss1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debMiss1",
            processType = "mediators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1992.14097440724, 1924.8163444438, 44.7912561640736,
			 0.465, 1924.74389005389, 44.823187691696))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(208, 1.75194182950603, 3.04560065571118, "contGamma", 2.39684884187062,
			 2.39273146041233, "<unicode>", 1.00113647512192, "contGamma",
			 0.316772839337233, 94, 157, 0.838821037268036, 1.49839377456281,
			 "contNormal", 1.08706685562032, 1.05968201450385, "<unicode>",
			 0.99624424137613, "contNormal", 0.168827012993083, 92, 59, -0.0148894678215103,
			 0.0190229975236247, "contcor1", 0.000716655626282412, 0.000519575216288409,
			 "<unicode>", 1.00659671319924, "debCollin1", 0.0085863657614161,
			 81, 258, -0.618091420160407, 0.0377872163052682, "debMiss1",
			 -0.276883350906606, -0.273568244556437, "<unicode>", 1.00210042086438,
			 "debCollin1", 0.181531859722867, 159, 220, 0.00527261901924364,
			 0.00883601903379929, "debCollin1", 0.00697828859154208, 0.00696151614468652,
			 "<unicode>", 0.996484865675064, "debCollin1", 0.000964157371527439,
			 149, 295, 0.457893588128045, 1.02942881669699, "contcor1", 0.675612942667553,
			 0.658182371511761, "<unicode>", 1.02597316600289, "contcor2",
			 0.140229837188302, 148, 269, -6.22410034610836, 4.20010354039054,
			 "debMiss1", -1.17893212725056, -1.34293670435272, "<unicode>",
			 1.0010547953979, "contcor2", 2.81351533026812, 132, 210, 0.79492909509418,
			 1.41163879011571, "contcor2", 1.06105770348893, 1.04388082291392,
			 "<unicode>", 1.0118693802556, "contcor2", 0.157480882124233,
			 96, 190, 511.097779465161, 856.597579767307, "debMiss1", 659.396466197683,
			 648.166820385291, "<unicode>", 0.9965609448577, "debMiss1",
			 91.8609532052739, 119, 215, 0.794373994562972, 1.41232576502995,
			 "contcor1", 1.04495326295872, 1.03596363369464, "<unicode>",
			 1.01341434966907, "contcor1", 0.156649802881758, 158))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(136, -0.143728267695584, 0.119041125653995, "contGamma", "contNormal",
			 "", "", -0.00946950369206367, -0.0116599091774967, "<unicode>",
			 "", "", 1.01080829612846, 0.0660652333338737, 117, 3, -0.0417581975713019,
			 0.025504443423144, "contGamma", "debCollin1", "contNormal",
			 "", -0.00462828848989624, -0.00151137449429765, "<unicode>",
			 "<unicode>", "", 1.23968588639938, 0.016081535504373, 30, 199,
			 -0.0282229898260289, 0.0390422883373474, "contGamma", "contcor2",
			 "contNormal", "", 0.00589090649792501, 0.00404152253038354,
			 "<unicode>", "<unicode>", "", 1.00737599436204, 0.015420822131919,
			 147, 2, -0.0375983821010362, 0.0457642118072092, "contGamma",
			 "debMiss1", "contNormal", "", 0.00608102402593657, 0.00460991562952226,
			 "<unicode>", "<unicode>", "", 1.66133662130427, 0.0200288413236933,
			 30, 173, -0.0832857136388918, 0.00885472282092033, "contGamma",
			 "contcor1", "contNormal", "", -0.0326130320472707, -0.0294990551294661,
			 "<unicode>", "<unicode>", "", 1.01190625609094, 0.0274373240965784,
			 122, 67, -0.00292913287027265, 0.00867507531292319, "contGamma",
			 "debCollin1", "contcor2", "contNormal", 0.0015045376211668,
			 0.000627142970325316, "<unicode>", "<unicode>", "<unicode>",
			 0.998836022268568, 0.00298492120080222, 153, 2, -0.00896253411899891,
			 0.00660701444913379, "contGamma", "debMiss1", "contcor1", "contNormal",
			 -0.000786404828679941, -0.000170750943144739, "<unicode>", "<unicode>",
			 "<unicode>", 1.41726459870602, 0.00404834533769873, 17))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(136, -0.143728267695584, 0.119041125653995, "contGamma", -0.00946950369206367,
			 -0.0116599091774967, "<unicode>", "Normal(0,10)", 1.01080829612846,
			 "contNormal", 0.0660652333338737, 117, 4, -2.20426516557701,
			 3.02930860009947, "debCollin1", 0.463509676421784, 0.37584652677211,
			 "<unicode>", "Normal(0,10)", 1.23856309297067, "contNormal",
			 1.47977598792463, 51, 236, -0.373030781387033, 0.0979527954014666,
			 "contcor2", -0.16007216430531, -0.162973309650427, "<unicode>",
			 "Normal(0,10)", 1.00297806403652, "contNormal", 0.123620300569969,
			 103, 99, 0.00311213889536281, 0.0175905292692019, "debMiss1",
			 0.0104618099999543, 0.00994436554177701, "<unicode>", "Normal(0,10)",
			 1.00249397093272, "contNormal", 0.00394897518294129, 129, 239,
			 0.0882292840231555, 0.559310953197505, "contcor1", 0.309274057395657,
			 0.310041070831865, "<unicode>", "Normal(0,10)", 0.999978992034303,
			 "contNormal", 0.120354381992515, 79, 225, -0.0209723129948526,
			 0.00129511092505808, "contGamma", -0.00962816819561203, -0.00972008096605629,
			 "<unicode>", "Normal(0,10)", 0.997245259458674, "debCollin1",
			 0.00580356546978996, 154, 232, -0.17045528715731, 0.110805186527823,
			 "contGamma", -0.0357905795334313, -0.0430800024585122, "<unicode>",
			 "Normal(0,10)", 1.00011222826463, "contcor2", 0.0697666306275869,
			 172, 23, -1.08269888466169, 3.04877124058531, "debCollin1",
			 1.04028438342658, 1.01234295596507, "<unicode>", "Normal(0,10)",
			 1.05686315701582, "contcor2", 1.16443595755275, 50, 2, -3.24287525145944,
			 3.98179918248937, "contGamma", 0.565482330015574, 0.509307275131761,
			 "<unicode>", "Normal(0,10)", 1.64557208098436, "debMiss1", 1.80289196284803,
			 28, 246, -0.236547735343201, 0.0296901948218609, "contGamma",
			 -0.103464205556113, -0.10387108045339, "<unicode>", "Normal(0,10)",
			 1.0283002974104, "contcor1", 0.0713311941545529, 158, 265, -0.0134115674575115,
			 0.00225212291395396, "debMiss1", -0.00509302880731659, -0.00519478672155712,
			 "<unicode>", "Normal(0,10)", 1.00714006124596, "contcor1", 0.00412069143505651,
			 228))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(83, -0.170791123790685, 0.0980167676814792, "Total", "contGamma",
			 "contNormal", -0.0340207609128821, -0.0298260411837002, "<unicode>",
			 1.03953558470152, 0.0662979822131888, 185, 55, -0.0829340372899479,
			 0.022743716057428, "Total indirect", "contGamma", "contNormal",
			 -0.0245512572208185, -0.021890723956297, "<unicode>", 1.04082231510372,
			 0.027692714473583, 67))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")

})
test_that("Test that model number 82 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debMiss1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debMiss1",
            processType = "mediators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1766.36065047304, 1696.23090652101, 36.5602005336848,
			 0.51, 1696.30339765189, 36.6164474234977))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(155, 0.200228674486594, 0.342423071015872, "facGenderm", 0.262538852694959,
			 0.260089741716837, "<unicode>", 0.996446457991105, "facGenderm",
			 0.0352296262944044, 117, 235, 0.752375306409623, 1.40595916304718,
			 "contNormal", 1.03152126498499, 1.00240010012381, "<unicode>",
			 1.02567869627661, "contNormal", 0.170335096644266, 94, 81, -0.0143474790975567,
			 0.0156577726486563, "contcor1", 0.000918644296465333, 0.000279208227628297,
			 "<unicode>", 1.01922389327887, "debCollin1", 0.00809969109180678,
			 84, 326, -0.706893675040144, 0.0475729034480801, "debMiss1",
			 -0.320020129869864, -0.299871519112737, "<unicode>", 0.998538038817614,
			 "debCollin1", 0.206680626437472, 183, 212, 0.00545732391863776,
			 0.00956271586136255, "debCollin1", 0.00715117973902784, 0.00697440462215413,
			 "<unicode>", 1.0126014502255, "debCollin1", 0.00114508937538236,
			 174, 239, 0.481634797695572, 0.85757110097155, "contcor1", 0.659989870657885,
			 0.651998396272384, "<unicode>", 1.01080099159737, "contcor2",
			 0.108829522143247, 177, 250, -7.34931556800869, 3.56207495451083,
			 "debMiss1", -1.51248731946038, -1.5054832655276, "<unicode>",
			 0.997429000965908, "contcor2", 2.78193964424756, 132, 180, 0.789873060810728,
			 1.32974565136863, "contcor2", 1.03793226350635, 1.03384358669986,
			 "<unicode>", 0.997351948893946, "contcor2", 0.13376012607142,
			 184, 143, 502.60094497184, 866.839424719917, "debMiss1", 664.973495556634,
			 655.002629489157, "<unicode>", 1.00866067003928, "debMiss1",
			 98.7693148222598, 120, 224, 0.805977338405761, 1.39829429334668,
			 "contcor1", 1.03208860338452, 1.01711431869527, "<unicode>",
			 1.03995597670681, "contcor1", 0.14895159271987, 211))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(236, 0.106232384720348, 0.87452143738986, "m", "facGender", "contNormal",
			 "", "", 0.496055999905393, 0.49573670108339, "<unicode>", "",
			 "", 1.00891756236623, 0.207093101185936, 184, 110, -0.0559725659584625,
			 0.0357791537073717, "m", "facGender", "debCollin1", "contNormal",
			 "", -0.00634179418587783, -0.00334451995479891, "<unicode>",
			 "<unicode>", "", 1.02134805623888, 0.0262789303500548, 154,
			 188, -0.089879142035927, 0.137566020307408, "m", "facGender",
			 "contcor2", "contNormal", "", 0.0264909586114478, 0.0173862176448227,
			 "<unicode>", "<unicode>", "", 1.00849394192156, 0.0538403819769828,
			 215, 9, -0.106637406856594, 0.0833885670534336, "m", "facGender",
			 "debMiss1", "contNormal", "", -0.0116867686353182, -0.0102868383063336,
			 "<unicode>", "<unicode>", "", 1.05266823595288, 0.053905852569711,
			 43, 164, -0.139597748875918, 0.115795973769819, "m", "facGender",
			 "contcor1", "contNormal", "", -0.020649835863672, -0.0208252060770578,
			 "<unicode>", "<unicode>", "", 1.02359689918071, 0.0604553612836096,
			 117, 121, -0.00603056767910582, 0.0114561888091675, "m", "facGender",
			 "debCollin1", "contcor2", "contNormal", 0.000855475084639234,
			 0.000206716724109814, "<unicode>", "<unicode>", "<unicode>",
			 1.01915207408003, 0.00387434384541351, 175, 12, -0.0168159808014407,
			 0.0378370876484217, "m", "facGender", "debMiss1", "contcor1",
			 "contNormal", 0.00224878636050732, 0.000378379751374603, "<unicode>",
			 "<unicode>", "<unicode>", 1.02191637055662, 0.0120782365991776,
			 83))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(236, 0.106232384720348, 0.87452143738986, "facGenderm", 0.496055999905393,
			 0.49573670108339, "<unicode>", "Normal(0,10)", 1.00891756236623,
			 "contNormal", 0.207093101185936, 184, 31, -1.75359387553804,
			 2.85442520995778, "debCollin1", 0.54597548113978, 0.719159433728894,
			 "<unicode>", "Normal(0,10)", 1.06409865656328, "contNormal",
			 1.22792685261007, 61, 250, -0.396527144646278, 0.193934490338863,
			 "contcor2", -0.108027256864167, -0.107986778421521, "<unicode>",
			 "Normal(0,10)", 1.00962373588702, "contNormal", 0.149233274025737,
			 118, 299, 0.0036288107823826, 0.01901785367315, "debMiss1",
			 0.0104131071241959, 0.0102683399191074, "<unicode>", "Normal(0,10)",
			 1.01120769508862, "contNormal", 0.00412690061007591, 217, 288,
			 0.0482791629306042, 0.550305557965414, "contcor1", 0.293768644195244,
			 0.284134547640027, "<unicode>", "Normal(0,10)", 1.00173472288577,
			 "contNormal", 0.143455902249419, 175, 171, -0.0479848965445424,
			 0.0249731200739596, "facGenderm", -0.00827253842536313, -0.00978177624778516,
			 "<unicode>", "Normal(0,10)", 1.00260035699491, "debCollin1",
			 0.0184191408934276, 56, 72, -0.621816370907471, 0.108705983046955,
			 "facGenderm", -0.264286461291534, -0.272542607855233, "<unicode>",
			 "Normal(0,10)", 0.9978133769888, "contcor2", 0.198172291255967,
			 84, 48, -1.45507754473255, 2.69384066114862, "debCollin1", 0.582014731837763,
			 0.529220694233145, "<unicode>", "Normal(0,10)", 1.02648342091914,
			 "contcor2", 1.12043257507073, 81, 8, -12.4388530402663, 6.22252968652929,
			 "facGenderm", -1.24049068707796, -0.989803501441142, "<unicode>",
			 "Normal(0,10)", 1.07505960767502, "debMiss1", 4.95565388039017,
			 34, 149, -0.463935965624334, 0.306546708574353, "facGenderm",
			 -0.0862453639869967, -0.0900123853428148, "<unicode>", "Normal(0,10)",
			 1.06820470927533, "contcor1", 0.190152995726388, 177, 213, -0.0133929728023032,
			 0.00213158312078332, "debMiss1", -0.00578640762665844, -0.00586024410093499,
			 "<unicode>", "Normal(0,10)", 0.995278648415369, "contcor1",
			 0.00402520216290398, 177))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(194, 0.0896136123101381, 0.915266560884822, "m", "Total", "facGender",
			 "contNormal", 0.48697282127712, 0.476324623313424, "<unicode>",
			 1.0075478937247, 0.223967072583252, 111, 36, -0.188180050058477,
			 0.150304376634551, "m", "Total indirect", "facGender", "contNormal",
			 -0.00908317862827367, -0.00507680041188365, "<unicode>", 1.00677319025796,
			 0.0891066812463332, 184))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")

})
test_that("Test that model number 92 - continuous works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contcor2", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contcor2", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contcor2",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 1509.15336093834, 1432.23108578508, 76.5748123993768,
			 0.55, 1435.77414683756, 77.637963590614))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(172, 0.0308194967201531, 0.690117170087553, "contcor2:contcor1",
			 0.287567771756502, 0.283317055669914, "<unicode>", 0.999270621041174,
			 "contGamma", 0.169817343712696, 115, 268, -0.34714631202213,
			 0.0274645070619967, "debCollin1:contcor1", -0.157530243589775,
			 -0.162396002212026, "<unicode>", 0.999892302792143, "contGamma",
			 0.0992886378413078, 134, 269, -1.2052914562805, 0.157593021955732,
			 "contGamma:contcor1", -0.555868821991032, -0.557860176228991,
			 "<unicode>", 1.00616147968352, "contGamma", 0.361313369562282,
			 213, 263, -0.519128505244651, 0.0622417489215182, "contcor1",
			 -0.223542755770977, -0.2264852992659, "<unicode>", 0.997319125351111,
			 "contGamma", 0.147491571326107, 79, 154, 1.81124078303016, 3.26710648809925,
			 "contGamma", 2.48824893544405, 2.44606190431053, "<unicode>",
			 0.995668403149192, "contGamma", 0.389612764073142, 105, 125,
			 0.848242546414681, 1.43506349098668, "contNormal", 1.13107757386249,
			 1.13102754985509, "<unicode>", 1.03292892861537, "contNormal",
			 0.142600826907349, 58, 146, -0.00224273737236579, 0.000770310582851511,
			 "debCollin1:contcor1", -0.000538833907221306, -0.000517640216332694,
			 "<unicode>", 1.00500836094448, "debCollin1", 0.000805593140176564,
			 182, 168, 0.00514249217290496, 0.00893559221059714, "debCollin1",
			 0.00688701179092964, 0.00671840006163053, "<unicode>", 0.996941062512538,
			 "debCollin1", 0.00101628292848036, 152, 253, -0.0676881130318219,
			 0.247558829493163, "contcor2:contcor1", 0.0931189033325063,
			 0.0925631591109481, "<unicode>", 1.04902354511776, "contcor2",
			 0.0849312726758088, 154, 192, 0.432289401814482, 0.716055656029171,
			 "contcor2", 0.567128198679984, 0.564789341222215, "<unicode>",
			 0.995443050043144, "contcor2", 0.0733233490994318, 182, 287,
			 0.0285119702126377, 0.422133152391792, "contcor2:contcor1",
			 0.223775186088438, 0.224303643853323, "<unicode>", 1.00468645270527,
			 "contcor1", 0.10750680519452, 104, 161, 0.47699320811801, 0.830427929494368,
			 "debCollin1:contcor1", 0.646304838513793, 0.643446129955804,
			 "<unicode>", 0.99917381718177, "contcor1", 0.0900598229220111,
			 153, 165, 1.47207758036401, 2.67511012227395, "contGamma:contcor1",
			 1.98338528973398, 1.97810079446786, "<unicode>", 0.996196401977404,
			 "contcor1", 0.30595732546032, 147, 162, 0.72783237338969, 1.26427636838937,
			 "contcor1", 0.97867357393513, 0.973266412947847, "<unicode>",
			 0.99622747589401, "contcor1", 0.136179206092132, 153, 198, -0.158511806209924,
			 1.04423150447696, "contcor2:contcor1", 0.375237441833658, 0.341015865578252,
			 "<unicode>", 1.00547233905199, "contGamma:contcor1", 0.289628174397285,
			 141, 168, 0.931232124040628, 1.73883359282747, "debCollin1:contcor1",
			 1.26240153619136, 1.25448953241412, "<unicode>", 0.995889918543304,
			 "contGamma:contcor1", 0.198142669644083, 147, 176, 4.80531439717816,
			 8.35033802575816, "contGamma:contcor1", 6.45042819639828, 6.39198586843421,
			 "<unicode>", 0.996184224613874, "contGamma:contcor1", 0.890944046691836,
			 153, 268, 0.00354183995821886, 0.25977535929905, "contcor2:contcor1",
			 0.133903492933682, 0.135746354510703, "<unicode>", 1.00650551401279,
			 "debCollin1:contcor1", 0.0721020496581444, 115, 158, 0.32143384786382,
			 0.553417826691855, "debCollin1:contcor1", 0.434602213343864,
			 0.434525273312933, "<unicode>", 1.00298262112193, "debCollin1:contcor1",
			 0.0601561453858063, 154, 189, 0.899642004892176, 1.47781954339809,
			 "contcor2:contcor1", 1.1630830447947, 1.14630374823554, "<unicode>",
			 1.01544125026956, "contcor2:contcor1", 0.15295684117786, 132
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(177, -0.275808570910053, 0.135139982716002, 16, "contGamma", "contNormal",
			 "", "", -0.0542974609436105, -0.0526382571047812, "<unicode>",
			 "", "", 1.02358948200828, 0.110968553012002, 125, 205, -0.168267735287589,
			 0.103784823726134, 50, "contGamma", "contNormal", "", "", -0.0358662977143032,
			 -0.0427217170159061, "<unicode>", "", "", 1.00915043686407,
			 0.0738492247871874, 119, 126, -0.229909886484591, 0.213442155049441,
			 84, "contGamma", "contNormal", "", "", -0.0162387489281919,
			 -0.00647805284131168, "<unicode>", "", "", 1.00361345745717,
			 0.116603034084106, 182, 77, -0.0308951463076651, 0.0684905496298838,
			 16, "contGamma", "debCollin1", "contNormal", "", 0.0128149000886099,
			 0.00844439599203981, "<unicode>", "<unicode>", "", 1.03140320885034,
			 0.0264162083465861, 131, 51, -0.0316736407390465, 0.0358264420446206,
			 50, "contGamma", "debCollin1", "contNormal", "", 0.00283621539520366,
			 0.00119105207562025, "<unicode>", "<unicode>", "", 1.00057769607234,
			 0.0158949876932259, 94, 48, -0.147513013966039, 0.0229600220463294,
			 84, "contGamma", "debCollin1", "contNormal", "", -0.0333259812678073,
			 -0.0231854613579279, "<unicode>", "<unicode>", "", 1.00660861473762,
			 0.040144255469549, 79, 111, -0.0117635039998778, 0.0994526646505732,
			 16, "contGamma", "contcor2", "contNormal", "", 0.0309443197842176,
			 0.0260629622203449, "<unicode>", "<unicode>", "", 0.996955600937382,
			 0.0298390959355989, 176, 135, -0.0391305761658039, 0.0101882503922747,
			 50, "contGamma", "contcor2", "contNormal", "", -0.00737491766204121,
			 -0.00426072341370824, "<unicode>", "<unicode>", "", 1.00798996994218,
			 0.0128655799628578, 174, 213, -0.0958814725084221, 0.0782852170719191,
			 84, "contGamma", "contcor2", "contNormal", "", -0.0034720985075909,
			 -0.00191934343315237, "<unicode>", "<unicode>", "", 1.01539650382118,
			 0.038650639701828, 90, 131, -0.010307213653879, 0.00477421172563567,
			 16, "contGamma", "debCollin1", "contcor2", "contNormal", -0.0011189246048764,
			 -0.000184469784636936, "<unicode>", "<unicode>", "<unicode>",
			 1.00264084083032, 0.00374397291182053, 108, 157, -0.00229974590847363,
			 0.00828621390730911, 50, "contGamma", "debCollin1", "contcor2",
			 "contNormal", 0.00119932138853538, 0.000442702425625545, "<unicode>",
			 "<unicode>", "<unicode>", 1.00176897516959, 0.00249971154296775,
			 154, 207, -0.0179700326138609, 0.0202486421060993, 84, "contGamma",
			 "debCollin1", "contcor2", "contNormal", 0.000503703575685516,
			 8.10830029895063e-05, "<unicode>", "<unicode>", "<unicode>",
			 0.999683861503869, 0.00941411827492918, 154))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(217, -0.171327614056782, 0.102782015231311, "contGamma", -0.0365317990303702,
			 -0.0418777600511372, "<unicode>", "Normal(0,10)", 1.00909703881537,
			 "contNormal", 0.0738709085378675, 119, 42, -3.02270747075732,
			 2.6813403011509, "debCollin1", -0.371682224533866, -0.256513249484595,
			 "<unicode>", "Normal(0,10)", 0.99764939454049, "contNormal",
			 1.42873743618577, 44, 185, -0.457924717142675, 0.101514757286179,
			 "contcor2", -0.175363609102555, -0.164118096269952, "<unicode>",
			 "Normal(0,10)", 0.995162915337333, "contNormal", 0.157376844082819,
			 133, 35, -3.87291493498198, 0.532890606599057, "contcor1", -1.36107615944925,
			 -1.1891720531998, "<unicode>", "Normal(0,10)", 1.07047849036987,
			 "contNormal", 1.05486001717841, 38, 120, -0.137550179954608,
			 0.182780483415851, "contGamma:contcor1", 0.0189601514548989,
			 0.0205049645561597, "<unicode>", "Normal(0,10)", 1.01012475769861,
			 "contNormal", 0.0862224586045567, 105, 36, -0.163391008186561,
			 5.73338601088047, "debCollin1:contcor1", 2.38880232388476, 2.21704801976723,
			 "<unicode>", "Normal(0,10)", 1.07669469468212, "contNormal",
			 1.46980790921254, 30, 128, -0.0380991249803821, 0.384649260266025,
			 "contcor2:contcor1", 0.149197712307822, 0.137462690193646, "<unicode>",
			 "Normal(0,10)", 1.01682556406022, "contNormal", 0.115640238184845,
			 67, 186, -0.0203184555331684, -0.000538861197558563, "contGamma",
			 -0.00954820454155247, -0.00974629232199614, "<unicode>", "Normal(0,10)",
			 0.999677966897613, "debCollin1", 0.00530711300286251, 174, 182,
			 -0.0145036512542889, 0.0349983693197879, "contcor1", 0.0100376674825167,
			 0.0103899726910177, "<unicode>", "Normal(0,10)", 1.01607038426882,
			 "debCollin1", 0.0138668619698064, 141, 213, -0.0150108300106777,
			 0.00447195480022574, "contGamma:contcor1", -0.00466963341160988,
			 -0.00427179390633951, "<unicode>", "Normal(0,10)", 0.995688740393847,
			 "debCollin1", 0.0055167921852916, 154, 68, -0.066604873563402,
			 0.112416679247436, "contGamma", 0.0364142177539807, 0.0410622181932373,
			 "<unicode>", "Normal(0,10)", 1.03452859705849, "contcor2", 0.0473100187605896,
			 39, 82, -1.31409017934437, 2.40647607983376, "debCollin1", 0.74012749145394,
			 0.753539474148783, "<unicode>", "Normal(0,10)", 1.00054648649295,
			 "contcor2", 0.915977746458927, 95, 54, -1.66882976429711, 0.784096973970611,
			 "contcor1", -0.514954755326596, -0.466928247255296, "<unicode>",
			 "Normal(0,10)", 1.00002410696236, "contcor2", 0.628314689576311,
			 119, 196, 0.0471708235738498, 0.244548662384499, "contGamma:contcor1",
			 0.144614316342151, 0.144386660259724, "<unicode>", "Normal(0,10)",
			 0.996066595452289, "contcor2", 0.051462906624702, 178, 52, -0.292083106603687,
			 2.96906743033714, "debCollin1:contcor1", 1.33250883565482, 1.26995055417509,
			 "<unicode>", "Normal(0,10)", 0.999457132368307, "contcor2",
			 0.877251472918554, 159))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(168, -0.229888128438477, 0.183386251802722, 16, "Total", "contGamma",
			 "contNormal", -0.0116571656756594, -0.0178115906036081, "<unicode>",
			 1.02283071221286, 0.10796559857616, 117, 211, -0.17075125886646,
			 0.10008672835248, 50, "Total", "contGamma", "contNormal", -0.0392056785926054,
			 -0.0417135876411455, "<unicode>", 1.00997759834964, 0.0719923914891438,
			 160, 187, -0.261035217242943, 0.166476706355164, 84, "Total",
			 "contGamma", "contNormal", -0.0525331251279045, -0.0567149141809501,
			 "<unicode>", 0.998413540630917, 0.115299341599497, 226, 89,
			 -0.0189873218128162, 0.138340995809853, 16, "Total indirect",
			 "contGamma", "contNormal", 0.0426402952679511, 0.035893261515114,
			 "<unicode>", 1.01170995157251, 0.0391807711817869, 179, 86,
			 -0.0495212998632798, 0.0341999264316945, 50, "Total indirect",
			 "contGamma", "contNormal", -0.00333938087830216, -0.00141108342427522,
			 "<unicode>", 1.00571719162133, 0.0205681515626569, 94, 127,
			 -0.155674965567878, 0.0551924548137004, 84, "Total indirect",
			 "contGamma", "contNormal", -0.0362943761997126, -0.0334315939090948,
			 "<unicode>", 1.01938916943299, 0.0533430966999055, 86))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")

})
test_that("Test that model number 92 - factor works", {

options <- jaspTools::analysisOptions("BayesianProcess")
options$priorDistributions <- TRUE
options$mcmcBurnin <- 50
options$mcmcSamples <- 200
options$mcmcChains <- 1
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1", "debMiss1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$nuPriorMu <- 0
options$nuPriorSigma <- 32
options$betaPriorMu <- 0
options$betaPriorSigma <- 10
options$psiPriorAlpha <- 1
options$psiPriorBeta <- 0.5
options$rhoPriorAlpha <- 1
options$rhoPriorBeta <- 1
options$statisticalPathPlotsParameterEstimates <- TRUE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- TRUE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- TRUE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "mediators", processVariable = "contcor2"),
        list(processDependent = "debCollin1", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contcor2", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contcor2", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "contcor2",
            processType = "moderators", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE))
set.seed(1)
results <- jaspTools::runAnalysis("BayesianProcess", "debug", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 100, 584.069822460395, 488.316157878161, 44.9758020214324,
			 0.55, 488.62602992787, 45.1152011123544))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(210, -0.14548024180859, 0.00993727286020846, "contcor2:facExperimexperimental",
			 -0.0613867845216191, -0.0586202785400696, "<unicode>", 0.997351349081167,
			 "facGenderm", 0.0388483207128193, 98, 230, -0.0116661150918764,
			 0.0478940371178568, "debCollin1:facExperimexperimental", 0.0168703376962565,
			 0.0164128644326358, "<unicode>", 0.995269889541758, "facGenderm",
			 0.0153563678165195, 181, 273, 0.0980305709104427, 0.20626783598027,
			 "facGenderm:facExperimexperimental", 0.142688501057604, 0.138938312271232,
			 "<unicode>", 0.999710802856613, "facGenderm", 0.0286386363573581,
			 184, 231, -0.0154158013060165, 0.077730185739807, "facExperimexperimental",
			 0.0288366790491011, 0.0275571040369146, "<unicode>", 0.995252827827918,
			 "facGenderm", 0.0233485700119959, 154, 228, 0.201857454173867,
			 0.35252953583533, "facGenderm", 0.262603290556152, 0.257953818262238,
			 "<unicode>", 1.0050635074055, "facGenderm", 0.0411287956675893,
			 182, 233, 0.911475492223662, 1.48077453719536, "contNormal",
			 1.15723622985875, 1.14498776417876, "<unicode>", 0.995031107848849,
			 "contNormal", 0.150608231601935, 151, 202, 0.00237451609091437,
			 0.00462593351591823, "debCollin1:facExperimexperimental", 0.00346853350520858,
			 0.00346296740650487, "<unicode>", 0.999112008145428, "debCollin1",
			 0.000615871062762418, 175, 151, 0.00519445882264803, 0.00912299481301502,
			 "debCollin1", 0.00704155752021054, 0.00703211119242686, "<unicode>",
			 1.00241913351835, "debCollin1", 0.000982753393790093, 114, 204,
			 0.280930009269591, 0.578935664778193, "contcor2:facExperimexperimental",
			 0.4121991073061, 0.409432087063689, "<unicode>", 0.996458265994099,
			 "contcor2", 0.0743828813182682, 159, 207, 0.75949307064088,
			 1.2676158480703, "contcor2", 0.982641085311603, 0.972933314989139,
			 "<unicode>", 1.00200328009245, "contcor2", 0.135930223199393,
			 145, 172, -0.0776862401564546, 0.0502157422898664, "contcor2:facExperimexperimental",
			 -0.0117292709235911, -0.0134596008871145, "<unicode>", 1.02299949726502,
			 "facExperimexperimental", 0.0334992305116483, 153, 188, 0.123269112591822,
			 0.20907433750654, "debCollin1:facExperimexperimental", 0.160772284845901,
			 0.160429531837691, "<unicode>", 1.0051890765662, "facExperimexperimental",
			 0.0232724806616865, 119, 216, 0.0877043492977858, 0.179575667977402,
			 "facGenderm:facExperimexperimental", 0.135008487655825, 0.135094947676227,
			 "<unicode>", 1.02116457509535, "facExperimexperimental", 0.0237812981174452,
			 135, 195, 0.185591189863999, 0.318433015133931, "facExperimexperimental",
			 0.245386233442406, 0.246358341192371, "<unicode>", 1.0029314079645,
			 "facExperimexperimental", 0.0355626291492782, 136, 193, -0.131124286585158,
			 -0.0134780397200215, "contcor2:facExperimexperimental", -0.0674387325545526,
			 -0.0683870701168769, "<unicode>", 1.01304753437513, "facGenderm:facExperimexperimental",
			 0.0291107605344081, 184, 217, 0.0535666932397299, 0.115670608318718,
			 "debCollin1:facExperimexperimental", 0.0864801769238518, 0.0870120555591117,
			 "<unicode>", 1.01346034789039, "facGenderm:facExperimexperimental",
			 0.0157594710370967, 135, 249, 0.158858055346893, 0.260306253085984,
			 "facGenderm:facExperimexperimental", 0.203873724410715, 0.201683310266616,
			 "<unicode>", 0.995908369619582, "facGenderm:facExperimexperimental",
			 0.0276890490170202, 226, 192, -0.0473551754677446, 0.0385894875681272,
			 "contcor2:facExperimexperimental", -0.0049842031002344, -0.00673745230388707,
			 "<unicode>", 1.01632664186557, "debCollin1:facExperimexperimental",
			 0.0218974363721487, 183, 194, 0.0828114118168054, 0.140930151088636,
			 "debCollin1:facExperimexperimental", 0.109029400903246, 0.107787913466649,
			 "<unicode>", 1.00554895644146, "debCollin1:facExperimexperimental",
			 0.0155045540331503, 137, 194, 0.359822106197521, 0.60771121439867,
			 "contcor2:facExperimexperimental", 0.472996269740263, 0.468529064850791,
			 "<unicode>", 0.996705328418717, "contcor2:facExperimexperimental",
			 0.0693997707189495, 180))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(236, -0.0518752756017219, 1.22957751953918, 0, "m", "facGender",
			 "contNormal", "", "", 0.582654120006802, 0.615475330825557,
			 "<unicode>", "", "", 1.0152517158362, 0.313866861496867, 154,
			 230, -0.312553245182946, 0.886305854691828, 1, "m", "facGender",
			 "contNormal", "", "", 0.290762031077183, 0.293727655850956,
			 "<unicode>", "", "", 1.00208021026232, 0.311279157449343, 185,
			 201, -0.102735569950054, 0.113975364530438, 0, "m", "facGender",
			 "debCollin1", "contNormal", "", 0.00177974111919742, -0.00164555229339842,
			 "<unicode>", "<unicode>", "", 0.997842084473517, 0.0534449654300415,
			 160, 142, -0.099598989895067, 0.100867640621091, 1, "m", "facGender",
			 "debCollin1", "contNormal", "", -0.00142177583365537, -0.000380803049861373,
			 "<unicode>", "<unicode>", "", 0.998115840116994, 0.0460966956356569,
			 115, 220, -0.101601919283666, 0.128166247538173, 0, "m", "facGender",
			 "contcor2", "contNormal", "", 0.0107723536985146, 0.00662936557555282,
			 "<unicode>", "<unicode>", "", 1.0012085830425, 0.0557989278464335,
			 159, 303, -0.13744996507274, 0.220847265017364, 1, "m", "facGender",
			 "contcor2", "contNormal", "", 0.0316306331564096, 0.0205563918598094,
			 "<unicode>", "<unicode>", "", 1.0050492065917, 0.0941282567597633,
			 138, 161, -0.0106866462477822, 0.0235610317327667, 0, "m", "facGender",
			 "debCollin1", "contcor2", "contNormal", 0.000776609222954959,
			 1.72136538209083e-06, "<unicode>", "<unicode>", "<unicode>",
			 1.03855275828785, 0.00776363266573184, 149, 113, -0.0117018258960869,
			 0.0172866683271553, 1, "m", "facGender", "debCollin1", "contcor2",
			 "contNormal", 0.000806109832392187, 0.000101087186742864, "<unicode>",
			 "<unicode>", "<unicode>", 0.995224876747817, 0.00626518516987644,
			 169))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(236, -0.0518752756017219, 1.22957751953918, "facGenderm", 0.582654120006802,
			 0.615475330825557, "<unicode>", "Normal(0,10)", 1.0152517158362,
			 "contNormal", 0.313866861496867, 154, 46, -4.35405751008383,
			 3.37573574594911, "debCollin1", -0.441026328617109, -0.39126284186852,
			 "<unicode>", "Normal(0,10)", 1.01163028359348, "contNormal",
			 2.11279535435066, 24, 275, -0.134156130441194, 0.401964887248652,
			 "contcor2", 0.159334261104541, 0.155435457073014, "<unicode>",
			 "Normal(0,10)", 0.995401118821998, "contNormal", 0.137262434232135,
			 180, 47, -3.3385781762224, 4.10656465042248, "facExperimexperimental",
			 -0.0858811802095078, -0.0907940609395766, "<unicode>", "Normal(0,10)",
			 1.07444799910294, "contNormal", 1.81363431929954, 72, 188, -1.17253635919084,
			 0.610060790743623, "facGenderm:facExperimexperimental", -0.291892088929619,
			 -0.283660974554066, "<unicode>", "Normal(0,10)", 1.01887642035504,
			 "contNormal", 0.472045309824427, 128, 47, -5.60660366754573,
			 5.10497496265398, "debCollin1:facExperimexperimental", 0.390765478584677,
			 0.46538699922998, "<unicode>", "Normal(0,10)", 1.05598801457918,
			 "contNormal", 2.70009936959445, 70, 395, -0.631777906521986,
			 0.199743883942643, "contcor2:facExperimexperimental", -0.221806237743865,
			 -0.240824448263662, "<unicode>", "Normal(0,10)", 0.995486291360664,
			 "contNormal", 0.22853380185395, 217, 188, -0.0431913462797118,
			 0.0528002792020619, "facGenderm", 0.00479461684227395, 0.00524219060420158,
			 "<unicode>", "Normal(0,10)", 1.02053515601898, "debCollin1",
			 0.0245175335204979, 109, 168, -0.0468035636746225, 0.0438990799884473,
			 "facExperimexperimental", -0.00434258837971164, -0.00722342403446915,
			 "<unicode>", "Normal(0,10)", 1.0199638968913, "debCollin1",
			 0.023762934224901, 177, 171, -0.0824764463144492, 0.0446110109343423,
			 "facGenderm:facExperimexperimental", -0.0212346285520639, -0.0203839760527029,
			 "<unicode>", "Normal(0,10)", 1.03913235792459, "debCollin1",
			 0.0347062567914027, 153, 247, -0.520589064913483, 0.445329569447867,
			 "facGenderm", 0.0498834797537964, 0.0690473816697686, "<unicode>",
			 "Normal(0,10)", 1.00428934806581, "contcor2", 0.241676617661193,
			 184, 47, -3.03617148003995, 2.56798865996427, "debCollin1",
			 -0.490760850469048, -0.591813598209525, "<unicode>", "Normal(0,10)",
			 1.04880094660853, "contcor2", 1.40319758748361, 67, 35, -3.150656608125,
			 2.27745741549632, "facExperimexperimental", -0.613981115984369,
			 -0.600920954698516, "<unicode>", "Normal(0,10)", 1.01948958146973,
			 "contcor2", 1.45917618889767, 38, 208, -1.15420304340932, 0.271860525682201,
			 "facGenderm:facExperimexperimental", -0.518689159040158, -0.523637430545145,
			 "<unicode>", "Normal(0,10)", 1.01780347609523, "contcor2", 0.34857722785759,
			 132, 38, -3.20756150456861, 4.88949508666237, "debCollin1:facExperimexperimental",
			 0.975116720297292, 0.786092121251578, "<unicode>", "Normal(0,10)",
			 1.02080602489766, "contcor2", 2.19777691772519, 41))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(228, -0.0321155323009918, 1.20408082459343, 0, "m", "Total", "facGender",
			 "contNormal", 0.595982824047469, 0.603160608589289, "<unicode>",
			 1.00885026279484, 0.320378924163339, 154, 250, -0.190177401247781,
			 0.908304835953452, 1, "m", "Total", "facGender", "contNormal",
			 0.321776998232329, 0.307621900413255, "<unicode>", 1.00036538549533,
			 0.292105073469583, 128, 198, -0.170323158490935, 0.168522082209333,
			 0, "m", "Total indirect", "facGender", "contNormal", 0.013328704040667,
			 0.00742896295408757, "<unicode>", 0.999132733180667, 0.0819951894056363,
			 228, 380, -0.152032802405208, 0.278822423708187, 1, "m", "Total indirect",
			 "facGender", "contNormal", 0.0310149671551464, 0.0181320210143685,
			 "<unicode>", 1.01205617138772, 0.106506111021748, 217))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")

})
