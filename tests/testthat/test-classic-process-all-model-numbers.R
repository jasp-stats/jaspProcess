# This code is automatically generated by 'generate-tests.R'

context('Integration tests for variable input across all hard-coded model number settings')


context('Model number 1 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(961.745418061927, 987.797119921808, 107.886787714819, 2, 1, 100,
			 3.73836509114558e-24, 0, 107.886787714819, 2))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 1))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544847446529868, 0.0642087015816481, -0.24031937247411, "contcor1",
			 "<unicode>", 0.121932638176643, "contGamma", 0.155374321394595,
			 -1.54671229014597, 0.776405337508051, 1.37186438137463, 1.07413485944134,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.151905608614108, 7.07106781139337, 1.68041002565803, 2.96918811058909,
			 2.32479906812356, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328775960960707, 7.07107375286906, 0.732634458077826,
			 1.29452348183273, 1.01357896995528, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341670609004, 7.07106988253289
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.165693732585693, 0.204085235411637, 16, 0.019195751412972,
			 "contGamma", "contNormal", "<unicode>", 0.83875282050795, 0.0943331027799745,
			 0.203489028212555, -0.161247504646519, 0.108820285393298, 50,
			 -0.0262136096266104, "contGamma", "contNormal", "<unicode>",
			 0.70358895088867, 0.0688961103801082, -0.380480254719558, -0.278343436805976,
			 0.126799125165147, 84, -0.0757721558204142, "contGamma", "contNormal",
			 "<unicode>", 0.46348030869911, 0.103354593545299, -0.733128090598164
			))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161055682276156, 0.108967818914664, -0.0260439316807462, "contGamma",
			 "<unicode>", 0.70537157543225, "contNormal", 0.0688848119967334,
			 -0.378079447788596, -0.087890843847416, 0.604701028445567, 0.258405092299076,
			 "contcor1", "<unicode>", 0.143598813836565, "contNormal", 0.176684846700261,
			 1.46251983192113, -0.182864140332991, 0.0896344997483065, -0.0466148202923424,
			 "contGamma:contcor1", "<unicode>", 0.502500755248928, "contNormal",
			 0.069516236581573, -0.670560182550198))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.165693732585693, 0.204085235411637, 16, 0.019195751412972,
			 "Total", 0.83875282050795, 0.0943331027799745, 0.203489028212555,
			 -0.161247504646519, 0.108820285393298, 50, -0.0262136096266104,
			 "Total", 0.70358895088867, 0.0688961103801082, -0.380480254719558,
			 -0.278343436805976, 0.126799125165147, 84, -0.0757721558204142,
			 "Total", 0.46348030869911, 0.103354593545299, -0.733128090598164,
			 -0.165693732585693, 0.204085235411637, 0.019195751412972, "Total indirect",
			 0.83875282050795, 0.0943331027799745, 0.203489028212555))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")
})


context('Model number 1 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(58206.011431205, 58278.1148349248, 12181.574393179, 2, 1, 10000,
			 0, 0, 12181.574393179, 2))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 1))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.035037759765976, 0.0449622243059265, 0.0399999920359513, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00253179768052712, 15.7990475872556,
			 1.07829654366037, 1.13977728009632, 1.10903691187834, "contNormal",
			 "<unicode>", 0, "contNormal", 0.01568414953563, 70.7106821035414,
			 0.243070477306064, 0.256929515130388, 0.249999996218226, "facGenderm",
			 "<unicode>", 0, "facGenderm", 0.00353553379899895, 70.7106791876832,
			 0.243070477319947, 0.256929515145748, 0.249999996232847, "facExperimexperimental",
			 "<unicode>", 0, "facExperimexperimental", 0.00353553379937572,
			 70.7106791842835))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0591421961534589, 0.0591421961534589, 2.26600416031625e-21,
			 0, "facGenderm", "contNormal", "<unicode>", 1, 0.0301751443495722,
			 7.50950561848224e-20, -0.0591421961534589, 0.0591421961534589,
			 -4.51653439965801e-22, 1, "facGenderm", "contNormal", "<unicode>",
			 1, 0.0301751443495722, -1.4967730882527e-20))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0591421961534589, 0.0591421961534589, 2.26600416031625e-21,
			 "facGenderm", "<unicode>", 1, "contNormal", 0.0301751443495722,
			 7.50950561848224e-20, -0.0591421961534588, 0.0591421961534588,
			 2.25611953848175e-21, "facExperimexperimental", "<unicode>",
			 1, "contNormal", 0.0301751443495722, 7.47674812204745e-20, -0.0836396959087514,
			 0.0836396959087514, -2.71765760028206e-21, "facGenderm:facExperimexperimental",
			 "<unicode>", 1, "contNormal", 0.0426740983857309, -6.36840074678829e-20
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0591421961534589, 0.0591421961534589, 2.26600416031625e-21,
			 0, "Total", 1, 0.0301751443495722, 7.50950561848224e-20, -0.0591421961534589,
			 0.0591421961534589, -4.51653439965801e-22, 1, "Total", 1, 0.0301751443495722,
			 -1.4967730882527e-20, -0.0591421961534589, 0.0591421961534589,
			 2.26600416031625e-21, "Total indirect", 1, 0.0301751443495722,
			 7.50950561848224e-20))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")
})


context('Model number 2 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1199.86016487037, 1241.54288784618, 244.453837403888, 6, 1, 100,
			 6.279621239127e-50, 0, 244.453837403888, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 2))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544852239634038, 0.0642073195366679, -0.240322460048685, "contcor1",
			 "<unicode>", 0.121929934031074, "contGamma", 0.155375191578746,
			 -1.54672349946476, -0.403935961326604, 0.194628076636832, -0.104653942344886,
			 "contcor2", "<unicode>", 0.493112492525023, "contGamma", 0.152697713500052,
			 -0.68536679394908, 0.424979647458112, 0.896764914455866, 0.660872280956989,
			 "contcor2", "<unicode>", 3.99669932704683e-08, "contcor1", 0.120355596000522,
			 5.49099753495567, 0.770361876488219, 1.36118592810279, 1.06577390229551,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.150723190904251, 7.07106780251589, 1.68041317990781, 2.96919911245791,
			 2.32480614618286, "contGamma", "<unicode>", 1.53765888910584e-12,
			 "contGamma", 0.328777962941125, 7.07105222438272, 0.732635390108398,
			 1.29452673272075, 1.01358106141457, "contcor1", "<unicode>",
			 1.53765888910584e-12, "contcor1", 0.14334226216514, 7.07105529175237,
			 0.721542190476358, 1.27492493434763, 0.998233562411992, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171661376505,
			 7.07106194457612))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175157417862338, 0.198979765663264, 16, 16, 0.0119111739004626,
			 "contGamma", "contNormal", "<unicode>", 0.90068480075145, 0.0954449128853255,
			 0.124796320101141, -0.250367660975988, 0.256905887306879, 50,
			 16, 0.00326911316544523, "contGamma", "contNormal", "<unicode>",
			 0.979846072297494, 0.129408895337918, 0.0252618891221409, -0.47766089956629,
			 0.465335704067805, 84, 16, -0.00616259774924233, "contGamma",
			 "contNormal", "<unicode>", 0.979562661301586, 0.24056477850418,
			 -0.0256172070889224, -0.285600590853229, 0.255933194292432,
			 16, 50, -0.0148336982803985, "contGamma", "contNormal", "<unicode>",
			 0.914491723381505, 0.13814891228033, -0.107374701946969, -0.158318804902544,
			 0.111367286871712, 50, 50, -0.0234757590154159, "contGamma",
			 "contNormal", "<unicode>", 0.732935187571585, 0.0687987365843215,
			 -0.341223693645063, -0.322690983515153, 0.256876043654946, 84,
			 50, -0.0329074699301035, "contGamma", "contNormal", "<unicode>",
			 0.823869276035411, 0.147851448226001, -0.222571170759195, -0.537941371057952,
			 0.445575783894927, 16, 84, -0.0461827935815127, "contGamma",
			 "contNormal", "<unicode>", 0.85396075704191, 0.250901843786605,
			 -0.184067174973779, -0.350939326724909, 0.241289618091849, 50,
			 84, -0.0548248543165301, "contGamma", "contNormal", "<unicode>",
			 0.716692710698469, 0.151081588612899, -0.362882432067896, -0.277371728597629,
			 0.148858598135193, 84, 84, -0.0642565652312177, "contGamma",
			 "contNormal", "<unicode>", 0.55455345818774, 0.108734224224239,
			 -0.590950693672156))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.157312073939047, 0.112101952335994, -0.0226050608015264, "contGamma",
			 "<unicode>", 0.742231451525843, "contNormal", 0.068729330844889,
			 -0.328899765553405, -0.219434253187456, 0.758255176249311, 0.269410461530927,
			 "contcor1", "<unicode>", 0.280067025788109, "contNormal", 0.249415151795813,
			 1.08016878522073, -0.585977004610917, 0.452208164679563, -0.066884419965677,
			 "contcor2", "<unicode>", 0.800624574282114, "contNormal", 0.264848022075801,
			 -0.252538869051981, -0.250025868401674, 0.232282914134284, -0.00887147713369474,
			 "contGamma:contcor1", "<unicode>", 0.942520530816259, "contNormal",
			 0.123040215621396, -0.0721022560704292, -0.259036779071225,
			 0.202956107691772, -0.0280403356897265, "contGamma:contcor2",
			 "<unicode>", 0.811945244166677, "contNormal", 0.117857493914975,
			 -0.237917291113924))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175157417862338, 0.198979765663264, 16, 16, 0.0119111739004626,
			 "Total", 0.90068480075145, 0.0954449128853255, 0.124796320101141,
			 -0.250367660975988, 0.256905887306879, 50, 16, 0.00326911316544523,
			 "Total", 0.979846072297494, 0.129408895337918, 0.0252618891221409,
			 -0.47766089956629, 0.465335704067805, 84, 16, -0.00616259774924233,
			 "Total", 0.979562661301586, 0.24056477850418, -0.0256172070889224,
			 -0.285600590853229, 0.255933194292432, 16, 50, -0.0148336982803985,
			 "Total", 0.914491723381505, 0.13814891228033, -0.107374701946969,
			 -0.158318804902544, 0.111367286871712, 50, 50, -0.0234757590154159,
			 "Total", 0.732935187571585, 0.0687987365843215, -0.341223693645063,
			 -0.322690983515153, 0.256876043654946, 84, 50, -0.0329074699301035,
			 "Total", 0.823869276035411, 0.147851448226001, -0.222571170759195,
			 -0.537941371057952, 0.445575783894927, 16, 84, -0.0461827935815127,
			 "Total", 0.85396075704191, 0.250901843786605, -0.184067174973779,
			 -0.350939326724909, 0.241289618091849, 50, 84, -0.0548248543165301,
			 "Total", 0.716692710698469, 0.151081588612899, -0.362882432067896,
			 -0.277371728597629, 0.148858598135193, 84, 84, -0.0642565652312177,
			 "Total", 0.55455345818774, 0.108734224224239, -0.590950693672156,
			 -0.175157417862338, 0.198979765663264, 0.0119111739004626, "Total indirect",
			 0.90068480075145, 0.0954449128853255, 0.124796320101141))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")
})


context('Model number 2 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(888.390142595547, 930.072865571356, 182.597210277056, 6, 1, 100,
			 9.52644444511261e-37, 0, 182.597210277056, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 2))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0096223268359578, 0.0896223175830675, 0.0399999953735549, "facExperimexperimental",
			 "<unicode>", 0.11412864551353, "facGenderm", 0.0253179765551445,
			 1.57990490616151, -0.163250713701503, 0.0341991764116733, -0.0645257686449151,
			 "contcor2", "<unicode>", 0.200188229807913, "facGenderm", 0.0503707955020185,
			 -1.28101547735789, -0.170527239521528, 0.0272978261644033, -0.0716147066785622,
			 "contcor2", "<unicode>", 0.155883213071662, "facExperimexperimental",
			 0.0504665053149828, -1.41905420697519, 0.756348936485806, 1.33642585351503,
			 1.04638739500042, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.147981524559838, 7.07106781142329, 0.180704804599393,
			 0.31929517662654, 0.249999990612966, "facGenderm", "<unicode>",
			 1.53743684450092e-12, "facGenderm", 0.035355336404222, 7.07106807738116,
			 0.180704807997164, 0.319295188477511, 0.249999998237338, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553385606906, 7.07106786173721, 0.721541791202578, 1.2749235416926,
			 0.998232666447587, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171407958264, 7.07106829126975))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161065462177506, 1.33098043661317, 16, 0.584957487217831, 0,
			 "facGenderm", "contNormal", "<unicode>", 0.124339818084807,
			 0.380630947956121, 1.5368101053235, -0.3588750440452, 1.00789206260258,
			 16, 0.32450850927869, 1, "facGenderm", "contNormal", "<unicode>",
			 0.352008831950457, 0.348671485146836, 0.930699879693432, 0.0267424851699203,
			 1.18684632304749, 50, 0.606794404108703, 0, "facGenderm", "contNormal",
			 "<unicode>", 0.0403326883359361, 0.295950294757536, 2.05032539199136,
			 -0.23834961549072, 0.931040467829845, 50, 0.346345426169562,
			 1, "facGenderm", "contNormal", "<unicode>", 0.24564633822618,
			 0.298319278452197, 1.16098908513907, -0.0593588649568759, 1.32414010991992,
			 84, 0.632390622481523, 0, "facGenderm", "contNormal", "<unicode>",
			 0.0731682258804882, 0.352939897311803, 1.79177992428224, -0.399560650492704,
			 1.14344393957747, 84, 0.371941644542382, 1, "facGenderm", "contNormal",
			 "<unicode>", 0.344710124075188, 0.393630852975155, 0.944899622911056
			))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0242260928547405, 1.18799361531017, 0.606109854082454, "facGenderm",
			 "<unicode>", 0.0411947062745897, "contNormal", 0.296884925344311,
			 2.04156493759163, -0.427734844483697, 0.721274257630731, 0.146769706573517,
			 "facExperimexperimental", "<unicode>", 0.616571355539647, "contNormal",
			 0.293119953013848, 0.500715509348433, -0.226807989820042, 0.320133541183245,
			 0.0466627756816015, "contcor2", "<unicode>", 0.738053637802817,
			 "contNormal", 0.139528464634425, 0.334431944075794, -1.08932599530197,
			 0.568428039423691, -0.260448977939141, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.537988184270879, "contNormal", 0.422904208394087,
			 -0.615858089774409, -0.392685638199718, 0.438474937614422, 0.022894649707352,
			 "facGenderm:contcor2", "<unicode>", 0.914014745957984, "contNormal",
			 0.212034655322809, 0.107975980023154))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161065462177506, 1.33098043661317, 16, 0.584957487217831, 0,
			 "Total", 0.124339818084807, 0.380630947956121, 1.5368101053235,
			 -0.3588750440452, 1.00789206260258, 16, 0.32450850927869, 1,
			 "Total", 0.352008831950457, 0.348671485146836, 0.930699879693432,
			 0.0267424851699203, 1.18684632304749, 50, 0.606794404108703,
			 0, "Total", 0.0403326883359361, 0.295950294757536, 2.05032539199136,
			 -0.23834961549072, 0.931040467829845, 50, 0.346345426169562,
			 1, "Total", 0.24564633822618, 0.298319278452197, 1.16098908513907,
			 -0.0593588649568759, 1.32414010991992, 84, 0.632390622481523,
			 0, "Total", 0.0731682258804882, 0.352939897311803, 1.79177992428224,
			 -0.399560650492704, 1.14344393957747, 84, 0.371941644542382,
			 1, "Total", 0.344710124075188, 0.393630852975155, 0.944899622911056,
			 -0.161065462177506, 1.33098043661317, 0.584957487217831, "Total indirect",
			 0.124339818084807, 0.380630947956121, 1.5368101053235))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")
})


context('Model number 3 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1687.57806167313, 1747.49697595086, 388.059054866021, 12, 1, 100,
			 1.2749197624573e-75, 0, 388.059054866021, 12))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 3))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54484693080317, 0.0642082814704822, -0.240319324666344, "contcor1",
			 "<unicode>", 0.121932139072065, "contGamma", 0.155374082656059,
			 -1.5467143590371, -0.403931808182952, 0.194628195443409, -0.104651806369771,
			 "contcor2", "<unicode>", 0.493118403123773, "contGamma", 0.152696684313519,
			 -0.685357425017156, 1.37709101268283, 3.45910145778441, 2.41809623523362,
			 "contGamma__contcor1__contcor2", "<unicode>", 5.29624837541931e-06,
			 "contGamma", 0.531134873274259, 4.55269717148662, 0.424978654015584,
			 0.896761857459467, 0.660870255737526, "contcor2", "<unicode>",
			 3.99653661276034e-08, "contcor1", 0.120355069574045, 5.49100472523878,
			 -0.374369299423692, 0.853226928295355, 0.239428814435831, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.444546825895241, "contcor1", 0.3131680575261,
			 0.764537789477067, -0.164886791027338, 1.06248762197478, 0.448800415473719,
			 "contGamma__contcor1__contcor2", "<unicode>", 0.151755934580698,
			 "contcor2", 0.313111471099339, 1.43335666974441, 0.760953956060781,
			 1.34456272506706, 1.05275834056392, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.148882523763118, 7.07106726803564,
			 1.68040818869688, 2.96918170342447, 2.32479494606067, "contGamma",
			 "<unicode>", 1.53721479989599e-12, "contGamma", 0.328774795071051,
			 7.07108629041429, 0.732634552314289, 1.29452381052832, 1.0135791814213,
			 "contcor1", "<unicode>", 1.53743684450092e-12, "contcor1", 0.143341730421104,
			 7.07106840725059, 0.721541406853383, 1.2749222011108, 0.998231803982093,
			 "contcor2", "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171164016895,
			 7.07107440059521, 6.95314998486222, 12.2858154225356, 9.61948270369893,
			 "contGamma__contcor1__contcor2", "<unicode>", 1.53743684450092e-12,
			 "contGamma__contcor1__contcor2", 1.36039883378899, 7.07107538228822
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197084318148257, 0.196142243832412, 16, 16, -0.000471037157922544,
			 "contGamma", "contNormal", "<unicode>", 0.996253472937876, 0.100314741771377,
			 -0.00469559258793751, -0.253421863376115, 0.257751291121816,
			 50, 16, 0.00216471387285026, "contGamma", "contNormal", "<unicode>",
			 0.986755649505179, 0.130403711121735, 0.0166000940788368, -0.464524667349792,
			 0.474607269605042, 84, 16, 0.00504130112762485, "contGamma",
			 "contNormal", "<unicode>", 0.983211877506449, 0.239578876031036,
			 0.0210423440127158, -0.336581616510582, 0.280058284344817, 16,
			 50, -0.0282616660828824, "contGamma", "contNormal", "<unicode>",
			 0.857421826794618, 0.157308987746555, -0.179657033509208, -0.212804303024389,
			 0.16155247292017, 50, 50, -0.0256259150521096, "contGamma",
			 "contNormal", "<unicode>", 0.788444108189868, 0.0955009323889206,
			 -0.268331569243218, -0.331923848816563, 0.286425193221893, 84,
			 50, -0.022749327797335, "contGamma", "contNormal", "<unicode>",
			 0.885330033443573, 0.157745001162245, -0.144215839676192, -0.611478689547961,
			 0.489805591942681, 16, 84, -0.0608365488026403, "contGamma",
			 "contNormal", "<unicode>", 0.828564874040031, 0.280945030158062,
			 -0.216542534204692, -0.434450229834436, 0.318048634290701, 50,
			 84, -0.0582007977718675, "contGamma", "contNormal", "<unicode>",
			 0.761752356295465, 0.191967523398581, -0.303180437719278, -0.357340730332477,
			 0.246692309298292, 84, 84, -0.0553242105170929, "contGamma",
			 "contNormal", "<unicode>", 0.719571485055453, 0.154092892623361,
			 -0.359031552820014))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209966825129232, 0.160437674824115, -0.0247645751525588, "contGamma",
			 "<unicode>", 0.793260308031627, "contNormal", 0.0944926801908226,
			 -0.26207929653967, -0.264231220903869, 0.718915859174445, 0.227342319135288,
			 "contcor1", "<unicode>", 0.364702107081678, "contNormal", 0.250807435196068,
			 0.906441704798597, -0.628303820152099, 0.464181975801033, -0.082060922175533,
			 "contcor2", "<unicode>", 0.768420735761631, "contNormal", 0.278700477297165,
			 -0.294441268889667, -0.168389977603542, 0.1370597805462, -0.0156650985286714,
			 "contGamma:contcor1:contcor2", "<unicode>", 0.840671294387619,
			 "contNormal", 0.0779222885111896, -0.201034887809049, -0.238546099067184,
			 0.243957541017566, 0.00270572097519125, "contGamma:contcor1",
			 "<unicode>", 0.982462584605073, "contNormal", 0.123089925093185,
			 0.0219816607504058, -0.276762995800031, 0.218489502562539, -0.0291367466187459,
			 "contGamma:contcor2", "<unicode>", 0.817611884799106, "contNormal",
			 0.126342244620069, -0.230617610969036, -0.234142004141445, 0.527681044136773,
			 0.146769519997664, "contcor1:contcor2", "<unicode>", 0.450131209066867,
			 "contNormal", 0.194346185513454, 0.755196298861776))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197084318148257, 0.196142243832412, 16, 16, -0.000471037157922544,
			 "Total", 0.996253472937876, 0.100314741771377, -0.00469559258793751,
			 -0.253421863376115, 0.257751291121816, 50, 16, 0.00216471387285026,
			 "Total", 0.986755649505179, 0.130403711121735, 0.0166000940788368,
			 -0.464524667349792, 0.474607269605042, 84, 16, 0.00504130112762485,
			 "Total", 0.983211877506449, 0.239578876031036, 0.0210423440127158,
			 -0.336581616510582, 0.280058284344817, 16, 50, -0.0282616660828824,
			 "Total", 0.857421826794618, 0.157308987746555, -0.179657033509208,
			 -0.212804303024389, 0.16155247292017, 50, 50, -0.0256259150521096,
			 "Total", 0.788444108189868, 0.0955009323889206, -0.268331569243218,
			 -0.331923848816563, 0.286425193221893, 84, 50, -0.022749327797335,
			 "Total", 0.885330033443573, 0.157745001162245, -0.144215839676192,
			 -0.611478689547961, 0.489805591942681, 16, 84, -0.0608365488026403,
			 "Total", 0.828564874040031, 0.280945030158062, -0.216542534204692,
			 -0.434450229834436, 0.318048634290701, 50, 84, -0.0582007977718675,
			 "Total", 0.761752356295465, 0.191967523398581, -0.303180437719278,
			 -0.357340730332477, 0.246692309298292, 84, 84, -0.0553242105170929,
			 "Total", 0.719571485055453, 0.154092892623361, -0.359031552820014,
			 -0.197084318148257, 0.196142243832412, -0.000471037157922544,
			 "Total indirect", 0.996253472937876, 0.100314741771377, -0.00469559258793751
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")
})


context('Model number 4 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(87.5581910272132, 105.79438232913, 0, 0, 1, 100, 1, "", 0, 0
			))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 4))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.79850843700121, 1.41091930982898, 1.1047138734151, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.156230134241852,
			 7.07106781144377, 0.00468047960523697, 0.0082701431168932, 0.00647531136106508,
			 "debCollin1", "<unicode>", 1.53743684450092e-12, "debCollin1",
			 0.000915747314739209, 7.07106781187685))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371895865663, 0.0938554961576601, -0.0432581998540016, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.536343400514189, 0.0699572528338261,
			 -0.618351894931546, -0.021152615921394, 0.0258913606804729,
			 0.00236937237953946, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.843493104874345, 0.0120012349647605,
			 0.197427380306835))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371895865663, 0.0938554961576601, -0.0432581998540016, "contGamma",
			 "<unicode>", 0.536343400514189, "contNormal", 0.0699572528338261,
			 -0.618351894931546, -2.81958314194313, 2.30044870967132, -0.259567216135903,
			 "debCollin1", "<unicode>", 0.842476879750206, "contNormal",
			 1.30615457528827, -0.198726261842795, -0.019472093871172, 0.00121576385529725,
			 -0.00912816500793735, "contGamma", "<unicode>", 0.0837015016290246,
			 "debCollin1", 0.00527761170349364, -1.72960147899755))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203402556, 0.0942455484536313, -0.0408888274744622, "Total",
			 0.553151714189203, 0.0689473770916283, -0.593043988027602, -0.021152615921394,
			 0.0258913606804729, 0.00236937237953946, "Total indirect", 0.843493104874345,
			 0.0120012349647605, 0.197427380306835))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")
})


context('Model number 4 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(3594.39323415703, 3640.01358649695, 0, 0, 1, 5000, 1, "", 0, 0
			))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 4))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.01359115565911, 1.09629726185871, 1.05494420875891, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0210988841764364, 49.9999999970182,
			 0.00638916541347027, 0.00691050282868952, 0.0066498341210799,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.00013299668242159,
			 50.000000000003))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408379788631389, 0.522421436711177, 0.465400612671283, "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0290927917500867, 15.9971107850073,
			 -0.00333264771908547, 0.00279079237651929, -0.000270927671283089,
			 "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.862309756808096, 0.00156213076972477, -0.173434693518535
			))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408379788631389, 0.522421436711177, 0.465400612671283, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0290927917500867, 15.9971107850073,
			 -0.318192879302554, 0.380043423043225, 0.0309252718703351, "debCollin1",
			 "<unicode>", 0.862167432082348, "contNormal", 0.178124778785064,
			 0.173615776992214, -0.0132813458442645, -0.00424009567573555,
			 -0.00876072076000001, "facGenderm", "<unicode>", 0.000145691021617989,
			 "debCollin1", 0.00230648375170287, -3.79830152869361))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408190776216511, 0.522068593783489, 0.465129685, "Total", 0,
			 0.0290509974839416, 16.0107991216862, -0.00333264771908547,
			 0.00279079237651929, -0.000270927671283089, "Total indirect",
			 0.862309756808096, 0.00156213076972477, -0.173434693518535
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")
})


context('Model number 5 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(749.493320586189, 785.965703190023, 108.439406341136, 4, 1, 100,
			 1.56594379542478e-22, 0, 108.439406341136, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 5))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54484981629945, 0.0642074554646604, -0.240321180417395, "contcor1",
			 "<unicode>", 0.121930519477027, "contGamma", 0.155374608045933,
			 -1.54672107263723, 0.775909019715999, 1.37098741586399, 1.07344821778999,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.151808502819922, 7.07106781142118, 0.00468047897744106, 0.00827014092717749,
			 0.00647530995230928, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000915746916282959, 7.07106935024442, 1.68041141270962,
			 2.96919294854718, 2.3248021806284, "contGamma", "<unicode>",
			 1.53743684450092e-12, "contGamma", 0.328776841310172, 7.07106428592748,
			 0.732634540522661, 1.29452376938821, 1.01357915495543, "contcor1",
			 "<unicode>", 1.53743684450092e-12, "contcor1", 0.14334172293411,
			 7.07106859195037))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167903477879097, 0.202768111490222, 16, 0.0174323168055624,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.853738640465711,
			 0.094560816497938, 0.184350320261274, -0.166282852969861, 0.107777929809012,
			 50, -0.0292524615804245, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.675653324090529, 0.069914749694543, -0.41840186381598,
			 -0.285599481518318, 0.125193554105386, 84, -0.0802029637064659,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.444078532644086,
			 0.104796067393071, -0.76532417390854, -0.0203639605993419, 0.0263253820199834,
			 "", 0.00298071071032073, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.802391316134589, 0.0119107654496728,
			 0.250253497385646))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.166080261300681, 0.107924225555039, -0.0290780178728209, "contGamma",
			 "<unicode>", 0.677415694171802, "contNormal", 0.0699003882257615,
			 -0.41599222280291, -2.85705005686315, 2.20397286686821, -0.326538594997467,
			 "debCollin1", "<unicode>", 0.800334026355355, "contNormal",
			 1.29110100074595, -0.252914833780475, -0.0857126928029157, 0.607920352412788,
			 0.261103829804936, "contcor1", "<unicode>", 0.140057778670108,
			 "contNormal", 0.17695045691834, 1.4755759004648, -0.184506710492921,
			 0.0886585195019194, -0.0479240954955006, "contGamma:contcor1",
			 "<unicode>", 0.49163417168576, "contNormal", 0.0696862881536428,
			 -0.687711984168802, -0.0194721311295638, 0.00121572434650741,
			 -0.0091282033915282, "contGamma", "<unicode>", 0.0837001676873514,
			 "debCollin1", 0.00527761112940196, -1.72960894005136))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.164688116509077, 0.205514171540843, 16, 0.0204130275158832,
			 "Total", 0.828874252217817, 0.0944410945736831, 0.216145604919444,
			 -0.161305499230867, 0.108761997490659, 50, -0.0262717508701038,
			 "Total", 0.702962427077919, 0.0688960355526386, -0.381324566201366,
			 -0.280068328058767, 0.125623822066476, 84, -0.0772222529961452,
			 "Total", 0.455579083814134, 0.103494797181298, -0.746146232461042,
			 -0.0203639605993419, 0.0263253820199834, 0.00298071071032073,
			 "Total indirect", 0.802391316134589, 0.0119107654496728, 0.250253497385646
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-5")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-5")
})


context('Model number 5 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(17968.8591879758, 18060.0998926557, 6154.93635766731, 4, 1, 5000,
			 0, 0, 6154.93635766731, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 5))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0329823536878864, 0.0470176677185555, 0.040000010703221, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00358050304530539, 11.1716175624169,
			 1.0083958355127, 1.09067801861772, 1.04953692706521, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0209907385426604, 49.9999999967696,
			 0.00638916698527639, 0.00691050466791572, 0.00664983582659606,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132996750642249,
			 49.9999871762551, 0.240200187976403, 0.259799829165925, 0.250000008571164,
			 "facGenderm", "<unicode>", 0, "facGenderm", 0.00500000034289439,
			 49.9999982852889, 0.240200187982739, 0.25979982917331, 0.250000008578024,
			 "facExperimexperimental", "<unicode>", 0, "facExperimexperimental",
			 0.0050000003431622, 49.999998283983))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.533075952892658, 0.695844116470473, 0.614460034681565, 0, "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0415232537081573, 14.7979741423985,
			 0.234164904524657, 0.39737331591739, 0.315769110221023, 1, "facGenderm",
			 "contNormal", "", "<unicode>", "", 3.35287353436797e-14, 0.0416355638879336,
			 7.58411993820831, -0.00278985009292545, 0.00335776056446913,
			 0.000283955235771836, "", "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.856320776562106, 0.00156829684266807,
			 0.181059623437586))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.533075952892658, 0.695844116470473, 0.614460034681565, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0415232537081573, 14.7979741423985,
			 -0.382875580852029, 0.318050956563327, -0.032412312144351, "debCollin1",
			 "<unicode>", 0.856159039246595, "contNormal", 0.178811075852458,
			 -0.181265684968504, 0.066291617815476, 0.229038773305355, 0.147665195560416,
			 "facExperimexperimental", "<unicode>", 0.000375594207956187,
			 "contNormal", 0.0415178944035728, 3.55666388389168, -0.414036240097562,
			 -0.183345608823522, -0.298690924460542, "facGenderm:facExperimexperimental",
			 "<unicode>", 3.86684509523505e-07, "contNormal", 0.0588507322312292,
			 -5.07539860824436, -0.0132813470376109, -0.00424009570965235,
			 -0.00876072137363162, "facGenderm", "<unicode>", 0.000145691151516969,
			 "debCollin1", 0.00230648404748118, -3.79830130765434))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.533235693769825, 0.696252286064849, 0.614743989917337, 0, "Total",
			 0, 0.0415866295454604, 14.7822508492863, 0.234626012620192,
			 0.397480118293398, 0.316053065456795, 1, "Total", 2.79776202205539e-14,
			 0.0415451781149496, 7.6074548190002, -0.00278985009292545, 0.00335776056446913,
			 0.000283955235771836, "Total indirect", 0.856320776562106, 0.00156829684266807,
			 0.181059623437586))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-5")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-5")
})


context('Model number 7 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(751.811728258376, 788.284110862209, 110.757814013323, 4, 1, 100,
			 5.01606234013903e-23, 0, 110.757814013323, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 7))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848119157849, 0.0642087797047907, -0.240319669726529, "contcor1",
			 "<unicode>", 0.121932636587487, "contGamma", 0.155374512916258,
			 -1.54671229673333, 0.798508437001411, 1.4109193098288, 1.1047138734151,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156230134241753, 7.07106781144829, 0.00465468570812206, 0.00822456670315713,
			 0.00643962620563959, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700661643233, 7.0710678896622, 1.68041100194839,
			 2.96919151583119, 2.32480125888979, "contGamma", "<unicode>",
			 1.53743684450092e-12, "contGamma", 0.328776580602639, 7.07106708947605,
			 0.732634575467378, 1.29452389127507, 1.01357923337122, "contcor1",
			 "<unicode>", 1.53743684450092e-12, "contcor1", 0.143341745113636,
			 7.071068044886))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.18037209314248, 0.0938552988800098, "", -0.0432583971312351,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.536341542042378,
			 0.0699572528336134, -0.618354714901699, -0.0129247034905523,
			 0.0157307459479517, 16, 0.00140302122869966, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.847799723575525, 0.00731019795887439,
			 0.191926571153443, -0.0215674048735882, 0.0263996863777316,
			 50, 0.00241614075207169, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.843475478031402, 0.0122367277229781,
			 0.197449907096867, -0.0314504782706364, 0.0384941421659617,
			 84, 0.00352183194766264, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.843534001341014, 0.0178433432931198,
			 0.197375115739696))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.18037209314248, 0.0938552988800098, -0.0432583971312351, "contGamma",
			 "<unicode>", 0.536341542042378, "contNormal", 0.0699572528336134,
			 -0.618354714901699, -2.81958318562843, 2.30044866600327, -0.25956725981258,
			 "debCollin1", "<unicode>", 0.84247685359183, "contNormal", 1.30615457529267,
			 -0.198726295281259, -0.0197475164491573, 0.00116000196996569,
			 -0.00929375723959581, "contGamma", "<unicode>", 0.0814251048630137,
			 "debCollin1", 0.00533364862416831, -1.74247647238761, -0.0185476058719446,
			 0.0350787535471827, 0.00826557383761903, "contcor1", "<unicode>",
			 0.54571802319551, "debCollin1", 0.0136804451107585, 0.604188955161911,
			 -0.0145563060774852, 0.00654285866705558, -0.00400672370521481,
			 "contGamma:contcor1", "<unicode>", 0.45663881638757, "debCollin1",
			 0.00538253889126747, -0.744392894534443))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.17734978176578, 0.0936390299607096, 16, -0.0418553759025354,
			 "Total", 0.54488032514503, 0.0691310692094383, -0.605449566760367,
			 -0.175977997880954, 0.0942934851226271, 50, -0.0408422563791634,
			 "Total", 0.553607842858751, 0.068948073825705, -0.592362543475968,
			 -0.175382641681902, 0.0959095113147572, 84, -0.0397365651835724,
			 "Total", 0.565861104044506, 0.0692084536084788, -0.574157680337251,
			 -0.0129247034905523, 0.0157307459479517, 16, 0.00140302122869966,
			 "Total indirect", 0.847799723575525, 0.00731019795887439, 0.191926571153443,
			 -0.0215674048735882, 0.0263996863777316, 50, 0.00241614075207169,
			 "Total indirect", 0.843475478031402, 0.0122367277229781, 0.197449907096867,
			 -0.0314504782706364, 0.0384941421659617, 84, 0.00352183194766264,
			 "Total indirect", 0.843534001341014, 0.0178433432931198, 0.197375115739696
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-7")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-7")
})


context('Model number 7 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(17994.5533769227, 18085.7940816025, 6090.78719659312, 4, 1, 5000,
			 0, 0, 6090.78719659312, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 7))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0329823221753726, 0.0470176313245523, 0.0399999767499625, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00358050180000459, 11.1716119650914,
			 1.01359115565911, 1.09629726185871, 1.05494420875891, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0210988841764364, 49.9999999970182,
			 0.00638916086286907, 0.00691049750387, 0.00664982918336953,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132996484913285,
			 50.0000371265847, 0.240200151904438, 0.2597997869566, 0.249999969430519,
			 "facGenderm", "<unicode>", 0, "facGenderm", 0.00499999877721263,
			 50.000006113979, 0.240200151883547, 0.259799786932376, 0.249999969407961,
			 "facExperimexperimental", "<unicode>", 0, "facExperimexperimental",
			 0.00499999877636236, 50.0000061179702))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408379788631199, 0.522421436711367, 0.465400612671283, "", "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0290927917501838, 15.9971107849539,
			 -0.0033360154502594, 0.00279415845771022, -0.000270928496274589,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.862459082816212, 0.00156384861056725, -0.173244708243413,
			 -0.00333599874264904, 0.0027941444745412, -0.00027092713405392,
			 1, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.862459085738549, 0.00156384078114292, -0.173244704525428
			))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408379788631199, 0.522421436711367, 0.465400612671283, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0290927917501838, 15.9971107849539,
			 -0.318192879297982, 0.380043423038653, 0.0309252718703351, "debCollin1",
			 "<unicode>", 0.862167432080561, "contNormal", 0.178124778782731,
			 0.173615776994488, -0.015237311854449, -0.00228418301942313,
			 -0.00876074743693606, "facGenderm", "<unicode>", 0.00802033291245485,
			 "debCollin1", 0.00330443032045448, -2.65121264101315, -0.0064764965007959,
			 0.0064766323342473, 6.79167256978455e-08, "facExperimexperimental",
			 "<unicode>", 0.999983600892863, "debCollin1", 0.0033044303204589,
			 2.05532328151539e-05, -0.00915920118803364, 0.00915928928560477,
			 4.40487855643811e-08, "facGenderm:facExperimexperimental", "<unicode>",
			 0.999992479228317, "debCollin1", 0.0046731701750982, 9.42588947415242e-06
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.408190594746687, 0.52206877360333, 0.465129684175008, 0, "Total",
			 0, 0.029051089651366, 16.0107482974615, 0.408190596108914, 0.522068774965545,
			 0.465129685537229, 1, "Total", 0, 0.0290510896513628, 16.0107483443537,
			 -0.0033360154502594, 0.00279415845771022, -0.000270928496274589,
			 0, "Total indirect", 0.862459082816212, 0.00156384861056725,
			 -0.173244708243413, -0.00333599874264904, 0.0027941444745412,
			 -0.00027092713405392, 1, "Total indirect", 0.862459085738549,
			 0.00156384078114292, -0.173244704525428))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-7")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-7")
})


context('Model number 8 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(752.940701960645, 794.623424936455, 107.886787715592, 2, 1, 100,
			 3.73836508970073e-24, 0, 107.886787715592, 2))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 8))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848460824152, 0.0642084832244124, -0.24031998879987, "contcor1",
			 "<unicode>", 0.121932168860329, "contGamma", 0.155374524443492,
			 -1.54671423555843, 0.775909019714327, 1.3709874158542, 1.07344821778426,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.151808502817852, 7.07106781147989, 0.0046546853899503, 0.00822456559339238,
			 0.00643962549167134, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700459702536, 7.07106867363911, 1.680410940773,
			 2.96919130245879, 2.32480112161589, "contGamma", "<unicode>",
			 1.53743684450092e-12, "contGamma", 0.328776541776156, 7.071067506996,
			 0.732634607068937, 1.29452400151006, 1.0135793042895, "contcor1",
			 "<unicode>", 1.53743684450092e-12, "contcor1", 0.143341765173553,
			 7.07106755007721))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167905039579464, 0.202766549778055, 16, 0.0174307550992954,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.853751595809737,
			 0.0945608164949278, 0.184333804903539, -0.166284391274893, 0.107776391500905,
			 50, -0.0292539998869939, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.675637239929195, 0.0699147496937581, -0.418423866424936,
			 -0.28560099427224, 0.125192041321761, 84, -0.0802044764752393,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.44406993896416,
			 0.104796067385494, -0.765338609322105, -0.0126897318329719,
			 0.0162197674981435, 16, 0.00176501783258584, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.810854202526906, 0.00737500779584468,
			 0.239324198895126, -0.0207614610995371, 0.0268405304519479,
			 50, 0.00303953467620541, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.802355705647833, 0.0121435883329907,
			 0.250299548441366, -0.0302835894107279, 0.0391446050589363,
			 84, 0.00443050782410422, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.802473481226242, 0.0177115995542023,
			 0.250147244496223))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.166081799693169, 0.107922687159517, -0.0290795562668262, "contGamma",
			 "<unicode>", 0.677399589609436, "contNormal", 0.0699003882249873,
			 -0.416014231183214, -2.85705040096261, 2.20397252277511, -0.326538939093747,
			 "debCollin1", "<unicode>", 0.800333820401812, "contNormal",
			 1.29110100074757, -0.252915100293993, -0.0857127293147369, 0.607920315858757,
			 0.26110379327201, "contcor1", "<unicode>", 0.140057834105104,
			 "contNormal", 0.176950456907571, 1.47557569409609, -0.184506686459188,
			 0.0886585435099415, -0.047924071474623, "contGamma:contcor1",
			 "<unicode>", 0.491634388756249, "contNormal", 0.0696862881470837,
			 -0.68771163953333, -0.0197475117356864, 0.00116000552443063,
			 -0.00929375310562787, "contGamma", "<unicode>", 0.0814252234860795,
			 "debCollin1", 0.00533364832849808, -1.74247579390839, -0.0185476053869986,
			 0.0350787510593954, 0.00826557283619838, "contcor1", "<unicode>",
			 0.545718049592324, "debCollin1", 0.0136804443523942, 0.604188915453747,
			 -0.0145563039224123, 0.00654285965255519, -0.00400672213492856,
			 "contGamma:contcor1", "<unicode>", 0.456638967874983, "debCollin1",
			 0.00538253859290145, -0.744392644060678))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.165693711122604, 0.204085256986366, 16, 0.0191957729318812,
			 "Total", 0.838752642275153, 0.0943331028084545, 0.203489256267322,
			 -0.162921258045264, 0.107943293936448, 16, -0.027488982054408,
			 "Total", 0.690764251998261, 0.0690993697124685, -0.397818130162305,
			 -0.282050419217929, 0.125171501932622, 50, -0.0784394586426535,
			 "Total", 0.450212917380938, 0.103885052062861, -0.755060108120172,
			 -0.164655282486898, 0.2055958620379, 16, 0.0204702897755008,
			 "Total", 0.828423964429749, 0.0944535581891535, 0.216723331211163,
			 -0.161248360272373, 0.108819429850796, 84, -0.0262144652107885,
			 "Total", 0.703579734355289, 0.0688961104013722, -0.380492673070646,
			 -0.279986889964684, 0.125657006366617, 16, -0.0771649417990339,
			 "Total", 0.455860039056704, 0.10348248731379, -0.745681165983641,
			 -0.164190286539075, 0.207912812385874, 16, 0.0218612629233996,
			 "Total", 0.81786026369641, 0.0949260042174372, 0.230297936836404,
			 -0.160340732011515, 0.110693747885736, 50, -0.0248234920628897,
			 "Total", 0.719581502461175, 0.0691427194670762, -0.359018162059852,
			 -0.278345249691444, 0.126797312389173, 50, -0.0757739686511351,
			 "Total", 0.463469612038204, 0.103354593573231, -0.733145630314398,
			 -0.0126897318329719, 0.0162197674981435, 50, 0.00176501783258584,
			 "Total indirect", 0.810854202526906, 0.00737500779584468, 0.239324198895126,
			 -0.0207614610995371, 0.0268405304519479, 84, 0.00303953467620541,
			 "Total indirect", 0.802355705647833, 0.0121435883329907, 0.250299548441366,
			 -0.0302835894107279, 0.0391446050589363, 50, 0.00443050782410422,
			 "Total indirect", 0.802473481226242, 0.0177115995542023, 0.250147244496223,
			 16, 84, 50, 84, 84, 84, 16, 50, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-8")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-8")
})


context('Model number 8 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(8871.52495600031, 8965.11413708896, 3494.1611539796, 2, 1, 2564,
			 0, 0, 3494.1611539796, 2))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 8))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.067866844958369, 0.0881406541335074, 0.0780037495459382, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517198513213906, 15.08197482263,
			 0.962212047742971, 1.07365523967922, 1.0179336437111, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0284299081042559, 35.8050275779369,
			 0.00607839812286972, 0.00678239715223462, 0.00643039763755217,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000179594889221932,
			 35.8050146382834, 0.236315784729395, 0.263685927103021, 0.250000855916208,
			 "facGenderm", "<unicode>", 0, "facGenderm", 0.00698230747848393,
			 35.8049049954601, 0.236315784712836, 0.263685927082449, 0.250000855897642,
			 "facExperimexperimental", "<unicode>", 0, "facExperimexperimental",
			 0.00698230747746009, 35.8049049980514))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498416558199395, 0.73099005191722, 0.614703305058307, 0, "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0593310631094078, 10.360564480781,
			 0.198320310097334, 0.431488798599427, 0.314904554348381, 1,
			 "facGenderm", "contNormal", "", "<unicode>", "", 1.19643623230914e-07,
			 0.0594828502822748, 5.29403942235463, -0.00295851882966315,
			 0.00214707643040764, -0.00040572119962776, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.755419805273703,
			 0.00130247170364942, -0.311500970417216, -0.00726413137054082,
			 0.0101477933991454, 0.00144183101430231, 1, "facGenderm", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.745485438342573, 0.00444189916422682,
			 0.32459787153977))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498416558199395, 0.73099005191722, 0.614703305058307, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0593310631094078, 10.360564480781,
			 -0.567954836663093, 0.406047445235616, -0.0809536957137386,
			 "debCollin1", "<unicode>", 0.744573571490514, "contNormal",
			 0.248474535650021, -0.325802784989456, 0.0312302147009336, 0.263775318184217,
			 0.147502766442575, "facExperimexperimental", "<unicode>", 0.0129042714763317,
			 "contNormal", 0.0593238205695538, 2.48640031991259, -0.464592055215619,
			 -0.135005446204235, -0.299798750709927, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.000362959628782189, "contNormal", 0.0840797615698862,
			 -3.56564701317257, -0.00422869413971235, 0.0142522315718374,
			 0.00501176871606252, "facGenderm", "<unicode>", 0.287768496314309,
			 "debCollin1", 0.00471460849722876, 1.06302967022785, -0.0125870620548402,
			 0.00589386365667928, -0.00334659919908048, "facExperimexperimental",
			 "<unicode>", 0.477805794274224, "debCollin1", 0.00471460849722105,
			 -0.709836076750186, -0.0358903210509308, -0.00975434526456942,
			 -0.0228223331577501, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619475305623896, "debCollin1", 0.00666746327802924, -3.42294096061312
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498034045902205, 0.730561121815154, 0.61429758385868, 0, "Total",
			 0, 0.0593192216150638, 10.3557930656103, 0.197705238037169,
			 0.431292428260337, 0.314498833148753, 0, "Total", 1.30785890117835e-07,
			 0.0595896639085396, 5.2777413484234, 0.499351554580197, 0.732938717565022,
			 0.61614513607261, 1, "Total", 0, 0.059589656959855, 10.3398000174376,
			 0.200082847382702, 0.432609923342664, 0.316346385362683, 0,
			 "Total", 9.66304425364939e-08, 0.0593192216270569, 5.33294902875782,
			 -0.00295851882966315, 0.00214707643040764, -0.00040572119962776,
			 0, "Total indirect", 0.755419805273703, 0.00130247170364942,
			 -0.311500970417216, -0.00726413137054082, 0.0101477933991454,
			 0.00144183101430231, 1, "Total indirect", 0.745485438342573,
			 0.00444189916422682, 0.32459787153977, 1, 1, 0, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-8")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-8")
})


context('Model number 9 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(990.094319982191, 1042.19772370195, 248.077941782029, 10, 1, 100,
			 1.37625258476784e-47, 0, 248.077941782029, 10))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 9))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848914888998, 0.0642084359669662, -0.240320239461016, "contcor1",
			 "<unicode>", 0.12193202889809, "contGamma", 0.155374628222797,
			 -1.54671481573177, -0.403935796369873, 0.194627281786815, -0.104654257291529,
			 "contcor2", "<unicode>", 0.493110497998796, "contGamma", 0.152697468646893,
			 -0.685369955500299, 0.424979120380995, 0.896762825550578, 0.660870972965787,
			 "contcor2", "<unicode>", 3.9965338816117e-08, "contcor1", 0.120355197567647,
			 5.49100484500751, 0.798508437001639, 1.41091930982992, 1.10471387341578,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156230134241981, 7.07106781144228, 0.00462621179028379, 0.00817425376561761,
			 0.0064002327779507, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905129380774423, 7.07106952209937, 1.68041221100461,
			 2.96919573296022, 2.32480397198241, "contGamma", "<unicode>",
			 1.53765888910584e-12, "contGamma", 0.328777347982252, 7.07105883738654,
			 0.732634339258145, 1.29452306739393, 1.01357870332604, "contcor1",
			 "<unicode>", 1.53743684450092e-12, "contcor1", 0.143341595194578,
			 7.071071742645, 0.721541877187929, 1.27492384159785, 0.998232859392889,
			 "contcor2", "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171462530671,
			 7.07106692456356))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180374206632216, 0.0938531853921592, "", "", -0.0432605106200283,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.536321631908842,
			 0.0699572528340943, -0.618384926043649, -0.0112824249123608,
			 0.0136975431417496, 16, 16, 0.00120755911469441, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.849705949560913,
			 0.00637255792737754, 0.1894936269636, -0.0217866972215342, 0.0265804120674077,
			 50, 16, 0.00239685742293672, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.845976937385165, 0.0123387750158818,
			 0.194254082747406, -0.0339597594966307, 0.0413494102375661,
			 84, 16, 0.00369482537046768, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.847491659297221, 0.019211875914105,
			 0.192319864389453, -0.0125632897169335, 0.0151467021660624,
			 16, 50, 0.00129170622456441, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.855011332657022, 0.00706900537498873,
			 0.182728142934319, -0.0221380508413519, 0.0271000599069653,
			 50, 50, 0.00248100453280672, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.843423056652746, 0.012560973348669,
			 0.197516901273389, -0.0339446251054951, 0.0415025700661704,
			 84, 50, 0.00377897248033768, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.84434407984191, 0.0192470871319023,
			 0.196339968455486, -0.0155174625508754, 0.0182981416572377,
			 16, 84, 0.00139033955318116, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.8719602081231, 0.00862658816050864,
			 0.161169111972442, -0.0235502518484266, 0.0287095275712736,
			 50, 84, 0.00257963786142347, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.846571492547133, 0.0133318213579226,
			 0.193494781558147, -0.0346052243825767, 0.0423604360004856,
			 84, 84, 0.00387760580895443, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.843444236375079, 0.0196344578242655,
			 0.197489833621086))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180374206632216, 0.0938531853921592, -0.0432605106200283, "contGamma",
			 "<unicode>", 0.536321631908842, "contNormal", 0.0699572528340943,
			 -0.618384926043649, -2.81958365335954, 2.30044819789232, -0.259567727733615,
			 "debCollin1", "<unicode>", 0.842476573332356, "contNormal",
			 1.30615457519577, -0.198726653539233, -0.0199698528455882, 0.000907986260766512,
			 -0.00953093329241082, "contGamma", "<unicode>", 0.0735368021875245,
			 "debCollin1", 0.00532607723178497, -1.7894846202252, -0.0336994141996402,
			 0.0420651734413483, 0.00418287962085401, "contcor1", "<unicode>",
			 0.828664341011265, "debCollin1", 0.0193280560863898, 0.216414915300223,
			 -0.031021361627411, 0.0494312533601181, 0.00920494586635359,
			 "contcor2", "<unicode>", 0.653794835174478, "debCollin1", 0.0205240034057077,
			 0.44849660587143, -0.0233913745398805, 0.013984426940707, -0.00470347379958678,
			 "contGamma:contcor1", "<unicode>", 0.621804491420715, "debCollin1",
			 0.00953481843937009, -0.493294531982458, -0.0182406100499067,
			 0.0175608413140601, -0.000339884367923266, "contGamma:contcor2",
			 "<unicode>", 0.970314219416229, "debCollin1", 0.00913319113166469,
			 -0.0372141963332936))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.177697886059787, 0.0935919830491195, 16, 16, -0.0420529515053339,
			 "Total", 0.543431242081307, 0.0692078709733461, -0.607632497776584,
			 -0.176067917286476, 0.0943406108922932, 50, 16, -0.0408636531970916,
			 "Total", 0.553601174039362, 0.0689830349719989, -0.592372504539394,
			 -0.175635248360402, 0.096503877861281, 84, 16, -0.0395656852495606,
			 "Total", 0.568739173719493, 0.0694245221770099, -0.569909363562935,
			 -0.177603322054906, 0.0936657132639783, 16, 50, -0.0419688043954639,
			 "Total", 0.544207204735532, 0.0692025561333321, -0.606463210905142,
			 -0.175918913733957, 0.0943599015595143, 50, 50, -0.0407795060872216,
			 "Total", 0.554228064829581, 0.0689499443421911, -0.59143638876396,
			 -0.175427633917997, 0.0964645576386157, 84, 50, -0.0394815381396906,
			 "Total", 0.569211061424022, 0.0693615274824598, -0.569213792900895,
			 -0.177683170460024, 0.0939428283263296, 16, 84, -0.0418701710668471,
			 "Total", 0.545682227912239, 0.0692936199156986, -0.604242802119237,
			 -0.175935700073027, 0.0945739545558174, 50, 84, -0.0406808727586048,
			 "Total", 0.555524301885479, 0.0690088330098385, -0.589502401131824,
			 -0.17537457707856, 0.0966087674564119, 84, 84, -0.0393829048110739,
			 "Total", 0.570305599029304, 0.0693847812205585, -0.567601484335369,
			 -0.0112824249123608, 0.0136975431417496, 16, 16, 0.00120755911469441,
			 "Total indirect", 0.849705949560913, 0.00637255792737754, 0.1894936269636,
			 -0.0217866972215342, 0.0265804120674077, 50, 16, 0.00239685742293672,
			 "Total indirect", 0.845976937385165, 0.0123387750158818, 0.194254082747406,
			 -0.0339597594966307, 0.0413494102375661, 84, 16, 0.00369482537046768,
			 "Total indirect", 0.847491659297221, 0.019211875914105, 0.192319864389453,
			 -0.0125632897169335, 0.0151467021660624, 16, 50, 0.00129170622456441,
			 "Total indirect", 0.855011332657022, 0.00706900537498873, 0.182728142934319,
			 -0.0221380508413519, 0.0271000599069653, 50, 50, 0.00248100453280672,
			 "Total indirect", 0.843423056652746, 0.012560973348669, 0.197516901273389,
			 -0.0339446251054951, 0.0415025700661704, 84, 50, 0.00377897248033768,
			 "Total indirect", 0.84434407984191, 0.0192470871319023, 0.196339968455486,
			 -0.0155174625508754, 0.0182981416572377, 16, 84, 0.00139033955318116,
			 "Total indirect", 0.8719602081231, 0.00862658816050864, 0.161169111972442,
			 -0.0235502518484266, 0.0287095275712736, 50, 84, 0.00257963786142347,
			 "Total indirect", 0.846571492547133, 0.0133318213579226, 0.193494781558147,
			 -0.0346052243825767, 0.0423604360004856, 84, 84, 0.00387760580895443,
			 "Total indirect", 0.843444236375079, 0.0196344578242655, 0.197489833621086
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-9")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-9")
})


context('Model number 9 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(678.245914480274, 730.349318200036, 183.413145095486, 10, 1, 100,
			 4.58015252931068e-34, 0, 183.413145095486, 10))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 9))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962232087905749, 0.0896223313388534, 0.0400000052298979,
			 "facExperimexperimental", "<unicode>", 0.114128584782667, "facGenderm",
			 0.0253179785446927, 1.57990517131088, -0.163250759782142, 0.0341991537123063,
			 -0.064525803034918, "contcor2", "<unicode>", 0.20018804328528,
			 "facGenderm", 0.0503708014667383, -1.28101600840175, -0.170527257822757,
			 0.0272978261975087, -0.0716147158126243, "contcor2", "<unicode>",
			 0.155883198648661, "facExperimexperimental", 0.050466509992195,
			 -1.41905425645046, 0.762533966062579, 1.34735445145524, 1.05494420875891,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.149191640766271, 7.07106781144409, 0.00473838136076594, 0.008372452222633,
			 0.00655541679169947, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000927075928571175, 7.0710678485664, 0.180704809124265,
			 0.319295192412297, 0.250000000768281, "facGenderm", "<unicode>",
			 1.53743684450092e-12, "facGenderm", 0.0353553392769497, 7.07106779007127,
			 0.18070481104406, 0.319295199108279, 0.250000005076169, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553404953872, 7.07106766822925, 0.721541818777502, 1.27492363787309,
			 0.998232728325296, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171425460007, 7.07106785294938))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991909118, 0.868598726151654, "", 0.465400612671283,
			 "", "facGenderm", "contNormal", "", "<unicode>", "", 0.0236768306610677,
			 0.205717103304319, 2.2623331030615, -0.0234811639866145, 0.0240751549876866,
			 16, 0.000296995500536031, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.98046936291523, 0.0121319369512448,
			 0.0244804685129489, -0.0327165446731377, 0.0319080609624235,
			 16, -0.000404241855357125, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.98043778607598, 0.0164861717218561,
			 -0.0245200560916888, -0.0138829443378545, 0.0142333636647573,
			 50, 0.000175209663451375, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.980511665622727, 0.00717265935098544,
			 0.0244274340767771, -0.0425410524002374, 0.0414889970153538,
			 50, -0.000526027692441781, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.980422891223063, 0.0214366309989391,
			 -0.0245387296384312, -0.0030627393155284, 0.0031276552541723,
			 84, 3.24579693219513e-05, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.983602011177913, 0.0015792113065673,
			 0.0205532782009423, -0.0540880958231656, 0.0527505370500232,
			 84, -0.000668779386571205, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.980423767003981, 0.0272552541056668,
			 -0.0245376316793229))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991909118, 0.868598726151654, 0.465400612671283, "facGenderm",
			 "<unicode>", 0.0236768306610677, "contNormal", 0.205717103304319,
			 2.2623331030615, -2.43771284931715, 2.49956339305782, 0.0309252718703351,
			 "debCollin1", "<unicode>", 0.980411525583115, "contNormal",
			 1.25953238970705, 0.0245529786475185, -0.0402673826197957, 0.051845450037813,
			 0.00578903370900866, "facGenderm", "<unicode>", 0.805406275849394,
			 "debCollin1", 0.0234986033886804, 0.24635650099092, -0.0489097927439167,
			 0.0420349029115894, -0.00343744491616361, "facExperimexperimental",
			 "<unicode>", 0.882215020419098, "debCollin1", 0.0232006037796782,
			 -0.148161873234287, -0.0174099716216197, 0.0258807481742401,
			 0.00423538827631018, "contcor2", "<unicode>", 0.701341776705399,
			 "debCollin1", 0.0110437538999011, 0.383509838656231, -0.0882812873519764,
			 0.0429308465323558, -0.0226752204098103, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498141895795569, "debCollin1", 0.0334730982097928,
			 -0.677416242371509, -0.0370222258431474, 0.0287645860070075,
			 -0.00412881991806995, "facGenderm:contcor2", "<unicode>", 0.805669042345657,
			 "debCollin1", 0.0167826583470597, -0.246017039296597))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0605314878589796, 0.870863728484659, 16, 0.465697608171819,
			 0, "Total", 0.0242729604433329, 0.206721206873564, 2.25278100498248,
			 0.0622346072846865, 0.867758134347165, 16, 0.464996370815926,
			 1, "Total", 0.0236469764543108, 0.205494471688344, 2.26281693612248,
			 0.0613836477673897, 0.869767996902079, 50, 0.465575822334734,
			 0, "Total", 0.0239694368187962, 0.206224286647898, 2.25761877954582,
			 0.0617397270746964, 0.868009442882986, 50, 0.464874584978841,
			 1, "Total", 0.0238131440898943, 0.205684829458103, 2.26013063872333,
			 0.0620841276996748, 0.868782013581535, 84, 0.465433070640605,
			 0, "Total", 0.023719355241179, 0.205794058524797, 2.26164484036609,
			 0.0608591033777141, 0.86860456319171, 84, 0.464731833284712,
			 1, "Total", 0.0241139629249585, 0.206061301683446, 2.25530863625543,
			 -0.0234811639866145, 0.0240751549876866, 16, 0.000296995500536031,
			 0, "Total indirect", 0.98046936291523, 0.0121319369512448, 0.0244804685129489,
			 -0.0327165446731377, 0.0319080609624235, 16, -0.000404241855357125,
			 1, "Total indirect", 0.98043778607598, 0.0164861717218561, -0.0245200560916888,
			 -0.0138829443378545, 0.0142333636647573, 50, 0.000175209663451375,
			 0, "Total indirect", 0.980511665622727, 0.00717265935098544,
			 0.0244274340767771, -0.0425410524002374, 0.0414889970153538,
			 50, -0.000526027692441781, 1, "Total indirect", 0.980422891223063,
			 0.0214366309989391, -0.0245387296384312, -0.0030627393155284,
			 0.0031276552541723, 84, 3.24579693219513e-05, 0, "Total indirect",
			 0.983602011177913, 0.0015792113065673, 0.0205532782009423, -0.0540880958231656,
			 0.0527505370500232, 84, -0.000668779386571205, 1, "Total indirect",
			 0.980423767003981, 0.0272552541056668, -0.0245376316793229
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-9")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-9")
})


context('Model number 10 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(994.470215605464, 1056.99430006918, 244.453837405302, 6, 1, 100,
			 6.27962123475793e-50, 0, 244.453837405302, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 10))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848428682139, 0.0642085159780603, -0.240319956352039, "contcor1",
			 "<unicode>", 0.121932219615165, "contGamma", 0.155374524599524,
			 -1.54671402516893, -0.403934092797642, 0.194627972591868, -0.104653060102887,
			 "contcor2", "<unicode>", 0.493114712610995, "contGamma", 0.152697210283171,
			 -0.685363274868034, 0.424979249412949, 0.896763235040356, 0.660871242226652,
			 "contcor2", "<unicode>", 3.99655712968183e-08, "contcor1", 0.120355269114325,
			 5.49100381802888, 0.770087770728383, 1.36070160614271, 1.06539468843555,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.150669563337137, 7.07106773815775, 0.00462621278645113, 0.00817425724019183,
			 0.00640023501332148, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905130013032696, 7.0710670524305, 1.68041080366514,
			 2.96919082422582, 2.32480081394548, "contGamma", "<unicode>",
			 1.53743684450092e-12, "contGamma", 0.328776454752846, 7.07106844282119,
			 0.732634670307024, 1.29452422207221, 1.01357944618962, "contcor1",
			 "<unicode>", 1.53743684450092e-12, "contcor1", 0.143341805307979,
			 7.07106656018371, 0.721541773271586, 1.27492347914683, 0.998232626209209,
			 "contcor2", "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171396576736,
			 7.07106857632172))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176624565537352, 0.198185259587653, 16, 16, 0.0107803470251507,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.910232194827669,
			 0.0956165082831768, 0.112745667235868, -0.253641521471254, 0.255687288251962,
			 50, 16, 0.00102288339035395, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.993718815554393, 0.129933206360101, 0.00787237857826047,
			 -0.482412775896821, 0.463160479846038, 84, 16, -0.0096261480253914,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.968168269508668,
			 0.241222099794032, -0.039905746752104, -0.28705442424927, 0.25496764548812,
			 16, 50, -0.016043389380575, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.907631529318152, 0.138273476965085, -0.116026513057353,
			 -0.162769367305738, 0.111167661274995, 50, 50, -0.0258008530153718,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.711978834331607,
			 0.0698831791659217, -0.369199760562031, -0.328511432806231,
			 0.255611663943997, 84, 50, -0.0364498844311171, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.806760315112174, 0.149013732231234,
			 -0.24460755317876, -0.539342548914669, 0.444372697598264, 16,
			 84, -0.0474849256582028, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.849921278012008, 0.250952378276426, -0.189218870864407,
			 -0.354368890590419, 0.23988411200442, 50, 84, -0.0572423892929995,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.705732629503542,
			 0.151597939370884, -0.377593452328901, -0.284291369931549, 0.148508528514059,
			 84, 84, -0.0678914207087449, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.538619509481368, 0.110410166171287, -0.614901897742101,
			 -0.0111495551700118, 0.013414375344633, 16, 16, 0.00113241008731062,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.856594631059563, 0.00626642395176697, 0.180710736462589, -0.0215877263403358,
			 0.0260831038736157, 50, 16, 0.00224768876663995, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.853366020963742,
			 0.0121611495389642, 0.184825353839978, -0.0336127699719665,
			 0.0405425173656955, 84, 16, 0.00346487369686453, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.854674881787889,
			 0.0189175127508948, 0.183156937304067, -0.0123696765246239,
			 0.0147923352860139, 16, 50, 0.00121132938069499, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.861225093406947,
			 0.00692921197146689, 0.174814883089593, -0.0219770223313307,
			 0.0266302384513793, 50, 50, 0.00232660806002432, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.851167422323687,
			 0.0124000392777923, 0.187629087932901, -0.033674792644901, 0.0407623786253988,
			 84, 50, 0.0035437929902489, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.851959128504292, 0.0189894232387561,
			 0.186619306215486, -0.0151130283697319, 0.0177206981816644,
			 16, 84, 0.00130383490596625, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.87630004283886, 0.00837610456375336,
			 0.155661249933346, -0.0233253014949989, 0.02816352866559, 50,
			 84, 0.00241911358529558, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.853879283611007, 0.0131351470146202,
			 0.18417103231528, -0.0343529900952039, 0.0416255871262443, 84,
			 84, 0.00363629851552016, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.851185612246558, 0.0193826462681859,
			 0.187605885450671))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161745986716662, 0.111898957325208, -0.0249235146957274, "contGamma",
			 "<unicode>", 0.721072279854837, "contNormal", 0.069808666434778,
			 -0.357026082413612, -2.77216319538397, 2.28533123269878, -0.243415981342596,
			 "debCollin1", "<unicode>", 0.850355241164619, "contNormal",
			 1.29020085776464, -0.188665183314426, -0.218443543829984, 0.759300817656846,
			 0.270428636913431, "contcor1", "<unicode>", 0.278280510991102,
			 "contNormal", 0.249429165331392, 1.08419012088718, -0.584165682579282,
			 0.454878207648324, -0.0646437374654786, "contcor2", "<unicode>",
			 0.807326166486014, "contNormal", 0.265067087564734, -0.243876891919641,
			 -0.251421148037748, 0.231388167901839, -0.0100164900679541,
			 "contGamma:contcor1", "<unicode>", 0.935184395420652, "contNormal",
			 0.123167905060482, -0.0813238648740142, -0.259079963781194,
			 0.202833923928551, -0.0281230199263218, "contGamma:contcor2",
			 "<unicode>", 0.811369497875862, "contNormal", 0.117837340724948,
			 -0.238659662152133, -0.019969793915132, 0.000908048837137623,
			 -0.00953087253899719, "contGamma", "<unicode>", 0.0735386879401227,
			 "debCollin1", 0.00532607816188241, -1.78947290094381, -0.0336993996606859,
			 0.0420652012128008, 0.00418290077605742, "contcor1", "<unicode>",
			 0.828663517373526, "debCollin1", 0.0193280594620892, 0.216415972035989,
			 -0.0310214239931861, 0.0494312050451843, 0.00920489052599912,
			 "contcor2", "<unicode>", 0.65379683723621, "debCollin1", 0.0205240069901719,
			 0.448493831170832, -0.0233913150532391, 0.0139844929548931,
			 -0.00470341104917301, "contGamma:contcor1", "<unicode>", 0.621809201765272,
			 "debCollin1", 0.00953482010459065, -0.493287864645553, -0.0182406488581328,
			 0.017560808758414, -0.000339920049859377, "contGamma:contcor2",
			 "<unicode>", 0.97031110954783, "debCollin1", 0.00913319272673992,
			 -0.0372180966754559))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175155835415554, 0.198981349640477, 16, 16, 0.0119127571124613,
			 "Total", 0.900671668758111, 0.0954449132757483, 0.124812907294959,
			 -0.251725414541164, 0.256036001496494, 16, 16, 0.00215529347766457,
			 "Total", 0.986724685229022, 0.129533353684766, 0.0166389074038006,
			 -0.480543671290211, 0.46355619541405, 50, 16, -0.00849373793808078,
			 "Total", 0.971867452931952, 0.240846228336643, -0.0352662277368473,
			 -0.285653934702343, 0.255831976115814, 16, 16, -0.0149109792932644,
			 "Total", 0.914040392952079, 0.138136699217264, -0.107943648413172,
			 -0.160103071191011, 0.110766185334889, 84, 16, -0.0246684429280612,
			 "Total", 0.721096794914756, 0.0691005698733452, -0.356993335558246,
			 -0.326151794787888, 0.255516846100275, 16, 16, -0.0353174743438065,
			 "Total", 0.81187466856861, 0.148387584026107, -0.238008284693097,
			 -0.538039486511539, 0.445334455369754, 16, 50, -0.0463525155708921,
			 "Total", 0.853409025240116, 0.250865309168439, -0.184770527756668,
			 -0.352494377164328, 0.24027441875295, 16, 16, -0.0561099792056889,
			 "Total", 0.710600020743787, 0.15121930826101, -0.371050362886472,
			 -0.281447112030851, 0.147929090787983, 50, 50, -0.0667590106214343,
			 "Total", 0.54221511462466, 0.109536758380689, -0.609466736174689,
			 -0.174426855819497, 0.200482927403078, 16, 16, 0.0130280357917907,
			 "Total", 0.891649997958284, 0.0956420082664313, 0.136216669096892,
			 -0.25036620302879, 0.256907347342778, 84, 50, 0.0032705721569939,
			 "Total", 0.97983707968122, 0.12940889587076, 0.0252731632936595,
			 -0.478986696577018, 0.464229778059515, 16, 16, -0.00737845925875145,
			 "Total", 0.975537299547634, 0.240620869076295, -0.0306642532174211,
			 -0.284770658192018, 0.257179256964148, 16, 84, -0.0137957006139351,
			 "Total", 0.920515485060208, 0.138255069845925, -0.0997844102882399,
			 -0.158459576281074, 0.111353247783611, 16, 16, -0.0235531642487318,
			 "Total", 0.732209424679362, 0.0688310668443232, -0.342187987613247,
			 -0.32428631024002, 0.255881918911066, 50, 84, -0.0342021956644772,
			 "Total", 0.817246132622064, 0.148004818896515, -0.23108839238803,
			 -0.537029355722176, 0.44655488193905, 16, 16, -0.0452372368915628,
			 "Total", 0.856927852615258, 0.250918957036867, -0.180286246307473,
			 -0.351100498930133, 0.241111097877414, 84, 84, -0.0549947005263596,
			 "Total", 0.71584509304603, 0.151077163019024, -0.364017297038034,
			 -0.279262325439958, 0.147974861555748, 16, 16, -0.0656437319421049,
			 "Total", 0.546984207558168, 0.108991081051922, -0.60228535499004,
			 -0.174562751332243, 0.203053192776273, 16, 16, 0.0142452207220152,
			 "Total", 0.882440830263285, 0.0963323681167365, 0.147875745198672,
			 -0.249574671766549, 0.258550185940986, 50, 16, 0.00448775708721848,
			 "Total", 0.972382122578272, 0.129626070100155, 0.0346207910472874,
			 -0.477659578118028, 0.465337029460974, 50, 16, -0.00616127432852687,
			 "Total", 0.979567049355307, 0.240564779510552, -0.0256117056747146,
			 -0.284453132510485, 0.259296101143064, 50, 16, -0.0125785156837105,
			 "Total", 0.927747308650414, 0.138714088101255, -0.0906794389516425,
			 -0.157964552096855, 0.113292593459841, 84, 16, -0.0223359793185072,
			 "Total", 0.746864517055583, 0.069199522974998, -0.322776492643993,
			 -0.322854602476869, 0.256884581008364, 50, 16, -0.0329850107342526,
			 "Total", 0.823512646476673, 0.147895366460338, -0.223029372208887,
			 -0.536283765861879, 0.448243661939203, 16, 50, -0.0440200519613382,
			 "Total", 0.860869629716777, 0.251159571187764, -0.175267268347219,
			 -0.350172032808878, 0.242617001616608, 50, 16, -0.053777515596135,
			 "Total", 0.722129774169108, 0.151224471240628, -0.355613844472066,
			 -0.277696766252501, 0.148843672228741, 50, 50, -0.0644265470118803,
			 "Total", 0.553794882716357, 0.108813335817836, -0.592083190241834,
			 -0.175115152687941, 0.199098505499632, 50, 16, 0.0119916764058457,
			 "Total", 0.900037409943452, 0.0954644220861514, 0.125614088932774,
			 -0.251637256760847, 0.256105682302945, 84, 50, 0.00223421277104894,
			 "Total", 0.986238136347892, 0.129528640084411, 0.0172487935455275,
			 -0.48043782101258, 0.463608183723187, 50, 16, -0.00841481864469641,
			 "Total", 0.972127149216822, 0.240832487786072, -0.0349405461117487,
			 -0.285598953705193, 0.255934833705433, 16, 84, -0.01483205999988,
			 "Total", 0.914501131310225, 0.138148912858138, -0.107362842696495,
			 -0.160001869124034, 0.110822821854681, 50, 16, -0.0245895236346768,
			 "Total", 0.721908116841854, 0.0690892009024007, -0.355909799411537,
			 -0.326026850507571, 0.255549740406726, 50, 84, -0.0352385550504221,
			 "Total", 0.812258039310728, 0.148364101458419, -0.237514025994341,
			 -0.537972146631052, 0.445424954076036, 50, 16, -0.0462735962775078,
			 "Total", 0.853659196720434, 0.250871217140723, -0.184451595543347,
			 -0.352402617817777, 0.240340497993168, 84, 84, -0.0560310599123045,
			 "Total", 0.710976804282573, 0.151212757093097, -0.370544529373326,
			 -0.281302168284941, 0.147941985628842, 50, 16, -0.0666800913280499,
			 "Total", 0.542568502788389, 0.109503071816525, -0.608933523251057,
			 -0.174356603928778, 0.200570514099128, 16, 16, 0.013106955085175,
			 "Total", 0.891002745927463, 0.0956464304919079, 0.137035485984853,
			 -0.250256236503164, 0.256955219403921, 84, 16, 0.00334949145037827,
			 "Total", 0.979348125989749, 0.12939305515507, 0.0258861763976753,
			 -0.478869096954728, 0.464270017023994, 50, 16, -0.00729953996536708,
			 "Total", 0.975796885079018, 0.24060113385197, -0.0303387596247079,
			 -0.284695254346887, 0.257261691705786, 84, 16, -0.0137167813205507,
			 "Total", 0.920969709603882, 0.138256863474931, -0.0992122993086546,
			 -0.158317291389731, 0.111368801479036, 84, 16, -0.0234742449553475,
			 "Total", 0.732951754745227, 0.0687987368635385, -0.341201685169138,
			 -0.324142183930306, 0.255895631188121, 84, 16, -0.0341232763710928,
			 "Total", 0.817620122251644, 0.147971549399298, -0.230607008641992,
			 -0.536950771339542, 0.446634136143186, 16, 50, -0.0451583175981784,
			 "Total", 0.857174861924938, 0.250919127912839, -0.179971602698479,
			 -0.350990054374712, 0.241158491908761, 84, 16, -0.0549157812329752,
			 "Total", 0.716206300372085, 0.1510610784061, -0.363533623699841,
			 -0.279091159745677, 0.147961534448236, 50, 50, -0.0655648126487205,
			 "Total", 0.547293196058507, 0.108944015696832, -0.601821148498634,
			 -0.174460477737717, 0.203108757768516, 84, 16, 0.0143241400153996,
			 "Total", 0.881779803175844, 0.0963204524380169, 0.14871337969075,
			 -0.249441003225838, 0.258574355987044, 84, 50, 0.00456667638060286,
			 "Total", 0.97189059359271, 0.129598136297412, 0.0352372071934961,
			 -0.47752917077245, 0.465364460702165, 84, 16, -0.0060823550351425,
			 "Total", 0.97982651484203, 0.240538509613452, -0.0252864085876183,
			 -0.28435552239474, 0.259356329614088, 16, 84, -0.0124995963903261,
			 "Total", 0.928194479062191, 0.138704551792165, -0.0901166993355453,
			 -0.157778087684771, 0.113263967634526, 84, 16, -0.0222570600251229,
			 "Total", 0.747535065101633, 0.0691446520082109, -0.321891272552501,
			 -0.322689606240389, 0.256877423358653, 50, 84, -0.0329060914408682,
			 "Total", 0.823876533830964, 0.14785144884564, -0.222561846351758,
			 -0.536192923376704, 0.448310658040797, 84, 16, -0.0439411326679539,
			 "Total", 0.861113196443177, 0.251153487814863, -0.174957286280432,
			 -0.350041258134653, 0.242644065529151, 84, 84, -0.0536985963027506,
			 "Total", 0.722474140324423, 0.151198013927508, -0.355154111538107,
			 -0.277497142968431, 0.148801887531439, 84, 16, -0.064347627718496,
			 "Total", 0.554056320922968, 0.108751751017483, -0.591692796818979,
			 -0.175189480088329, 0.199357843950563, 16, 16, 0.012084181931117,
			 "Total", 0.899359635648067, 0.0955495424898807, 0.126470327499441,
			 -0.251623893851357, 0.256277330443997, 16, 50, 0.0023267182963202,
			 "Total", 0.985672865004231, 0.129569019711998, 0.0179573659003669,
			 -0.480362143810273, 0.463717517571423, 50, 16, -0.00832231311942515,
			 "Total", 0.972434419919835, 0.240841073822906, -0.0345552068313093,
			 -0.285618852176136, 0.256139743226919, 16, 50, -0.0147395544746088,
			 "Total", 0.91506747402422, 0.138206262889619, -0.10664896196767,
			 -0.160051870042602, 0.111057833823791, 84, 16, -0.0244970181094055,
			 "Total", 0.723190415110551, 0.0691619096077459, -0.354198116395877,
			 -0.325958951530777, 0.255666852480475, 16, 50, -0.0351460495251509,
			 "Total", 0.812757272996011, 0.148376656050581, -0.236870478555398,
			 -0.537939670282085, 0.445577488777612, 16, 50, -0.0461810907522365,
			 "Total", 0.853966081797289, 0.250901844834282, -0.184060387370761,
			 -0.35237213519732, 0.240495026423253, 16, 50, -0.0559385543870333,
			 "Total", 0.711490256018585, 0.15124440201377, -0.369855370792106,
			 -0.281238698169661, 0.148063526564103, 50, 50, -0.0665875858027786,
			 "Total", 0.543183167686622, 0.109517886073429, -0.608006492730632,
			 -0.174396071665869, 0.200794992886762, 16, 50, 0.0131994606104463,
			 "Total", 0.890315054131801, 0.0957137650263195, 0.137905562557451,
			 -0.250217409311513, 0.257101403262812, 84, 50, 0.00344199697564953,
			 "Total", 0.978782389616054, 0.129420442563229, 0.026595465967194,
			 -0.478779693584591, 0.464365624704399, 16, 50, -0.00720703444009582,
			 "Total", 0.976103670870518, 0.240602716613264, -0.0299540858953813,
			 -0.284691158352606, 0.257442606762048, 16, 84, -0.0136242757952794,
			 "Total", 0.921526478518895, 0.138301971207363, -0.0985110745446417,
			 -0.158319875339171, 0.111556396479018, 16, 50, -0.0233817394300762,
			 "Total", 0.734144514935567, 0.0688472527931479, -0.339617609729858,
			 -0.324052005790978, 0.255990464099335, 50, 84, -0.0340307708458215,
			 "Total", 0.818107306578061, 0.147972736862926, -0.229980005555658,
			 -0.536905107430247, 0.446773483284432, 16, 50, -0.0450658120729072,
			 "Total", 0.857477729018143, 0.250943027135654, -0.179585831044214,
			 -0.350937749336254, 0.241291197920847, 84, 84, -0.0548232757077039,
			 "Total", 0.716700517466416, 0.151081589235447, -0.362871981855227,
			 -0.278997490197564, 0.148052875950665, 16, 50, -0.0654723071234493,
			 "Total", 0.547856428505077, 0.108943421796714, -0.600975314008581,
			 -0.174461580168085, 0.203294871249426, 16, 16, 0.0144166455406709,
			 "Total", 0.881080527867755, 0.0963682124766593, 0.149599594826589,
			 -0.249374250777698, 0.258692614589446, 50, 50, 0.00465918190587412,
			 "Total", 0.971324340352658, 0.129611275863922, 0.0359473500651731,
			 -0.477424765820867, 0.465445066801125, 50, 16, -0.00598984950987123,
			 "Total", 0.98013276476653, 0.240532438366018, -0.0249024603523807,
			 -0.284325131741752, 0.259510950011642, 50, 50, -0.0124070908650548,
			 "Total", 0.928740706002358, 0.138736243635879, -0.0894293411721449,
			 -0.1577280332236, 0.113398924223897, 84, 16, -0.0221645544998516,
			 "Total", 0.74862492525083, 0.0691663111123755, -0.32045303766223,
			 -0.322575022103506, 0.256947850272312, 50, 50, -0.032813585915597,
			 "Total", 0.824350399965815, 0.147840184040885, -0.221953091633884,
			 -0.536132848737754, 0.448435594452389, 16, 50, -0.0438486271426826,
			 "Total", 0.861411659345148, 0.251170034489484, -0.174577461964391,
			 -0.349965052127333, 0.242752870572374, 50, 50, -0.0536060907774794,
			 "Total", 0.722947124052105, 0.151206330160909, -0.354522794914959,
			 -0.277370286431688, 0.148860042045239, 50, 50, -0.0642551221932247,
			 "Total", 0.554562352239294, 0.108734224669172, -0.590937420014015,
			 -0.0111495551700118, 0.013414375344633, 50, 50, 0.00113241008731062,
			 "Total indirect", 0.856594631059563, 0.00626642395176697, 0.180710736462589,
			 -0.0215877263403358, 0.0260831038736157, 84, 50, 0.00224768876663995,
			 "Total indirect", 0.853366020963742, 0.0121611495389642, 0.184825353839978,
			 -0.0336127699719665, 0.0405425173656955, 50, 50, 0.00346487369686453,
			 "Total indirect", 0.854674881787889, 0.0189175127508948, 0.183156937304067,
			 -0.0123696765246239, 0.0147923352860139, 16, 84, 0.00121132938069499,
			 "Total indirect", 0.861225093406947, 0.00692921197146689, 0.174814883089593,
			 -0.0219770223313307, 0.0266302384513793, 50, 50, 0.00232660806002432,
			 "Total indirect", 0.851167422323687, 0.0124000392777923, 0.187629087932901,
			 -0.033674792644901, 0.0407623786253988, 50, 84, 0.0035437929902489,
			 "Total indirect", 0.851959128504292, 0.0189894232387561, 0.186619306215486,
			 -0.0151130283697319, 0.0177206981816644, 50, 50, 0.00130383490596625,
			 "Total indirect", 0.87630004283886, 0.00837610456375336, 0.155661249933346,
			 -0.0233253014949989, 0.02816352866559, 84, 84, 0.00241911358529558,
			 "Total indirect", 0.853879283611007, 0.0131351470146202, 0.18417103231528,
			 -0.0343529900952039, 0.0416255871262443, 50, 50, 0.00363629851552016,
			 "Total indirect", 0.851185612246558, 0.0193826462681859, 0.187605885450671,
			 16, 16, 84, 50, 50, 16, 84, 50, 84, 16, 84, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 84, 50, 50, 84,
			 84, 50, 84, 84, 84, 50, 16, 16, 16, 84, 50, 16, 16, 84, 84,
			 16, 16, 84, 16, 50, 16, 84, 50, 50, 16, 84, 84, 50, 16, 84,
			 16, 84, 16, 84, 50, 84, 16, 84, 84, 84, 16, 84, 16, 16, 50,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 16, 50, 50, 84, 50, 50,
			 50, 84, 84, 50, 50, 84, 16, 84, 50, 84, 50, 84, 50, 84, 84,
			 84, 50, 84, 16, 16, 84, 84, 50, 16, 84, 84, 84, 16, 84, 84,
			 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 84, 16, 84, 84,
			 84, 50, 84, 84, 84, 84, 84, 84, 84, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")
})


context('Model number 10 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(685.42997966185, 747.954064125565, 182.597210277062, 6, 1, 100,
			 9.52644444508335e-37, 0, 182.597210277062, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 10))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962233970971547, 0.0896223407384278, 0.0400000005143562,
			 "facExperimexperimental", "<unicode>", 0.114128730376335, "facGenderm",
			 0.0253179857464149, 1.57990453565289, -0.163250835620198, 0.0341991746206242,
			 -0.0645258304997869, "contcor2", "<unicode>", 0.200188072233423,
			 "facGenderm", 0.0503708261473891, -1.2810159259842, -0.170527282262822,
			 0.027297869693904, -0.0716147062844589, "contcor2", "<unicode>",
			 0.155883395753338, "facExperimexperimental", 0.0504665273232431,
			 -1.41905358032186, 0.756337499872039, 1.33640564566263, 1.04637157276733,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147979286957845, 7.07106781143912, 0.00473838147070793, 0.00837245260610438,
			 0.00655541703840616, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000927075998350364, 7.0710675824537, 0.180704832841867,
			 0.319295275138645, 0.250000053990256, "facGenderm", "<unicode>",
			 1.53743684450092e-12, "facGenderm", 0.0353553543304781, 7.07106628471104,
			 0.180704820500495, 0.31929523209201, 0.250000026296252, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553464973588, 7.07106706802968, 0.72154193935944, 1.27492405845551,
			 0.998232998907475, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171501992148, 7.07106593626096))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.160966936824366, 1.33182551361795, 16, 0.585429288396791, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.124224648200623,
			 0.380821398305599, 1.53728044432787, -0.360278235668253, 1.00801085606412,
			 16, 0.323866310197934, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.353498436705918, 0.349059753782535, 0.927824839983425,
			 0.0268555791486281, 1.187289903163, 50, 0.607072741155816, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.040297955497651,
			 0.296034603994699, 2.05068168708644, -0.240696017802753, 0.93171554371667,
			 50, 0.345509762956959, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.248007295922915, 0.299090077870628, 1.15520302584698,
			 -0.059306950516077, 1.32419133025818, 84, 0.632442189871049,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0.0731446712957471,
			 0.352939720241574, 1.79192693142661, -0.402473478060555, 1.14423190140494,
			 84, 0.370879211672192, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.347245173925336, 0.394574949250524, 0.939946168343072,
			 -0.0244283558102053, 0.0234847523780695, 16, -0.000471801716067889,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.969209589063641, 0.0122229562803723, -0.0385996403198718,
			 -0.0318354875993759, 0.0331198845722069, 16, 0.00064219848641552,
			 1, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.969085399103093, 0.0165705524907454, 0.0387554058184956, -0.0144875537272998,
			 0.0139308794767738, 50, -0.000278337125262978, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.96937455034052,
			 0.00724973352271639, -0.0383927387663054, -0.0413456584732719,
			 0.0430169846277128, 50, 0.000835663077220432, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.969026515690842,
			 0.0215214778859271, 0.038829260780779, -0.00379203005333242,
			 0.00368889619391548, 84, -5.15669297084682e-05, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.978443353257874,
			 0.00190843462080337, -0.0270205377466695, -0.0525714566613411,
			 0.0546963232068909, 84, 0.00106243327277494, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.969029984481503,
			 0.0273647323916017, 0.0388249100181591))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0243383512409848, 1.18845016055797, 0.606394255899478, "facGenderm",
			 "<unicode>", 0.0411595852871078, "contNormal", 0.296972755239217,
			 2.04191881309454, -2.52535807344878, 2.42710102166278, -0.0491285258930036,
			 "debCollin1", "<unicode>", 0.968981446200175, "contNormal",
			 1.26340563759741, -0.0388857896711862, -0.42796242033805, 0.721164092436873,
			 0.146600836049411, "facExperimexperimental", "<unicode>", 0.617012908216336,
			 "contNormal", 0.293149905263333, 0.500088294136482, -0.226798874971634,
			 0.320540575338686, 0.0468708501835257, "contcor2", "<unicode>",
			 0.737112947249378, "contNormal", 0.139629976527034, 0.335678994935954,
			 -1.09233336597586, 0.569207409578146, -0.261562978198857, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.537180192471001, "contNormal", 0.42387023145834,
			 -0.617082679524204, -0.393011065501025, 0.43839469468749, 0.0226918145932324,
			 "facGenderm:contcor2", "<unicode>", 0.914798653138231, "contNormal",
			 0.212097203506426, 0.106987806619265, -0.0402674808413544, 0.0518453535494461,
			 0.00578893635404585, "facGenderm", "<unicode>", 0.805409486277609,
			 "debCollin1", 0.0234986038308293, 0.246352353344967, -0.0489096700387725,
			 0.0420350273282207, -0.00343732135527589, "facExperimexperimental",
			 "<unicode>", 0.882219225578526, "debCollin1", 0.02320060421629,
			 -0.148156544684402, -0.017410047270715, 0.0258806733396879,
			 0.0042353130344864, "contcor2", "<unicode>", 0.701346832681099,
			 "debCollin1", 0.0110437541076965, 0.38350301837441, -0.0882812895932151,
			 0.0429308467604879, -0.0226752214163636, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.49814188480843, "debCollin1", 0.0334730988397459,
			 -0.677416259693263, -0.0370220790742948, 0.0287647340137122,
			 -0.00412867253029128, "facGenderm:contcor2", "<unicode>", 0.805675844201084,
			 "debCollin1", 0.0167826586628441, -0.24600825252032))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161065462582752, 1.3309804359442, 16, 0.584957486680723, 0,
			 "Total", 0.124339818363923, 0.380630947888843, 1.53681010418404,
			 -0.362292850491807, 1.00908186745554, 16, 0.323394508481866,
			 0, "Total", 0.355284019136339, 0.349846917791494, 0.924388616951047,
			 0.0264641946485893, 1.18673768423091, 16, 0.606600939439748,
			 1, "Total", 0.0404257541684208, 0.295993574048913, 2.04937198852671,
			 -0.243361889013822, 0.933437811495604, 16, 0.345037961240891,
			 0, "Total", 0.250422469903587, 0.300209521652406, 1.14932384336693,
			 -0.0601041544269663, 1.32404493073693, 50, 0.631970388154982,
			 0, "Total", 0.0734943922219438, 0.353105744820284, 1.78974824801173,
			 -0.404960348462432, 1.14577516837468, 16, 0.370407409956125,
			 0, "Total", 0.349113204462832, 0.395603064410652, 0.936310770261442,
			 -0.162060587066606, 1.33420356083302, 50, 0.586071486883206,
			 1, "Total", 0.124686581464249, 0.381707051686144, 1.53539601716632,
			 -0.358875044571562, 1.00789206194026, 16, 0.324508508684349,
			 0, "Total", 0.352008832784548, 0.348671485112152, 0.930699878081425,
			 0.0258086226882172, 1.18962125659624, 84, 0.607714939642231,
			 0, "Total", 0.040668688130846, 0.296896433579401, 2.04689201657152,
			 -0.238626005133328, 0.930929928020076, 16, 0.346151961443374,
			 0, "Total", 0.245977145529958, 0.298361587860469, 1.16017602643023,
			 -0.0595482244768047, 1.32571700119173, 84, 0.633084388357465,
			 1, "Total", 0.0732197441690361, 0.353390479772928, 1.7914585270216,
			 -0.40027033119805, 1.14331315151527, 16, 0.371521410158608,
			 0, "Total", 0.345436426691225, 0.393778532383479, 0.943478071061537,
			 -0.160933493356603, 1.33123539589966, 16, 0.585150951271528,
			 0, "Total", 0.124246380724906, 0.380662323651429, 1.53719166545977,
			 -0.361367404382217, 1.00854335052756, 16, 0.323587973072671,
			 1, "Total", 0.354482328831775, 0.34947345097039, 0.925930058990627,
			 0.0267424852555687, 1.18684632280554, 16, 0.606794404030553,
			 1, "Total", 0.0403326883052255, 0.295950294673963, 2.05032539230628,
			 -0.242153394160455, 0.932616245823846, 16, 0.345231425831696,
			 1, "Total", 0.249339369108471, 0.299691639553261, 1.1519554777915,
			 -0.0596785047935307, 1.3240062102851, 50, 0.632163852745786,
			 0, "Total", 0.0733098295867267, 0.352987280887038, 1.79089697271016,
			 -0.403852993123927, 1.14505474221779, 16, 0.370600874546929,
			 1, "Total", 0.34829309274245, 0.395136785053016, 0.937905273732501,
			 -0.162660836707048, 1.33519073965507, 50, 0.586264951474011,
			 1, "Total", 0.124961988210942, 0.38211201536788, 1.53427510231413,
			 -0.358749761780535, 1.00815370833084, 16, 0.324701973275154,
			 1, "Total", 0.351769855343992, 0.348706272383916, 0.931161837311793,
			 0.0251451367130894, 1.19067167175298, 84, 0.607908404233036,
			 0, "Total", 0.0409009467597583, 0.297333661290059, 2.04453273670888,
			 -0.238349615515606, 0.931040467583964, 16, 0.346345426034179,
			 1, "Total", 0.245646338321511, 0.29831927839582, 1.16098908490465,
			 -0.059914104592393, 1.32646981048893, 84, 0.63327785294827,
			 1, "Total", 0.0733639325254158, 0.35367586496919, 1.79055998916815,
			 -0.399869600744719, 1.14329935024354, 16, 0.371714874749413,
			 1, "Total", 0.345055731535604, 0.393672782551257, 0.944222946632118,
			 -0.160945063999577, 1.33170050693374, 16, 0.585377721467082,
			 0, "Total", 0.12422076887151, 0.380783928354581, 1.53729629293069,
			 -0.360462987194145, 1.0080924737306, 50, 0.323814743268225,
			 0, "Total", 0.353668782045258, 0.349127706355763, 0.927496550326076,
			 0.026854802016311, 1.1871875464359, 16, 0.607021174226107, 1,
			 "Total", 0.0402974374316813, 0.296008690356596, 2.0506870034621,
			 -0.2409462373099, 0.931862629364401, 50, 0.34545819602725, 0,
			 "Total", 0.248238153489599, 0.29919143308889, 1.15463933061417,
			 -0.059358864366124, 1.32414011024881, 50, 0.632390622941341,
			 0, "Total", 0.0731682256173651, 0.352939897244999, 1.79177992592421,
			 -0.402714041507616, 1.14436933099258, 50, 0.370827644742484,
			 0, "Total", 0.347430033630515, 0.39467137781699, 0.939585856956767,
			 -0.163528797267784, 1.33651224060691, 50, 0.586491721669565,
			 1, "Total", 0.125367471483623, 0.382670561731448, 1.532628271733,
			 -0.358784397025202, 1.00864188396662, 50, 0.324928743470709,
			 0, "Total", 0.351617789406449, 0.34883964495723, 0.931455894328028,
			 0.0241565292943329, 1.19211381956285, 84, 0.60813517442859,
			 0, "Total", 0.0412469763375207, 0.297953763304125, 2.04103874267182,
			 -0.238237828758674, 0.931382221218142, 50, 0.346572196229734,
			 0, "Total", 0.24543015931109, 0.298377944493529, 1.16152082493232,
			 -0.0605211952069195, 1.32753044149457, 84, 0.633504623143824,
			 1, "Total", 0.0736069131470185, 0.354101311975695, 1.78904907075664,
			 -0.399560649979446, 1.14344393986938, 50, 0.371941644944967,
			 0, "Total", 0.344710123483786, 0.393630852918689, 0.944899624069351,
			 -0.0244283558102053, 0.0234847523780695, 16, -0.000471801716067889,
			 0, "Total indirect", 0.969209589063641, 0.0122229562803723,
			 -0.0385996403198718, -0.0318354875993759, 0.0331198845722069,
			 50, 0.00064219848641552, 1, "Total indirect", 0.969085399103093,
			 0.0165705524907454, 0.0387554058184956, -0.0144875537272998,
			 0.0139308794767738, 16, -0.000278337125262978, 1, "Total indirect",
			 0.96937455034052, 0.00724973352271639, -0.0383927387663054,
			 -0.0413456584732719, 0.0430169846277128, 50, 0.000835663077220432,
			 1, "Total indirect", 0.969026515690842, 0.0215214778859271,
			 0.038829260780779, -0.00379203005333242, 0.00368889619391548,
			 50, -5.15669297084682e-05, 0, "Total indirect", 0.978443353257874,
			 0.00190843462080337, -0.0270205377466695, -0.0525714566613411,
			 0.0546963232068909, 50, 0.00106243327277494, 1, "Total indirect",
			 0.969029984481503, 0.0273647323916017, 0.0388249100181591, 50,
			 1, 50, 1, 84, 0, 50, 1, 84, 1, 50, 1, 16, 0, 84, 0, 16, 1, 84,
			 0, 50, 0, 84, 0, 50, 1, 84, 0, 84, 0, 84, 0, 84, 1, 84, 0, 16,
			 0, 84, 1, 16, 1, 84, 1, 50, 0, 84, 1, 50, 1, 84, 1, 84, 0, 84,
			 1, 84, 1, 84, 1, 16, 0, 16, 1, 50, 0, 50, 1, 84, 0, 84, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")
})


context('Model number 11 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1478.2549219961, 1548.59451701778, 392.934333112584, 18, 1, 100,
			 2.71738116799422e-72, 0, 392.934333112584, 18))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 11))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544847416033933, 0.0642100396129094, -0.240318688210512, "contcor1",
			 "<unicode>", 0.121934501661198, "contGamma", 0.155374654955655,
			 -1.54670456567772, -0.403935871427295, 0.19462682209197, -0.104654524667663,
			 "contcor2", "<unicode>", 0.493109115488801, "contGamma", 0.152697370523298,
			 -0.68537214694011, 1.37709004851916, 3.45910899429098, 2.41809952140507,
			 "contGamma__contcor1__contcor2", "<unicode>", 5.29656069003792e-06,
			 "contGamma", 0.531137041852432, 4.55268477034012, 0.424979457851701,
			 0.896763630410984, 0.660871544131342, "contcor2", "<unicode>",
			 3.99654960236973e-08, "contcor1", 0.120355316801905, 5.49100415081027,
			 -0.374368332866469, 0.853229750753713, 0.239430708943622, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.444543910851273, "contcor1", 0.313168530978967,
			 0.764542683120683, -0.164895161910039, 1.06248053971371, 0.448792688901836,
			 "contGamma__contcor1__contcor2", "<unicode>", 0.151763413053595,
			 "contcor2", 0.313111799835388, 1.43333048814443, 0.798508426054253,
			 1.41091927164602, 1.10471384885014, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.156230127293763, 7.07106796868262,
			 0.00458999074458564, 0.00811025464785488, 0.00635012269622026,
			 "debCollin1", "<unicode>", 1.53743684450092e-12, "debCollin1",
			 0.000898043007687036, 7.07106746766548, 1.68041177108733, 2.96919419852911,
			 2.32480298480822, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328777068764409, 7.0710618400035, 0.732634753601556,
			 1.29452451260394, 1.01357963310275, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341858175584, 7.07106525618763,
			 0.721541768136528, 1.27492346124068, 0.998232614688604, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171393318744,
			 7.07106865790256, 6.95315419450187, 12.2858301059484, 9.61949215022514,
			 "contGamma__contcor1__contcor2", "<unicode>", 1.53743684450092e-12,
			 "contGamma__contcor1__contcor2", 1.36040150571899, 7.07106843809405
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371904834779, 0.0938554841357814, "", "", -0.0432582103494988,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.536343297103598,
			 0.0699572520550457, -0.618352051842476, -0.00831425898121424,
			 0.00998673664916324, 16, 16, 0.000836238833974502, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.857846839480026,
			 0.00466870712286894, 0.179115719184507, -0.0190244711525219,
			 0.0231735039772947, 50, 16, 0.00207451641238641, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.847186404686926,
			 0.0107649873831022, 0.192709599979911, -0.0316637919683486,
			 0.0385156699847542, 84, 16, 0.00342593900820284, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.848244758551808,
			 0.0179032529441024, 0.191358465352599, -0.00639362442855208,
			 0.00685953477760109, 16, 50, 0.000232955174524508, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.945067726924172,
			 0.00338097008687211, 0.0689018738820092, -0.0135216053337506,
			 0.0164640708396234, 50, 50, 0.00147123275293641, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.847484208416013,
			 0.00764954774932019, 0.192329376997112, -0.0257053419776064,
			 0.0313506526751121, 84, 50, 0.00282265534875284, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.846234307754687,
			 0.014555368135019, 0.193925383581454, -0.0125197153254621, 0.0115713435791765,
			 16, 84, -0.000474185873142817, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.938499288116314, 0.00614579122235555,
			 -0.077156196165263, -0.00992805510240565, 0.0114562385129438,
			 50, 84, 0.000764091705269089, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.888608879182964, 0.00545527718468963,
			 0.140064689547496, -0.019619210923682, 0.023850239525853, 84,
			 84, 0.00211551430108552, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.84870585453109, 0.0110893492922361,
			 0.190769922142018))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371904834779, 0.0938554841357814, -0.0432582103494988, "contGamma",
			 "<unicode>", 0.536343297103598, "contNormal", 0.0699572520550457,
			 -0.618352051842476, -2.81958311577918, 2.30044867886002, -0.259567218459579,
			 "debCollin1", "<unicode>", 0.842476876628557, "contNormal",
			 1.3061545607535, -0.198726265833224, -0.0201068338194517, 0.00866072217796231,
			 -0.0057230558207447, "contGamma", "<unicode>", 0.435487602037295,
			 "debCollin1", 0.00733879709635709, -0.779835679553748, -0.0350283097329475,
			 0.0413280484676678, 0.00314986936736019, "contcor1", "<unicode>",
			 0.871537588032671, "debCollin1", 0.0194790207378565, 0.161705735095736,
			 -0.0390764344094956, 0.0457717418841731, 0.00334765373733875,
			 "contcor2", "<unicode>", 0.877089899479364, "debCollin1", 0.0216453406702726,
			 0.154659323146453, -0.0169077251495495, 0.00681510495463026,
			 -0.00504631009745964, "contGamma:contcor1:contcor2", "<unicode>",
			 0.404368123997377, "debCollin1", 0.00605185357774492, -0.833845371939754,
			 -0.0236340696956531, 0.0138396934092744, -0.00489718814318933,
			 "contGamma:contcor1", "<unicode>", 0.608463175916872, "debCollin1",
			 0.00955980910887032, -0.512268402791154, -0.0167951839273748,
			 0.0216687223743035, 0.00243676922346433, "contGamma:contcor2",
			 "<unicode>", 0.803874704729976, "debCollin1", 0.00981240130050264,
			 0.248335667166355, -0.0164773457530368, 0.0426898274458178,
			 0.0131062408463905, "contcor1:contcor2", "<unicode>", 0.385223984139144,
			 "debCollin1", 0.0150939439871237, 0.868311215251042))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.178430930224071, 0.0935869871930228, 16, 16, -0.0424219715155243,
			 "Total", 0.540985126595719, 0.0693936009954103, -0.611323968017311,
			 -0.176420873932088, 0.094053486057863, 50, 16, -0.0411836939371124,
			 "Total", 0.550596443065446, 0.068999829109978, -0.59686660776319,
			 -0.175671461277945, 0.0960069185953535, 84, 16, -0.0398322713412959,
			 "Total", 0.565479095460964, 0.0693069826834226, -0.57472234108416,
			 -0.179907311291289, 0.0938568009413408, 16, 50, -0.0430252551749743,
			 "Total", 0.537853035113131, 0.0698390670420596, -0.6160628570405,
			 -0.177237312632322, 0.093663357439197, 50, 50, -0.0417869775965624,
			 "Total", 0.545407033352302, 0.0691085836801973, -0.604656836695326,
			 -0.175760805507692, 0.0948896955062004, 84, 50, -0.0404355550007459,
			 "Total", 0.558115714890663, 0.0690447638703439, -0.585642599584787,
			 -0.182165894795744, 0.0947011023504613, 16, 84, -0.0437323962226416,
			 "Total", 0.535804124289695, 0.070630633861157, -0.619170377383404,
			 -0.178737588538281, 0.0937493512498213, 50, 84, -0.0424941186442297,
			 "Total", 0.540994631816174, 0.0695132517580538, -0.611309607441955,
			 -0.176410682253279, 0.094125290156452, 84, 84, -0.0411426960484133,
			 "Total", 0.551083950281717, 0.0690155468528207, -0.596136637678931,
			 -0.00831425898121424, 0.00998673664916324, 16, 16, 0.000836238833974502,
			 "Total indirect", 0.857846839480026, 0.00466870712286894, 0.179115719184507,
			 -0.0190244711525219, 0.0231735039772947, 50, 16, 0.00207451641238641,
			 "Total indirect", 0.847186404686926, 0.0107649873831022, 0.192709599979911,
			 -0.0316637919683486, 0.0385156699847542, 84, 16, 0.00342593900820284,
			 "Total indirect", 0.848244758551808, 0.0179032529441024, 0.191358465352599,
			 -0.00639362442855208, 0.00685953477760109, 16, 50, 0.000232955174524508,
			 "Total indirect", 0.945067726924172, 0.00338097008687211, 0.0689018738820092,
			 -0.0135216053337506, 0.0164640708396234, 50, 50, 0.00147123275293641,
			 "Total indirect", 0.847484208416013, 0.00764954774932019, 0.192329376997112,
			 -0.0257053419776064, 0.0313506526751121, 84, 50, 0.00282265534875284,
			 "Total indirect", 0.846234307754687, 0.014555368135019, 0.193925383581454,
			 -0.0125197153254621, 0.0115713435791765, 16, 84, -0.000474185873142817,
			 "Total indirect", 0.938499288116314, 0.00614579122235555, -0.077156196165263,
			 -0.00992805510240565, 0.0114562385129438, 50, 84, 0.000764091705269089,
			 "Total indirect", 0.888608879182964, 0.00545527718468963, 0.140064689547496,
			 -0.019619210923682, 0.023850239525853, 84, 84, 0.00211551430108552,
			 "Total indirect", 0.84870585453109, 0.0110893492922361, 0.190769922142018
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-11")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-11")
})


context('Model number 12 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1485.37964375147, 1571.35025988908, 388.059054867953, 12, 1, 100,
			 1.27491976125776e-75, 0, 388.059054867953, 12))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 12))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544850925749109, 0.0642052014598325, -0.240322862144638, "contcor1",
			 "<unicode>", 0.121927207205833, "contGamma", 0.155374316062208,
			 -1.54673480299292, -0.403932178950085, 0.194629419288104, -0.10465137983099,
			 "contcor2", "<unicode>", 0.493121317267503, "contGamma", 0.152697091109726,
			 -0.68535280580944, 1.37708519273608, 3.4590942363926, 2.41808971456434,
			 "contGamma__contcor1__contcor2", "<unicode>", 5.29648038072317e-06,
			 "contGamma", 0.531134515756193, 4.55268795913523, 0.424978760330708,
			 0.896762019028565, 0.660870389679636, "contcor2", "<unicode>",
			 3.99652597682376e-08, "contcor1", 0.120355083669706, 5.49100519503839,
			 -0.374378113377553, 0.853214850422019, 0.239418368522233, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.444565484600718, "contcor1", 0.313167224878281,
			 0.764506466522122, -0.164885166232402, 1.06248910424593, 0.448801969006765,
			 "contGamma__contcor1__contcor2", "<unicode>", 0.15175446984776,
			 "contcor2", 0.313111434740563, 1.43336179778497, 0.760512607677458,
			 1.34378274487763, 1.05214767627755, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.14879613651091, 7.07106851662377,
			 0.00458998970540224, 0.00811025102324364, 0.00635012036432294,
			 "debCollin1", "<unicode>", 1.53743684450092e-12, "debCollin1",
			 0.000898042348126998, 7.0710700643094, 1.68041002238994, 2.96918809923759,
			 2.32479906081377, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328775958898575, 7.07107377498654, 0.732634122088471,
			 1.29452230993105, 1.01357821600976, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341457362146, 7.07107514226674,
			 0.721541827318736, 1.27492366766484, 0.99823274749179, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171430881157,
			 7.07106771717952, 6.95314480211664, 12.2857973461297, 9.61947107412316,
			 "contGamma__contcor1__contcor2", "<unicode>", 1.53721479989599e-12,
			 "contGamma__contcor1__contcor2", 1.36039554452947, 7.07108393055661
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.198193435741037, 0.195255015180969, 16, 16, -0.00146921028003383,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.988321185560215,
			 0.100371347133283, -0.0146377459503743, -0.256619223059652,
			 0.25599434150663, 50, 16, -0.000312440776511196, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.998093681996794, 0.130771169421916,
			 -0.00238921757672096, -0.469659252910223, 0.471559305140168,
			 84, 16, 0.000950026114972673, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.996843090899385, 0.240111187112264, 0.00395660912928846,
			 -0.336777878901706, 0.27969978388476, 16, 50, -0.0285390475084734,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.856000194920787,
			 0.157267599723557, -0.181468068175765, -0.215051954787173, 0.160287398777271,
			 50, 50, -0.0273822780049508, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.77489954308595, 0.0957515945509901, -0.285972031414777,
			 -0.336419845993103, 0.284180223766169, 84, 50, -0.0261198111134669,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.868958229189432,
			 0.15831925347978, -0.164981899164923, -0.610770759666535, 0.490232656217222,
			 16, 84, -0.0602690517246565, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.830096892776813, 0.280873379451952, -0.214577301139236,
			 -0.435325884132527, 0.317101319690259, 50, 84, -0.0591122822211339,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.758114380743412,
			 0.191949242373287, -0.307957882460286, -0.360478064961051, 0.244778434301751,
			 84, 84, -0.05784981532965, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.707911243903675, 0.154405005407494, -0.374662823766478,
			 -0.00840738584419937, 0.0104051951065618, 16, 16, 0.000998904631181222,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.835120336063707, 0.00479921598028138, 0.208139128408773, -0.0186037862778857,
			 0.0235599211768878, 50, 16, 0.00247806744950103, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.817793350077391,
			 0.0107562454686299, 0.230384055173173, -0.0310738804049565,
			 0.0392586517428621, 84, 16, 0.00409238566895275, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.819579481837709,
			 0.0179423021807014, 0.228085873693203, -0.00748386899668485,
			 0.00804037348121153, 16, 50, 0.000278252242263337, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.943986951398073,
			 0.00396033871039203, 0.0702597082247525, -0.013235812781329,
			 0.0167506429024953, 50, 50, 0.00175741506058314, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.818297642942229,
			 0.00764974660768096, 0.229735068455543, -0.0250555089521232,
			 0.0317989755121929, 84, 50, 0.00337173328003487, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.81617312779992,
			 0.0145039615301039, 0.232469816817745, -0.0146046023578068,
			 0.0134716764149689, 16, 84, -0.000566462971418981, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.936962704447783,
			 0.00716244762511908, -0.0790879041729207, -0.0108023420677956,
			 0.0126277417615973, 50, 84, 0.000912699846900826, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.878636750507062,
			 0.00597717203331449, 0.1526976037855, -0.0192830315187791, 0.0243370676514842,
			 84, 84, 0.00252701806635255, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.820353038252327, 0.0111277807945282,
			 0.227090927922947))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.212248666674163, 0.159172652098807, -0.026538007287678, "contGamma",
			 "<unicode>", 0.779417380202101, "contNormal", 0.0947520775133353,
			 -0.280078368560765, -2.8329318624813, 2.21281418911297, -0.310058836684164,
			 "debCollin1", "<unicode>", 0.809649813628964, "contNormal",
			 1.28720376787392, -0.24087781936522, -0.263176115629548, 0.719814274923515,
			 0.228319079646984, "contcor1", "<unicode>", 0.362568751325246,
			 "contNormal", 0.250767462643897, 0.910481277115319, -0.62717257105392,
			 0.465126937901218, -0.0810228165763511, "contcor2", "<unicode>",
			 0.771230258343095, "contNormal", 0.278652954230551, -0.290766041939446,
			 -0.170441038442299, 0.135979861267081, -0.0172305885876089,
			 "contGamma:contcor1:contcor2", "<unicode>", 0.825540585368164,
			 "contNormal", 0.0781700332573426, -0.220424475590081, -0.240310608383069,
			 0.242685563735529, 0.00118747767622995, "contGamma:contcor1",
			 "<unicode>", 0.992310586949234, "contNormal", 0.123215573329003,
			 0.00963739926818517, -0.276011783347571, 0.219249700671036,
			 -0.0283810413382675, "contGamma:contcor2", "<unicode>", 0.822265474267469,
			 "contNormal", 0.126344536921384, -0.224632121260037, -0.231400929235212,
			 0.533066844971679, 0.150832957868234, "contcor1:contcor2", "<unicode>",
			 0.439274117180775, "contNormal", 0.195020872892797, 0.773419560844376,
			 -0.0201068155953033, 0.00866073511996437, -0.00572304023766946,
			 "contGamma", "<unicode>", 0.435488767749584, "debCollin1", 0.00733879574884601,
			 -0.779833699359923, -0.0350281981925741, 0.0413281459876382,
			 0.00314997389753203, "contcor1", "<unicode>", 0.871533338582642,
			 "debCollin1", 0.0194790171611574, 0.161711131083826, -0.0390765766188202,
			 0.0457715840943657, 0.00334750373777274, "contcor2", "<unicode>",
			 0.877095340600942, "debCollin1", 0.0216453366955866, 0.154652421667124,
			 -0.0169077127819072, 0.00681511296637981, -0.00504629990776372,
			 "contGamma:contcor1:contcor2", "<unicode>", 0.404368986631972,
			 "debCollin1", 0.00605185246652736, -0.833843841315477, -0.0236341080020354,
			 0.0138396482220056, -0.00489722989001488, "contGamma:contcor1",
			 "<unicode>", 0.608460054256842, "debCollin1", 0.00955980735350986,
			 -0.512272863764025, -0.0167951242954599, 0.0216687749431787,
			 0.00243682532385939, "contGamma:contcor2", "<unicode>", 0.803870246227096,
			 "debCollin1", 0.0098123994986737, 0.248341430063948, -0.0164773427925139,
			 0.0426898195425495, 0.0131062383750178, "contcor1:contcor2",
			 "<unicode>", 0.385223986492798, "debCollin1", 0.0150939412156974,
			 0.868311210950493))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197083569260551, 0.196142957962846, 16, 16, -0.000470305648852613,
			 "Total", 0.99625929082855, 0.100314732904563, -0.00468830086304522,
			 -0.255153087403325, 0.256526015112665, 16, 16, 0.000686463854670026,
			 "Total", 0.995803993612063, 0.130532781865394, 0.00525893836674614,
			 -0.468179010326126, 0.472076871818434, 50, 16, 0.0019489307461539,
			 "Total", 0.99351718366505, 0.239865602011358, 0.00812509476061352,
			 -0.335862781002535, 0.28078249524795, 16, 16, -0.0275401428772922,
			 "Total", 0.861025538199266, 0.157310359046009, -0.175068845079919,
			 -0.213669075935739, 0.1609023291882, 84, 16, -0.0263833733737695,
			 "Total", 0.782467655444442, 0.0955556857367048, -0.276104694036382,
			 -0.334844358251088, 0.284602545286517, 16, 16, -0.0251209064822857,
			 "Total", 0.873694201783913, 0.158025073017597, -0.158967852395729,
			 -0.609920243923404, 0.491379949736453, 16, 50, -0.0592701470934753,
			 "Total", 0.832915353562087, 0.280949089459493, -0.21096401204753,
			 -0.434284120409981, 0.318057365230076, 16, 16, -0.0581133775899526,
			 "Total", 0.762051144931183, 0.191927375088122, -0.302788372754384,
			 -0.359072830972768, 0.245371009575831, 50, 50, -0.0568509106984688,
			 "Total", 0.712359943681699, 0.154197690701558, -0.368688470234623,
			 -0.196011687017726, 0.19802940135666, 16, 16, 0.00100885716946719,
			 "Total", 0.991992461557629, 0.100522532934924, 0.0100361296120572,
			 -0.253420928033971, 0.25775218137995, 84, 50, 0.00216562667298983,
			 "Total", 0.986750064072634, 0.1304036996205, 0.0166070953453945,
			 -0.46622572787165, 0.473081915000597, 16, 16, 0.0034280935644737,
			 "Total", 0.988585729908597, 0.239623699792799, 0.0143061540550369,
			 -0.334872108789374, 0.28275014867143, 16, 84, -0.0260609800589724,
			 "Total", 0.868626040206532, 0.157559593526343, -0.165403955898218,
			 -0.212221294631284, 0.162412873520384, 16, 16, -0.0249042105554497,
			 "Total", 0.794415303027802, 0.0955716970073774, -0.260581441318629,
			 -0.332873359498659, 0.285589872170728, 50, 84, -0.0236417436639659,
			 "Total", 0.880886510727222, 0.157774131705416, -0.149845500072902,
			 -0.608864878025038, 0.493282909474727, 16, 16, -0.0577909842751555,
			 "Total", 0.837149512960275, 0.281165316351057, -0.205540943047893,
			 -0.433040413635208, 0.319771984091943, 84, 84, -0.0566342147716328,
			 "Total", 0.768072640018806, 0.192047507930054, -0.294896900157954,
			 -0.357363648329565, 0.246620152569267, 16, 16, -0.055371747880149,
			 "Total", 0.719318803897063, 0.154080331491542, -0.359369345484491,
			 -0.195860559137623, 0.20110690991546, 16, 16, 0.00262317538891892,
			 "Total", 0.979334686654084, 0.101269072336102, 0.0259030257551176,
			 -0.252319654951779, 0.259879544736662, 50, 16, 0.00377994489244156,
			 "Total", 0.97692168212745, 0.13066546215354, 0.0289284163553478,
			 -0.464523515277335, 0.474608338845186, 50, 16, 0.00504241178392543,
			 "Total", 0.983208177956245, 0.239578854899956, 0.0210469817381465,
			 -0.334441908104437, 0.285548584425396, 50, 16, -0.0244466618395206,
			 "Total", 0.877163853521141, 0.158163746227032, -0.154565521003968,
			 -0.211715605866252, 0.165135821194256, 84, 16, -0.023289892335998,
			 "Total", 0.808581433060935, 0.0961373346737656, -0.24225648043011,
			 -0.331374611529015, 0.287319760639987, 50, 16, -0.0220274254445141,
			 "Total", 0.889006453131581, 0.157833097202087, -0.139561510449931,
			 -0.608078592182671, 0.495725260071264, 16, 50, -0.0561766660557037,
			 "Total", 0.841871915488122, 0.281587789612615, -0.199499652072936,
			 -0.432218446770149, 0.322178653665787, 50, 16, -0.0550198965521811,
			 "Total", 0.774962937277061, 0.192451776253677, -0.285889263394781,
			 -0.356166353891799, 0.248651494570405, 50, 50, -0.0537574296606972,
			 "Total", 0.727531467312784, 0.154293102636816, -0.348411100314928,
			 -0.197974766731619, 0.195592850656078, 50, 16, -0.0011909580377705,
			 "Total", 0.990535774796833, 0.100401747300488, -0.0118619254125741,
			 -0.25628038794597, 0.256212010877474, 84, 50, -3.41885342478592e-05,
			 "Total", 0.999791353455443, 0.130740259225659, -0.00026149966697595,
			 -0.469284806989888, 0.47174136370436, 50, 16, 0.00122827835723601,
			 "Total", 0.995917639519839, 0.240062107803241, 0.00511650242712493,
			 -0.33658071846248, 0.28005912793006, 16, 84, -0.0282607952662101,
			 "Total", 0.8574261604869, 0.157308973852713, -0.179651513668066,
			 -0.214761711542996, 0.160553660017621, 50, 16, -0.0271040257626874,
			 "Total", 0.777112340069015, 0.0957454765804515, -0.283084138600667,
			 -0.336038485040406, 0.284355367297999, 50, 84, -0.0258415588712036,
			 "Total", 0.870299070165444, 0.15826664602819, -0.163278615676235,
			 -0.61056618087997, 0.490584581915183, 50, 16, -0.0599907994823932,
			 "Total", 0.8308917136722, 0.280910968640467, -0.213558052833367,
			 -0.435083011379611, 0.31741495142187, 84, 84, -0.0588340299788705,
			 "Total", 0.759239626196484, 0.191967293464852, -0.306479447185845,
			 -0.360145522850214, 0.245002396675441, 50, 16, -0.0575715630873867,
			 "Total", 0.709202306109037, 0.154377305985973, -0.37292763155627,
			 -0.196416566048089, 0.196992975609188, 16, 16, 0.00028820478054931,
			 "Total", 0.997708742800407, 0.100361421118052, 0.00287166898733234,
			 -0.254174480708988, 0.257064429277132, 84, 16, 0.00144497428407195,
			 "Total", 0.991160138085565, 0.130420485789205, 0.0110793505738617,
			 -0.467128247756733, 0.472543130107845, 50, 16, 0.00270744117555582,
			 "Total", 0.990988606676232, 0.23971649103672, 0.0112943467670778,
			 -0.335279961756017, 0.281716696860236, 84, 16, -0.0267816324478903,
			 "Total", 0.864892059487482, 0.15739999905178, -0.170150143641868,
			 -0.212803234381559, 0.161553508492824, 84, 16, -0.0256248629443676,
			 "Total", 0.788452569213212, 0.0955009239524965, -0.268320576218863,
			 -0.333759048846496, 0.285034256740728, 84, 16, -0.0243623960528838,
			 "Total", 0.877348949277119, 0.157858335782746, -0.154330754420297,
			 -0.609337142549421, 0.492313869221274, 16, 50, -0.0585116366640734,
			 "Total", 0.835074466726005, 0.281038585520035, -0.208197876301588,
			 -0.433584949547863, 0.318875215226762, 84, 16, -0.0573548671605507,
			 "Total", 0.765100914928325, 0.191957650933878, -0.298789169806559,
			 -0.358119882575293, 0.245935082037159, 50, 50, -0.0560924002690668,
			 "Total", 0.715855337253262, 0.154098485833709, -0.364003578397242,
			 -0.195739968416547, 0.199545014416549, 84, 16, 0.00190252300000103,
			 "Total", 0.984947383949832, 0.100839858780838, 0.0188667757274027,
			 -0.252664999207595, 0.258783584214643, 84, 50, 0.00305929250352367,
			 "Total", 0.98129329157109, 0.130473974893539, 0.0234475304827643,
			 -0.465203652024474, 0.473847170814489, 84, 16, 0.00432175939500754,
			 "Total", 0.985606511066612, 0.239558183274304, 0.0180405417002973,
			 -0.334513476596448, 0.284178848139571, 16, 84, -0.0251673142284385,
			 "Total", 0.873309805471295, 0.157832574888157, -0.159455766632918,
			 -0.211742778966667, 0.163721689516836, 84, 16, -0.0240105447249159,
			 "Total", 0.802065287414256, 0.0957835122086729, -0.250675133655642,
			 -0.331922571563692, 0.286426415896828, 50, 84, -0.022748077833432,
			 "Total", 0.885336280389214, 0.157744987239046, -0.144207928452013,
			 -0.608361847794115, 0.494567210904871, 84, 16, -0.0568973184446216,
			 "Total", 0.839745393508895, 0.281364623890732, -0.202219161946662,
			 -0.432486198077999, 0.321005100195801, 84, 84, -0.055740548941099,
			 "Total", 0.771829984658062, 0.19222070002746, -0.289982030723725,
			 -0.356576971641431, 0.247620807542201, 84, 16, -0.0544780820496151,
			 "Total", 0.723755508041743, 0.15413491879174, -0.353444128537956,
			 -0.199449997773984, 0.195378651271078, 16, 16, -0.00203567325145282,
			 "Total", 0.983875435437438, 0.100723444961086, -0.0202105205222011,
			 -0.257931638759926, 0.256173831264066, 16, 50, -0.000878903747930178,
			 "Total", 0.99465307626982, 0.131151764542408, -0.00670142526100735,
			 -0.470760916079878, 0.471528042366985, 50, 16, 0.000383563143553692,
			 "Total", 0.998726875924393, 0.240384253455553, 0.00159562507959621,
			 -0.337697666578223, 0.279486645618438, 16, 50, -0.0291055104798924,
			 "Total", 0.853340354566965, 0.157447870742762, -0.184858076152995,
			 -0.216492625787436, 0.160595143834697, 84, 16, -0.0279487409763697,
			 "Total", 0.771407270257502, 0.096197627251458, -0.290534618939327,
			 -0.337710526238479, 0.284337978068707, 16, 50, -0.0266862740848859,
			 "Total", 0.866451596143711, 0.15868875887869, -0.168167387995556,
			 -0.611477606840719, 0.489806577448568, 16, 50, -0.0608355146960755,
			 "Total", 0.828567727955513, 0.280945005361342, -0.216538872502221,
			 -0.436245080314272, 0.316887589929166, 16, 50, -0.0596787451925528,
			 "Total", 0.756091224679042, 0.1921292116039, -0.310617759237926,
			 -0.361682618049017, 0.244850061446879, 50, 50, -0.058416278301069,
			 "Total", 0.70577570636207, 0.154730567571687, -0.377535474844068,
			 -0.197322720753954, 0.196209699887688, 16, 50, -0.000556510433133009,
			 "Total", 0.995577083731672, 0.10039276837375, -0.00554333187686578,
			 -0.25538983083503, 0.256590348975809, 84, 50, 0.00060025907038963,
			 "Total", 0.99633307352473, 0.130609588709097, 0.0045958269704575,
			 -0.468366747709191, 0.472092199632938, 16, 50, 0.0018627259618735,
			 "Total", 0.993805262471885, 0.239917405309575, 0.00776403012307487,
			 -0.336033204664149, 0.280780509341004, 16, 84, -0.0276263476615726,
			 "Total", 0.860632652768238, 0.157353328650552, -0.175568879911811,
			 -0.213938932175572, 0.160999775859473, 16, 50, -0.0264695781580499,
			 "Total", 0.781983233633787, 0.095649387180712, -0.27673547043266,
			 -0.335071384259454, 0.284657161726322, 50, 84, -0.0252071112665661,
			 "Total", 0.873321538666905, 0.158096921901146, -0.159440873126723,
			 -0.610044854998015, 0.491332151242504, 16, 50, -0.0593563518777557,
			 "Total", 0.832687427798407, 0.280968684865651, -0.211256111712726,
			 -0.434448981217224, 0.318049816468758, 84, 84, -0.058199582374233,
			 "Total", 0.761757160608024, 0.191967506449505, -0.303174133219997,
			 -0.359287406139858, 0.24541317517436, 16, 50, -0.0569371154827492,
			 "Total", 0.71206008293213, 0.154263186998337, -0.369090750623237,
			 -0.196025560123424, 0.198141175696062, 16, 16, 0.00105780778631872,
			 "Total", 0.991606619209572, 0.100554586443583, 0.0105197368288338,
			 -0.2534016556963, 0.257830810275983, 50, 50, 0.00221457728984135,
			 "Total", 0.98645217138694, 0.130418841877917, 0.0169805011143588,
			 -0.466181789568407, 0.473135877931057, 50, 16, 0.00347704418132522,
			 "Total", 0.988422877557852, 0.239626257142652, 0.0145102803957552,
			 -0.334870805047014, 0.282846746162773, 50, 50, -0.0260120294421209,
			 "Total", 0.868890611392876, 0.157583903602889, -0.165067807354685,
			 -0.212225301757733, 0.162514781880536, 84, 16, -0.0248552599385982,
			 "Total", 0.794867052912516, 0.0955987167606576, -0.259995748696358,
			 -0.332839573672102, 0.285653987577873, 50, 50, -0.0235927930471143,
			 "Total", 0.881137088219169, 0.157781868985495, -0.14952790963126,
			 -0.608847596596728, 0.49336352928012, 16, 50, -0.057742033658304,
			 "Total", 0.837294742483972, 0.281181474397221, -0.205355042618251,
			 -0.433025092302878, 0.319854563993315, 50, 50, -0.0565852641547813,
			 "Total", 0.768287474844579, 0.192064666043563, -0.294615690227722,
			 -0.357339290390487, 0.246693695863892, 50, 50, -0.0553227972632974,
			 "Total", 0.719578322319443, 0.154092879006684, -0.359022413105135,
			 -0.00840738584419937, 0.0104051951065618, 50, 50, 0.000998904631181222,
			 "Total indirect", 0.835120336063707, 0.00479921598028138, 0.208139128408773,
			 -0.0186037862778857, 0.0235599211768878, 84, 50, 0.00247806744950103,
			 "Total indirect", 0.817793350077391, 0.0107562454686299, 0.230384055173173,
			 -0.0310738804049565, 0.0392586517428621, 50, 50, 0.00409238566895275,
			 "Total indirect", 0.819579481837709, 0.0179423021807014, 0.228085873693203,
			 -0.00748386899668485, 0.00804037348121153, 16, 84, 0.000278252242263337,
			 "Total indirect", 0.943986951398073, 0.00396033871039203, 0.0702597082247525,
			 -0.013235812781329, 0.0167506429024953, 50, 50, 0.00175741506058314,
			 "Total indirect", 0.818297642942229, 0.00764974660768096, 0.229735068455543,
			 -0.0250555089521232, 0.0317989755121929, 50, 84, 0.00337173328003487,
			 "Total indirect", 0.81617312779992, 0.0145039615301039, 0.232469816817745,
			 -0.0146046023578068, 0.0134716764149689, 50, 50, -0.000566462971418981,
			 "Total indirect", 0.936962704447783, 0.00716244762511908, -0.0790879041729207,
			 -0.0108023420677956, 0.0126277417615973, 84, 84, 0.000912699846900826,
			 "Total indirect", 0.878636750507062, 0.00597717203331449, 0.1526976037855,
			 -0.0192830315187791, 0.0243370676514842, 50, 50, 0.00252701806635255,
			 "Total indirect", 0.820353038252327, 0.0111277807945282, 0.227090927922947,
			 16, 16, 84, 50, 50, 16, 84, 50, 84, 16, 84, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 84, 50, 50, 84,
			 84, 50, 84, 84, 84, 50, 16, 16, 16, 84, 50, 16, 16, 84, 84,
			 16, 16, 84, 16, 50, 16, 84, 50, 50, 16, 84, 84, 50, 16, 84,
			 16, 84, 16, 84, 50, 84, 16, 84, 84, 84, 16, 84, 16, 16, 50,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 16, 50, 50, 84, 50, 50,
			 50, 84, 84, 50, 50, 84, 16, 84, 50, 84, 50, 84, 50, 84, 84,
			 84, 50, 84, 16, 16, 84, 84, 50, 16, 84, 84, 84, 16, 84, 84,
			 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 84, 16, 84, 84,
			 84, 50, 84, 84, 84, 84, 84, 84, 84, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-12")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-12")
})


context('Model number 13 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1479.38389570266, 1554.93383109632, 390.063306819145, 16, 1, 100,
			 4.39464100470734e-73, 0, 390.063306819145, 16))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 13))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544852106944066, 0.0642038441696374, -0.240324131387214, "contcor1",
			 "<unicode>", 0.121925128708819, "contGamma", 0.155374271139128,
			 -1.54674341913417, -0.403932548067454, 0.194628526046028, -0.104652011010713,
			 "contcor2", "<unicode>", 0.493118330913749, "contGamma", 0.152696957401987,
			 -0.685357539477414, 1.37708443780615, 3.45909489212409, 2.41808966496512,
			 "contGamma__contcor1__contcor2", "<unicode>", 5.29656041936555e-06,
			 "contGamma", 0.531134875625413, 4.55268478108845, 0.424978275347674,
			 0.896760223721548, 0.660869249534611, "contcor2", "<unicode>",
			 3.99639521475592e-08, "contcor1", 0.120354749397242, 5.49101097251554,
			 -0.374376654324662, 0.853215538079435, 0.239419441877387, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.444563156734044, "contcor1", 0.313167028090105,
			 0.764510374344072, -0.164879852559551, 1.06249369235136, 0.448806919895905,
			 "contGamma__contcor1__contcor2", "<unicode>", 0.151749711504124,
			 "contcor2", 0.313111249643432, 1.43337845704044, 0.77590902199129,
			 1.37098742379226, 1.07344822289178, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.151808504262036, 7.07106777785584,
			 0.00458998887638206, 0.00811024813167183, 0.00635011850402695,
			 "debCollin1", "<unicode>", 1.53743684450092e-12, "debCollin1",
			 0.000898041821956201, 7.07107213581046, 1.68041053782682, 2.96918989709114,
			 2.32480021745898, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776286051694, 7.07107025685378, 0.732633646620851,
			 1.2945206515346, 1.01357714907773, "contcor1", "<unicode>",
			 1.53721479989599e-12, "contcor1", 0.143341155589042, 7.07108258554607,
			 0.721541189293257, 1.27492144229035, 0.998231315791804, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171025937743,
			 7.0710778586537, 6.95314637899505, 12.2858028465352, 9.61947461276512,
			 "contGamma__contcor1__contcor2", "<unicode>", 1.53721479989599e-12,
			 "contGamma__contcor1__contcor2", 1.36039654544764, 7.07108132915747
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167905031887044, 0.20276655832966, 16, "", 0.0174307632213082,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.853751528767532,
			 0.0945608167141116, 0.184333890368218, -0.166283717007734, 0.107777066421806,
			 50, "", -0.0292533252929641, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.675644294031043, 0.0699147498605323, -0.418414216618372,
			 -0.28559959283062, 0.125193443807201, 84, "", -0.0802030745117094,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.444077904309787,
			 0.104796067651779, -0.765325229360814, -0.00850442433247025,
			 0.0106084196777802, 16, 16, 0.00105199767265498, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.829176139438261,
			 0.00487581510706578, 0.215758319287062, -0.0186279269050229,
			 0.0238474573053507, 50, 16, 0.00260976520016386, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.809673285921372,
			 0.0108357563060888, 0.240847535367456, -0.0311489543431669,
			 0.0397686952817562, 84, 16, 0.00430987046929464, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.811706317730686,
			 0.0180915695860517, 0.238225348485931, -0.0078492850217725,
			 0.00843540141973781, 16, 50, 0.000293058198982655, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.943761652909804,
			 0.00415433308212851, 0.0705427786335572, -0.0132572700081658,
			 0.0169589214611489, 50, 50, 0.00185082572649153, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.810247706759465,
			 0.00770835375232813, 0.240106485244341, -0.0250622828148765,
			 0.0321641448061212, 84, 50, 0.00355093099562232, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.807824388898875,
			 0.0145988467319789, 0.243233665015743, -0.0153064922498125,
			 0.0141134215402801, 16, 84, -0.000596535354766201, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.936648652547712,
			 0.00750521795863425, -0.0794827489426776, -0.0111440319764255,
			 0.0130664963219108, 50, 84, 0.000961232172742678, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.876322190258609,
			 0.00617626866853317, 0.15563315398502, -0.019339030991887, 0.024661705875634,
			 84, 84, 0.00266133744187346, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.812584918374498, 0.011224884032205,
			 0.237092644720239))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.166081127916191, 0.10792335958988, -0.0290788841631553, "contGamma",
			 "<unicode>", 0.677406626182631, "contNormal", 0.0699003883916704,
			 -0.416004615027581, -2.85705024414217, 2.20397269205075, -0.326538776045712,
			 "debCollin1", "<unicode>", 0.800333918472814, "contNormal",
			 1.29110100392498, -0.252914973385526, -0.0857124793000922, 0.607920567566794,
			 0.261104044133351, "contcor1", "<unicode>", 0.140057454250945,
			 "contNormal", 0.176950457339567, 1.47557710818624, -0.184506002634118,
			 0.088659228013894, -0.0479233873101118, "contGamma:contcor1",
			 "<unicode>", 0.4916405736342, "contNormal", 0.0696862883202712,
			 -0.687701820046157, -0.0201068190861296, 0.00866072741548949,
			 -0.00572304583532005, "contGamma", "<unicode>", 0.435488251488275,
			 "debCollin1", 0.00733879467391591, -0.779834576331905, -0.0350283351039076,
			 0.0413279978910841, 0.00314983139358823, "contcor1", "<unicode>",
			 0.871539081243671, "debCollin1", 0.0194790143077324, 0.161703839004722,
			 -0.0390764039795594, 0.0457717443058782, 0.0033476701631594,
			 "contcor2", "<unicode>", 0.8770892609435, "debCollin1", 0.0216453335251844,
			 0.154660133061215, -0.0169077416467477, 0.00681508062694241,
			 -0.00504633050990264, "contGamma:contcor1:contcor2", "<unicode>",
			 0.404366067957294, "debCollin1", 0.0060518515801343, -0.833849020102811,
			 -0.0236340603527012, 0.0138396903821061, -0.00489718498529754,
			 "contGamma:contcor1", "<unicode>", 0.608463288740988, "debCollin1",
			 0.0095598059531694, -0.512268241561322, -0.0167951738631668,
			 0.021668719741672, 0.00243677293925257, "contGamma:contcor2",
			 "<unicode>", 0.803874348338709, "debCollin1", 0.00981239806145344,
			 0.248336127824356, -0.0164772767213623, 0.0426898769475174,
			 0.0131063001130775, "contcor1:contcor2", "<unicode>", 0.385221678329665,
			 "debCollin1", 0.0150939390048957, 0.868315428386623))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.166497409959937, 0.203462931747863, 16, 16, 0.0184827608939632,
			 "Total", 0.844739509367858, 0.0943793724338815, 0.195834750934707,
			 -0.164159385895002, 0.107756730654384, 16, 16, -0.0282013276203091,
			 "Total", 0.684339402796824, 0.0693676309090945, -0.406548807429601,
			 -0.283403956813737, 0.125101803135628, 50, 16, -0.0791510768390544,
			 "Total", 0.447544152800791, 0.104212567978699, -0.759515655110167,
			 -0.165019295988361, 0.205100352831305, 16, 16, 0.0200405284214721,
			 "Total", 0.831912986427133, 0.0944200127500104, 0.212248736658531,
			 -0.161830849939661, 0.108543729754061, 84, 16, -0.0266435600928002,
			 "Total", 0.69928782163116, 0.0689743744850422, -0.386282011134122,
			 -0.280694255061681, 0.12550763643859, 16, 16, -0.0775933093115455,
			 "Total", 0.453983388655334, 0.103624835635843, -0.748790662348769,
			 -0.164519971401832, 0.208001238783037, 16, 16, 0.0217406336906028,
			 "Total", 0.819047599840313, 0.0950326672130888, 0.228770109565109,
			 -0.160815538767627, 0.110928629120288, 50, 16, -0.0249434548236694,
			 "Total", 0.718988461672578, 0.0693237656486035, -0.359811019933709,
			 -0.278751724374163, 0.126965316289334, 50, 16, -0.0758932040424147,
			 "Total", 0.463400143261375, 0.103501146925082, -0.733259546363764,
			 -0.16762322535128, 0.203070868191862, 50, 50, 0.0177238214202909,
			 "Total", 0.851330039284422, 0.0945665574640989, 0.187421662536669,
			 -0.165842104036689, 0.107921569848726, 84, 50, -0.0289602670939814,
			 "Total", 0.678381950127139, 0.0698389552167357, -0.414672112492335,
			 -0.285088177557366, 0.125268144931913, 50, 50, -0.0799100163127267,
			 "Total", 0.445260488871179, 0.104684658934072, -0.763340274748877,
			 -0.165610934393712, 0.204174112289312, 16, 50, 0.0192815889477997,
			 "Total", 0.838044361292222, 0.0943346534935951, 0.204395608970026,
			 -0.162790421665576, 0.107985422532631, 84, 50, -0.0274024995664725,
			 "Total", 0.691591295639945, 0.0690767397600293, -0.396696480778741,
			 -0.281898497774403, 0.125194000203967, 50, 50, -0.0783522487852178,
			 "Total", 0.450572811391298, 0.103852035340818, -0.75446040636646,
			 -0.164531896506511, 0.206495284940372, 84, 50, 0.0209816942169305,
			 "Total", 0.824568404748622, 0.0946515304295127, 0.221673058234971,
			 -0.160978711759635, 0.109573923164952, 84, 50, -0.0257023942973417,
			 "Total", 0.709601291555664, 0.0690197975724736, -0.372391620974448,
			 -0.279425004966691, 0.126120717934517, 84, 50, -0.0766521435160871,
			 "Total", 0.458751002620454, 0.103457442611217, -0.740905067643501,
			 -0.16942420136602, 0.203092657099104, 16, 84, 0.016834227866542,
			 "Total", 0.859395630833209, 0.0950315570601015, 0.177143555123436,
			 -0.168455388128317, 0.108755666832856, 16, 84, -0.0298498606477303,
			 "Total", 0.672955931730214, 0.0707184053247351, -0.422094651465362,
			 -0.287491545485743, 0.125892325752791, 50, 84, -0.0807996098664756,
			 "Total", 0.443566046313875, 0.105457006990754, -0.76618531259435,
			 -0.166789314908835, 0.203573305696937, 16, 84, 0.0183919953940509,
			 "Total", 0.845658051312379, 0.0944819964874726, 0.194661375476856,
			 -0.164574675273402, 0.107990489032959, 84, 84, -0.0282920931202214,
			 "Total", 0.684091671254462, 0.0695332073589926, -0.406886064871887,
			 -0.283747958776933, 0.125264274099, 16, 84, -0.0792418423389667,
			 "Total", 0.4475863755575, 0.104341772630051, -0.759445046232085,
			 -0.165027272132507, 0.205211473458871, 16, 84, 0.0200921006631817,
			 "Total", 0.831540306687608, 0.0944503951378123, 0.212726486044503,
			 -0.161831598015595, 0.108647622313414, 50, 84, -0.0265919878510906,
			 "Total", 0.699952077554016, 0.0690010690151743, -0.385385157514627,
			 -0.280656302936246, 0.125572828796574, 50, 84, -0.0775417370698359,
			 "Total", 0.454313717886721, 0.103631784802451, -0.748242802318327,
			 -0.00850442433247025, 0.0106084196777802, 50, 16, 0.00105199767265498,
			 "Total indirect", 0.829176139438261, 0.00487581510706578, 0.215758319287062,
			 -0.0186279269050229, 0.0238474573053507, 84, 16, 0.00260976520016386,
			 "Total indirect", 0.809673285921372, 0.0108357563060888, 0.240847535367456,
			 -0.0311489543431669, 0.0397686952817562, 50, 16, 0.00430987046929464,
			 "Total indirect", 0.811706317730686, 0.0180915695860517, 0.238225348485931,
			 -0.0078492850217725, 0.00843540141973781, 16, 50, 0.000293058198982655,
			 "Total indirect", 0.943761652909804, 0.00415433308212851, 0.0705427786335572,
			 -0.0132572700081658, 0.0169589214611489, 84, 50, 0.00185082572649153,
			 "Total indirect", 0.810247706759465, 0.00770835375232813, 0.240106485244341,
			 -0.0250622828148765, 0.0321641448061212, 50, 50, 0.00355093099562232,
			 "Total indirect", 0.807824388898875, 0.0145988467319789, 0.243233665015743,
			 -0.0153064922498125, 0.0141134215402801, 84, 84, -0.000596535354766201,
			 "Total indirect", 0.936648652547712, 0.00750521795863425, -0.0794827489426776,
			 -0.0111440319764255, 0.0130664963219108, 84, 84, 0.000961232172742678,
			 "Total indirect", 0.876322190258609, 0.00617626866853317, 0.15563315398502,
			 -0.019339030991887, 0.024661705875634, 84, 84, 0.00266133744187346,
			 "Total indirect", 0.812584918374498, 0.011224884032205, 0.237092644720239,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 50, 84, 16, 50, 84, 16, 50, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-13")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-13")
})


context('Model number 14 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(955.148946914815, 996.831669890625, 420.632098276142, 4, 1, 100,
			 9.67905340149231e-90, 0, 420.632098276142, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 14))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848541874033, 0.0642086253458289, -0.240319958264102, "contcor1",
			 "<unicode>", 0.121932352995429, "contGamma", 0.155374581375991,
			 -1.54671347227994, 0.761632488075169, 1.34576159075158, 1.05369703941337,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.149015264383414, 7.0710678115648, 0.00468047987132154, 0.00827014404498108,
			 0.00647531195815131, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000915747483620708, 7.07106715985617, 0.323891768636146,
			 0.572298414952702, 0.448095091794424, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702068701151,
			 7.07106878651744, 1.68041095391854, 2.96919134828341, 2.32480115110098,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776550112811, 7.07106741737902, 0.732634773667283, 1.29452458288077,
			 1.01357967827403, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341870984773, 7.07106493943905))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211934998329, 0.117652641633942, "", -0.0182796466821934,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.792112548229308,
			 0.0693544827294541, -0.263568351500806, -0.0186973015281136,
			 0.0556659656787583, 16, 0.0184843320753223, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.329873436056043, 0.0189705698149149,
			 0.97436883845153, -0.0215735578686645, 0.024248834391671, 50,
			 0.00133763826150323, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.908897118937885, 0.0116896005798516,
			 0.114429766215349, -0.0566796632203186, 0.0219280657248847,
			 84, -0.017375798747717, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.386228003996281, 0.0200533605630642,
			 -0.866478149289404))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211934998329, 0.117652641633942, -0.0182796466821934, "contGamma",
			 "<unicode>", 0.792112548229308, "contNormal", 0.0693544827294541,
			 -0.263568351500806, -2.65749892872317, 2.35038162669897, -0.153558651012103,
			 "debCollin1", "<unicode>", 0.904326045177261, "contNormal",
			 1.27754402502384, -0.120198324288071, -2.74314933241943, 0.527114551387715,
			 -1.10801739051586, "contcor1", "<unicode>", 0.184133872770698,
			 "contNormal", 0.834266320606543, -1.32813391017665, -0.533830950009324,
			 4.3904381489297, 1.92830359946019, "debCollin1:contcor1", "<unicode>",
			 0.124780927604653, "contNormal", 1.25621417989847, 1.53501180795145,
			 -0.019472096913897, 0.00121576176637669, -0.00912816757376018,
			 "contGamma", "<unicode>", 0.0837014289642957, "debCollin1",
			 0.00527761194681559, -1.72960188542622))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.138531019451171, 0.138940390237429, 16, 0.000204685393128963,
			 "Total", 0.997692795161865, 0.0707848235674887, 0.00289165647116163,
			 -0.150858307991668, 0.116974291150287, 50, -0.0169420084206901,
			 "Total", 0.804166276268057, 0.068325898142666, -0.247958810366676,
			 -0.171505611641062, 0.100194720781241, 84, -0.0356554454299103,
			 "Total", 0.606961742242762, 0.0693125829263806, -0.514415188765672,
			 -0.0186973015281136, 0.0556659656787583, 16, 0.0184843320753223,
			 "Total indirect", 0.329873436056043, 0.0189705698149149, 0.97436883845153,
			 -0.0215735578686645, 0.024248834391671, 50, 0.00133763826150323,
			 "Total indirect", 0.908897118937885, 0.0116896005798516, 0.114429766215349,
			 -0.0566796632203186, 0.0219280657248847, 84, -0.017375798747717,
			 "Total indirect", 0.386228003996281, 0.0200533605630642, -0.866478149289404
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-14")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-14")
})


context('Model number 14 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(21159.2943837637, 21263.5694748264, 21068.1377517673, 4, 1, 5000,
			 0, 0, 21068.1377517673, 4))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 14))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.032981710400573, 0.047016995028979, 0.039999352714776, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00358049554459024, 11.1714571954183,
			 1.01344414970635, 1.09613826064552, 1.05479120517594, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0210958241047926, 49.9999999969808,
			 0.00638916597185428, 0.00691050348207448, 0.00664983472696438,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132996706656971,
			 49.9999954443672, 0.105866688404181, 0.114505079982326, 0.110185884193254,
			 "debCollin1:facExperimexperimental", "<unicode>", 0, "debCollin1:facExperimexperimental",
			 0.00220371181467701, 50.0001331659618, 0.240200037493163, 0.259799653080277,
			 0.24999984528672, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00499999381154795, 50.0000309419028, 0.240200037493431, 0.259799653080597,
			 0.249999845287014, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.0049999938115611, 50.0000309418301
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.409414462788856, 0.525141325300099, 0.467277894044478, "", "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0295227012904527, 15.8277486008907,
			 -0.00329396112392794, 0.00537596954311609, 0.00104100420959408,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.637877626120503, 0.0022117576484648, 0.470668298724611, -0.00610309834439858,
			 0.00284066632591747, -0.00163121600924056, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.474646523538657,
			 0.00228161454518127, -0.714939345335808))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.409414462788856, 0.525141325300099, 0.467277894044478, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0295227012904527, 15.8277486008907,
			 -0.609830036556313, 0.372177771972248, -0.118826132292032, "debCollin1",
			 "<unicode>", 0.635268874025626, "contNormal", 0.25051679935818,
			 -0.474324007796933, -0.671882493181804, 0.266108013169045, -0.202887240006379,
			 "facExperimexperimental", "<unicode>", 0.396504818050136, "contNormal",
			 0.239287689403887, -0.847879974568737, -0.397275027889085, 1.00731981024497,
			 0.305022391177941, "debCollin1:facExperimexperimental", "<unicode>",
			 0.394628735162956, "contNormal", 0.35832159397145, 0.851253165619275,
			 -0.0132813598989518, -0.00424010931853745, -0.00876073460874463,
			 "facGenderm", "<unicode>", 0.000145687594794941, "debCollin1",
			 0.00230648385677762, -3.79830735992413))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.410201629426491, 0.526436167081653, 0.468318898254072, 0, "Total",
			 0, 0.0296522126355395, 15.7937252106701, 0.407949699941206,
			 0.523343656129268, 0.465646678035237, 1, "Total", 0, 0.0294377746474615,
			 15.8179985957394, -0.00329396112392794, 0.00537596954311609,
			 0.00104100420959408, 0, "Total indirect", 0.637877626120503,
			 0.0022117576484648, 0.470668298724611, -0.00610309834439858,
			 0.00284066632591747, -0.00163121600924056, 1, "Total indirect",
			 0.474646523538657, 0.00228161454518127, -0.714939345335808
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-14")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-14")
})


context('Model number 15 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(957.131264837892, 1001.41915799969, 543.946577283823, 8, 1, 100,
			 2.59255662350405e-112, 0, 543.946577283823, 8))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 15))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848197308917, 0.0642086830706642, -0.240319757119126, "contcor1",
			 "<unicode>", 0.121932489573557, "contGamma", 0.155374508201106,
			 -1.54671290613563, 0.761497827524653, 1.34552365319733, 1.05351074036099,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148988917724866, 7.07106781127493, 0.00468047962747408, 0.00827014319445498,
			 0.00647531141096453, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000915747328852904, 7.07106775738644, 0.323891791138177,
			 0.572298493344836, 0.448095142241506, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702211280562,
			 7.0710679916362, 1.68041078088021, 2.96919074472629, 2.32480076280325,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776440284571, 7.07106859844041, 0.732634649729282, 1.29452415042436,
			 1.01357940007682, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341792279651, 7.0710668811744))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197085182815116, 0.178065700270274, 16, -0.00950974127242079,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.920847130872627,
			 0.0957035144636667, -0.0993666881066432, -0.15565687661706,
			 0.117371148067564, 50, -0.0191428642747482, "contGamma", "contNormal",
			 "", "<unicode>", "", 0.78344021573524, 0.0696512861558259, -0.274838633014201,
			 -0.245504186941252, 0.186191799554372, 84, -0.0296561936934399,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.787708788971124,
			 0.110128550805216, -0.269287060227396, -0.0194060823796683,
			 0.0555056377090171, 16, 0.0180497776646744, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.344916188167423, 0.0191104838353101,
			 0.94449611115152, -0.0215454005838117, 0.0245412410690681, 50,
			 0.00149792024262822, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.898618641948507, 0.0117570123778818,
			 0.127406537858736, -0.0572067856853813, 0.0240741287919275,
			 84, -0.0165663284467269, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.424323488478477, 0.0207353081787324,
			 -0.798942957776651))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.155572474930671, 0.117358737199185, -0.0191068688657428, "contGamma",
			 "<unicode>", 0.783762532530778, "contNormal", 0.0696265886217049,
			 -0.274419144237473, -2.68756666104673, 2.34581816801332, -0.170874246516707,
			 "debCollin1", "<unicode>", 0.89413452958145, "contNormal", 1.28405033683342,
			 -0.133074414308475, -2.9340259845933, 0.846751872016471, -1.04363705628841,
			 "contcor1", "<unicode>", 0.279231321170438, "contNormal", 0.964501870042527,
			 -1.08204772712612, -0.790595282427076, 4.51341368043348, 1.8614091990032,
			 "debCollin1:contcor1", "<unicode>", 0.168922424090858, "contNormal",
			 1.35308837425022, 1.37567451943755, -0.155644441148095, 0.135866743892408,
			 -0.00988884862784341, "contGamma:contcor1", "<unicode>", 0.894213492514114,
			 "contNormal", 0.0743664647258589, -0.132974569441982, -0.0194720943739582,
			 0.00121576343222313, -0.00912816547086753, "contGamma", "<unicode>",
			 0.0837014871379456, "debCollin1", 0.00527761172382873, -1.72960156004909
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176714545778166, 0.193794618562673, 16, 0.0085400363922536,
			 "Total", 0.928007319993438, 0.094519380780302, 0.0903522253505216,
			 -0.14105585584546, 0.138869682625313, 16, -0.00109308661007378,
			 "Total", 0.987787256355335, 0.0714108883323342, -0.0153070019936839,
			 -0.234157157498835, 0.210944325441304, 50, -0.0116064160287655,
			 "Total", 0.918585546185741, 0.113548383146589, -0.102215599263812,
			 -0.195781763261802, 0.179758121202217, 16, -0.00801182102979256,
			 "Total", 0.933351967255097, 0.0958027513327361, -0.0836282979177331,
			 -0.151951437919654, 0.116661549855414, 84, -0.0176449440321199,
			 "Total", 0.796795501267759, 0.0685249805337884, -0.257496520169306,
			 -0.240903124286961, 0.184586577385337, 16, -0.0281582734508117,
			 "Total", 0.795315070665318, 0.108545285788031, -0.259414982846878,
			 -0.221917454077519, 0.169765314639224, 16, -0.0260760697191477,
			 "Total", 0.79411788119345, 0.0999209097223946, -0.260967096792789,
			 -0.17141996024582, 0.10000157480287, 50, -0.035709192721475,
			 "Total", 0.606050114552023, 0.0692414598404941, -0.515719813009942,
			 -0.252799772032754, 0.16035472775242, 50, -0.0462225221401668,
			 "Total", 0.660987542929876, 0.105398492789685, -0.438550124548749,
			 -0.0194060823796683, 0.0555056377090171, 50, 0.0180497776646744,
			 "Total indirect", 0.344916188167423, 0.0191104838353101, 0.94449611115152,
			 -0.0215454005838117, 0.0245412410690681, 84, 0.00149792024262822,
			 "Total indirect", 0.898618641948507, 0.0117570123778818, 0.127406537858736,
			 -0.0572067856853813, 0.0240741287919275, 50, -0.0165663284467269,
			 "Total indirect", 0.424323488478477, 0.0207353081787324, -0.798942957776651,
			 16, 84, 50, 84, 84, 84, 16, 50, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-15")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-15")
})


context('Model number 15 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(21135.9050396709, 21246.6973239249, 27191.2334919267, 8, 1, 5000,
			 0, 0, 27191.2334919267, 8))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 15))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0329818192140196, 0.047017015325803, 0.0399994172699113, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00358047296340422, 11.1715456809038,
			 1.00831105683011, 1.09058632223911, 1.04944868953461, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0209889737918598, 49.9999999972187,
			 0.00638914313671548, 0.00691047676187921, 0.00664980994929734,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132995715552924,
			 50.0001817475929, 0.105867692124763, 0.114506254472042, 0.110186973298403,
			 "debCollin1:facExperimexperimental", "<unicode>", 0, "debCollin1:facExperimexperimental",
			 0.00220375537903214, 49.9996389557516, 0.240199282836524, 0.259798770030138,
			 0.249999026433331, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00499996105750229, 50.0001947131599, 0.240199282841922, 0.259798770036465,
			 0.249999026439193, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00499996105773898, 50.0001947119654
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.533628771360149, 0.696426246676882, 0.615027509018516, 0, "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0415307313299782, 14.8089737243459,
			 0.236032577714893, 0.399733849519968, 0.317883213617431, 1,
			 "facGenderm", "contNormal", "", "<unicode>", "", 2.70894418008538e-14,
			 0.041761295895315, 7.61190970735878, -0.00306577111277064, 0.00561758144118402,
			 0.00127590516420669, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.564627226148701, 0.00221518166212436,
			 0.575982180614068, -0.00516701631125366, 0.00365520957779843,
			 -0.000755903366727614, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.73697182929777, 0.00225060918431172,
			 -0.335866116603795))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.533628771360149, 0.696426246676882, 0.615027509018516, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0415307313299782, 14.8089737243459,
			 -0.635513963140289, 0.34422535400824, -0.145644304566024, "debCollin1",
			 "<unicode>", 0.560080784604684, "contNormal", 0.249938091943676,
			 -0.582721518890549, -0.480769151176258, 0.467165882276696, -0.00680163444978117,
			 "facExperimexperimental", "<unicode>", 0.977561407918631, "contNormal",
			 0.24182460517901, -0.0281263126419509, -0.469161325364862, 0.933022353285749,
			 0.231930513960444, "debCollin1:facExperimexperimental", "<unicode>",
			 0.516737793912799, "contNormal", 0.357706490963828, 0.648382178739656,
			 -0.412579476734571, -0.1817091140676, -0.297144295401085, "facGenderm:facExperimexperimental",
			 "<unicode>", 4.530771835487e-07, "contNormal", 0.058896582918882,
			 -5.04518735510243, -0.0132810360826904, -0.00423980234636457,
			 -0.00876041921452746, "facGenderm", "<unicode>", 0.000145763813372835,
			 "debCollin1", 0.00230647955973729, -3.7981776935952))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.534659822712524, 0.697947005652921, 0.616303414182723, 0, "Total",
			 0, 0.0416556590397543, 14.7951905788971, 0.237193414056835,
			 0.40112482350644, 0.319159118781637, 0, "Total", 2.30926389122033e-14,
			 0.0418200055569068, 7.63173305530387, 0.53275343338315, 0.695789777920427,
			 0.614271605651788, 1, "Total", 0, 0.0415916684753615, 14.7691022786373,
			 0.235638145921651, 0.398616474579755, 0.317127310250703, 0,
			 "Total", 2.39808173319034e-14, 0.0415768682342268, 7.62749393398607,
			 -0.00306577111277064, 0.00561758144118402, 0.00127590516420669,
			 0, "Total indirect", 0.564627226148701, 0.00221518166212436,
			 0.575982180614068, -0.00516701631125366, 0.00365520957779843,
			 -0.000755903366727614, 1, "Total indirect", 0.73697182929777,
			 0.00225060918431172, -0.335866116603795, 1, 1, 0, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-15")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-15")
})


context('Model number 16 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1397.64854781597, 1460.17263227968, 888.487261968535, 11, 1, 100,
			 1.85051544347561e-183, 0, 888.487261968535, 11))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 16))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544847653303406, 0.0642092453649086, -0.240319203969249, "contcor1",
			 "<unicode>", 0.121933359630249, "contGamma", 0.155374512866685,
			 -1.54670929958409, -0.403933756852346, 0.194628496173394, -0.104652630339476,
			 "contcor2", "<unicode>", 0.493116623729451, "contGamma", 0.152697258150436,
			 -0.685360245541365, 0.424979119862409, 0.896762846912807, 0.660870983387608,
			 "contcor2", "<unicode>", 3.9965377007789e-08, "contcor1", 0.12035520314959,
			 5.49100467693288, 0.744754608229653, 1.3159393317632, 1.03034696999643,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145713066168303, 7.07106779845224, 0.00468048451047813, 0.00827016022612908,
			 0.0064753223683036, "debCollin1", "<unicode>", 1.53765888910584e-12,
			 "debCollin1", 0.000915750428060378, 7.07105579193534, 0.323891830845923,
			 0.57229863177737, 0.448095231311646, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702463134141,
			 7.07106658691958, 0.318532950424391, 0.562829881668092, 0.440681416046242,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217909029666, 7.07106470563998, 1.68041125813776, 2.96919240926906,
			 2.32480183370341, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776743169019, 7.07106534146871, 0.732634506671958,
			 1.29452365156678, 1.01357907911937, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341701512614, 7.07106911961819,
			 0.721541735575105, 1.27492334761205, 0.998232541593579, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171372637954,
			 7.07106917599809))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732150382717, 0.122661151765916, "", "", -0.0120354993084006,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.860979115348552,
			 0.0687240439808008, -0.175127926286802, -0.0235237637249477,
			 0.0469048819314028, 16, 16, 0.0116905591032275, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.515256390858236,
			 0.0179668213834241, 0.650674866396406, -0.058599530785615, 0.0261201093187054,
			 50, 16, -0.0162397107334548, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.452410835437954, 0.0216125502235189,
			 -0.751401873703113, -0.127745856749727, 0.0343017559207772,
			 84, 16, -0.0467220504144748, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.258389723127393, 0.0413394363235026,
			 -1.13020530925604, -0.0188121361000593, 0.0717942899562486,
			 16, 50, 0.0264910769280947, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.251757939761104, 0.0231143089288884,
			 1.14608993976826, -0.0244468915509936, 0.0215685057338182, 50,
			 50, -0.00143919290858766, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.902423082965774, 0.0117388374602226,
			 -0.122600974199056, -0.0869916004609611, 0.0231485352817458,
			 84, 50, -0.0319215325896076, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.255915094241592, 0.0280974897017186,
			 -1.13609909385091, -0.0308375950748367, 0.118516706213898, 16,
			 84, 0.0438395555695304, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.249894515489913, 0.0381012871835457,
			 1.15060563067966, -0.0243237491375046, 0.0561423206032008, 50,
			 84, 0.0159092857328481, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.438324605092179, 0.0205274358037728,
			 0.775025477362549, -0.0528433262925189, 0.0236972183961752,
			 84, 84, -0.0145730539481719, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.455461646552488, 0.0195260079502573,
			 -0.746340674719423))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732150382717, 0.122661151765916, -0.0120354993084006, "contGamma",
			 "<unicode>", 0.860979115348552, "contNormal", 0.0687240439808008,
			 -0.175127926286802, -2.33172269517051, 2.7258429063746, 0.197060105602047,
			 "debCollin1", "<unicode>", 0.878608172731475, "contNormal",
			 1.29021901459377, 0.152733840823212, -3.92782174786796, 0.322249056158175,
			 -1.80278634585489, "contcor1", "<unicode>", 0.0963630831810196,
			 "contNormal", 1.08422165854836, -1.6627470329901, -1.07379973468115,
			 3.00630212702526, 0.966251196172055, "contcor2", "<unicode>",
			 0.353242247129548, "contNormal", 1.04086143773297, 0.928318757083151,
			 -0.0857623923695217, 6.36779050854954, 3.14101405809001, "debCollin1:contcor1",
			 "<unicode>", 0.0564078426047829, "contNormal", 1.64634476751202,
			 1.90787137668421, -4.80094209648221, 1.40104546507622, -1.699948315703,
			 "debCollin1:contcor2", "<unicode>", 0.282624697000852, "contNormal",
			 1.58216875679322, -1.07444184345322, -0.0194721109134229, 0.00121576439645643,
			 -0.00912817325848325, "contGamma", "<unicode>", 0.08370148495606,
			 "debCollin1", 0.00527761618913987, -1.72960157225282))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.137050065665861, 0.136360185255515, 16, 16, -0.000344940205173068,
			 "Total", 0.996054106115398, 0.0697487946406162, -0.00494546474889477,
			 -0.164815261206574, 0.108264841122863, 50, 16, -0.0282752100418554,
			 "Total", 0.684833371235064, 0.06966457151342, -0.405876465290661,
			 -0.209620092643186, 0.0921049931974356, 84, 16, -0.0587575497228754,
			 "Total", 0.445247738212308, 0.0769720995438159, -0.763361660538154,
			 -0.125903174192458, 0.154814329431846, 16, 50, 0.0144555776196941,
			 "Total", 0.840028435808133, 0.0716129239717077, 0.201857106482694,
			 -0.146057272968186, 0.119107888534209, 50, 50, -0.0134746922169883,
			 "Total", 0.842109477275078, 0.0676454168530605, -0.199195937342777,
			 -0.18333894372053, 0.0954248799245137, 84, 50, -0.0439570318980082,
			 "Total", 0.536498830772373, 0.0711145270637362, -0.618116068726884,
			 -0.121360081957845, 0.184968194480105, 16, 84, 0.0318040562611298,
			 "Total", 0.684022371275006, 0.0781464044375886, 0.406980416949702,
			 -0.133610256013632, 0.141357828862527, 50, 84, 0.00387378642444751,
			 "Total", 0.955959643138078, 0.0701462085643084, 0.0552244590795825,
			 -0.161120995140827, 0.107903888627682, 84, 84, -0.0266085532565725,
			 "Total", 0.698230724946606, 0.0686300579731421, -0.387709904995061,
			 -0.0235237637249477, 0.0469048819314028, 16, 16, 0.0116905591032275,
			 "Total indirect", 0.515256390858236, 0.0179668213834241, 0.650674866396406,
			 -0.058599530785615, 0.0261201093187054, 50, 16, -0.0162397107334548,
			 "Total indirect", 0.452410835437954, 0.0216125502235189, -0.751401873703113,
			 -0.127745856749727, 0.0343017559207772, 84, 16, -0.0467220504144748,
			 "Total indirect", 0.258389723127393, 0.0413394363235026, -1.13020530925604,
			 -0.0188121361000593, 0.0717942899562486, 16, 50, 0.0264910769280947,
			 "Total indirect", 0.251757939761104, 0.0231143089288884, 1.14608993976826,
			 -0.0244468915509936, 0.0215685057338182, 50, 50, -0.00143919290858766,
			 "Total indirect", 0.902423082965774, 0.0117388374602226, -0.122600974199056,
			 -0.0869916004609611, 0.0231485352817458, 84, 50, -0.0319215325896076,
			 "Total indirect", 0.255915094241592, 0.0280974897017186, -1.13609909385091,
			 -0.0308375950748367, 0.118516706213898, 16, 84, 0.0438395555695304,
			 "Total indirect", 0.249894515489913, 0.0381012871835457, 1.15060563067966,
			 -0.0243237491375046, 0.0561423206032008, 50, 84, 0.0159092857328481,
			 "Total indirect", 0.438324605092179, 0.0205274358037728, 0.775025477362549,
			 -0.0528433262925189, 0.0236972183961752, 84, 84, -0.0145730539481719,
			 "Total indirect", 0.455461646552488, 0.0195260079502573, -0.746340674719423
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-16")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-16")
})


context('Model number 16 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(45259.5603269831, 45415.9729635771, 41659.3132081864, 11, 1, 5000,
			 0, 0, 41659.3132081864, 11))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 16))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0329823839159121, 0.0470177020553589, 0.0400000429856355, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00358050409348224, 11.1716233081396,
			 -0.0784876453707363, -0.0505639979675332, -0.0645258216691347,
			 "contcor2", "<unicode>", 0, "facGenderm", 0.00712351033576669,
			 -9.05814951164662, -0.0856031539190941, -0.0576264765296818,
			 -0.071614815224388, "contcor2", "<unicode>", 0, "facExperimexperimental",
			 0.00713703864205892, -10.0342479305574, 1.00835021260749, 1.09062867301509,
			 1.04948944281129, "contNormal", "<unicode>", 0, "contNormal",
			 0.0209897888574994, 49.9999999969662, 0.0063890998419124, 0.00691042610117924,
			 0.00664976297154582, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000132993836463065, 50.0005349751123, 0.105866990816758, 0.114505433845919,
			 0.110186212331338, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.00220372494017736,
			 49.99998426413, 0.423406858274736, 0.457955635064187, 0.440681246669461,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.00881362541913196, 49.9999972443647, 0.240200335227083, 0.25980000146917,
			 0.250000168348127, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00500000673397246, 49.9999663299461, 0.240200100387235, 0.259799726674498,
			 0.249999913530867, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00499999654122778, 50.0000172939074,
			 0.959102529445143, 1.03736250361025, 0.998232516527697, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0199646459788068, 50.0000108986334
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.423881214684599, 0.539952191194674, "", 0.481916702939636, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.029610487086913,
			 16.2752034954747, -0.00115498029102297, 0.0103378998724156,
			 16, 0.00459145979069632, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.117341664734566, 0.00293191105910439,
			 1.56602969808329, -0.00270733775205979, 0.00854008938653826,
			 16, 0.00291637581723924, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.309434790100454, 0.00286929434094614,
			 1.01640873005645, -0.00316444214556864, 0.00551253227715735,
			 50, 0.00117404506579435, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.595842226882181, 0.00221355455793292,
			 0.530389034951418, -0.00491596657869692, 0.00391388876337145,
			 50, -0.000501038907662734, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.823978128315595, 0.00225255550911066,
			 -0.222431325503961, -0.00830818373633164, 0.0026448046659065,
			 84, -0.00283168953521257, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.310857781264825, 0.00279418103818078,
			 -1.01342378912435, -0.0102583867563461, 0.00124483973900674,
			 84, -0.00450677350866966, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.124596562277508, 0.00293455047799061,
			 -1.53576281698708))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.423881214684599, 0.539952191194674, 0.481916702939636, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.029610487086913, 16.2752034954747,
			 -0.637167818126732, 0.344694290139093, -0.146236763993819, "debCollin1",
			 "<unicode>", 0.559336729947954, "contNormal", 0.250479630240818,
			 -0.583826971691166, -0.584913807751264, 0.353291782836633, -0.115811012457315,
			 "facExperimexperimental", "<unicode>", 0.628477158272591, "contNormal",
			 0.239342558839944, -0.48387137255753, -0.426370932659783, 0.0181326775427763,
			 -0.204119127558504, "contcor2", "<unicode>", 0.0718514813497846,
			 "contNormal", 0.113395861788468, -1.80005799452605, -0.510737641681652,
			 0.893134778392417, 0.191198568355382, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.593431850398919, "contNormal", 0.358137300263585,
			 0.533869463512073, 0.0744356774481627, 0.743498614744836, 0.408967146096499,
			 "debCollin1:contcor2", "<unicode>", 0.0165719168708369, "contNormal",
			 0.170682457069149, 2.39607018271838, -0.0132815659421977, -0.00424036414196062,
			 -0.00876096504207915, "facGenderm", "<unicode>", 0.000145616856392028,
			 "debCollin1", 0.00230647141262618, -3.79842776030933))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.428055928165475, 0.54496039729519, 16, 0.486508162730333, 0,
			 "Total", 0, 0.0298231166623066, 16.3131227443183, 0.426780340297662,
			 0.542885817216089, 16, 0.484833078756876, 1, "Total", 0, 0.0296192883732183,
			 16.3688294143914, 0.424804426392254, 0.541377069618608, 50,
			 0.483090748005431, 0, "Total", 0, 0.0297384656416811, 16.2446426734382,
			 0.423512153442856, 0.539319174621091, 50, 0.481415664031974,
			 1, "Total", 0, 0.029543150305747, 16.2953394966252, 0.420754870688259,
			 0.537415156120589, 84, 0.479085013404424, 0, "Total", 0, 0.0297608237581231,
			 16.0978411517813, 0.419441431504971, 0.535378427356963, 84,
			 0.477409929430967, 1, "Total", 0, 0.0295763077195521, 16.1416338360371,
			 -0.00115498029102297, 0.0103378998724156, 16, 0.00459145979069632,
			 0, "Total indirect", 0.117341664734566, 0.00293191105910439,
			 1.56602969808329, -0.00270733775205979, 0.00854008938653826,
			 16, 0.00291637581723924, 1, "Total indirect", 0.309434790100454,
			 0.00286929434094614, 1.01640873005645, -0.00316444214556864,
			 0.00551253227715735, 50, 0.00117404506579435, 0, "Total indirect",
			 0.595842226882181, 0.00221355455793292, 0.530389034951418, -0.00491596657869692,
			 0.00391388876337145, 50, -0.000501038907662734, 1, "Total indirect",
			 0.823978128315595, 0.00225255550911066, -0.222431325503961,
			 -0.00830818373633164, 0.0026448046659065, 84, -0.00283168953521257,
			 0, "Total indirect", 0.310857781264825, 0.00279418103818078,
			 -1.01342378912435, -0.0102583867563461, 0.00124483973900674,
			 84, -0.00450677350866966, 1, "Total indirect", 0.124596562277508,
			 0.00293455047799061, -1.53576281698708))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-16")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-16")
})


context('Model number 17 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1401.2245659664, 1468.95899080209, 1154.68783922667, 23, 1, 100,
			 1.54958666240334e-229, 0, 1154.68783922667, 23))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 17))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54484823773864, 0.0642084495591367, -0.240319894089752, "contcor1",
			 "<unicode>", 0.121932158616112, "contGamma", 0.155374458944638,
			 -1.54671427802288, -0.403934492747073, 0.194627489418532, -0.104653501664271,
			 "contcor2", "<unicode>", 0.493112828175136, "contGamma", 0.152697189052193,
			 -0.685366261906099, 0.424979261739977, 0.89676337887355, 0.660871320306764,
			 "contcor2", "<unicode>", 3.99657709149182e-08, "contcor1", 0.120355302662433,
			 5.49100293620086, 0.741603658986123, 1.31037176564458, 1.02598771231535,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145096570943352, 7.07106794905524, 0.00468047979158161, 0.0082701437668527,
			 0.00647531177921715, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.00091574743301048, 7.07106735525302, 0.323891797467913,
			 0.572298515553665, 0.448095156510789, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702251789196,
			 7.07106776480021, 0.318532887193295, 0.562829661263247, 0.440681274228271,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217508068857, 7.07106697938886, 1.68041033958577, 2.96918920554555,
			 2.32479977256566, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776160206388, 7.07107161025993, 0.732634682461519,
			 1.29452426583997, 1.01357947415074, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341813372736, 7.07106635741452,
			 0.721541892530729, 1.27492389560074, 0.998232894065735, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.14117147239312,
			 7.07106667617631))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209487149924261, 0.166373189193362, 16, 16, -0.0215569803654495,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.822117466854725,
			 0.0958845014710375, -0.224822364769356, -0.198507272835611,
			 0.314044732417454, 50, 16, 0.0577687297909213, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.658628596168929, 0.130755465226915,
			 0.441807382128683, -0.344935560412258, 0.633620881190121, 84,
			 16, 0.144342660388931, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.563121167500335, 0.249636332432919, 0.578211748995785,
			 -0.366989268586981, 0.186093961679657, 16, 50, -0.090447653453662,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.521496915120714,
			 0.141095253440698, -0.641039661136986, -0.146446906165946, 0.124203019571364,
			 50, 50, -0.0111219432972913, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.872027695892257, 0.0690446171134169, -0.161083423477049,
			 -0.233446144031163, 0.384350118632601, 84, 50, 0.0754519873007188,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.632120643034432,
			 0.157603983424405, 0.478744164083323, -0.669519649792558, 0.327123456928804,
			 16, 84, -0.171198096431877, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.500728115163034, 0.254250362400217, -0.673344552258272,
			 -0.385812021708442, 0.20206724915743, 50, 84, -0.0918723862755064,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.540142776165218,
			 0.149971957521411, -0.612597100110467, -0.229493221683952, 0.218896310328959,
			 84, 84, -0.00529845567749633, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.963054911684772, 0.114387186588568, -0.0463203601339898,
			 -0.0233319551757592, 0.0488977158883569, 16, 16, 0.0127828803562989,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.487850849246603, 0.0184262750830767, 0.693731114870803, -0.0619905653402082,
			 0.0255954271829731, 50, 16, -0.0181975690786175, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.415395388308596,
			 0.0223437760117146, -0.814435709929994, -0.139192826668691,
			 0.035175242422123, 84, 16, -0.052008792123284, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.242324048748775,
			 0.0444824676540506, -1.16919754829627, -0.0190493890458552,
			 0.0769522009573541, 16, 50, 0.0289514059557495, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.237149715685379,
			 0.0244906515529003, 1.18214110772895, -0.0252588044173729, 0.021200717459039,
			 50, 50, -0.00202904347916697, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.864069314509431, 0.0118521366318154,
			 -0.171196429993921, -0.0960695510188301, 0.0243890179711633,
			 84, 50, -0.0358402665238334, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.243491716508615, 0.0307297914502907,
			 -1.16630360416892, -0.0309767823931155, 0.126783581765687, 16,
			 84, 0.047903399686286, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.233939173250648, 0.0402457303815776,
			 1.19027283719551, -0.0239457167498851, 0.0577916172526243, 50,
			 84, 0.0169229502513696, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.417030139769639, 0.0208517438706127,
			 0.81158441022383, -0.0583143653212283, 0.0245378197346345, 84,
			 84, -0.0168882727932969, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.424276995777394, 0.0211361498755565,
			 -0.799023137739378))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.14454049647319, 0.126022998084474, -0.00925874919435818, "contGamma",
			 "<unicode>", 0.893291160526377, "contNormal", 0.0690225679379404,
			 -0.134140897259617, -2.28223744388356, 2.81249442775587, 0.265128491936156,
			 "debCollin1", "<unicode>", 0.838359743338864, "contNormal",
			 1.29970038016668, 0.203992009221505, -4.64758147825424, 0.31958320763066,
			 -2.16399913531179, "contcor1", "<unicode>", 0.0876810494336009,
			 "contNormal", 1.2671571327497, -1.70775910846666, -0.962519596253998,
			 3.35439346481548, 1.19593693428074, "contcor2", "<unicode>",
			 0.277497537122199, "contNormal", 1.10127356806573, 1.08595808431259,
			 -0.00781878326470586, 6.97589418840576, 3.48403770257053, "debCollin1:contcor1",
			 "<unicode>", 0.0505152007793785, "contNormal", 1.78159216872277,
			 1.95557533521729, -0.173334378899014, 0.336197437917986, 0.0814315295094861,
			 "contGamma:contcor1", "<unicode>", 0.531007566875847, "contNormal",
			 0.12998499483565, 0.626468690578062, -4.98755797330793, 1.27340655465868,
			 -1.85707570932462, "debCollin1:contcor2", "<unicode>", 0.244952566846334,
			 "contNormal", 1.59721417774824, -1.16269673485039, -0.303234659383237,
			 0.158779484109149, -0.072227587637044, "contGamma:contcor2",
			 "<unicode>", 0.540001901152237, "contNormal", 0.117862916649667,
			 -0.612810116109138, -0.019472094392889, 0.00121576400155217,
			 -0.00912816519566843, "contGamma", "<unicode>", 0.0837015052538457,
			 "debCollin1", 0.00527761187389778, -1.72960145872319))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.194504848470138, 0.176956648451837, 16, 16, -0.00877410000915058,
			 "Total", 0.926228817870803, 0.0947623272294839, -0.0925905923342567,
			 -0.188463397399886, 0.329566617694326, 16, 16, 0.0705516101472202,
			 "Total", 0.593436092932026, 0.132152942395974, 0.533863331894828,
			 -0.33606999886217, 0.650321080352631, 50, 16, 0.15712554074523,
			 "Total", 0.532352802787632, 0.251635001202912, 0.624418463226935,
			 -0.35156731918956, 0.196237772994834, 16, 16, -0.0776647730973631,
			 "Total", 0.578384720698276, 0.139748764902164, -0.555745685135285,
			 -0.13651796056854, 0.139839834686556, 84, 16, 0.00166093705900761,
			 "Total", 0.98120425990834, 0.0705007330325891, 0.0235591459487355,
			 -0.225828654644371, 0.402298389958406, 16, 16, 0.0882348676570177,
			 "Total", 0.581877808659266, 0.160239435407324, 0.550643900065717,
			 -0.65453242972139, 0.337701997570233, 16, 50, -0.158415216075578,
			 "Total", 0.531422376724437, 0.253125678614057, -0.625836212836848,
			 -0.373099115845902, 0.214920104007487, 16, 16, -0.0790895059192075,
			 "Total", 0.59802939904865, 0.150007659449768, -0.527236450520661,
			 -0.222171215098132, 0.237140064455737, 50, 50, 0.00748442467880254,
			 "Total", 0.949069936162135, 0.117173397872833, 0.0638747771650808,
			 -0.232177712625728, 0.152668613737594, 16, 16, -0.039754549444067,
			 "Total", 0.685530594492409, 0.0981768872792923, -0.404927784387519,
			 -0.213767811459136, 0.292910132883744, 84, 50, 0.0395711607123037,
			 "Total", 0.759495478258834, 0.129256952765329, 0.306143382353649,
			 -0.358001405711972, 0.6102915883326, 16, 16, 0.126145091310314,
			 "Total", 0.609581074431146, 0.247018057903702, 0.510671537056171,
			 -0.391820029312099, 0.17452958424754, 16, 84, -0.10864522253228,
			 "Total", 0.452065354304727, 0.144479597081103, -0.751976228666338,
			 -0.166505051226987, 0.10786602647517, 16, 16, -0.0293195123759088,
			 "Total", 0.675298987412122, 0.0699939080172803, -0.418886631800446,
			 -0.246762834519766, 0.361271670963969, 50, 84, 0.0572544182221013,
			 "Total", 0.712043799917609, 0.155113693486165, 0.369112596930123,
			 -0.693762412989462, 0.314971081968473, 16, 16, -0.189395665510495,
			 "Total", 0.46173702395198, 0.257334701789088, -0.735989604953178,
			 -0.408827842107549, 0.188687931399301, 84, 84, -0.110069955354124,
			 "Total", 0.470232837192529, 0.152430294183969, -0.722100261915652,
			 -0.246252543523893, 0.199260494011665, 16, 16, -0.0234960247561139,
			 "Total", 0.836217546167082, 0.11365337349301, -0.206734072504754,
			 -0.285231316346846, 0.138099771369379, 16, 16, -0.0735657724887335,
			 "Total", 0.495745856402775, 0.107994608843685, -0.681198564228473,
			 -0.251184400960124, 0.262704276295398, 50, 16, 0.00575993766763729,
			 "Total", 0.964954910619817, 0.131096459248489, 0.0439366379584633,
			 -0.386998313841317, 0.571666050372612, 50, 16, 0.0923338682656474,
			 "Total", 0.705766168191436, 0.244561729648032, 0.37754831223402,
			 -0.443851427187084, 0.158938536033192, 50, 16, -0.142456445576946,
			 "Total", 0.354242984552029, 0.153775775467051, -0.926390682435345,
			 -0.216541834819902, 0.0902803639787514, 84, 16, -0.0631307354205753,
			 "Total", 0.419924867917453, 0.0782724073551422, -0.806551600414368,
			 -0.277660333872392, 0.324546724227262, 50, 16, 0.0234431951774348,
			 "Total", 0.878715244924453, 0.153627072448725, 0.152598072746972,
			 -0.741287107909668, 0.294873330799346, 16, 50, -0.223206888555161,
			 "Total", 0.398434573537237, 0.264331499681146, -0.844420316248377,
			 -0.455877496045867, 0.168115139248286, 50, 16, -0.14388117839879,
			 "Total", 0.366068050572866, 0.159184719774477, -0.903863000183887,
			 -0.283642498864333, 0.169028003262772, 50, 50, -0.0573072478007803,
			 "Total", 0.619714069246908, 0.115479290869044, -0.496255626177751,
			 -0.180704466083869, 0.195493317264469, 50, 16, 0.0073944255903,
			 "Total", 0.938584664498331, 0.0959705857647736, 0.0770488742084364,
			 -0.177813635990416, 0.351253907483758, 84, 50, 0.0867201357466707,
			 "Total", 0.520535353089179, 0.134968690151297, 0.642520392318097,
			 -0.325021455654683, 0.671609588344044, 50, 16, 0.173294066344681,
			 "Total", 0.495494112098173, 0.254247285118509, 0.681596526247687,
			 -0.333983803403127, 0.210991308407302, 16, 84, -0.0614962474979125,
			 "Total", 0.658247744083434, 0.139026817867349, -0.44233370540487,
			 -0.124733966195591, 0.160392891512507, 50, 16, 0.0178294626584582,
			 "Total", 0.806363751036104, 0.0727377798666562, 0.245119698334805,
			 -0.215055518748589, 0.423862305261526, 50, 84, 0.104403393256468,
			 "Total", 0.521820211167474, 0.162992235839489, 0.640542125940785,
			 -0.635617982411671, 0.351124601459416, 50, 16, -0.142246690476128,
			 "Total", 0.572013643250899, 0.251724672405816, -0.565088392475115,
			 -0.355715537798819, 0.229873577159306, 84, 84, -0.062920980319757,
			 "Total", 0.673614561329131, 0.149387723340117, -0.421192444150865,
			 -0.209190112670823, 0.25649601322733, 50, 16, 0.0236529502782531,
			 "Total", 0.842184934978052, 0.118799664068173, 0.199099471061466,
			 -0.212090549388191, 0.164918501698959, 16, 16, -0.0235860238446164,
			 "Total", 0.806275093843465, 0.0961775456235291, -0.245234204009946,
			 -0.198606489936491, 0.31008586256, 84, 16, 0.0557396863117543,
			 "Total", 0.667541958642019, 0.129770841839185, 0.429523963332443,
			 -0.344611788108514, 0.629239021928042, 50, 16, 0.142313616909764,
			 "Total", 0.566754124994507, 0.248435894158813, 0.572838387108387,
			 -0.370031799315396, 0.185078405449738, 84, 16, -0.092476696932829,
			 "Total", 0.51373882679954, 0.141612348273686, -0.65302707045084,
			 -0.146090055011947, 0.11978808145903, 84, 16, -0.0131509867764582,
			 "Total", 0.846262576451314, 0.0678273015647712, -0.193889281647152,
			 -0.232300118246414, 0.379146005889517, 84, 16, 0.0734229438215519,
			 "Total", 0.637849190266004, 0.155984020359287, 0.470708112615846,
			 -0.672517394461817, 0.326063114639729, 16, 50, -0.173227139911044,
			 "Total", 0.496502454311515, 0.25474460678314, -0.680003169050442,
			 -0.387440656015637, 0.199637796506291, 84, 16, -0.0939014297546734,
			 "Total", 0.530671906815413, 0.149767663373595, -0.626980668853975,
			 -0.228045976027302, 0.213390977713975, 50, 50, -0.0073274991566633,
			 "Total", 0.94812013074444, 0.112613537091313, -0.0650676583466319,
			 -0.259175096114138, 0.144380602335573, 84, 16, -0.0573972468892829,
			 "Total", 0.577167627657147, 0.102949773983835, -0.557526691591331,
			 -0.230928119134015, 0.27478504566819, 84, 50, 0.0219284632670879,
			 "Total", 0.865030728700879, 0.12901083101302, 0.16997381611219,
			 -0.370937462463278, 0.587942250193474, 84, 16, 0.108502393865098,
			 "Total", 0.65736006478134, 0.24461666648476, 0.443560920947542,
			 -0.417994132052369, 0.165418292097378, 16, 84, -0.126287919977495,
			 "Total", 0.396146111282567, 0.148832434869117, -0.848524181496813,
			 -0.187648402362736, 0.0937239827204861, 84, 16, -0.0469622098211247,
			 "Total", 0.512949386871292, 0.0717799886382227, -0.654252121128331,
			 -0.258898164287657, 0.338121605841428, 50, 84, 0.0396117207768854,
			 "Total", 0.794799234949283, 0.152303760384961, 0.260083668825794,
			 -0.717642682926433, 0.303565957015011, 84, 16, -0.207038362955711,
			 "Total", 0.426776088464818, 0.260517195212924, -0.794720528088348,
			 -0.430459114779219, 0.17503380918054, 84, 84, -0.12771265279934,
			 "Total", 0.408347761587872, 0.154465318938463, -0.826804707212104,
			 -0.259607348809458, 0.177329904406799, 84, 16, -0.0411387222013298,
			 "Total", 0.7120748743571, 0.111465633211315, -0.369070905678521,
			 -0.171555003655587, 0.22424784229726, 16, 16, 0.0263464193208365,
			 "Total", 0.794147990815713, 0.100971969147109, 0.260928053036696,
			 -0.170210024048954, 0.381554283003368, 16, 50, 0.105672129477207,
			 "Total", 0.452813945174958, 0.140758787254401, 0.750732025605055,
			 -0.314720322218065, 0.699212442368499, 50, 16, 0.192246060075217,
			 "Total", 0.457339184173037, 0.258661070454441, 0.743235384193921,
			 -0.31838719268968, 0.233298685154928, 16, 50, -0.042544253767376,
			 "Total", 0.762429223645813, 0.140738779435805, -0.302292331494758,
			 -0.119785641541766, 0.193348554319756, 84, 16, 0.0367814563889947,
			 "Total", 0.645197792320678, 0.0798826402759145, 0.460443674144365,
			 -0.206503110603325, 0.453213884577334, 16, 50, 0.123355386987005,
			 "Total", 0.463584617363671, 0.168298244351535, 0.732957063588525,
			 -0.616221178438687, 0.369631784947505, 16, 50, -0.123294696745591,
			 "Total", 0.623962806094817, 0.251497724234342, -0.49024179889082,
			 -0.340007841497301, 0.25206986831886, 16, 50, -0.0439689865892204,
			 "Total", 0.770972981207396, 0.151043007546668, -0.291102430383183,
			 -0.199655142994192, 0.284865031011771, 50, 50, 0.0426049440087897,
			 "Total", 0.730328906528687, 0.123604356464659, 0.34468804520633,
			 -0.195763189748529, 0.186495129520369, 16, 50, -0.00463403011407988,
			 "Total", 0.96209848015266, 0.0975166692561963, -0.0475203895849368,
			 -0.186148199887919, 0.335531559972501, 84, 50, 0.0746916800422909,
			 "Total", 0.5746359537065, 0.133084016843004, 0.561237042690128,
			 -0.331690292770312, 0.654221514050914, 16, 50, 0.161265610640301,
			 "Total", 0.521403999191238, 0.251512735590545, 0.641182683102125,
			 -0.349367616893788, 0.202318210489203, 16, 84, -0.0735247032022924,
			 "Total", 0.601378147602611, 0.140738766562707, -0.522419692867872,
			 -0.132308877255115, 0.143910891163272, 16, 50, 0.00580100695407831,
			 "Total", 0.9343890319735, 0.0704655214578363, 0.08232404776213,
			 -0.219765803137792, 0.404515678241969, 50, 84, 0.0923749375520884,
			 "Total", 0.561893184151266, 0.159258406354406, 0.580031783983332,
			 -0.650324198475422, 0.341773906114407, 16, 50, -0.154275146180508,
			 "Total", 0.542150550679596, 0.253090901775587, -0.609564172786036,
			 -0.366990952635958, 0.217092080587684, 84, 84, -0.0749494360241369,
			 "Total", 0.614961112607727, 0.149003511756036, -0.503004493926638,
			 -0.212882349794843, 0.23613133894259, 16, 50, 0.0116244945738732,
			 "Total", 0.919167184096161, 0.114546413168608, 0.10148283348482,
			 -0.235088656892793, 0.1581981505753, 16, 16, -0.0384452531587463,
			 "Total", 0.701580680344605, 0.100330110800578, -0.383187587973089,
			 -0.212575348095904, 0.294336262091152, 50, 50, 0.0408804569976244,
			 "Total", 0.751906113506406, 0.12931656249439, 0.316127000355409,
			 -0.354966255384612, 0.609875030575881, 50, 16, 0.127454387595635,
			 "Total", 0.604585378595623, 0.246137503946766, 0.517817827644828,
			 -0.392121671361471, 0.177449818867553, 50, 50, -0.107335926246959,
			 "Total", 0.460082105737118, 0.145301519497738, -0.738711657097499,
			 -0.162739861332281, 0.106719429151104, 84, 16, -0.0280102160905882,
			 "Total", 0.683658865700256, 0.0687408780489962, -0.407475389980084,
			 -0.241488499418089, 0.358615928432933, 50, 50, 0.0585637145074219,
			 "Total", 0.702058894498206, 0.153090677324831, 0.382542657272071,
			 -0.69251535713944, 0.316342618689092, 16, 50, -0.188086369225174,
			 "Total", 0.464894292980534, 0.257366457696742, -0.730811508649656,
			 -0.404963830210711, 0.187442512073104, 50, 50, -0.108760659068803,
			 "Total", 0.471731448044146, 0.151126843900358, -0.71966472839539,
			 -0.237530978987231, 0.193157522045645, 50, 50, -0.0221867284707932,
			 "Total", 0.83996881930729, 0.109871534484841, -0.201933363130142,
			 -0.0233319551757592, 0.0488977158883569, 50, 50, 0.0127828803562989,
			 "Total indirect", 0.487850849246603, 0.0184262750830767, 0.693731114870803,
			 -0.0619905653402082, 0.0255954271829731, 84, 50, -0.0181975690786175,
			 "Total indirect", 0.415395388308596, 0.0223437760117146, -0.814435709929994,
			 -0.139192826668691, 0.035175242422123, 50, 50, -0.052008792123284,
			 "Total indirect", 0.242324048748775, 0.0444824676540506, -1.16919754829627,
			 -0.0190493890458552, 0.0769522009573541, 16, 84, 0.0289514059557495,
			 "Total indirect", 0.237149715685379, 0.0244906515529003, 1.18214110772895,
			 -0.0252588044173729, 0.021200717459039, 50, 50, -0.00202904347916697,
			 "Total indirect", 0.864069314509431, 0.0118521366318154, -0.171196429993921,
			 -0.0960695510188301, 0.0243890179711633, 50, 84, -0.0358402665238334,
			 "Total indirect", 0.243491716508615, 0.0307297914502907, -1.16630360416892,
			 -0.0309767823931155, 0.126783581765687, 50, 50, 0.047903399686286,
			 "Total indirect", 0.233939173250648, 0.0402457303815776, 1.19027283719551,
			 -0.0239457167498851, 0.0577916172526243, 84, 84, 0.0169229502513696,
			 "Total indirect", 0.417030139769639, 0.0208517438706127, 0.81158441022383,
			 -0.0583143653212283, 0.0245378197346345, 50, 50, -0.0168882727932969,
			 "Total indirect", 0.424276995777394, 0.0211361498755565, -0.799023137739378,
			 16, 16, 84, 50, 50, 16, 84, 50, 84, 16, 84, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 84, 50, 50, 84,
			 84, 50, 84, 84, 84, 50, 16, 16, 16, 84, 50, 16, 16, 84, 84,
			 16, 16, 84, 16, 50, 16, 84, 50, 50, 16, 84, 84, 50, 16, 84,
			 16, 84, 16, 84, 50, 84, 16, 84, 84, 84, 16, 84, 16, 16, 50,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 16, 50, 50, 84, 50, 50,
			 50, 84, 84, 50, 50, 84, 16, 84, 50, 84, 50, 84, 50, 84, 84,
			 84, 50, 84, 16, 16, 84, 84, 50, 16, 84, 84, 84, 16, 84, 84,
			 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 84, 16, 84, 84,
			 84, 50, 84, 84, 84, 84, 84, 84, 84, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-17")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-17")
})


context('Model number 17 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(45243.080075906, 45412.5270988828, 50913.6501385557, 23, 1, 5000,
			 0, 0, 50913.6501385557, 23))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 17))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0329825459380684, 0.0470178764050981, 0.0400002111715833, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.0035805072383316, 11.1716604684821,
			 -0.0784875612644296, -0.0505639505303451, -0.0645257558973873,
			 "contcor2", "<unicode>", 0, "facGenderm", 0.00712350098122782,
			 -9.0581521736894, -0.085603423045307, -0.057626708678301, -0.071615065861804,
			 "contcor2", "<unicode>", 0, "facExperimexperimental", 0.00713704807529189,
			 -10.0342697858141, 1.00422840688499, 1.08617053986772, 1.04519947337636,
			 "contNormal", "<unicode>", 0, "contNormal", 0.0209039894684504,
			 49.9999999977916, 0.00638916986658643, 0.00691050803943926,
			 0.00664983895301285, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000132996875699013, 49.9999636687871, 0.105867104234368, 0.114505566559916,
			 0.110186335397142, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.0022037298628157,
			 49.9999284197008, 0.42340693547044, 0.4579557253938, 0.44068133043212,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.00881362876968056, 49.9999877403609, 0.240200125494423, 0.259799756053331,
			 0.249999940773877, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00499999763095331, 50.000011845248, 0.240200468066618, 0.259800156909472,
			 0.250000312488045, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00500001249958008, 49.9999375019645,
			 0.959102169926758, 1.03736208292566, 0.998232126426208, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0199646303748955, 50.0000304379006
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.467518299729033, 0.679442050215778, 16, 0.573480174972406, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.05406317467014,
			 10.6075934029296, 0.224887551437988, 0.418462593744857, 16,
			 0.321675072591423, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 7.31874560955248e-11, 0.0493822957548617, 6.51397566018897,
			 0.521814549648763, 0.685959124874694, 50, 0.603886837261728,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0418743855807255,
			 14.4213898039782, 0.268901961200068, 0.435261508561422, 50,
			 0.352081734880745, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0, 0.0424394398758285, 8.29609759013984, 0.541525486068703,
			 0.73753073917705, 84, 0.639528112622876, 0, "facGenderm", "contNormal",
			 "", "<unicode>", "", 0, 0.0500022588819009, 12.7899844311706,
			 0.277349251390475, 0.498096769093311, 84, 0.387723010241893,
			 1, "facGenderm", "contNormal", "", "<unicode>", "", 5.77893288777886e-12,
			 0.05631417705735, 6.88499824559344, -0.00103681196967799, 0.0105376506022252,
			 16, 0.0047504193162736, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.10765429533599, 0.00295272328042787,
			 1.60882645108052, -0.00231481847242214, 0.00905460725633167,
			 16, 0.00336989439195476, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.24529011108794, 0.00290041700215779,
			 1.16186547984228, -0.00292615136611573, 0.0057770974206389,
			 50, 0.00142547302726159, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.520853348575413, 0.00222025732498269,
			 0.642030548090951, -0.00436641475614762, 0.00445631096203311,
			 50, 4.4948102942747e-05, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.98406698847011, 0.00225073669408552,
			 0.0199703959422981, -0.00790494555577557, 0.00296119680821145,
			 84, -0.00247187437378206, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.37254238814991, 0.00277202602948263,
			 -0.891721198679876, -0.00951225003212992, 0.00180745143592811,
			 84, -0.0038523992981009, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.182185154263549, 0.00288773200868648,
			 -1.33405706849273))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.520594891180967, 0.685272389544103, 0.602933640362535, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0420103378587799, 14.3520302642966,
			 -0.664773202541627, 0.315555289155466, -0.17460895669308, "debCollin1",
			 "<unicode>", 0.485059027902595, "contNormal", 0.250088394335253,
			 -0.698188962975268, -0.439602385802465, 0.50858423783836, 0.0344909260179475,
			 "facExperimexperimental", "<unicode>", 0.886613983198061, "contNormal",
			 0.241888787528751, 0.142590015727157, -0.447424727114446, 0.00862418676346735,
			 -0.219400270175489, "contcor2", "<unicode>", 0.059317118382509,
			 "contNormal", 0.116341146438192, -1.88583555253213, -0.543974175994164,
			 0.859135739172549, 0.157580781589193, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.659763186420098, "contNormal", 0.357942780131233,
			 0.440240145454027, -0.369545608458224, -0.134064596303742, -0.251805102380983,
			 "facGenderm:facExperimexperimental", "<unicode>", 2.76912885799341e-05,
			 "contNormal", 0.0600727906257274, -4.19166647259337, 0.0612600485258739,
			 0.734562628082122, 0.397911338303998, "debCollin1:contcor2",
			 "<unicode>", 0.0205246383079958, "contNormal", 0.17176401833584,
			 2.31661637960743, -0.02738004082091, 0.091139030733518, 0.031879494956304,
			 "facGenderm:contcor2", "<unicode>", 0.29170439846148, "contNormal",
			 0.0302350126046426, 1.05439000053233, -0.0132813709646102, -0.00424011751128549,
			 -0.00876074423794785, "facGenderm", "<unicode>", 0.000145685850683197,
			 "debCollin1", 0.00230648458967639, -3.79831032782969))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.472332916337915, 0.684128272239443, 16, 0.578230594288679, 0,
			 "Total", 0, 0.0540304203475529, 10.7019451370022, 0.229588120880056,
			 0.423262862935336, 16, 0.326425491907696, 0, "Total", 3.9279690611238e-11,
			 0.0494077298315077, 6.60676969010489, 0.526350245165332, 0.690924267990672,
			 16, 0.608637256578002, 1, "Total", 0, 0.0419839405528569, 14.4969064019072,
			 0.273301204310052, 0.440363104083986, 16, 0.356832154197019,
			 0, "Total", 0, 0.0426186147020295, 8.37268307972541, 0.545804594421271,
			 0.742752469457028, 50, 0.64427853193915, 0, "Total", 0, 0.0502427280779792,
			 12.8233190470708, 0.281576084287886, 0.503370774828447, 16,
			 0.392473429558167, 0, "Total", 4.02078370598247e-12, 0.0565813178941169,
			 6.9364490642056, 0.470888740261336, 0.682811398467385, 50, 0.57685006936436,
			 1, "Total", 0, 0.054062896021985, 10.669980926101, 0.228425393408766,
			 0.421664540557988, 16, 0.325044966983377, 0, "Total", 4.29118962586017e-11,
			 0.0492966066400883, 6.59365804540081, 0.525075827545112, 0.689437635762254,
			 84, 0.607256731653683, 0, "Total", 0, 0.0419298031784274, 14.4826993122189,
			 0.272359217813101, 0.438544040732299, 16, 0.3554516292727, 0,
			 "Total", 0, 0.0423948664950077, 8.3843082585142, 0.544697177022825,
			 0.741098837006837, 84, 0.642898007014831, 1, "Total", 0, 0.0501033849430916,
			 12.8314286099641, 0.280689606091101, 0.501496203176594, 16,
			 0.391092904633848, 0, "Total", 3.83915121915379e-12, 0.0563292486053793,
			 6.94298103235305, 0.468816214610987, 0.680995081388348, 16,
			 0.574905647999667, 0, "Total", 0, 0.0541282565524166, 10.6211743111094,
			 0.226264323133728, 0.41993676810364, 16, 0.323100545618684,
			 1, "Total", 6.1703753218012e-11, 0.0494071438295744, 6.53955117772424,
			 0.523012478133928, 0.687612142444052, 16, 0.60531231028899,
			 1, "Total", 0, 0.0419904818681531, 14.4154647281645, 0.270208602932984,
			 0.43680581288303, 16, 0.353507207908007, 1, "Total", 0, 0.0425000692013077,
			 8.31780311306246, 0.542698549031853, 0.739208622268423, 50,
			 0.640953585650138, 0, "Total", 0, 0.0501310418932738, 12.7855628258174,
			 0.278630227244076, 0.499666739294233, 16, 0.389148483269155,
			 1, "Total", 5.15365528030998e-12, 0.0563879014598394, 6.90127621696144,
			 0.467364148514697, 0.679686097636, 50, 0.573525123075348, 1,
			 "Total", 0, 0.0541647578210801, 10.5885292604805, 0.225092803367305,
			 0.418347238021426, 16, 0.321720020694365, 1, "Total", 6.76874112315318e-11,
			 0.0493005065854493, 6.52569401364566, 0.52172770579045, 0.686135864938892,
			 84, 0.603931785364671, 0, "Total", 0, 0.0419416276128724, 14.3993406965283,
			 0.2692575909351, 0.434995775032276, 16, 0.352126682983688, 1,
			 "Total", 0, 0.0422809259263177, 8.32826328347997, 0.541583069222989,
			 0.737563052228649, 84, 0.639573060725819, 1, "Total", 0, 0.0499958123086762,
			 12.7925326380751, 0.277737727821729, 0.497798188867943, 16,
			 0.387767958344836, 1, "Total", 4.93982632576717e-12, 0.0561389042814109,
			 6.90729474164739, 0.464564614331153, 0.677451986866094, 16,
			 0.571008300598624, 0, "Total", 0, 0.0543090011383292, 10.5140637579436,
			 0.222225695403461, 0.41618070103182, 50, 0.31920319821764, 0,
			 "Total", 1.10926379193188e-10, 0.0494792269547429, 6.45125677710377,
			 0.518932367346276, 0.683897558429617, 16, 0.601414962887946,
			 1, "Total", 0, 0.0420837302074337, 14.2909138501632, 0.266418121837993,
			 0.432801599175934, 50, 0.349609860506963, 0, "Total", 2.22044604925031e-16,
			 0.0424455445738679, 8.23666804176675, 0.538917473067766, 0.735195003430422,
			 50, 0.637056238249094, 0, "Total", 0, 0.0500717186414821, 12.7228754181672,
			 0.275053397584959, 0.495448874151263, 50, 0.385251135868111,
			 0, "Total", 7.28084259549178e-12, 0.0562243689947252, 6.85203129454871,
			 0.463103435030521, 0.676152116318088, 50, 0.569627775674305,
			 1, "Total", 0, 0.0543501520864844, 10.4807025151997, 0.221043577638637,
			 0.414601768948006, 50, 0.317822673293322, 0, "Total", 1.22240439992538e-10,
			 0.0493779969520184, 6.43652421952547, 0.517635293225144, 0.682433582702111,
			 84, 0.600034437963627, 0, "Total", 0, 0.0420411524846565, 14.2725496924143,
			 0.265455629797606, 0.431003041367683, 50, 0.348229335582644,
			 0, "Total", 2.22044604925031e-16, 0.0422322585710488, 8.24557689702544,
			 0.537792131424494, 0.733559295225057, 84, 0.635675713324775,
			 1, "Total", 0, 0.0499415206975103, 12.7284012270068, 0.274153244965044,
			 0.49358797692254, 50, 0.383870610943792, 0, "Total", 7.01394498037189e-12,
			 0.0559792765806845, 6.8573699838816, -0.00103681196967799, 0.0105376506022252,
			 16, 0.0047504193162736, 0, "Total indirect", 0.10765429533599,
			 0.00295272328042787, 1.60882645108052, -0.00231481847242214,
			 0.00905460725633167, 50, 0.00336989439195476, 1, "Total indirect",
			 0.24529011108794, 0.00290041700215779, 1.16186547984228, -0.00292615136611573,
			 0.0057770974206389, 16, 0.00142547302726159, 1, "Total indirect",
			 0.520853348575413, 0.00222025732498269, 0.642030548090951, -0.00436641475614762,
			 0.00445631096203311, 50, 4.4948102942747e-05, 1, "Total indirect",
			 0.98406698847011, 0.00225073669408552, 0.0199703959422981, -0.00790494555577557,
			 0.00296119680821145, 50, -0.00247187437378206, 0, "Total indirect",
			 0.37254238814991, 0.00277202602948263, -0.891721198679876, -0.00951225003212992,
			 0.00180745143592811, 50, -0.0038523992981009, 1, "Total indirect",
			 0.182185154263549, 0.00288773200868648, -1.33405706849273, 50,
			 1, 50, 1, 84, 0, 50, 1, 84, 1, 50, 1, 16, 0, 84, 0, 16, 1, 84,
			 0, 50, 0, 84, 0, 50, 1, 84, 0, 84, 0, 84, 0, 84, 1, 84, 0, 16,
			 0, 84, 1, 16, 1, 84, 1, 50, 0, 84, 1, 50, 1, 84, 1, 84, 0, 84,
			 1, 84, 1, 84, 1, 16, 0, 16, 1, 50, 0, 50, 1, 84, 0, 84, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-17")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-17")
})


context('Model number 18 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1607.63624598857, 1688.3965217542, 1323.98309230546, 21, 1, 100,
			 1.78136919543833e-267, 0, 1323.98309230546, 21))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 18))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544849536692753, 0.0642091756337323, -0.24032018052951, "contcor1",
			 "<unicode>", 0.121932954489184, "contGamma", 0.155374975543087,
			 -1.54671097896885, -0.403934358317774, 0.19462898559561, -0.104652686361082,
			 "contcor2", "<unicode>", 0.493117180283452, "contGamma", 0.152697536443214,
			 -0.685359363345072, -0.0667364796089488, 0.346854981113542,
			 0.140059250752296, "debCollin1__contcor1__contcor2", "<unicode>",
			 0.184359717544194, "contGamma", 0.10550996446487, 1.32745045894628,
			 0.424979740291718, 0.896764848059598, 0.660872294175658, "contcor2",
			 "<unicode>", 3.99665489592138e-08, "contcor1", 0.12035555537991,
			 5.49099949802542, 0.000709910717149737, 0.276794775258093, 0.138752342987621,
			 "debCollin1__contcor1__contcor2", "<unicode>", 0.0488333865002926,
			 "contcor1", 0.0704311065710047, 1.97004348991364, -0.00478837171676633,
			 0.268766093779461, 0.131988861031347, "debCollin1__contcor1__contcor2",
			 "<unicode>", 0.0585778384464928, "contcor2", 0.069785584749003,
			 1.89134849992402, 0.710358046494155, 1.25516254719842, 0.982760296846287,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.138983293826217, 7.07106782254795, 0.00468047959874036, 0.00827014309423328,
			 0.00647531134648682, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.00091574731061584, 7.07106782779648, 0.323891803691199,
			 0.572298537117419, 0.448095170404309, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702290923764,
			 7.07106754736691, 0.318532860215745, 0.562829567155337, 0.440681213685541,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217336814793, 7.07106795099479, 1.68041239716893, 2.96919638231979,
			 2.32480438974436, "contGamma", "<unicode>", 1.53765888910584e-12,
			 "contGamma", 0.328777466146475, 7.07105756666616, 0.732635298040662,
			 1.29452641132369, 1.01358085468218, "contcor1", "<unicode>",
			 1.53765888910584e-12, "contcor1", 0.143342203661688, 7.07105673549153,
			 0.72154205879841, 1.27492447458842, 0.998233266693414, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171577680768,
			 7.07106404201789, 0.340023716555742, 0.600802305231541, 0.470413010893641,
			 "debCollin1__contcor1__contcor2", "<unicode>", 1.53743684450092e-12,
			 "debCollin1__contcor1__contcor2", 0.0665263726101059, 7.07107561163168
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831927028979, 0.120438979821836, "", "", -0.0146964736035712,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.831207443631813,
			 0.0689479268452577, -0.213153234274252, -0.0196450816365705,
			 0.0621270577104825, 16, 16, 0.021240988036956, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.308566936213312,
			 0.0208606229481922, 1.01823363998805, -0.0396385256488236, 0.0406874856196512,
			 50, 16, 0.000524479985413812, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.979580577692615, 0.0204917059451286,
			 0.0255947448601025, -0.0907726433835908, 0.0466027322783984,
			 84, 16, -0.0220849555525962, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.528575771896546, 0.0350453826564133,
			 -0.630181606778794, -0.0173790265623712, 0.0856883304166078,
			 16, 50, 0.0341546519271183, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.193946331068213, 0.0262931762501661,
			 1.29899300115567, -0.0175032552152862, 0.0443795429664384, 50,
			 50, 0.0134381438755761, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.394641046897898, 0.0157867181922342,
			 0.851230997598133, -0.0568444190864688, 0.0385018357616011,
			 84, 50, -0.00917129166243389, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.706132571635322, 0.0243234711454264,
			 -0.37705521582837, -0.029551157700401, 0.128134053983242, 16,
			 84, 0.0492914481414205, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.220444924616294, 0.0402265584795037,
			 1.22534589098731, -0.0223737837206123, 0.0795236639003689, 50,
			 84, 0.0285749400898783, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.271655022683574, 0.0259947245012498,
			 1.09925920117001, -0.0366193908544485, 0.0485503999581852, 84,
			 84, 0.00596550455186833, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.783653124780517, 0.0217273866980317,
			 0.274561530789561))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831927028979, 0.120438979821836, -0.0146964736035712, "contGamma",
			 "<unicode>", 0.831207443631813, "contNormal", 0.0689479268452577,
			 -0.213153234274252, -4.39513847842033, 1.52254944861055, -1.43629451490489,
			 "debCollin1", "<unicode>", 0.341394264820885, "contNormal",
			 1.50964200712586, -0.951413983000771, -3.43497710276077, 0.849245465074403,
			 -1.29286581884319, "contcor1", "<unicode>", 0.236836383788022,
			 "contNormal", 1.0929340032849, -1.18293127943441, -1.18791424295213,
			 2.91802651956386, 0.865056138305865, "contcor2", "<unicode>",
			 0.408879988216387, "contNormal", 1.04745311518557, 0.82586621373751,
			 -0.133637901819298, 4.63689779463341, 2.25162994640706, "debCollin1:contcor1:contcor2",
			 "<unicode>", 0.0642913114051826, "contNormal", 1.2169957545348,
			 1.8501543148503, -0.924281210731043, 5.5838069792715, 2.32976288427023,
			 "debCollin1:contcor1", "<unicode>", 0.160541022697072, "contNormal",
			 1.66025708669585, 1.40325429292808, -4.58909594391115, 1.6226345417456,
			 -1.48323070108277, "debCollin1:contcor2", "<unicode>", 0.34927502986005,
			 "contNormal", 1.5846542422856, -0.935996422123898, -2.95950679117644,
			 0.224915026218203, -1.36729588247912, "contcor1:contcor2", "<unicode>",
			 0.092355673057088, "contNormal", 0.812367431879605, -1.68310031744571,
			 -0.0194720932739939, 0.00121576442919575, -0.00912816442239908,
			 "contGamma", "<unicode>", 0.0837015211172012, "debCollin1",
			 0.00527761169755486, -1.72960136999624))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.131652393441486, 0.144741422308255, 16, 16, 0.00654451443338481,
			 "Total", 0.926049001674465, 0.0705099221031357, 0.0928169289963485,
			 -0.150698321715704, 0.12235433447939, 50, 16, -0.0141719936181574,
			 "Total", 0.838781515735352, 0.0696575698198789, -0.203452311856463,
			 -0.182752130844733, 0.109189272532398, 84, 16, -0.0367814291561674,
			 "Total", 0.621399318522814, 0.0744762163182406, -0.493868122932004,
			 -0.124194490408066, 0.16311084705516, 16, 50, 0.0194581783235471,
			 "Total", 0.790637472462215, 0.0732935247100083, 0.26548291135588,
			 -0.137410435779105, 0.134893776323115, 50, 50, -0.00125832972799506,
			 "Total", 0.985547782261506, 0.0694666366959089, -0.0181141593698198,
			 -0.163208459008005, 0.115472928475995, 84, 50, -0.0238677652660051,
			 "Total", 0.737079302178952, 0.0710934970443852, -0.335723607056549,
			 -0.123029559843939, 0.192219508919637, 16, 84, 0.0345949745378493,
			 "Total", 0.667074021886266, 0.080422158583071, 0.430167197043274,
			 -0.13042942099896, 0.158186353971574, 50, 84, 0.0138784664863072,
			 "Total", 0.850488747548098, 0.0736278261353522, 0.188494856018076,
			 -0.148750765148436, 0.13128882704503, 84, 84, -0.00873096905170285,
			 "Total", 0.902729507888542, 0.0714399842043993, -0.122214039503738,
			 -0.0196450816365705, 0.0621270577104825, 16, 16, 0.021240988036956,
			 "Total indirect", 0.308566936213312, 0.0208606229481922, 1.01823363998805,
			 -0.0396385256488236, 0.0406874856196512, 50, 16, 0.000524479985413812,
			 "Total indirect", 0.979580577692615, 0.0204917059451286, 0.0255947448601025,
			 -0.0907726433835908, 0.0466027322783984, 84, 16, -0.0220849555525962,
			 "Total indirect", 0.528575771896546, 0.0350453826564133, -0.630181606778794,
			 -0.0173790265623712, 0.0856883304166078, 16, 50, 0.0341546519271183,
			 "Total indirect", 0.193946331068213, 0.0262931762501661, 1.29899300115567,
			 -0.0175032552152862, 0.0443795429664384, 50, 50, 0.0134381438755761,
			 "Total indirect", 0.394641046897898, 0.0157867181922342, 0.851230997598133,
			 -0.0568444190864688, 0.0385018357616011, 84, 50, -0.00917129166243389,
			 "Total indirect", 0.706132571635322, 0.0243234711454264, -0.37705521582837,
			 -0.029551157700401, 0.128134053983242, 16, 84, 0.0492914481414205,
			 "Total indirect", 0.220444924616294, 0.0402265584795037, 1.22534589098731,
			 -0.0223737837206123, 0.0795236639003689, 50, 84, 0.0285749400898783,
			 "Total indirect", 0.271655022683574, 0.0259947245012498, 1.09925920117001,
			 -0.0366193908544485, 0.0485503999581852, 84, 84, 0.00596550455186833,
			 "Total indirect", 0.783653124780517, 0.0217273866980317, 0.274561530789561
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-18")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-18")
})


context('Model number 21 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1196.38264812788, 1253.69639221962, 533.124121942581, 11, 1, 100,
			 2.74264460952372e-107, 0, 533.124121942581, 11))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 21))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403934585553493, 0.194627755005576, -0.104653415273959, "contcor2",
			 "<unicode>", 0.493113443986803, "contGamma", 0.152697280480777,
			 -0.685365285776214, -0.544848250930992, 0.0642086949947644,
			 -0.240319777968114, "contcor1", "<unicode>", 0.121932497358586,
			 "contGamma", 0.155374524922376, -1.5467128738651, 0.424979224083132,
			 0.896763186812491, 0.660871205447812, "contcor1", "<unicode>",
			 3.99655801786025e-08, "contcor2", 0.120355263272879, 5.49100377894924,
			 0.797155177373516, 1.40852817649253, 1.10284167693302, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.155965365675454,
			 7.07106781147754, 0.00465468542915727, 0.00822456573014391,
			 0.00643962557965059, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700484586808, 7.0710685770331, 0.318532862733058,
			 0.562829575901197, 0.440681219317127, "debCollin1:contcor2",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2", 0.0623217352704235,
			 7.07106786107518, 1.68041105739129, 2.96919170921792, 2.3248013833046,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776615793036, 7.07106671104632, 0.721541855543054, 1.27492376611661,
			 0.998232810829832, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171448796652, 7.07106726847948, 0.732634577077837,
			 1.29452389690225, 1.01357923699004, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341746138328, 7.07106801958389
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.178615926667724, 0.0960662317056182, "", "", -0.0412748474810527,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.555845063111298,
			 0.070073266789594, -0.589024165306676, -0.0180242800615154,
			 0.0250910343994083, 16, 16, 0.00353337716894644, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.748024648476141,
			 0.0109990068187507, 0.321245111233395, -0.0280505237807075,
			 0.040220171478969, 50, 16, 0.00608482384913078, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.726807831938925,
			 0.0174163137175446, 0.349374956596076, -0.0409462082994059,
			 0.0586850155394951, 84, 16, 0.00886940362004459, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.727118499697861,
			 0.0254165955662398, 0.348961118609668, -0.0129049879674199,
			 0.0162362421893808, 16, 50, 0.00166562711098044, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.822717177879378,
			 0.00743412388866913, 0.224051567598859, -0.021262067959195,
			 0.0269988161658262, 50, 50, 0.00286837410331561, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.815776950801466,
			 0.0123116762618336, 0.232979981142586, -0.0310107196649134,
			 0.039372758825414, 84, 50, 0.00418101958025027, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.81587233996751,
			 0.017955298935466, 0.232857141241562, -0.0198977742515326, 0.0188504489708599,
			 16, 84, -0.00052366264033638, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.957751154344874, 0.00988493245999252,
			 -0.0529758440389765, -0.0341957431237784, 0.0323921457321262,
			 50, 84, -0.000901798695826095, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.957662174444169, 0.0169870184812429,
			 -0.0530875207336628, -0.0498459685429103, 0.0472169962618297,
			 84, 84, -0.00131448614054029, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.957663333260782, 0.0247614154061912,
			 -0.0530860663244488))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.178615926667724, 0.0960662317056182, -0.0412748474810527, "contGamma",
			 "<unicode>", 0.555845063111298, "contNormal", 0.070073266789594,
			 -0.589024165306676, -2.89508727812076, 2.25712081262235, -0.318983232749207,
			 "debCollin1", "<unicode>", 0.80824526691151, "contNormal", 1.31436295038661,
			 -0.242690371525902, -1.81452229468607, 1.39871379792211, -0.207904248381982,
			 "contcor2", "<unicode>", 0.799782233278348, "contNormal", 0.819718147362344,
			 -0.253628944352358, -2.05867623512561, 2.78324101757367, 0.362282391224029,
			 "debCollin1:contcor2", "<unicode>", 0.769294977062278, "contNormal",
			 1.23520566982141, 0.293297221730215, -0.0197475139826179, 0.00116000342033934,
			 -0.00929375528113927, "contGamma", "<unicode>", 0.0814251542542797,
			 "debCollin1", 0.00533364836493758, -1.74247618988809, -0.0185476033166776,
			 0.0350787534962246, 0.00826557508977351, "contcor1", "<unicode>",
			 0.545717942829957, "debCollin1", 0.0136804444458929, 0.604189076054103,
			 -0.0145563050217875, 0.00654285869735168, -0.0040067231622179,
			 "contGamma:contcor1", "<unicode>", 0.456638855520969, "debCollin1",
			 0.00538253862968062, -0.744392829830122))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.174967820057767, 0.0994848794335543, 16, 16, -0.0377414703121062,
			 "Total", 0.589852059436426, 0.0700147302848851, -0.539050427796248,
			 -0.17365745982826, 0.103277412564417, 50, 16, -0.0351900236319219,
			 "Total", 0.618410766344402, 0.0706479492932278, -0.498103964573182,
			 -0.174174738696921, 0.109363850974905, 84, 16, -0.0324054438610081,
			 "Total", 0.654148824820048, 0.0723326020040018, -0.448006057617217,
			 -0.1754443085898, 0.0962258678496553, 16, 50, -0.0396092203700722,
			 "Total", 0.567646330202622, 0.0693048899322525, -0.571521293934546,
			 -0.173945290931535, 0.0971323441760607, 50, 50, -0.0384064733777371,
			 "Total", 0.578636000122394, 0.0691537286516031, -0.555378200519441,
			 -0.173238690757298, 0.099051034955693, 84, 50, -0.0370938279008024,
			 "Total", 0.593335385257719, 0.0694629411205455, -0.53400888736384,
			 -0.177683792740816, 0.094086772498038, 16, 84, -0.0417985101213891,
			 "Total", 0.546583355270383, 0.0693304997904415, -0.602887765813449,
			 -0.178703833957245, 0.094350541603487, 50, 84, -0.0421766461768788,
			 "Total", 0.544859010853066, 0.0696580084416218, -0.605481654162216,
			 -0.181431736940873, 0.0962530696976869, 84, 84, -0.042589333621593,
			 "Total", 0.547699555344141, 0.0708392625652569, -0.60121085510115,
			 -0.0180242800615154, 0.0250910343994083, 16, 16, 0.00353337716894644,
			 "Total indirect", 0.748024648476141, 0.0109990068187507, 0.321245111233395,
			 -0.0280505237807075, 0.040220171478969, 50, 16, 0.00608482384913078,
			 "Total indirect", 0.726807831938925, 0.0174163137175446, 0.349374956596076,
			 -0.0409462082994059, 0.0586850155394951, 84, 16, 0.00886940362004459,
			 "Total indirect", 0.727118499697861, 0.0254165955662398, 0.348961118609668,
			 -0.0129049879674199, 0.0162362421893808, 16, 50, 0.00166562711098044,
			 "Total indirect", 0.822717177879378, 0.00743412388866913, 0.224051567598859,
			 -0.021262067959195, 0.0269988161658262, 50, 50, 0.00286837410331561,
			 "Total indirect", 0.815776950801466, 0.0123116762618336, 0.232979981142586,
			 -0.0310107196649134, 0.039372758825414, 84, 50, 0.00418101958025027,
			 "Total indirect", 0.81587233996751, 0.017955298935466, 0.232857141241562,
			 -0.0198977742515326, 0.0188504489708599, 16, 84, -0.00052366264033638,
			 "Total indirect", 0.957751154344874, 0.00988493245999252, -0.0529758440389765,
			 -0.0341957431237784, 0.0323921457321262, 50, 84, -0.000901798695826095,
			 "Total indirect", 0.957662174444169, 0.0169870184812429, -0.0530875207336628,
			 -0.0498459685429103, 0.0472169962618297, 84, 84, -0.00131448614054029,
			 "Total indirect", 0.957663333260782, 0.0247614154061912, -0.0530860663244488
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-21")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-21")
})


context('Model number 21 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(42173.6903768327, 42317.0686270438, 26648.0809347351, 11, 1, 5000,
			 0, 0, 26648.0809347351, 11))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 21))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0784876335242776, -0.0505639907761863, -0.0645258121502319,
			 "contcor2", "<unicode>", 0, "facGenderm", 0.00712350914821636,
			 -9.0581496854522, 0.0329823709312385, 0.0470176915062304, 0.0400000312187345,
			 "facExperimexperimental", "<unicode>", 0, "facGenderm", 0.00358050471480616,
			 11.1716180831506, -0.0241739904131647, 0.00352550242937301,
			 -0.0103242439918958, "facExperimexperimental", "<unicode>",
			 0.14400222789637, "contcor2", 0.00706632699912544, -1.46104815035783,
			 1.00843514785556, 1.09072053873368, 1.04957784329462, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0209915568671598, 49.9999999969813,
			 0.00638916282989101, 0.00691049980555188, 0.00664983131772145,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132996570287287,
			 50.0000210784164, 0.423407071524531, 0.457955884595387, 0.440681478059959,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.00881363467476252, 49.9999709906099, 0.240200248094208, 0.259799899511891,
			 0.250000073803049, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00500000295216735, 49.9999852389451, 0.959102725964796, 1.03736273356338,
			 0.99823272976409, "contcor2", "<unicode>", 0, "contcor2", 0.0199646545079127,
			 50.0000002188094, 0.240200231995162, 0.259799880673822, 0.250000056334492,
			 "facExperimexperimental", "<unicode>", 0, "facExperimexperimental",
			 0.0050000022534241, 49.9999887326625))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.425120413740229, 0.539798578811423, "", 0.482459496275826, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.029255171517375,
			 16.4914260027253, -0.00130956724818974, 0.00907102445709254,
			 16, 0.00388072860445141, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.142799800199393, 0.00264815878943773,
			 1.46544407379566, -0.00130956706847023, 0.00907102931682995,
			 16, 0.00388073112417986, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.142799720907331, 0.00264815998334179,
			 1.46544436461224, -0.00267197687284453, 0.00349117857995305,
			 50, 0.000409600853554259, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.794465119829322, 0.00157226242456794,
			 0.260516849575425, -0.00267197858837179, 0.00349118082738194,
			 50, 0.000409601119505072, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.794465118566503, 0.00157226343554472,
			 0.260516851212763, -0.00872098729221508, 0.00140279997541291,
			 84, -0.00365909365840109, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.15654135852159, 0.00258264624949314,
			 -1.41680017506045, -0.00872099201622317, 0.00140279994777597,
			 84, -0.0036590960342236, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.156541281702585, 0.00258264744756902,
			 -1.41680043773215))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.425120413740229, 0.539798578811423, 0.482459496275826, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.029255171517375, 16.4914260027253,
			 -0.410251726509068, 0.291902086090299, -0.0591748202093845,
			 "debCollin1", "<unicode>", 0.741130652556438, "contNormal",
			 0.179124162009574, -0.330356438492209, -0.430143472528329, 0.0129906277830165,
			 -0.208576422372656, "contcor2", "<unicode>", 0.0650302721563798,
			 "contNormal", 0.113046490600524, -1.84504995479877, 0.0816175427371529,
			 0.749194628910051, 0.415406085823602, "debCollin1:contcor2",
			 "<unicode>", 0.014719336632826, "contNormal", 0.170303406449981,
			 2.43921184245724, -0.015237298057605, -0.00228416714377804,
			 -0.00876073260069152, "facGenderm", "<unicode>", 0.00802044964160764,
			 "debCollin1", 0.00330443085077063, -2.65120772572633, -0.00647656924440836,
			 0.00647656166943389, -3.78748723561603e-09, "facExperimexperimental",
			 "<unicode>", 0.999999085477129, "debCollin1", 0.00330443085077453,
			 -1.14618444345061e-06, -0.00915925239506415, 0.00915924101850605,
			 -5.68827904765613e-09, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.999999028798625, "debCollin1", 0.00467317092509458,
			 -1.21722041389723e-06))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.428881182269612, 0.543799267490942, 16, 0.486340224880277, 0,
			 "Total", 0, 0.0293163767619684, 16.5893701267749, 0.428881184652366,
			 0.543799270147646, 16, 0.486340227400006, 1, "Total", 0, 0.0293163768318549,
			 16.5893701731775, 0.42558795465533, 0.54015023960343, 50, 0.48286909712938,
			 0, "Total", 0, 0.0292256097182788, 16.5221222682439, 0.425587954906142,
			 0.540150239884521, 50, 0.482869097395331, 1, "Total", 0, 0.0292256097260031,
			 16.5221222729771, 0.421408978882742, 0.536191826352108, 84,
			 0.478800402617425, 0, "Total", 0, 0.0292818767015002, 16.3514247224767,
			 0.421408976410783, 0.536191824072422, 84, 0.478800400241602,
			 1, "Total", 0, 0.0292818767505506, 16.35142461395, -0.00130956724818974,
			 0.00907102445709254, 16, 0.00388072860445141, 0, "Total indirect",
			 0.142799800199393, 0.00264815878943773, 1.46544407379566, -0.00130956706847023,
			 0.00907102931682995, 16, 0.00388073112417986, 1, "Total indirect",
			 0.142799720907331, 0.00264815998334179, 1.46544436461224, -0.00267197687284453,
			 0.00349117857995305, 50, 0.000409600853554259, 0, "Total indirect",
			 0.794465119829322, 0.00157226242456794, 0.260516849575425, -0.00267197858837179,
			 0.00349118082738194, 50, 0.000409601119505072, 1, "Total indirect",
			 0.794465118566503, 0.00157226343554472, 0.260516851212763, -0.00872098729221508,
			 0.00140279997541291, 84, -0.00365909365840109, 0, "Total indirect",
			 0.15654135852159, 0.00258264624949314, -1.41680017506045, -0.00872099201622317,
			 0.00140279994777597, 84, -0.0036590960342236, 1, "Total indirect",
			 0.156541281702585, 0.00258264744756902, -1.41680043773215))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-21")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-21")
})


context('Model number 22 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1196.96798989136, 1259.49207435508, 529.70946370606, 9, 1, 100,
			 2.48707889258799e-108, 0, 529.70946370606, 9))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 22))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544847643453949, 0.0642094930071353, -0.240319075223407, "contcor1",
			 "<unicode>", 0.121933705211302, "contGamma", 0.15537457352922,
			 -1.54670786709005, -0.40393562538084, 0.194627501534644, -0.104654061923098,
			 "contcor2", "<unicode>", 0.493111340384235, "contGamma", 0.15269748108559,
			 -0.685368620222606, 0.424980145701973, 0.896765565534048, 0.66087285561801,
			 "contcor2", "<unicode>", 3.99663153682894e-08, "contcor1", 0.120355634989586,
			 5.49100053084505, 0.770394544730479, 1.36124365009224, 1.06581909741136,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.150729582283731, 7.07106781073059, 0.00465467796724413, 0.00822453970350535,
			 0.00643960883537474, "debCollin1", "<unicode>", 1.53721479989599e-12,
			 "debCollin1", 0.000910695748600442, 7.07108696320493, 0.318532993097797,
			 0.562830030609769, 0.440681511853783, "debCollin1:contcor2",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2", 0.0623218180127177,
			 7.0710631670574, 1.68041077738007, 2.96919073256002, 2.32480075497005,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.32877643807378, 7.07106862216306, 0.732634908676641, 1.29452505348387,
			 1.01357998108025, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341956596995, 7.07106282865896, 0.721542537011038,
			 1.27492614302363, 0.998234340017334, "contcor2", "<unicode>",
			 1.53765888910584e-12, "contcor2", 0.141171881314558, 7.0710564364661
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.181059121676869, 0.193865536675368, 16, "", 0.00640320749924956,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.946623830386802,
			 0.0956458030120947, 0.0669470828577795, -0.161734829572181,
			 0.112345145896353, 50, "", -0.0246948418379142, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.723946839357794, 0.0699196458788126,
			 -0.353188886006605, -0.271690929679246, 0.154422109220603, 84,
			 "", -0.0586344102293216, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.589615266124996, 0.108704303308881, -0.539393643531419,
			 -0.0178557936950923, 0.0222732128371888, 16, 16, 0.00220870957104823,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.829179725024346, 0.0102371795728936, 0.215753719598369, -0.0295232395842537,
			 0.0371304495791918, 50, 16, 0.00380360499746905, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.822997431562259,
			 0.0170038045824314, 0.223691408533299, -0.0430574445593464,
			 0.0541459058582024, 84, 16, 0.005544230649428, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.823082048290782,
			 0.0247972287205981, 0.223582671753261, -0.0128032239737344,
			 0.0155426194923741, 16, 50, 0.00136969775931982, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.849767883715056,
			 0.00723121539214417, 0.189414598382427, -0.0213836129479713,
			 0.0261011089109181, 50, 50, 0.0023587479814734, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.84561384969199,
			 0.0121136720453648, 0.194717833918572, -0.0311820479709649,
			 0.0380583891587922, 84, 50, 0.0034381705939137, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.845670010378815,
			 0.0176637013934738, 0.194646100345877, -0.0190886335349977,
			 0.019861127804922, 16, 84, 0.000386247134962117, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.968992321228713,
			 0.00993634618981534, 0.0388721495390345, -0.0328344497716722,
			 0.0341647573431677, 50, 84, 0.000665153785747745, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.968957196044213,
			 0.0170919485366367, 0.0389162057399123, -0.0478610416804463,
			 0.0498001315743652, 84, 84, 0.00096954494695942, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.968957652857158,
			 0.0249140224068275, 0.0389156327760918))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.16157706035774, 0.11241978044233, -0.0245786399577047, "contGamma",
			 "<unicode>", 0.72511305597831, "contNormal", 0.0698984376655189,
			 -0.351633609828584, -2.79883012340776, 2.28229489185875, -0.258267615774506,
			 "debCollin1", "<unicode>", 0.842070838888549, "contNormal",
			 1.29622917955273, -0.199245333964494, -0.063924617503854, 0.675672333292298,
			 0.305873857894222, "contcor1", "<unicode>", 0.104983764337524,
			 "contNormal", 0.188676158498319, 1.62115796891713, -1.86123299020655,
			 1.40972889838193, -0.225752045912311, "contcor2", "<unicode>",
			 0.786743500858528, "contNormal", 0.834444386322763, -0.270541751628478,
			 -0.175212168322282, 0.111364981393988, -0.0319235934641465,
			 "contGamma:contcor1", "<unicode>", 0.662354376797725, "contNormal",
			 0.0731077591161761, -0.436664915599677, -2.275329868441, 2.60081075558488,
			 0.162740443571942, "debCollin1:contcor2", "<unicode>", 0.895912168997437,
			 "contNormal", 1.24393628211749, 0.130826993240294, -0.0197474968328031,
			 0.00115999338830509, -0.00929375172224902, "contGamma", "<unicode>",
			 0.0814248748408832, "debCollin1", 0.00533364143066502, -1.74247778802975,
			 -0.0185475805828755, 0.0350787065100061, 0.00826556296356528,
			 "contcor1", "<unicode>", 0.545718009891601, "debCollin1", 0.0136804266598465,
			 0.604188975174697, -0.0145562742172326, 0.00654286207073375,
			 -0.00400670607324944, "contGamma:contcor1", "<unicode>", 0.456640190385363,
			 "debCollin1", 0.00538253163180388, -0.744390622727591))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.177378401060344, 0.194602235200939, 16, 16, 0.00861191707029779,
			 "Total", 0.927689420573624, 0.0948947631679508, 0.0907522900400296,
			 -0.159226653787064, 0.114254389253332, 16, 16, -0.0224861322668659,
			 "Total", 0.747222445528983, 0.0697668541865003, -0.322303944029871,
			 -0.270485434128054, 0.157634032811507, 50, 16, -0.0564257006582733,
			 "Total", 0.605405790049477, 0.109216156601987, -0.516642431063601,
			 -0.175838437593987, 0.196252062587425, 16, 16, 0.0102068124967186,
			 "Total", 0.914370491776892, 0.0949227901931909, 0.107527522905145,
			 -0.158935280033422, 0.117152806352532, 84, 16, -0.0208912368404451,
			 "Total", 0.766759694745532, 0.070431928485345, -0.296615999159983,
			 -0.270581516493351, 0.160919906029646, 16, 16, -0.0548308052318525,
			 "Total", 0.618410378065589, 0.110078916226682, -0.498104515481795,
			 -0.175439296799507, 0.199334173096862, 16, 16, 0.0119474381486776,
			 "Total", 0.900552251258407, 0.0956072338197371, 0.124963746688916,
			 -0.160309116052814, 0.122007893675842, 50, 16, -0.0191506111884862,
			 "Total", 0.790313705656952, 0.0720209687411445, -0.265903271272519,
			 -0.271768547279746, 0.165588188119959, 50, 16, -0.0530901795798936,
			 "Total", 0.634191871493333, 0.111572645938782, -0.475835086039128,
			 -0.1792481607566, 0.194793971273739, 50, 50, 0.00777290525856937,
			 "Total", 0.935076651878033, 0.0954206646093337, 0.0814593494018596,
			 -0.158721441653302, 0.112071153496113, 84, 50, -0.0233251440785943,
			 "Total", 0.735627612474153, 0.0690810130403906, -0.337649131823769,
			 -0.268539194230356, 0.154009769290352, 50, 50, -0.0572647124700017,
			 "Total", 0.595254713043105, 0.107795083698915, -0.531236773561485,
			 -0.178522149568529, 0.196046060529975, 16, 50, 0.00876195548072296,
			 "Total", 0.926939940899417, 0.095554870664219, 0.0916955401626002,
			 -0.157341956614318, 0.112669768901436, 84, 50, -0.0223360938564408,
			 "Total", 0.745735938125889, 0.0688818079427918, -0.324266951224502,
			 -0.266771880753975, 0.154220556258279, 50, 50, -0.0562756622478482,
			 "Total", 0.600284313335795, 0.107398003313578, -0.523991699208184,
			 -0.178365073328582, 0.198047829514908, 84, 50, 0.00984137809316325,
			 "Total", 0.918369995917423, 0.0960254641954104, 0.102487170206605,
			 -0.156719733042699, 0.114206390554698, 84, 50, -0.0212566712440005,
			 "Total", 0.758421145410703, 0.0691150770459121, -0.307554764496319,
			 -0.265408740520879, 0.155016261250064, 84, 50, -0.0551962396354079,
			 "Total", 0.606808330787314, 0.107253246765553, -0.514634673541047,
			 -0.182531402365545, 0.196110311633969, 16, 84, 0.00678945463421167,
			 "Total", 0.943964004006923, 0.0965940489177841, 0.0702885396179066,
			 -0.159653361817169, 0.111036172411265, 16, 84, -0.024308594702952,
			 "Total", 0.724823788664215, 0.0690547215060069, -0.352019299662768,
			 -0.267205425040362, 0.150709098851643, 50, 84, -0.0582481630943594,
			 "Total", 0.584823722400906, 0.106612806966981, -0.54635240128702,
			 -0.184809529573769, 0.198946252143764, 16, 84, 0.0070683612849973,
			 "Total", 0.942442123767092, 0.0978986820024629, 0.0722007808523866,
			 -0.159874676217463, 0.11181530011313, 84, 84, -0.0240296880521664,
			 "Total", 0.728817452768495, 0.0693099410177046, -0.346699011704948,
			 -0.265051460865091, 0.149112947977943, 16, 84, -0.0579692564435738,
			 "Total", 0.583239025129845, 0.10565612738548, -0.548659674342183,
			 -0.188413591110723, 0.203159096003141, 16, 84, 0.00737275244620898,
			 "Total", 0.941164255327017, 0.0998928271648203, 0.0738066251147757,
			 -0.161758899235784, 0.114308305453875, 50, 84, -0.0237252968909547,
			 "Total", 0.736207540324837, 0.0704266014241185, -0.336879764339015,
			 -0.26377897496528, 0.148449244400556, 50, 84, -0.0576648652823621,
			 "Total", 0.583456973653284, 0.105162192422269, -0.548342174636435,
			 -0.0178557936950923, 0.0222732128371888, 50, 16, 0.00220870957104823,
			 "Total indirect", 0.829179725024346, 0.0102371795728936, 0.215753719598369,
			 -0.0295232395842537, 0.0371304495791918, 84, 16, 0.00380360499746905,
			 "Total indirect", 0.822997431562259, 0.0170038045824314, 0.223691408533299,
			 -0.0430574445593464, 0.0541459058582024, 50, 16, 0.005544230649428,
			 "Total indirect", 0.823082048290782, 0.0247972287205981, 0.223582671753261,
			 -0.0128032239737344, 0.0155426194923741, 16, 50, 0.00136969775931982,
			 "Total indirect", 0.849767883715056, 0.00723121539214417, 0.189414598382427,
			 -0.0213836129479713, 0.0261011089109181, 84, 50, 0.0023587479814734,
			 "Total indirect", 0.84561384969199, 0.0121136720453648, 0.194717833918572,
			 -0.0311820479709649, 0.0380583891587922, 50, 50, 0.0034381705939137,
			 "Total indirect", 0.845670010378815, 0.0176637013934738, 0.194646100345877,
			 -0.0190886335349977, 0.019861127804922, 84, 84, 0.000386247134962117,
			 "Total indirect", 0.968992321228713, 0.00993634618981534, 0.0388721495390345,
			 -0.0328344497716722, 0.0341647573431677, 84, 84, 0.000665153785747745,
			 "Total indirect", 0.968957196044213, 0.0170919485366367, 0.0389162057399123,
			 -0.0478610416804463, 0.0498001315743652, 84, 84, 0.00096954494695942,
			 "Total indirect", 0.968957652857158, 0.0249140224068275, 0.0389156327760918,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 50, 84, 16, 50, 84, 16, 50, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-22")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-22")
})


context('Model number 22 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(21382.6250464525, 21523.0088180854, 14110.8006372927, 9, 1, 2564,
			 0, 0, 14110.8006372927, 9))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 22))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678664018365246, 0.0881401264819745, 0.0780032641592495, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517196356804677, 15.0819438561336,
			 -0.0939573638861815, -0.0542217180643317, -0.0740895409752566,
			 "contcor2", "<unicode>", 2.69340105774063e-13, "facGenderm",
			 0.0101368306089498, -7.30894535318, -0.0997963647360834, -0.0599933468007834,
			 -0.0798948557684334, "contcor2", "<unicode>", 3.5527136788005e-15,
			 "facExperimexperimental", 0.0101540176884017, -7.86829984151912,
			 0.960814199845091, 1.07209549333844, 1.01645484659177, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0283886067221449, 35.805027578154,
			 0.00607839081958111, 0.00678238805322622, 0.00643038943640367,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000179594431121735,
			 35.8050603030388, 0.426153272857565, 0.475510184060923, 0.450831728459244,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.0125912801440941, 35.8050748851541, 0.236315338052375, 0.263685370597784,
			 0.25000035432508, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698227946056652, 35.8049768327084, 0.236315482517816, 0.263685550583971,
			 0.250000516550894, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698228852214817, 35.8049535990785,
			 0.975409833427784, 1.08838178954851, 1.03189581148814, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288199061339468, 35.8049678126009
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.495490888995439, 0.72797426797646, "", 0.61173257848595, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0593080742337156,
			 10.3144906724722, 0.214796706545703, 0.451210186143059, "",
			 0.333003446344381, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 3.3617855388357e-08, 0.0603106693444766, 5.52146825700714,
			 -0.00765147381156077, 0.00327488653581862, 16, -0.00218829363787107,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.432412757684291, 0.00278738804222045, -0.785069608079348,
			 -0.00592087311578699, 0.0214746274999818, 16, 0.00777687719209743,
			 1, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.265808678206084, 0.00698877653667645, 1.11276661248004, -0.00338839857538925,
			 0.00208753107058916, 50, -0.000650433752400045, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.641493918206512,
			 0.00139694649727542, -0.465611069334895, -0.00651753402738416,
			 0.0111406278631195, 50, 0.00231154691786765, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.607853859386528,
			 0.00450471591054452, 0.513139333039147, -0.00281918747247475,
			 0.00482810374731454, 84, 0.0010044581374199, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.606639962282485,
			 0.00195087544467912, 0.514875585809174, -0.0156014087463873,
			 0.00846201260308262, 84, -0.00356969807165234, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.560901283918756,
			 0.00613874069607379, -0.581503316133787))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.495490888995439, 0.72797426797646, 0.61173257848595, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0593080742337156, 10.3144906724722,
			 -0.61963249354798, 0.362177605409274, -0.128727444069353, "debCollin1",
			 "<unicode>", 0.60728623079283, "contNormal", 0.250466362316259,
			 -0.513951026712366, 0.0250396641310361, 0.258026925449969, 0.141533294790503,
			 "facExperimexperimental", "<unicode>", 0.0172541175415599, "contNormal",
			 0.0594366180084702, 2.38124744530944, -0.461062305503837, 0.142370431990509,
			 -0.159345936756664, "contcor2", "<unicode>", 0.300613415874975,
			 "contNormal", 0.153939751509249, -1.0351188383404, -0.44496238440449,
			 -0.112495879878647, -0.278729132141568, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.00101498256359966, "contNormal", 0.0848144422928934,
			 -3.28634044634782, -0.167904877620394, 0.745567940896342, 0.288831531637974,
			 "debCollin1:contcor2", "<unicode>", 0.215180955193971, "contNormal",
			 0.233033062271066, 1.23944443257585, -0.0042288152476935, 0.0142520986789011,
			 0.0050116417156038, "facGenderm", "<unicode>", 0.287780404730395,
			 "debCollin1", 0.0047146054908074, 1.06300341043923, -0.0125866354534077,
			 0.00589427847307735, -0.00334617849016516, "facExperimexperimental",
			 "<unicode>", 0.477860858320062, "debCollin1", 0.00471460549077945,
			 -0.70974729417115, -0.0358902667385448, -0.00975430761864724,
			 -0.022822287178596, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619486046945728, "debCollin1", 0.0066674590263022, -3.4229362473118
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.493173487578883, 0.725915082117275, 16, 0.609544284848079, 0,
			 "Total", 0, 0.0593739467597945, 10.266191117698, 0.212444134426566,
			 0.449186170986454, 16, 0.33081515270651, 0, "Total", 4.31201376827062e-08,
			 0.0603944864363016, 5.4775720802829, 0.502466307085605, 0.736552604270489,
			 16, 0.619509455678047, 1, "Total", 0, 0.0597169894526957, 10.3740905453512,
			 0.221917326850125, 0.459643320222832, 16, 0.340780323536479,
			 0, "Total", 1.91823039674688e-08, 0.0606455004397682, 5.61921859107972,
			 0.494852408175684, 0.727311881291415, 50, 0.61108214473355,
			 0, "Total", 0, 0.0593019756866303, 10.3045832395651, 0.213959667907242,
			 0.450746357276721, 50, 0.332353012591981, 1, "Total", 3.75511410855012e-08,
			 0.060405877668473, 5.50199790848238, 0.497311098829352, 0.730777151978283,
			 50, 0.614044125403817, 1, "Total", 0, 0.0595587610258354, 10.3098874930836,
			 0.217329731366126, 0.453300255158371, 50, 0.335314993262249,
			 1, "Total", 2.54399996624244e-08, 0.0601976683381813, 5.57023224518432,
			 0.49652508163172, 0.728948991615019, 84, 0.61273703662337, 0,
			 "Total", 0, 0.0592929032922618, 10.3340703963022, 0.215458982187369,
			 0.452556826776233, 84, 0.334007904481801, 0, "Total", 3.34900012166628e-08,
			 0.0604852554585342, 5.52213761766751, 0.490973228160626, 0.725352532667969,
			 84, 0.608162880414297, 1, "Total", 0, 0.0597917375921436, 10.1713531819856,
			 0.211613363822942, 0.447254132722516, 84, 0.329433748272729,
			 0, "Total", 4.24865469472735e-08, 0.0601135456463177, 5.48019160624754,
			 -0.00765147381156077, 0.00327488653581862, 16, -0.00218829363787107,
			 0, "Total indirect", 0.432412757684291, 0.00278738804222045,
			 -0.785069608079348, -0.00592087311578699, 0.0214746274999818,
			 16, 0.00777687719209743, 1, "Total indirect", 0.265808678206084,
			 0.00698877653667645, 1.11276661248004, -0.00338839857538925,
			 0.00208753107058916, 50, -0.000650433752400045, 1, "Total indirect",
			 0.641493918206512, 0.00139694649727542, -0.465611069334895,
			 -0.00651753402738416, 0.0111406278631195, 50, 0.00231154691786765,
			 1, "Total indirect", 0.607853859386528, 0.00450471591054452,
			 0.513139333039147, -0.00281918747247475, 0.00482810374731454,
			 84, 0.0010044581374199, 0, "Total indirect", 0.606639962282485,
			 0.00195087544467912, 0.514875585809174, -0.0156014087463873,
			 0.00846201260308262, 84, -0.00356969807165234, 0, "Total indirect",
			 0.560901283918756, 0.00613874069607379, -0.581503316133787,
			 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-22")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-22")
})


context('Model number 28 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1198.2211268112, 1258.14004108892, 664.266215114254, 16, 1, 100,
			 5.1570479846217e-131, 0, 664.266215114254, 16))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 28))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.4039345997336, 0.19462817754167, -0.104653211095965, "contcor2",
			 "<unicode>", 0.493114603016699, "contGamma", 0.152697391890019,
			 -0.685363448586878, -0.544848528381973, 0.0642089521055749,
			 -0.240319788138199, "contcor1", "<unicode>", 0.121932809062452,
			 "contGamma", 0.155374661292686, -1.54671158179066, 0.424979112735707,
			 0.896762563416235, 0.660870838075971, "contcor1", "<unicode>",
			 3.99649222604381e-08, "contcor2", 0.120355132645777, 5.49100668619603,
			 0.795868641201094, 1.40625493998812, 1.10106179059461, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.155713651781787,
			 7.07106780937618, 0.00465468567351171, 0.00822456658243833,
			 0.00643962612797502, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700639676389, 7.07106797494212, 0.318532877862561,
			 0.562829628675634, 0.440681253269097, "debCollin1:contcor2",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2", 0.0623217448738992,
			 7.07106731624354, 1.68041246768145, 2.96919662821954, 2.32480454795049,
			 "contGamma", "<unicode>", 1.53765888910584e-12, "contGamma",
			 0.328777510888939, 7.07105708557971, 0.721541584276302, 1.27492281994834,
			 0.998232202112322, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171276624734, 7.07107158041684, 0.732634367435652,
			 1.29452316568102, 1.01357876655834, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341613080005, 7.07107130148323
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.198261277312435, 0.164304267888721, "", 16, -0.0169785047118571,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.854354352001922,
			 0.0924929100894268, -0.18356547215826, -0.181941915156986, 0.0938445208033379,
			 "", 50, -0.0440486971768241, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.531254506925926, 0.0703549754321233, -0.626092140694743,
			 -0.292845150034452, 0.141286914464966, "", 84, -0.0757791177847431,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.493826304325801,
			 0.110750010695043, -0.684235760422687, -0.0180264461258884,
			 0.0245002893210155, 16, 16, 0.00323692159756352, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.765424418203348,
			 0.0108488563520425, 0.29836523708364, -0.0285154307144714, 0.0396641389148257,
			 50, 16, 0.00557435410017718, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.74859472779887, 0.0173930669560994,
			 0.320492878814702, -0.0416146282287737, 0.0578653574223194,
			 84, 16, 0.00812536459677285, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.748836896289636, 0.0253780136869296,
			 0.320173386972269, -0.0128918262409335, 0.0165827053398522,
			 16, 50, 0.00184543954945931, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.80612203634577, 0.00751915132453378,
			 0.245431893814656, -0.0210294343145862, 0.0273855558387534,
			 50, 50, 0.0031780607620836, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.796937749082322, 0.0123509897465542,
			 0.257312233861278, -0.0306759057885242, 0.0399408006762768,
			 84, 50, 0.00463244744387629, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.797065448465863, 0.0180147969610198,
			 0.25714680292539, -0.0194348726923311, 0.0198636907097221, 16,
			 84, 0.000214409008695505, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.982937156937773, 0.0100253279427671,
			 0.0213867326754326, -0.0334575115922219, 0.0341959859115483,
			 50, 84, 0.000369237159663166, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.982931310918669, 0.017258862417221,
			 0.0213940612502211, -0.0487690049944624, 0.0498454298110505,
			 84, 84, 0.000538212408294029, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.9829313868414, 0.0251572058423958,
			 0.0213939660734108))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180749762773673, 0.094349576964169, -0.0432000929047519, "contGamma",
			 "<unicode>", 0.538182311360504, "contNormal", 0.0701796925626671,
			 -0.615564009006969, -2.92780528837557, 2.22882738441082, -0.349488951982376,
			 "debCollin1", "<unicode>", 0.790492038160562, "contNormal",
			 1.31549169103648, -0.265671728954071, -1.80178104634184, 1.6407974597128,
			 -0.0804917933145209, "contcor2", "<unicode>", 0.926973882863058,
			 "contNormal", 0.878224940154323, -0.0916528210874731, -2.19066163521793,
			 2.73046794147493, 0.269903153128497, "debCollin1:contcor2",
			 "<unicode>", 0.829773963138544, "contNormal", 1.25541326664931,
			 0.214991477546567, -0.166733031486162, 0.109970203922801, -0.0283814137816807,
			 "contGamma:contcor2", "<unicode>", 0.687635096146205, "contNormal",
			 0.0705888571401216, -0.402066486575104, -0.0197475672419159,
			 0.00115995105115469, -0.00929380809538062, "contGamma", "<unicode>",
			 0.0814234359913906, "debCollin1", 0.0053336485920115, -1.74248601778911,
			 -0.0185473695232678, 0.0350789895729625, 0.00826581002484736,
			 "contcor1", "<unicode>", 0.545706543850114, "debCollin1", 0.0136804450283853,
			 0.604206223386506, -0.0145563840438161, 0.00654278057363947,
			 -0.0040068017350883, "contGamma:contcor1", "<unicode>", 0.456630045976538,
			 "debCollin1", 0.00538253885884717, -0.744407395870891))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.193957529206299, 0.166474362977712, 16, 16, -0.0137415831142936,
			 "Total", 0.881199721279748, 0.0919486008485493, -0.149448528715817,
			 -0.178689528766005, 0.0970659776074841, 16, 16, -0.0408117755792606,
			 "Total", 0.561814290959765, 0.0703470850864133, -0.580148779855314,
			 -0.290625774658188, 0.145541382283829, 16, 50, -0.0725421961871796,
			 "Total", 0.514431940474004, 0.111269176470192, -0.651952306006443,
			 -0.191911187555838, 0.169102886332479, 50, 16, -0.0114041506116799,
			 "Total", 0.901451904218706, 0.0920971193185054, -0.12382744103255,
			 -0.177724790009047, 0.100776103855753, 50, 84, -0.038474343076647,
			 "Total", 0.588142166022636, 0.0710474519076831, -0.541530231466138,
			 -0.289894729206114, 0.149485201836982, 50, 16, -0.0702047636845659,
			 "Total", 0.531097341982778, 0.112088776760407, -0.626331785515248,
			 -0.19115641944076, 0.173450139210591, 84, 16, -0.00885314011508427,
			 "Total", 0.924170942122346, 0.0930135863534537, -0.0951811500036365,
			 -0.178552067912809, 0.106705402752706, 84, 16, -0.0359233325800513,
			 "Total", 0.621554556968912, 0.0727711001109177, -0.493648337393511,
			 -0.290293077825367, 0.154985571449427, 84, 50, -0.0676537531879703,
			 "Total", 0.551457669547758, 0.113593579470617, -0.595577263285997,
			 -0.195869342170904, 0.165603211846109, 16, 16, -0.0151330651623978,
			 "Total", 0.869646151345958, 0.092214080684202, -0.164107965400889,
			 -0.178531371014635, 0.0941248557599055, 16, 84, -0.0422032576273648,
			 "Total", 0.544017895149914, 0.0695564380073354, -0.606748402253061,
			 -0.289380440784345, 0.141513084313777, 16, 16, -0.0739336782352838,
			 "Total", 0.501208140077178, 0.109923837503382, -0.672590039744649,
			 -0.194727829218139, 0.167126941318592, 50, 16, -0.0138004439497735,
			 "Total", 0.881160291124925, 0.0923115866901115, -0.149498502242209,
			 -0.176839069431321, 0.0950977966018396, 50, 16, -0.0408706364147405,
			 "Total", 0.555764734149925, 0.0693729242420176, -0.589143918341359,
			 -0.287365001275666, 0.142162887230347, 50, 50, -0.0726010570226595,
			 "Total", 0.507608046024286, 0.1095754544201, -0.66256678931319,
			 -0.194193005192941, 0.169500890656979, 84, 16, -0.0123460572679808,
			 "Total", 0.894140394168074, 0.0927807599319913, -0.133066998772488,
			 -0.175939827992622, 0.0971073285267263, 84, 84, -0.0394162497329478,
			 "Total", 0.571482989979474, 0.0696561668155919, -0.565868774222082,
			 -0.285765206580794, 0.14347186589906, 84, 16, -0.0711466703408668,
			 "Total", 0.515864203869393, 0.109501265295082, -0.649733773844,
			 -0.199329280871941, 0.165801089465618, 16, 16, -0.0167640957031616,
			 "Total", 0.857172820018826, 0.0931472142390527, -0.179974203631451,
			 -0.17996503460989, 0.0922964582736332, 16, 50, -0.0438342881681286,
			 "Total", 0.527967879208297, 0.0694557387357849, -0.631111107102002,
			 -0.288922787517132, 0.137793369965037, 16, 50, -0.0755647087760476,
			 "Total", 0.487583450474929, 0.108858162917291, -0.694157486687154,
			 -0.201396545976156, 0.168178010871768, 50, 50, -0.016609267552194,
			 "Total", 0.860162125911544, 0.0942809561203882, -0.176167788656974,
			 -0.180289039836476, 0.0929301198021543, 50, 84, -0.043679460017161,
			 "Total", 0.530870566534437, 0.0697000459686373, -0.626677635719427,
			 -0.28718459114283, 0.13636482989267, 50, 50, -0.0754098806250799,
			 "Total", 0.485230639498661, 0.108050307142479, -0.697914542025702,
			 -0.204846077569606, 0.17196549296248, 84, 16, -0.0164402923035631,
			 "Total", 0.864202933693861, 0.0961271670051919, -0.171026493505994,
			 -0.182306128855388, 0.0952851593183273, 84, 50, -0.0435104847685301,
			 "Total", 0.538937044896282, 0.0708154053756394, -0.614421177676372,
			 -0.286365045764161, 0.135883235011262, 84, 50, -0.0752409053764491,
			 "Total", 0.484866770886217, 0.10771837750746, -0.698496460097889,
			 -0.0180264461258884, 0.0245002893210155, 16, 50, 0.00323692159756352,
			 "Total indirect", 0.765424418203348, 0.0108488563520425, 0.29836523708364,
			 -0.0285154307144714, 0.0396641389148257, 50, 84, 0.00557435410017718,
			 "Total indirect", 0.74859472779887, 0.0173930669560994, 0.320492878814702,
			 -0.0416146282287737, 0.0578653574223194, 84, 50, 0.00812536459677285,
			 "Total indirect", 0.748836896289636, 0.0253780136869296, 0.320173386972269,
			 -0.0128918262409335, 0.0165827053398522, 16, 16, 0.00184543954945931,
			 "Total indirect", 0.80612203634577, 0.00751915132453378, 0.245431893814656,
			 -0.0210294343145862, 0.0273855558387534, 50, 50, 0.0031780607620836,
			 "Total indirect", 0.796937749082322, 0.0123509897465542, 0.257312233861278,
			 -0.0306759057885242, 0.0399408006762768, 84, 50, 0.00463244744387629,
			 "Total indirect", 0.797065448465863, 0.0180147969610198, 0.25714680292539,
			 -0.0194348726923311, 0.0198636907097221, 16, 50, 0.000214409008695505,
			 "Total indirect", 0.982937156937773, 0.0100253279427671, 0.0213867326754326,
			 -0.0334575115922219, 0.0341959859115483, 50, 84, 0.000369237159663166,
			 "Total indirect", 0.982931310918669, 0.017258862417221, 0.0213940612502211,
			 -0.0487690049944624, 0.0498454298110505, 84, 50, 0.000538212408294029,
			 "Total indirect", 0.9829313868414, 0.0251572058423958, 0.0213939660734108,
			 16, 84, 50, 84, 84, 84, 16, 84, 50, 84, 84, 84, 16, 84, 50,
			 84, 84, 84, 16, 16, 16, 50, 50, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-28")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-28")
})


context('Model number 28 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(42173.0609450041, 42322.9563884066, 29739.7092030263, 16, 1, 5000,
			 0, 0, 29739.7092030263, 16))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 28))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0784876114620213, -0.0505639780903507, -0.064525794776186,
			 "contcor2", "<unicode>", 0, "facGenderm", 0.00712350675622834,
			 -9.05815028809634, 0.0329823732534878, 0.0470176840840311, 0.0400000286687595,
			 "facExperimexperimental", "<unicode>", 0, "facGenderm", 0.00358050222893176,
			 11.1716251272083, -0.0241738813569831, 0.00352560291754658,
			 -0.0103241392197183, "facExperimexperimental", "<unicode>",
			 0.144006172630172, "contcor2", 0.00706632481336895, -1.46103377532063,
			 1.0079049649809, 1.09014709447071, 1.0490260297258, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0209805205959191, 49.9999999966564,
			 0.00638916654842153, 0.00691050415673632, 0.00664983535257893,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000132996731681558,
			 49.9999907403817, 0.423406888008855, 0.45795566985727, 0.440681278933062,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.00881362670970758, 49.9999935835362, 0.240200162799017, 0.259799799704737,
			 0.249999981251877, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00499999925006773, 50.0000037496986, 0.959102760740034, 1.03736277425667,
			 0.998232767498351, "contcor2", "<unicode>", 0, "contcor2", 0.0199646560176459,
			 49.9999983278479, 0.240200153984991, 0.259799789391129, 0.24999997168806,
			 "facExperimexperimental", "<unicode>", 0, "facExperimexperimental",
			 0.00499999886751432, 50.0000056624701))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.354688205977389, 0.516153306977691, 16, 0.43542075647754, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.041190833677026,
			 10.5708167960775, 0.423854546897927, 0.538543050317081, 50,
			 0.481198798607504, "", "facGenderm", "contNormal", "", "<unicode>",
			 "", 0, 0.0292578088995008, 16.4468501472683, 0.449440369031813,
			 0.620275011998039, 84, 0.534857690514926, "", "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0435810668751437, 12.2727075967931,
			 -0.00114390852645152, 0.00951719817057512, 16, 0.0041866448220618,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.123714947562881, 0.00271972005126627, 1.53936609031233, -0.0011439081956736,
			 0.00951720208273266, 16, 0.00418664694352953, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.123714883413893,
			 0.00271972096490031, 1.5393663532255, -0.00265061380528763,
			 0.00351450209885088, 50, 0.000431944146781622, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.7835925191749,
			 0.00157276254889584, 0.274640407151651, -0.00265061513165951,
			 0.00351450386297452, 50, 0.000431944365657501, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.78359251802797,
			 0.00157276333730204, 0.274640408644361, -0.00916973042319543,
			 0.00123144770614169, 84, -0.00396914135852687, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.134689091692618,
			 0.0026534105247291, -1.49586402915625, -0.00916973423092524,
			 0.0012314474913639, 84, -0.00396914336978067, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.134689028809086,
			 0.00265341144131534, -1.49586427041752))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.422347222444823, 0.53718024799374, 0.479763735219282, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.029294677467215, 16.3771639321241,
			 -0.413751026039225, 0.288271073998806, -0.0627399760202096,
			 "debCollin1", "<unicode>", 0.726094490415467, "contNormal",
			 0.179090561248954, -0.350325419623843, -0.480444720743357, -0.0248113799109616,
			 -0.252628050327159, "contcor2", "<unicode>", 0.0297485320044126,
			 "contNormal", 0.116235130958113, -2.1734225121508, 0.113131247841433,
			 0.785554829607891, 0.449343038724662, "debCollin1:contcor2",
			 "<unicode>", 0.00880669233389364, "contNormal", 0.171539780085361,
			 2.61946843176004, -0.0100088341940403, 0.105999696282452, 0.047995431044206,
			 "facGenderm:contcor2", "<unicode>", 0.104853567891478, "contNormal",
			 0.0295945566835802, 1.6217655009117, -0.0152372911454334, -0.00228415630188937,
			 -0.0087607237236614, "facGenderm", "<unicode>", 0.00802053254089219,
			 "debCollin1", 0.0033044318532679, -2.65120423500262, -0.00647656707223072,
			 0.00647656777128882, 3.49529049920832e-10, "facExperimexperimental",
			 "<unicode>", 0.999999915603092, "debCollin1", 0.00330443185326165,
			 1.05775838462466e-07, -0.00915925392474857, 0.00915924504623441,
			 -4.43925708143466e-09, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.999999242053486, "debCollin1", 0.00467317234282797,
			 -9.49945081363774e-07))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.359040887173518, 0.520173915425686, 16, 0.439607401299602, 0,
			 "Total", 0, 0.0411061196846381, 10.6944514508356, 0.427918145234295,
			 0.542852741624836, 16, 0.485385443429565, 0, "Total", 0, 0.029320588872329,
			 16.554423430685, 0.453264400579867, 0.624824270094108, 50, 0.539044335336988,
			 0, "Total", 0, 0.0437660770472016, 12.3164873734429, 0.359040889350049,
			 0.52017391749209, 16, 0.43960740342107, 1, "Total", 0, 0.0411061196565443,
			 10.6944515097543, 0.427918147252564, 0.542852743849503, 84,
			 0.485385445551033, 1, "Total", 0, 0.0293205889249824, 16.5544234733111,
			 0.45326440249054, 0.624824272426371, 16, 0.539044337458455,
			 1, "Total", 0, 0.0437660771547523, 12.3164873916493, 0.355180227065553,
			 0.51652517418309, 16, 0.435852700624322, 0, "Total", 0, 0.0411601816130821,
			 10.5891831265825, 0.424345017134924, 0.538916468373647, 16,
			 0.481630742754285, 0, "Total", 0, 0.0292279481006916, 16.4784315715576,
			 0.449891085411878, 0.620688183911538, 50, 0.535289634661708,
			 0, "Total", 0, 0.0435714890291061, 12.2853188309477, 0.355180227285676,
			 0.516525174400719, 16, 0.435852700843198, 1, "Total", 0, 0.0411601816124457,
			 10.5891831320639, 0.424345017342338, 0.538916468603985, 84,
			 0.481630742973161, 1, "Total", 0, 0.0292279481065397, 16.4784315757492,
			 0.449891085612671, 0.620688184148496, 16, 0.535289634880583,
			 1, "Total", 0, 0.0435714890383319, 12.2853188333698, 0.35040973419886,
			 0.512493496039166, 16, 0.431451615119013, 0, "Total", 0, 0.0413486582199475,
			 10.4344768051233, 0.419810637387175, 0.534648677110779, 50,
			 0.477229657248977, 0, "Total", 0, 0.0292959566169154, 16.2899496162356,
			 0.445705800572313, 0.616071297740485, 50, 0.530888549156399,
			 0, "Total", 0, 0.0434613846254302, 12.2151779960955, 0.350409732000468,
			 0.512493494215051, 50, 0.431451613107759, 1, "Total", 0, 0.0413486583154282,
			 10.4344767323871, 0.419810635294773, 0.534648675180673, 84,
			 0.477229655237723, 1, "Total", 0, 0.0292959566583182, 16.2899495245608,
			 0.445705798650936, 0.616071295639354, 50, 0.530888547145145,
			 1, "Total", 0, 0.0434613845795737, 12.215177962707, -0.00114390852645152,
			 0.00951719817057512, 16, 0.0041866448220618, 0, "Total indirect",
			 0.123714947562881, 0.00271972005126627, 1.53936609031233, -0.0011439081956736,
			 0.00951720208273266, 50, 0.00418664694352953, 1, "Total indirect",
			 0.123714883413893, 0.00271972096490031, 1.5393663532255, -0.00265061380528763,
			 0.00351450209885088, 50, 0.000431944146781622, 0, "Total indirect",
			 0.7835925191749, 0.00157276254889584, 0.274640407151651, -0.00265061513165951,
			 0.00351450386297452, 50, 0.000431944365657501, 1, "Total indirect",
			 0.78359251802797, 0.00157276333730204, 0.274640408644361, -0.00916973042319543,
			 0.00123144770614169, 84, -0.00396914135852687, 0, "Total indirect",
			 0.134689091692618, 0.0026534105247291, -1.49586402915625, -0.00916973423092524,
			 0.0012314474913639, 50, -0.00396914336978067, 1, "Total indirect",
			 0.134689028809086, 0.00265341144131534, -1.49586427041752, 16,
			 84, 50, 84, 84, 84, 16, 84, 50, 84, 84, 84, 16, 16, 50, 50,
			 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-28")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-28")
})


context('Model number 29 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1198.91216990467, 1264.04142455437, 660.957258207725, 14, 1, 100,
			 5.50066842146552e-132, 0, 660.957258207725, 14))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 29))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848065686957, 0.0642087625207377, -0.240319651583109, "contcor1",
			 "<unicode>", 0.12193262147181, "contGamma", 0.155374494891706,
			 -1.54671235939083, -0.403934272934682, 0.194627931518342, -0.10465317070817,
			 "contcor2", "<unicode>", 0.493114356096807, "contGamma", 0.15269724575921,
			 -0.685363839981758, 0.424979171354574, 0.896763028709052, 0.660871100031813,
			 "contcor2", "<unicode>", 3.99655009086786e-08, "contcor1", 0.120355236391038,
			 5.49100412951391, 0.769964646518897, 1.36048407161537, 1.06522435906713,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.150645478629816, 7.07106757372209, 0.00465468600531619, 0.00822456773975321,
			 0.0064396268725347, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700850269645, 7.07106715737447, 0.318532856107965,
			 0.562829552795086, 0.440681204451526, "debCollin1:contcor2",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2", 0.0623217310660049,
			 7.07106809958152, 1.68041095554975, 2.96919135400673, 2.32480115477824,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776551156734, 7.07106740611182, 0.732634543680831, 1.2945237804039,
			 1.01357916204236, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341724938616, 7.0710685425086, 0.721541807450487,
			 1.27492359836435, 0.998232702907419, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.141171418270659, 7.07106803300346
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.17964138311742, 0.198135266654332, 16, 16, 0.00924694176845624,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.923560964385532,
			 0.0963733652127301, 0.095949142670747, -0.253471010509888, 0.255842527106166,
			 50, 16, 0.00118575829813889, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.992718462803939, 0.129929310342806, 0.00912618018990777,
			 -0.481391760037309, 0.46616776221786, 84, 16, -0.00761199890972434,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.974878903318861,
			 0.241728809745842, -0.0314898291094377, -0.289015157534653,
			 0.254388142175045, 16, 50, -0.0173135076798041, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.900607626875317, 0.138625838024574,
			 -0.124893799933133, -0.162492608056341, 0.111743225756098, 50,
			 50, -0.0253746911501215, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.716824573817314, 0.0699594063910298, -0.362705924179697,
			 -0.3283389626029, 0.259994065886931, 84, 50, -0.0341724483579847,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.819892547774723,
			 0.150087714144374, -0.227683182149827, -0.540489594904538, 0.443596732442487,
			 16, 84, -0.0484464312310257, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.846976588036953, 0.251047043494006, -0.192977501574052,
			 -0.353829622888167, 0.240814393485481, 50, 84, -0.056507614701343,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.709519506316193,
			 0.15169768961678, -0.372501485316574, -0.285373914802378, 0.154763170983965,
			 84, 84, -0.0653053719092063, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.560822940737012, 0.112281932029897, -0.581619595678295,
			 -0.0178571646467323, 0.0222266334118251, 16, 16, 0.00218473438254637,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.830818099306007, 0.0102256465870632, 0.213652443778993, -0.0295512223710297,
			 0.0370758788162946, 50, 16, 0.00376232822263246, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.824818205771693,
			 0.0169970218108267, 0.221352203021587, -0.0430977848918503,
			 0.0540659276760142, 84, 16, 0.00548407139208195, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.824900236025506,
			 0.0247871168384418, 0.221246844795472, -0.0127982170246085,
			 0.0155458428840761, 16, 50, 0.00137381292973382, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.849312549153415,
			 0.00723076039464473, 0.189995637353894, -0.02137094524364, 0.0261026281424377,
			 50, 50, 0.00236584144939883, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.845119525414889, 0.0121108279949385,
			 0.195349273426027, -0.0311637011968159, 0.0380607301868978,
			 84, 50, 0.00344851449504098, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.845176224674429, 0.017659618219964,
			 0.195276843026112, -0.0190539460129197, 0.0199005230482221,
			 16, 84, 0.000423288517651179, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.966024485873965, 0.00993754716117481,
			 0.0425948688127925, -0.0327671767691471, 0.0342250659743503,
			 50, 84, 0.000728944602601589, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.965978262554023, 0.0170901718786477,
			 0.0426528538026189, -0.0477631867400907, 0.0498882454829682,
			 84, 84, 0.00106252937143875, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.965978863873021, 0.0249115374040852,
			 0.0426520994751815))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161473237629299, 0.112449348035906, -0.0245119447966966, "contGamma",
			 "<unicode>", 0.725757529293559, "contNormal", 0.0698794946809922,
			 -0.350774499852874, -2.79872516410727, 2.28099171915156, -0.258866722477857,
			 "debCollin1", "<unicode>", 0.841666028751438, "contNormal",
			 1.29586995560301, -0.199762886205197, -0.22557070757197, 0.758946810400398,
			 0.266688051414214, "contcor1", "<unicode>", 0.288309309472341,
			 "contNormal", 0.251157043123781, 1.06183783698544, -1.87023509444858,
			 1.53191989447777, -0.169157599985405, "contcor2", "<unicode>",
			 0.845469945565452, "contNormal", 0.867912628946784, -0.194901646022455,
			 -0.251164556906181, 0.23461419767585, -0.00827517961516553,
			 "contGamma:contcor1", "<unicode>", 0.946760446394336, "contNormal",
			 0.123925428837926, -0.0667754769361188, -2.28051662194507, 2.59510115357587,
			 0.157292265815399, "debCollin1:contcor2", "<unicode>", 0.899367204916443,
			 "contNormal", 1.24380289994591, 0.126460764661538, -0.258825150608586,
			 0.203131190767402, -0.0278469799205917, "contGamma:contcor2",
			 "<unicode>", 0.813203461233249, "contNormal", 0.117848170940854,
			 -0.236295393456447, -0.0197475131776682, 0.00116000632407021,
			 -0.00929375342679899, "contGamma", "<unicode>", 0.0814252456213527,
			 "debCollin1", 0.00533364890035079, -1.74247566730306, -0.0185476054562363,
			 0.0350787567400501, 0.0082655756419069, "contcor1", "<unicode>",
			 0.545717956320379, "debCollin1", 0.0136804458192305, 0.604189055760747,
			 -0.0145563056028413, 0.00654286023433393, -0.00400672268425369,
			 "contGamma:contcor1", "<unicode>", 0.456638954421322, "debCollin1",
			 0.00538253917000588, -0.744392666305357))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175969823246849, 0.198833175548854, 16, 16, 0.0114316761510026,
			 "Total", 0.90483191795571, 0.0956147668406412, 0.119559734638641,
			 -0.250956248816035, 0.257697234177405, 16, 16, 0.00337049268068526,
			 "Total", 0.979277570013879, 0.129760925967424, 0.0259746349338737,
			 -0.479480589399785, 0.468626060345429, 50, 16, -0.00542726452717797,
			 "Total", 0.982097837222758, 0.241868385649879, -0.0224389165727277,
			 -0.285960655870927, 0.255703109276412, 16, 16, -0.0151287732972578,
			 "Total", 0.912818339396239, 0.138182071053324, -0.109484343243196,
			 -0.160014457729486, 0.113634544194335, 84, 16, -0.0231899567675751,
			 "Total", 0.739747178891869, 0.069809701627767, -0.332188166212578,
			 -0.326743257193623, 0.262767829242747, 16, 16, -0.0319877139754383,
			 "Total", 0.831560269976777, 0.150388244653054, -0.212700893272835,
			 -0.537929549090963, 0.445406155394004, 16, 50, -0.0462616968484793,
			 "Total", 0.853687372496143, 0.250855554551358, -0.184415676707721,
			 -0.351682389003768, 0.243036628366174, 16, 16, -0.0543228803187967,
			 "Total", 0.720302581872847, 0.151716822875576, -0.358054428567538,
			 -0.284208257379771, 0.157966982326451, 50, 50, -0.0631206375266599,
			 "Total", 0.575772226819021, 0.112801878808499, -0.559570799647921,
			 -0.174429755112173, 0.20044829509435, 16, 16, 0.0130092699910887,
			 "Total", 0.891796004056308, 0.095633912960522, 0.136031974310818,
			 -0.249961423692486, 0.259857596734029, 84, 50, 0.00494808652077135,
			 "Total", 0.969651681006078, 0.130058262408877, 0.0380451532192209,
			 -0.478540995417527, 0.470841654043343, 16, 16, -0.00384967068709188,
			 "Total", 0.987318163472054, 0.242193901762859, -0.0158949942961868,
			 -0.284525772686165, 0.257423413771821, 16, 84, -0.0135511794571717,
			 "Total", 0.921919652984746, 0.138254883950116, -0.0980159186424188,
			 -0.159746234307471, 0.116521508452493, 16, 16, -0.021612362927489,
			 "Total", 0.759105926646063, 0.0704777600351664, -0.306655076959101,
			 -0.326297572744501, 0.265477332473796, 50, 84, -0.0304101201353523,
			 "Total", 0.840356729224188, 0.150965760056343, -0.201437200885834,
			 -0.536505964586748, 0.447137758569961, 16, 16, -0.0446841030083932,
			 "Total", 0.858667181750301, 0.250934132187011, -0.178071044456766,
			 -0.350833939071784, 0.245343366114363, 84, 84, -0.0527452864787106,
			 "Total", 0.728737249184638, 0.152088841909524, -0.346805760478392,
			 -0.284303980671581, 0.161217893298434, 16, 16, -0.0615430436865738,
			 "Total", 0.588171962988126, 0.113655627726896, -0.541486989403254,
			 -0.174018360891321, 0.203480387212398, 16, 16, 0.0147310131605382,
			 "Total", 0.878425010474955, 0.0963024706273639, 0.152966098009457,
			 -0.249806930397723, 0.263146589778165, 50, 16, 0.00666982969022085,
			 "Total", 0.959349408863626, 0.130857894385305, 0.0509700214996723,
			 -0.478016619651878, 0.473760764616593, 50, 16, -0.00212792751764238,
			 "Total", 0.993007474828068, 0.242804814725161, -0.00876394284047068,
			 -0.283839001341579, 0.260180128766134, 50, 16, -0.0118294362877222,
			 "Total", 0.932073005711255, 0.1387829405027, -0.0852369624456261,
			 -0.161140298420788, 0.121359058904709, 84, 16, -0.0198906197580395,
			 "Total", 0.782548136677777, 0.0720674868400175, -0.275999908283116,
			 -0.326608858588585, 0.26923210465678, 50, 16, -0.0286883769659028,
			 "Total", 0.850300088279532, 0.152003038817367, -0.188735548901573,
			 -0.535437371103087, 0.4495126514252, 16, 50, -0.0429623598389437,
			 "Total", 0.864237415189111, 0.251267377946087, -0.170982640843102,
			 -0.350703822928578, 0.248656736310056, 50, 16, -0.0510235433092611,
			 "Total", 0.738603436503745, 0.152900911436719, -0.333703330018266,
			 -0.285455038449306, 0.165812437415057, 50, 50, -0.0598213005171243,
			 "Total", 0.603316740956767, 0.11512136942921, -0.519636804302519,
			 -0.177834400027859, 0.19907590942424, 50, 16, 0.0106207546981901,
			 "Total", 0.912046505491814, 0.0961523559680482, 0.110457560724975,
			 -0.251246018073062, 0.256365160528807, 84, 50, 0.00255957122787272,
			 "Total", 0.98423020992326, 0.129495027104029, 0.019765787807562,
			 -0.47925036366921, 0.466773991709229, 50, 16, -0.00623818597999051,
			 "Total", 0.979378237086207, 0.241337178346275, -0.0258484251068844,
			 -0.287312643435968, 0.255433253935828, 16, 84, -0.0159396947500703,
			 "Total", 0.90834774755596, 0.138458130264869, -0.115122851360031,
			 -0.159475876199187, 0.111474119758412, 50, 16, -0.0240008782203877,
			 "Total", 0.728419236759462, 0.0691211670456238, -0.347229065223186,
			 -0.325701590297601, 0.260104319441099, 50, 84, -0.0327986354282509,
			 "Total", 0.826281998375027, 0.149443029147337, -0.219472501430057,
			 -0.538916413135156, 0.444771176532573, 50, 16, -0.0470726183012918,
			 "Total", 0.851204985124267, 0.250945322829126, -0.187581174140251,
			 -0.351671963475977, 0.241404359932759, 84, 84, -0.0551338017716092,
			 "Total", 0.715554904921384, 0.151297760593268, -0.364405934069473,
			 -0.282267811794761, 0.154404693835816, 50, 16, -0.0639315589794724,
			 "Total", 0.566034302742581, 0.111398094320864, -0.573901729371853,
			 -0.177106249030916, 0.200331815466626, 16, 16, 0.0116127832178551,
			 "Total", 0.904003161287997, 0.0962869898311208, 0.120605943110517,
			 -0.250066845465559, 0.257170044960634, 84, 16, 0.00355159974753772,
			 "Total", 0.978103393774283, 0.12939954367203, 0.0274467718104125,
			 -0.477933473339796, 0.467441158419145, 50, 16, -0.00524615746032551,
			 "Total", 0.982645133539278, 0.241171429479301, -0.021752814882145,
			 -0.286483913611224, 0.256588581150414, 84, 16, -0.0149476662304053,
			 "Total", 0.91408049065448, 0.138541447456516, -0.107893099897754,
			 -0.158092683827366, 0.11207498442592, 84, 16, -0.0230088497007227,
			 "Total", 0.738499573918656, 0.0689215899843911, -0.333840959065708,
			 -0.324166056722204, 0.260552842905032, 84, 16, -0.0318066069085859,
			 "Total", 0.831147573606753, 0.149165725553996, -0.213229994963369,
			 -0.538001550809657, 0.445840371246403, 16, 50, -0.0460805897816268,
			 "Total", 0.854327888447437, 0.250984694059809, -0.183599202948391,
			 -0.350479934026068, 0.24219638752218, 84, 16, -0.0541417732519442,
			 "Total", 0.720275473386154, 0.15119571742726, -0.35809065344719,
			 -0.280516834507202, 0.154637773587588, 50, 50, -0.0629395304598074,
			 "Total", 0.570736410000893, 0.111010868446368, -0.566967282939643,
			 -0.176941950688044, 0.202332863215038, 84, 16, 0.0126954562634972,
			 "Total", 0.895607880369999, 0.0967555569629732, 0.131211649873046,
			 -0.2492505997255, 0.25851914531186, 84, 50, 0.00463427279317987,
			 "Total", 0.971460899153546, 0.129535478468631, 0.0357760888983178,
			 -0.47674877434606, 0.468421805516694, 84, 16, -0.00416348441468336,
			 "Total", 0.986223359827597, 0.241119374467628, -0.0172673159254664,
			 -0.286018519421874, 0.258288533052347, 16, 84, -0.0138649931847632,
			 "Total", 0.920462368652382, 0.138856391435671, -0.099851314306886,
			 -0.157465802606745, 0.113613449296584, 84, 16, -0.0219261766550805,
			 "Total", 0.751196268693804, 0.0691541411070735, -0.317062381284319,
			 -0.322898095589732, 0.261450227863845, 50, 84, -0.0307239338629437,
			 "Total", 0.836710903010144, 0.149071189078688, -0.206102426986921,
			 -0.537245753456667, 0.447249919984697, 84, 16, -0.0449979167359847,
			 "Total", 0.857807008435925, 0.251151470436942, -0.179166447473707,
			 -0.349581858435021, 0.243463658022417, 84, 84, -0.053059100206302,
			 "Total", 0.725804837306241, 0.151289901532708, -0.350711446492883,
			 -0.279153127004273, 0.155439412175942, 84, 16, -0.0618568574141653,
			 "Total", 0.576888712212176, 0.1108674808844, -0.557935085389577,
			 -0.181100487688281, 0.200440948260495, 16, 16, 0.00967023028610742,
			 "Total", 0.920859413897214, 0.0973337874977107, 0.099351217441681,
			 -0.252400392969157, 0.255618486600737, 16, 50, 0.00160904681579007,
			 "Total", 0.990094057136301, 0.129599034364173, 0.0124155771968845,
			 -0.479416047263314, 0.465038626479167, 50, 16, -0.00718871039207316,
			 "Total", 0.976197444657435, 0.240936741999399, -0.0298365053516458,
			 -0.289655817615994, 0.255875379291688, 16, 50, -0.016890219162153,
			 "Total", 0.903401867041508, 0.139168678917256, -0.121365089426445,
			 -0.160364350110112, 0.110461544845171, 84, 16, -0.0249514026324703,
			 "Total", 0.717990273211934, 0.0690895080449242, -0.3611460457389,
			 -0.325176597370092, 0.257678277689425, 16, 50, -0.0337491598403335,
			 "Total", 0.820442127592122, 0.148690200344752, -0.226976355954078,
			 -0.540493518614458, 0.444447233187709, 16, 50, -0.0480231427133745,
			 "Total", 0.848427296315444, 0.251265012921476, -0.191125466116457,
			 -0.352356212829063, 0.240187560461679, 16, 50, -0.0560843261836918,
			 "Total", 0.710621468791018, 0.151161903474924, -0.371021566244008,
			 -0.280908674045486, 0.151144507262376, 50, 50, -0.0648820833915551,
			 "Total", 0.556088338976064, 0.110219673605189, -0.588661545342304,
			 -0.183358584283798, 0.203310357025913, 16, 50, 0.00997588637105783,
			 "Total", 0.919445362592613, 0.0986418486155119, 0.101132394729767,
			 -0.252548884050737, 0.256378289852218, 84, 50, 0.00191470290074048,
			 "Total", 0.988233476664171, 0.12983074635996, 0.0147476846157219,
			 -0.478483383605955, 0.464717274991709, 16, 50, -0.00688305430712275,
			 "Total", 0.977178929008708, 0.240616834298362, -0.0286058717678408,
			 -0.290971266396516, 0.257802140242111, 16, 84, -0.0165845630772025,
			 "Total", 0.905699440788014, 0.139995788434707, -0.118464728565299,
			 -0.160549493664961, 0.111258000569921, 16, 50, -0.0246457465475199,
			 "Total", 0.722264684311907, 0.0693399206258036, -0.355433728869145,
			 -0.323685480049394, 0.256798472538628, 50, 84, -0.0334435037553831,
			 "Total", 0.821326361061001, 0.148085362069611, -0.225839362432475,
			 -0.540971450951063, 0.445536477694214, 16, 50, -0.0477174866284241,
			 "Total", 0.849616861908537, 0.251664810278843, -0.189607305747487,
			 -0.352081899702591, 0.240524559505108, 84, 84, -0.0557786700987414,
			 "Total", 0.71215717535056, 0.15117789507412, -0.368960489041035,
			 -0.278733734556996, 0.149580879943786, 16, 50, -0.0645764273066047,
			 "Total", 0.554518846646711, 0.109265940057897, -0.591002349610384,
			 -0.186932574776277, 0.207551517056067, 16, 16, 0.010309471139895,
			 "Total", 0.918404550213816, 0.100635546097781, 0.102443634875076,
			 -0.253593881528405, 0.258090456867561, 50, 50, 0.00224828766957764,
			 "Total", 0.986258111192275, 0.130534117573605, 0.0172237550716186,
			 -0.477943664551258, 0.464844725474687, 50, 16, -0.00654946953828559,
			 "Total", 0.9782751705107, 0.240511661811783, -0.0272314011260336,
			 -0.293212307882106, 0.260710351265376, 50, 50, -0.0162509783083654,
			 "Total", 0.908442891801999, 0.141309397396267, -0.115002813739228,
			 -0.162394148016164, 0.113769824458798, 84, 16, -0.0243121617786827,
			 "Total", 0.73002535628721, 0.0704512875372476, -0.345091802131067,
			 -0.322832768080682, 0.25661293010759, 50, 50, -0.033109918986546,
			 "Total", 0.822767158392366, 0.147820496386379, -0.223987334611581,
			 -0.54194828495373, 0.447180481234557, 16, 50, -0.0473839018595869,
			 "Total", 0.851046830031025, 0.252333403570272, -0.187782914149101,
			 -0.352543302929534, 0.241653132269725, 50, 50, -0.0554450853299043,
			 "Total", 0.714534810252873, 0.15158350864766, -0.365772542307228,
			 -0.27740291693583, 0.148917231860295, 50, 50, -0.0642428425377675,
			 "Total", 0.554721442644679, 0.108757138436952, -0.590700007935662,
			 -0.0178571646467323, 0.0222266334118251, 50, 50, 0.00218473438254637,
			 "Total indirect", 0.830818099306007, 0.0102256465870632, 0.213652443778993,
			 -0.0295512223710297, 0.0370758788162946, 84, 50, 0.00376232822263246,
			 "Total indirect", 0.824818205771693, 0.0169970218108267, 0.221352203021587,
			 -0.0430977848918503, 0.0540659276760142, 50, 50, 0.00548407139208195,
			 "Total indirect", 0.824900236025506, 0.0247871168384418, 0.221246844795472,
			 -0.0127982170246085, 0.0155458428840761, 16, 84, 0.00137381292973382,
			 "Total indirect", 0.849312549153415, 0.00723076039464473, 0.189995637353894,
			 -0.02137094524364, 0.0261026281424377, 50, 50, 0.00236584144939883,
			 "Total indirect", 0.845119525414889, 0.0121108279949385, 0.195349273426027,
			 -0.0311637011968159, 0.0380607301868978, 50, 84, 0.00344851449504098,
			 "Total indirect", 0.845176224674429, 0.017659618219964, 0.195276843026112,
			 -0.0190539460129197, 0.0199005230482221, 50, 50, 0.000423288517651179,
			 "Total indirect", 0.966024485873965, 0.00993754716117481, 0.0425948688127925,
			 -0.0327671767691471, 0.0342250659743503, 84, 84, 0.000728944602601589,
			 "Total indirect", 0.965978262554023, 0.0170901718786477, 0.0426528538026189,
			 -0.0477631867400907, 0.0498882454829682, 50, 50, 0.00106252937143875,
			 "Total indirect", 0.965978863873021, 0.0249115374040852, 0.0426520994751815,
			 16, 16, 84, 50, 50, 16, 84, 50, 84, 16, 84, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 84, 50, 50, 84,
			 84, 50, 84, 84, 84, 50, 16, 16, 16, 84, 50, 16, 16, 84, 84,
			 16, 16, 84, 16, 50, 16, 84, 50, 50, 16, 84, 84, 50, 16, 84,
			 16, 84, 16, 84, 50, 84, 16, 84, 84, 84, 16, 84, 16, 16, 50,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 16, 50, 50, 84, 50, 50,
			 50, 84, 84, 50, 50, 84, 16, 84, 50, 84, 50, 84, 50, 84, 84,
			 84, 50, 84, 16, 16, 84, 84, 50, 16, 84, 84, 84, 16, 84, 84,
			 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 84, 16, 84, 84,
			 84, 50, 84, 84, 84, 84, 84, 84, 84, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")
})


context('Model number 29 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(21384.5216194931, 21530.7547149441, 15627.3102718527, 14, 1, 2564,
			 0, 0, 15627.3102718527, 14))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 29))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678667171764975, 0.0881404414371679, 0.0780035793068327, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517196346988693, 15.0820050762149,
			 -0.0939564169475424, -0.0542208694149342, -0.0740886431812383,
			 "contcor2", "<unicode>", 2.69340105774063e-13, "facGenderm",
			 0.010136805534703, -7.3088748647292, -0.0997965912863613, -0.0599935747554428,
			 -0.0798950830209021, "contcor2", "<unicode>", 3.5527136788005e-15,
			 "facExperimexperimental", 0.0101540173301345, -7.86832249968629,
			 0.960775443184005, 1.07205224789021, 1.01641384553711, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0283874616023407, 35.8050275778549,
			 0.00607839367957321, 0.0067823916164277, 0.00643039264800045,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000179594610515178,
			 35.8050424205631, 0.426153185375148, 0.4755100750685, 0.450831630221824,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.0125912746567471, 35.8050826871799, 0.236315044061571, 0.263685004320842,
			 0.250000024191206, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698226101988655, 35.8050241145623, 0.23631559674106, 0.263685692892529,
			 0.250000644816795, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.0069822956869004, 35.8049352286562,
			 0.975409199389381, 1.08838099961263, 1.031895099501, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288198663634515, 35.8049925175788
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.47289081805062, 0.784661077914264, 16, 0.628775947982442, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 2.66453525910038e-15,
			 0.0795346910256639, 7.90568165757445, 0.203709193953231, 0.488293451862502,
			 16, 0.346001322907866, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 1.88012011448357e-06, 0.0725993590071132, 4.76590052088429,
			 0.49706528590414, 0.732444866047153, 50, 0.614755075975647,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0600469146371202,
			 10.237912800196, 0.213611795858367, 0.450349105943775, 50, 0.331980450901071,
			 1, "facGenderm", "contNormal", "", "<unicode>", "", 3.86357936754678e-08,
			 0.0603932806808599, 5.4969766033307, 0.46212332412401, 0.737211091283973,
			 84, 0.599667207703992, 0, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0, 0.0701767403201846, 8.54509920192906, 0.163228704121701,
			 0.47055646113713, 84, 0.316892582629416, 1, "facGenderm", "contNormal",
			 "", "<unicode>", "", 5.30139301861965e-05, 0.078401378657871,
			 4.04192615046064, -0.00753824075267087, 0.00326570576009866,
			 16, -0.0021362674962861, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.438287365861088, 0.0027561594493546,
			 -0.775088501061267, -0.00612371120469407, 0.0213084256000968,
			 16, 0.00759235719770138, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.277960004091901, 0.0069981226750012,
			 1.08491341896919, -0.00338789441709671, 0.00208747909422928,
			 50, -0.000650207661433717, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.641575943802358, 0.00139680462358366,
			 -0.465496498547905, -0.00651816139273741, 0.0111398755056649,
			 50, 0.00231085705646374, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.607958440208366, 0.00450468402421847,
			 0.512989822158427, -0.00284117615774662, 0.00473906048716661,
			 84, 0.000948942164709994, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.623623453195188, 0.00193376937145406,
			 0.490721478330405, -0.0154488870851002, 0.00870375063850476,
			 84, -0.0033725682232977, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.584130385924917, 0.00616150039340464,
			 -0.547361520403009))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.497062697594084, 0.732350850613749, 0.614706774103917, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.06002359096279, 10.2410862836412,
			 -0.619617000251485, 0.36217329987007, -0.128721850190707, "debCollin1",
			 "<unicode>", 0.60729459981681, "contNormal", 0.250461311500056,
			 -0.513939056773958, 0.0250943237431442, 0.258077773183844, 0.141586048463494,
			 "facExperimexperimental", "<unicode>", 0.0172107639704067, "contNormal",
			 0.0594356455726849, 2.38217398161085, -0.457792580719255, 0.163098616765654,
			 -0.1473469819768, "contcor2", "<unicode>", 0.352237057768568,
			 "contNormal", 0.158393522121432, -0.930258889399765, -0.450822920858023,
			 -0.114726329291129, -0.282774625074576, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.000973662264180719, "contNormal", 0.0857405019219693,
			 -3.29802857151365, -0.181441650389288, 0.739664134844825, 0.279111242227769,
			 "debCollin1:contcor2", "<unicode>", 0.234909427927504, "contNormal",
			 0.234980283438797, 1.1878070710578, -0.0936256879981697, 0.0672312225718363,
			 -0.0131972327131667, "facGenderm:contcor2", "<unicode>", 0.74775282732594,
			 "contNormal", 0.0410356802060713, -0.321603849306101, -0.00422896986344155,
			 0.0142519486782099, 0.00501148940738415, "facGenderm", "<unicode>",
			 0.287795175673373, "debCollin1", 0.00471460666813945, 1.06297083938115,
			 -0.012586742504323, 0.00589417603721389, -0.00334628323355457,
			 "facExperimexperimental", "<unicode>", 0.477847188800306, "debCollin1",
			 0.00471460666811024, -0.709769333715353, -0.0358904522411059,
			 -0.00975448659459177, -0.0228224694178489, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.000619425707780064, "debCollin1", 0.006667460691286,
			 -3.4229627251761))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.470449659973514, 0.782829700998798, 16, 0.626639680486156, 0,
			 "Total", 3.77475828372553e-15, 0.0796902503028877, 7.86344224173492,
			 0.201262753848222, 0.486467356974938, 16, 0.34386505541158,
			 0, "Total", 2.28790932532696e-06, 0.0727576132460528, 4.72617283704308,
			 0.494754820910503, 0.730482796048218, 16, 0.612618808479361,
			 1, "Total", 0, 0.0601357925444312, 10.1872575808613, 0.211330939208109,
			 0.448357427601461, 16, 0.329844183404785, 0, "Total", 4.89891895938399e-08,
			 0.0604670520129417, 5.45494070612519, 0.460049600952689, 0.735012279462722,
			 50, 0.597530940207706, 0, "Total", 0, 0.070144829363933, 8.5185315243627,
			 0.161170495585983, 0.468342134680277, 16, 0.31475631513313,
			 0, "Total", 5.90140836074227e-05, 0.0783615519257559, 4.01671875298421,
			 0.480631816240688, 0.7921047941196, 50, 0.636368305180144, 1,
			 "Total", 1.11022302462516e-15, 0.079458852391108, 8.00877795274272,
			 0.211379634393297, 0.495807725817838, 16, 0.353593680105568,
			 0, "Total", 1.09830804828626e-06, 0.0725595198860984, 4.87315352500441,
			 0.504038953274469, 0.740655913072227, 84, 0.622347433173348,
			 0, "Total", 0, 0.060362578512708, 10.3101532192222, 0.220487742672381,
			 0.458657873525163, 16, 0.339572808098772, 0, "Total", 2.28557222037296e-08,
			 0.0607588028992975, 5.58886600615856, 0.468438473217897, 0.74608065658549,
			 84, 0.607259564901693, 1, "Total", 0, 0.0708283890820442, 8.57367466311104,
			 0.169598956839204, 0.47937092281503, 16, 0.324484939827117,
			 0, "Total", 4.02378911330548e-05, 0.0790249128094364, 4.10610943171291,
			 0.472248688027416, 0.784002792614601, 16, 0.628125740321008,
			 0, "Total", 2.88657986402541e-15, 0.079530569705939, 7.89791576551605,
			 0.202903244826514, 0.487798985666351, 16, 0.345351115246433,
			 1, "Total", 2.01670063471049e-06, 0.0726788203985016, 4.75174353894099,
			 0.496426690648266, 0.73178304598016, 16, 0.614104868314213,
			 1, "Total", 0, 0.0600409898315364, 10.2280936746259, 0.212775321641374,
			 0.449885164837901, 16, 0.331330243239637, 1, "Total", 4.31155859903498e-08,
			 0.0604883163840814, 5.47759076539338, 0.461483893181585, 0.736550106903531,
			 50, 0.599017000042558, 0, "Total", 0, 0.070171241893125, 8.53650275927704,
			 0.162435719528593, 0.470049030407371, 16, 0.316242374967982,
			 1, "Total", 5.58033265689595e-05, 0.0784742253697497, 4.0298884567249,
			 0.474837924670862, 0.78733568540695, 50, 0.631086805038906,
			 1, "Total", 2.44249065417534e-15, 0.0797202813931865, 7.91626414270087,
			 0.206206471540658, 0.490417888388002, 16, 0.34831217996433,
			 1, "Total", 1.55507661347976e-06, 0.0725042447435686, 4.80402466360739,
			 0.498891531061026, 0.735240335003195, 84, 0.617065933032111,
			 0, "Total", 0, 0.0602941701496706, 10.2342553434328, 0.216143584270146,
			 0.452439031644923, 16, 0.334291307957535, 1, "Total", 2.92963331371965e-08,
			 0.0602805585303215, 5.54559075276955, 0.464016315224406, 0.739939814296505,
			 84, 0.601978064760456, 1, "Total", 0, 0.0703899411541612, 8.55204671136267,
			 0.165707004859, 0.472699874512759, 16, 0.31920343968588, 1,
			 "Total", 4.58481049994131e-05, 0.0783159466386322, 4.07584219289026,
			 0.474088253596402, 0.785361526697902, 16, 0.629724890147152,
			 0, "Total", 2.22044604925031e-15, 0.079407906358684, 7.93025429108655,
			 0.20456265335896, 0.489337876786193, 50, 0.346950265072576,
			 0, "Total", 1.79023790547461e-06, 0.0726480755956497, 4.77576676639941,
			 0.498097625413594, 0.733310410867119, 16, 0.615704018140357,
			 1, "Total", 0, 0.06000436418956, 10.260987287446, 0.214202359396776,
			 0.451656426734785, 50, 0.332929393065781, 0, "Total", 3.88394165717898e-08,
			 0.0605761302786725, 5.49604921169746, 0.462917629344832, 0.738314670392571,
			 50, 0.600616149868702, 0, "Total", 0, 0.0702556381698939, 8.54900995157537,
			 0.16369956650136, 0.471983483086891, 50, 0.317841524794126,
			 0, "Total", 5.31203503002509e-05, 0.0786453013976876, 4.04145599476933,
			 0.468011556163785, 0.782795203354504, 50, 0.625403379759145,
			 1, "Total", 6.88338275267597e-15, 0.0803034264082636, 7.78800367221675,
			 0.199984668194893, 0.485272841174245, 50, 0.342628754684569,
			 0, "Total", 2.50402973800412e-06, 0.0727789324777569, 4.70780132408901,
			 0.492565342438766, 0.730199673065933, 84, 0.611382507752349,
			 0, "Total", 0, 0.0606221166566315, 10.085139573982, 0.210683993537706,
			 0.44653177181784, 50, 0.328607882677773, 0, "Total", 4.71715759786662e-08,
			 0.0601663551321531, 5.46165513859031, 0.458585009738017, 0.734004269223371,
			 84, 0.596294639480694, 1, "Total", 0, 0.0702613062428253, 8.48681402847651,
			 0.160920922603922, 0.466119106208315, 50, 0.313520014406118,
			 0, "Total", 5.65380718442476e-05, 0.0778581101519613, 4.02681254135502,
			 -0.00753824075267087, 0.00326570576009866, 16, -0.0021362674962861,
			 0, "Total indirect", 0.438287365861088, 0.0027561594493546,
			 -0.775088501061267, -0.00612371120469407, 0.0213084256000968,
			 50, 0.00759235719770138, 1, "Total indirect", 0.277960004091901,
			 0.0069981226750012, 1.08491341896919, -0.00338789441709671,
			 0.00208747909422928, 16, -0.000650207661433717, 1, "Total indirect",
			 0.641575943802358, 0.00139680462358366, -0.465496498547905,
			 -0.00651816139273741, 0.0111398755056649, 50, 0.00231085705646374,
			 1, "Total indirect", 0.607958440208366, 0.00450468402421847,
			 0.512989822158427, -0.00284117615774662, 0.00473906048716661,
			 50, 0.000948942164709994, 0, "Total indirect", 0.623623453195188,
			 0.00193376937145406, 0.490721478330405, -0.0154488870851002,
			 0.00870375063850476, 50, -0.0033725682232977, 1, "Total indirect",
			 0.584130385924917, 0.00616150039340464, -0.547361520403009,
			 50, 1, 50, 1, 84, 0, 50, 1, 84, 1, 50, 1, 16, 0, 84, 0, 16,
			 1, 84, 0, 50, 0, 84, 0, 50, 1, 84, 0, 84, 0, 84, 0, 84, 1, 84,
			 0, 16, 0, 84, 1, 16, 1, 84, 1, 50, 0, 84, 1, 50, 1, 84, 1, 84,
			 0, 84, 1, 84, 1, 84, 1, 16, 0, 16, 1, 50, 0, 50, 1, 84, 0, 84,
			 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")
})


context('Model number 58 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(958.596328289737, 1005.48939163752, 543.411640735668, 7, 1, 100,
			 3.69260017232995e-113, 0, 543.411640735668, 7))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 58))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848560467517, 0.0642085785655763, -0.240319990950971, "contcor1",
			 "<unicode>", 0.121932284975789, "contGamma", 0.155374574185357,
			 -1.54671375423546, 0.761632488021886, 1.34576159080486, 1.05369703941337,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.149015264410599, 7.07106781027479, 0.00465468575934563, 0.00822456688182219,
			 0.00643962632058391, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700694154417, 7.07106776344679, 0.323891783045089,
			 0.5722984652057, 0.448095124125395, "debCollin1:contcor1", "<unicode>",
			 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702160141744,
			 7.07106827638344, 1.68041102990758, 2.96919161339415, 2.32480132165087,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776598359028, 7.07106689847845, 0.7326347162105, 1.29452438193242,
			 1.01357954907146, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341834379109, 7.07106584383981))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211983385323, 0.117652593273353, "", -0.0182796950559851,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.79211201073381,
			 0.0693544827361902, -0.263569048961366, -0.0232783744511886,
			 0.0451693383442318, 16, 0.0109454819465216, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.530766643970138, 0.0174614720819687,
			 0.626836150763272, -0.0219984855745086, 0.0247265672748418,
			 50, 0.0013640408501666, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.908893641074803, 0.0119198753696271,
			 0.11443415370284, -0.0845459505060982, 0.0328912750983231, 84,
			 -0.0258273377038875, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.388638717207285, 0.0299590264236361,
			 -0.862088685348971))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211983385323, 0.117652593273353, -0.0182796950559851, "contGamma",
			 "<unicode>", 0.79211201073381, "contNormal", 0.0693544827361902,
			 -0.263569048961366, -2.65749893940856, 2.35038161603006, -0.15355866168925,
			 "debCollin1", "<unicode>", 0.904326038557207, "contNormal",
			 1.27754402502805, -0.120198332645232, -2.74314935700805, 0.52711457881107,
			 -1.10801738909849, "contcor1", "<unicode>", 0.184133880308839,
			 "contNormal", 0.834266333875149, -1.32813388735438, -0.533830985977199,
			 4.39043819070962, 1.92830360236621, "debCollin1:contcor1", "<unicode>",
			 0.124780932989519, "contNormal", 1.25621419973245, 1.53501178602893,
			 -0.0197475154615341, 0.00116000314418939, -0.00929375615867236,
			 "contGamma", "<unicode>", 0.0814251430146111, "debCollin1",
			 0.00533364867177136, -1.74247625417476, -0.01854762249923, 0.0350787373987442,
			 0.0082655574497571, "contcor1", "<unicode>", 0.545718823113496,
			 "debCollin1", 0.0136804452329155, 0.604187751862778, -0.0145562999497492,
			 0.00654286498317659, -0.00400671748328632, "contGamma:contcor1",
			 "<unicode>", 0.456639519528208, "debCollin1", 0.00538253893932576,
			 -0.744391731941325))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146208936061104, 0.131540509842177, 16, -0.00733421310946357,
			 "Total", 0.917558950599048, 0.0708557524766102, -0.103509070937954,
			 -0.150831154605378, 0.116999846193741, 50, -0.0169156542058185,
			 "Total", 0.80446358506195, 0.0683254903946541, -0.24757457441011,
			 -0.184093139244291, 0.0958790737245459, 84, -0.0441070327598727,
			 "Total", 0.536873069331641, 0.0714227953108379, -0.617548397089686,
			 -0.0232783744511886, 0.0451693383442318, 16, 0.0109454819465216,
			 "Total indirect", 0.530766643970138, 0.0174614720819687, 0.626836150763272,
			 -0.0219984855745086, 0.0247265672748418, 50, 0.0013640408501666,
			 "Total indirect", 0.908893641074803, 0.0119198753696271, 0.11443415370284,
			 -0.0845459505060982, 0.0328912750983231, 84, -0.0258273377038875,
			 "Total indirect", 0.388638717207285, 0.0299590264236361, -0.862088685348971
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-58")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-58")
})


context('Model number 58 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(10495.3424510859, 10600.6302798107, 14338.7825482888, 7, 1, 2564,
			 0, 0, 14338.7825482888, 7))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 58))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678678078563315, 0.0881414923542761, 0.0780046501053038, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517195332614806, 15.0822416959822,
			 0.966971149540048, 1.07896553962092, 1.02296834458048, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0285705224596656, 35.8050275778001,
			 0.0060784413808656, 0.00678245104650965, 0.00643044621368763,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000179597602608308,
			 35.8047441630501, 0.10358665214406, 0.115584105206813, 0.109585378675436,
			 "debCollin1:facExperimexperimental", "<unicode>", 0, "debCollin1:facExperimexperimental",
			 0.00306063100071926, 35.8048319610182, 0.236314783287065, 0.263684679428663,
			 0.249999731357864, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698224466303658, 35.8050660529474, 0.236314783287136, 0.263684679428757,
			 0.249999731357946, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698224466304256, 35.8050660529285
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.383040483507355, 0.548379695315258, 0.465710089411306, "", "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0421791454108537, 11.0412405200478,
			 -0.00374357531391039, 0.00310521112177659, -0.000319182096066898,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.855045154380217, 0.00174717150154527, -0.182685040240526,
			 -0.0130499317385315, 0.0121359152849463, -0.000457008226792588,
			 1, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.943295239085781, 0.00642507903771208, -0.0711288101064863
			))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.383040483507355, 0.548379695315258, 0.465710089411306, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0421791454108537, 11.0412405200478,
			 -0.736773118806031, 0.609403358398756, -0.0636848802036374,
			 "debCollin1", "<unicode>", 0.852880920754848, "contNormal",
			 0.343418677032653, -0.185443845844127, -0.713137965842038, 0.591729432449674,
			 -0.0607042666961819, "facExperimexperimental", "<unicode>",
			 0.855299773301279, "contNormal", 0.332880453055347, -0.182360562595391,
			 -0.887537084009097, 1.0662268130482, 0.0893448645195507, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.857736078354155, "contNormal", 0.498418315966094,
			 0.179256784226262, -0.0042286001919685, 0.0142523953234436,
			 0.00501189756573755, "facGenderm", "<unicode>", 0.287757923754345,
			 "debCollin1", 0.00471462630466372, 1.06305298487385, -0.0125864074589993,
			 0.00589458805629768, -0.00334590970135083, "facExperimexperimental",
			 "<unicode>", 0.477898162984547, "debCollin1", 0.00471462630463436,
			 -0.709687149130331, -0.0358900870440541, -0.00975401254015361,
			 -0.0228220497921039, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619601634169742, "debCollin1", 0.0066674884615377, -3.42288553234939
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.382719604548488, 0.548062210081991, 0.46539090731524, 0, "Total",
			 0, 0.0421800111730889, 11.0334467529056, 0.382583566166696,
			 0.547922596202331, 0.465253081184514, 1, "Total", 0, 0.0421790990395253,
			 11.0304177134873, -0.00374357531391039, 0.00310521112177659,
			 -0.000319182096066898, 0, "Total indirect", 0.855045154380217,
			 0.00174717150154527, -0.182685040240526, -0.0130499317385315,
			 0.0121359152849463, -0.000457008226792588, 1, "Total indirect",
			 0.943295239085781, 0.00642507903771208, -0.0711288101064863
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-58")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-58")
})


context('Model number 59 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(960.578646213673, 1010.07687974745, 543.393958659604, 6, 1, 100,
			 3.74832833808652e-114, 0, 543.393958659604, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 59))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.5448479880197, 0.0642086999878725, -0.240319644015914, "contcor1",
			 "<unicode>", 0.12193254732866, "contGamma", 0.155374459125712,
			 -1.54671266672905, 0.761497827499561, 1.34552365322258, 1.05351074036107,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148988917737709, 7.07106781066596, 0.00465468577371999, 0.00822456693195891,
			 0.00643962635283945, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700703277633, 7.07106772802863, 0.323891799165623,
			 0.572298521429937, 0.44809516029778, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702262448991,
			 7.07106770561433, 1.68041066580362, 2.96919034339911, 2.32480050460137,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776367260117, 7.07106938365209, 0.732634564171931, 1.29452385195858,
			 1.01357920806525, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341737965279, 7.07106822097254))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197083117811736, 0.178067765659597, 16, -0.0095076760760692,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.920864263816478,
			 0.0957035145621234, -0.0993451088977254, -0.155656044302292,
			 0.117371980035443, 50, -0.0191420321334247, "contGamma", "contNormal",
			 "", "<unicode>", "", 0.783449394696498, 0.0696512860673322,
			 -0.274826686113449, -0.245504699589584, 0.18619128503966, 84,
			 -0.0296567072749624, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.787705199659887, 0.110128550329089, -0.269291724864636,
			 -0.0231725696149466, 0.0445488821865313, 16, 0.0106881562857924,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.536137939745019, 0.0172761980157942, 0.618663682600828, -0.0219695891954241,
			 0.0250245640912413, 50, 0.00152748744790862, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.898613953384184, 0.0119885247018183,
			 0.127412461991836, -0.0852937481404876, 0.0360453710292068,
			 84, -0.0246241885556404, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.426323783734901, 0.0309544257258812,
			 -0.795498155052251))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.155571638011355, 0.117359573777455, -0.0191060321169499, "contGamma",
			 "<unicode>", 0.783771766659028, "contNormal", 0.0696265885347017,
			 -0.274407126918584, -2.68756648797426, 2.34581831800022, -0.170874084987019,
			 "debCollin1", "<unicode>", 0.894134628585442, "contNormal",
			 1.28405033094414, -0.133074289121813, -2.93402643743435, 0.846751387953195,
			 -1.04363752474058, "contcor1", "<unicode>", 0.279231101395746,
			 "contNormal", 0.964501862077527, -1.08204822175521, -0.790596227130365,
			 4.51341269512591, 1.86140823399777, "debCollin1:contcor1", "<unicode>",
			 0.168922641729553, "contNormal", 1.35308836389179, 1.37567381678159,
			 -0.15564570658036, 0.135865477748045, -0.00989011441615736,
			 "contGamma:contcor1", "<unicode>", 0.894200031054399, "contNormal",
			 0.0743664645441976, -0.132991590722717, -0.0197475286414048,
			 0.00115999001669014, -0.00929376931235733, "contGamma", "<unicode>",
			 0.0814247126017016, "debCollin1", 0.00533364868513166, -1.74247871598013,
			 -0.0185475792371072, 0.0350787807953749, 0.00826560077913386,
			 "contcor1", "<unicode>", 0.545716718627881, "debCollin1", 0.0136804452672294,
			 0.604190917596342, -0.014556314093374, 0.00654285089245448,
			 -0.00400673160045976, "contGamma:contcor1", "<unicode>", 0.456637934395537,
			 "debCollin1", 0.00538253895282158, -0.744394352847068))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.185870223677012, 0.188231184096459, 16, 0.00118048020972316,
			 "Total", 0.990130925170525, 0.0954357862502412, 0.0123693664201375,
			 -0.148155302298258, 0.131247550602994, 16, -0.00845387584763237,
			 "Total", 0.905588278329864, 0.0712775477266792, -0.118605032261345,
			 -0.239527319573618, 0.201590217595278, 50, -0.0189685509891701,
			 "Total", 0.866141708694981, 0.112532051774516, -0.168561318220501,
			 -0.195782287967193, 0.179821910710872, 16, -0.00798018862816058,
			 "Total", 0.933625839690518, 0.0958191583214749, -0.0832838522896111,
			 -0.151916701236892, 0.11668761186586, 84, -0.0176145446855161,
			 "Total", 0.797131531118476, 0.0685227675665137, -0.257061197483275,
			 -0.240837362448774, 0.184578922794666, 16, -0.0281292198270538,
			 "Total", 0.795487071145912, 0.10852655676305, -0.259192041708919,
			 -0.236915455330212, 0.168651726066793, 16, -0.0341318646317096,
			 "Total", 0.741479552227714, 0.103462916817877, -0.329894668365005,
			 -0.183540472345136, 0.096008030967006, 50, -0.0437662206890651,
			 "Total", 0.539410003901133, 0.0713147041265006, -0.613705423378481,
			 -0.259207973116188, 0.150646181454983, 50, -0.0542808958306028,
			 "Total", 0.603653731781217, 0.104556552519344, -0.519153458321611,
			 -0.0231725696149466, 0.0445488821865313, 50, 0.0106881562857924,
			 "Total indirect", 0.536137939745019, 0.0172761980157942, 0.618663682600828,
			 -0.0219695891954241, 0.0250245640912413, 84, 0.00152748744790862,
			 "Total indirect", 0.898613953384184, 0.0119885247018183, 0.127412461991836,
			 -0.0852937481404876, 0.0360453710292068, 50, -0.0246241885556404,
			 "Total indirect", 0.426323783734901, 0.0309544257258812, -0.795498155052251,
			 16, 84, 50, 84, 84, 84, 16, 50, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-59")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-59")
})


context('Model number 59 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(10484.6911160922, 10595.828268635, 14326.1312132951, 6, 1, 2564,
			 0, 0, 14326.1312132951, 6))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 59))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678662033818865, 0.0881398494546735, 0.07800302641828, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517194352363182, 15.0819563403711,
			 0.962211655111216, 1.07365480157391, 1.01793322834256, "contNormal",
			 "<unicode>", 0, "contNormal", 0.0284298965036445, 35.8050275776442,
			 0.00607839586688605, 0.00678239434155323, 0.00643039510421964,
			 "debCollin1", "<unicode>", 0, "debCollin1", 0.000179594747714813,
			 35.8050287441076, 0.103586106914671, 0.115583425916715, 0.109584766415693,
			 "debCollin1:facExperimexperimental", "<unicode>", 0, "debCollin1:facExperimexperimental",
			 0.0030605968009302, 35.8050320063025, 0.236315002932495, 0.263684953078523,
			 0.249999978005509, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698225843993024, 35.8050307298575, 0.23631500293266, 0.263684953078558,
			 0.249999978005609, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698225843989691, 35.8050307300428
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498431737469395, 0.731051364500337, 0.614741550984866, 0, "facGenderm",
			 "contNormal", "", "<unicode>", "", 0, 0.0593428320279902, 10.3591542563205,
			 0.198113760322144, 0.431996856293638, 0.315055308307891, 1,
			 "facGenderm", "contNormal", "", "<unicode>", "", 1.28908735907984e-07,
			 0.0596651514559283, 5.28039065719303, -0.00390771789882092,
			 0.00301980788103574, -0.000443955008892592, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.801650871325537,
			 0.00176725843803766, -0.251211141130865, -0.0113235355811748,
			 0.0139057071601547, 0.00129108578948996, 1, "facGenderm", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.841012064680583, 0.00643614957732247,
			 0.200599096397488))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498431737469395, 0.731051364500337, 0.614741550984866, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0593428320279902, 10.3591542563205,
			 -0.760154703943734, 0.582984375730414, -0.0885851641066603,
			 "debCollin1", "<unicode>", 0.795994614962949, "contNormal",
			 0.342643816485573, -0.258534255820695, -0.52305551670459, 0.79662293346807,
			 0.13678370838174, "facExperimexperimental", "<unicode>", 0.684523894541488,
			 "contNormal", 0.336658852045781, 0.406297673596116, -0.959212640874849,
			 0.991404051585291, 0.016095705355221, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.974196388123552, "contNormal", 0.497615442897511,
			 0.0323456709090439, -0.464620466997703, -0.134752018356247,
			 -0.299686242676975, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000369074380058843, "contNormal", 0.0841516607558652, -3.56126355659698,
			 -0.00422884296883297, 0.0142520791025506, 0.00501161806685882,
			 "facGenderm", "<unicode>", 0.287782891927107, "debCollin1",
			 0.00471460756859788, 1.06299792590145, -0.0125866490173046,
			 0.0058942730541473, -0.00334618798157865, "facExperimexperimental",
			 "<unicode>", 0.477859803684243, "debCollin1", 0.00471460756861531,
			 -0.709748994561902, -0.035890272850797, -0.00975430221212959,
			 -0.0228222875314633, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619489364314774, "debCollin1", 0.00666746196481787, -3.42293479166277
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.498033606632528, 0.730561585319418, 0.614297595975973, 0, "Total",
			 0, 0.0593194519187702, 10.3557530642254, 0.197618518902513,
			 0.431604187695484, 0.314611353298998, 0, "Total", 1.35950093849146e-07,
			 0.0596913184728446, 5.27063836665167, 0.499040750781364, 0.733024522767349,
			 0.616032636774356, 1, "Total", 0, 0.0596908345846197, 10.32038906913,
			 0.200083356771171, 0.432609431423591, 0.316346394097381, 0,
			 "Total", 9.66181394890242e-08, 0.0593189661867656, 5.33297214083882,
			 -0.00390771789882092, 0.00301980788103574, -0.000443955008892592,
			 0, "Total indirect", 0.801650871325537, 0.00176725843803766,
			 -0.251211141130865, -0.0113235355811748, 0.0139057071601547,
			 0.00129108578948996, 1, "Total indirect", 0.841012064680583,
			 0.00643614957732247, 0.200599096397488, 1, 1, 0, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-59")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-59")
})


context('Model number 60 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1196.87892001237, 1259.40300447609, 685.183438992842, 15, 1, 100,
			 2.67003943091957e-136, 0, 685.183438992842, 15))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 60))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544851995901985, 0.0642098230359, -0.240321086433042, "contcor1",
			 "<unicode>", 0.121933451168637, "contGamma", 0.155375768060558,
			 -1.54670892014112, -0.403937856150522, 0.194628742887389, -0.104654556631567,
			 "contcor2", "<unicode>", 0.493111804616933, "contGamma", 0.152698366847383,
			 -0.685367884360972, 0.424981297745599, 0.896769000479541, 0.66087514911257,
			 "contcor2", "<unicode>", 3.99680157858739e-08, "contcor1", 0.120356217373213,
			 5.4909930166986, 0.761632488097041, 1.34576159077697, 1.053697039437,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.149015264384311, 7.07106781168079, 0.00462621565096111, 0.00817426723145367,
			 0.00640024144120739, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905131831115047, 7.07105995081713, 0.323891234945345,
			 0.572296553317506, 0.448093894131426, "debCollin1:contcor1",
			 "<unicode>", 1.53721479989599e-12, "debCollin1:contcor1", 0.0633698681025646,
			 7.07108768801889, 1.68041560436403, 2.96920756886292, 2.32481158661347,
			 "contGamma", "<unicode>", 1.53788093371077e-12, "contGamma",
			 0.328779501731848, 7.07103567700393, 0.732636176546702, 1.29452947598411,
			 1.01358282626541, "contcor1", "<unicode>", 1.53765888910584e-12,
			 "contcor1", 0.14334276136438, 7.07104297850701, 0.721543037167061,
			 1.27492788758829, 0.998235462377674, "contcor2", "<unicode>",
			 1.53765888910584e-12, "contcor2", 0.141172198771573, 7.07104848591961
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211631749586, 0.117652944832751, "", "", -0.0182793434584174,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.792115917526911,
			 0.0693544827167155, -0.263563979463029, -0.0238489948296999,
			 0.042690011128108, 16, 16, 0.00942050814920407, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.578909411060837,
			 0.0169745481250317, 0.554978434760925, -0.0317977738496782,
			 0.0691942085520432, 16, 16, 0.0186982173511825, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.467987587885602,
			 0.0257637342314281, 0.725757267297586, -0.0593188757249132,
			 0.116966191282357, 50, 16, 0.0288236577787221, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.521567152563287,
			 0.0449715067209869, 0.640931556008349, -0.0355938529965648,
			 0.0557483540317564, 16, 50, 0.0100772505175958, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.665405166729763,
			 0.0233020116055236, 0.432462685548019, -0.0191478611646966,
			 0.0578577806038452, 84, 50, 0.0193549597195743, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.324499759428659,
			 0.0196446573447146, 0.985253108768614, -0.0373655268561928,
			 0.0963263271504205, 16, 50, 0.0294804001471138, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.387377203022615,
			 0.0341056914976902, 0.864383592665476, -0.0683987577539578,
			 0.0900928645091369, 16, 84, 0.0108470533775895, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.788486055576843,
			 0.040432279244225, 0.268277069221588, -0.0371278265762944, 0.0773773517354303,
			 16, 84, 0.020124762579568, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.490858705968165, 0.0292110414310995,
			 0.688943686825974, -0.0301314192193051, 0.0906318252335202,
			 50, 84, 0.0302502030071075, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.326144272531199, 0.0308075162108565,
			 0.98190983005788, -0.0111614244513869, 0.0125248739792022, 16,
			 16, 0.000681724763907671, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.91017246590017, 0.00604253410200993,
			 0.11282100396933, -0.0219510897982931, 0.0246573212684726, 84,
			 16, 0.00135311573508975, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909394994318069, 0.0118901192660699,
			 0.113801695745059, -0.0339624425693739, 0.0381341498664617,
			 16, 16, 0.00208585364854389, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909706375100171, 0.0183923258295878,
			 0.113408911296492, -0.0121077482669797, 0.0135662494690676,
			 16, 50, 0.000729250601043948, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.911344670318471, 0.00654960956899219,
			 0.111342606511453, -0.0225860567912174, 0.0253873399356695,
			 16, 50, 0.00140064157222602, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.908883412865122, 0.0122383362922214,
			 0.114447057082118, -0.0344755075064745, 0.0387422664778349,
			 50, 50, 0.00213337948568017, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909065998820149, 0.0186783467864313,
			 0.114216718967331, -0.0137463037930299, 0.0153162201469701,
			 16, 84, 0.000784958176970093, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.915681944904562, 0.00741404540319145,
			 0.105874476656455, -0.0236596181200882, 0.0265723164163925,
			 84, 84, 0.00145634914815217, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909516442949044, 0.0128145044839354,
			 0.113648494951786, -0.0353018660301682, 0.0396800401533808,
			 16, 84, 0.00218908706160632, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.908887587552485, 0.0191283887803543,
			 0.114441790510584, -0.0414441988100925, 0.023733105549237, 16,
			 16, -0.00885554663042771, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.594313979939113, 0.0166271688851019,
			 -0.532594977029574, -0.0684086175432594, 0.0332549011965974,
			 50, 16, -0.017576858173331, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.497945387747079, 0.0259350476696933,
			 -0.677726079288092, -0.114565091742009, 0.0603749691973923,
			 50, 16, -0.0270950612723083, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.543767186472933, 0.0446283866232507,
			 -0.607126166156142, -0.0535094758848847, 0.0345636694694184,
			 50, 50, -0.00947290320773317, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.673304903212539, 0.0224680519767233,
			 -0.421616578844798, -0.0589902066811679, 0.0226017771798949,
			 84, 50, -0.0181942147506365, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.382060739632611, 0.0208146640715467,
			 -0.874105615545709, -0.0967813869058223, 0.0413565512065948,
			 50, 50, -0.0277124178496137, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.431637392315989, 0.0352399174683901,
			 -0.786392813617441, -0.0854331111524754, 0.0650400314020803,
			 16, 84, -0.0101965398751975, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.790526630635854, 0.0383867111185381,
			 -0.265626816627, -0.0761853210101569, 0.0383496181739552, 50,
			 84, -0.0189178514181008, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.517335273522736, 0.0292186336298904,
			 -0.647458456056892, -0.0923677594699403, 0.0354956504357842,
			 50, 84, -0.0284360545170781, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.383334714823004, 0.0326188161910869,
			 -0.871768440353401))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.154211631749586, 0.117652944832751, -0.0182793434584174, "contGamma",
			 "<unicode>", 0.792115917526911, "contNormal", 0.0693544827167155,
			 -0.263563979463029, -2.65749885810042, 2.35038168993281, -0.153558584083808,
			 "debCollin1", "<unicode>", 0.904326086535687, "contNormal",
			 1.27754402313888, -0.120198272077168, -2.74314934936668, 0.527114550572635,
			 -1.10801739939702, "contcor1", "<unicode>", 0.184133871418521,
			 "contNormal", 0.834266324721969, -1.32813391427046, -0.533830979306674,
			 4.39043814180886, 1.92830358125109, "debCollin1:contcor1", "<unicode>",
			 0.124780932863176, "contNormal", 1.25621418555584, 1.53501178654329,
			 -0.0199697522081476, 0.000908101028150763, -0.00953082558999843,
			 "contGamma", "<unicode>", 0.0735402509761414, "debCollin1",
			 0.00532608083642869, -1.7894631874174, -0.033699682246683, 0.0420649566730663,
			 0.00418263721319164, "contcor1", "<unicode>", 0.828674230435827,
			 "debCollin1", 0.0193280691679467, 0.216402227084744, -0.0310212513067928,
			 0.0494314181318768, 0.00920508341254197, "contcor2", "<unicode>",
			 0.653790218637279, "debCollin1", 0.02052401729656, 0.44850300404321,
			 -0.0233911761177382, 0.0139846506593594, -0.00470326272918942,
			 "contGamma:contcor1", "<unicode>", 0.621820366567124, "debCollin1",
			 0.00953482489268, -0.493272061325444, -0.0182407680647829, 0.0175607075300377,
			 -0.000340030267372646, "contGamma:contcor2", "<unicode>", 0.970301502414459,
			 "debCollin1", 0.00913319731311853, -0.0372301457764677))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.1476835630429, 0.129965892424473, 16, 16, -0.00885883530921337,
			 "Total", 0.900467052920415, 0.0708302442436282, -0.125071364694755,
			 -0.142437277787783, 0.143275025573313, 16, 16, 0.000418873892765063,
			 "Total", 0.995414675159193, 0.0728871309918851, 0.00574688408042428,
			 -0.14848914736055, 0.169577776001159, 50, 16, 0.0105443143203046,
			 "Total", 0.896605597498017, 0.0811410122508834, 0.129950490236703,
			 -0.150432660009483, 0.134028474127839, 16, 50, -0.00820209294082161,
			 "Total", 0.910009637433495, 0.0725679493044554, -0.113026384504957,
			 -0.137916259300933, 0.140067491823246, 84, 50, 0.00107561626115683,
			 "Total", 0.987898493324121, 0.070915525314975, 0.0151675709427438,
			 -0.137018891325363, 0.159421004702756, 16, 50, 0.0112010566886964,
			 "Total", 0.882251638495312, 0.075623812061446, 0.148115472935896,
			 -0.163631125628083, 0.148766545466428, 16, 84, -0.00743229008082791,
			 "Total", 0.925697428622424, 0.0796947478521708, -0.0932594716858178,
			 -0.143373816358248, 0.147064654600549, 16, 84, 0.00184541912115053,
			 "Total", 0.980129256287532, 0.0740928081458994, 0.0249068589425931,
			 -0.133360515133456, 0.157302234230836, 50, 84, 0.0119708595486901,
			 "Total", 0.871746016583359, 0.07415002307619, 0.161441076510386,
			 -0.152033724216806, 0.116838486827787, 16, 16, -0.0175976186945098,
			 "Total", 0.797519768489827, 0.0685911101340185, -0.256558301216094,
			 -0.15086415931023, 0.117011703863574, 84, 16, -0.0169262277233277,
			 "Total", 0.804375942404872, 0.068336935088291, -0.247687838230659,
			 -0.150767695278607, 0.11838071565886, 16, 16, -0.0161934898098735,
			 "Total", 0.813552928813299, 0.0686615705850911, -0.235845024689688,
			 -0.151936163267443, 0.116835977552696, 16, 50, -0.0175500928573735,
			 "Total", 0.797981199148221, 0.0685655815464418, -0.255960679710508,
			 -0.150795341316363, 0.11703793754398, 16, 50, -0.0168787018861914,
			 "Total", 0.804883733280849, 0.0683260715434003, -0.247031645533289,
			 -0.1507303940521, 0.118438466106625, 50, 50, -0.0161459639727373,
			 "Total", 0.814103966064458, 0.0686667873190259, -0.235134984511845,
			 -0.151887345846506, 0.116898575283611, 16, 84, -0.0174943852814473,
			 "Total", 0.798618734146323, 0.0685690969962371, -0.255135127160963,
			 -0.150780447721373, 0.117134459100842, 84, 84, -0.0168229943102653,
			 "Total", 0.805572846416594, 0.0683468953857043, -0.246141309203988,
			 -0.150752102037623, 0.118571589244001, 16, 84, -0.0160902563968111,
			 "Total", 0.814838253920479, 0.068706285780253, -0.234189000527164,
			 -0.164032409149895, 0.109762628972204, 16, 16, -0.0271348900888452,
			 "Total", 0.697652965886576, 0.0698469564445468, -0.388490658292151,
			 -0.175413388087148, 0.103700984823651, 50, 16, -0.0358562016317485,
			 "Total", 0.614563319475261, 0.0712039545400881, -0.503570368574983,
			 -0.199273415897885, 0.108524606436434, 50, 16, -0.0453744047307257,
			 "Total", 0.563358131718943, 0.0785213465048824, -0.577860756984145,
			 -0.167618079458357, 0.112113586126056, 50, 50, -0.0277522466661506,
			 "Total", 0.697352335243389, 0.0713614300545574, -0.38889700843906,
			 -0.172491845448767, 0.0995447290306593, 84, 50, -0.0364735582090539,
			 "Total", 0.599188388647523, 0.0693983605375446, -0.525568009482323,
			 -0.190036000587743, 0.0980524779716807, 50, 50, -0.0459917613080312,
			 "Total", 0.531449270508438, 0.0734933092729838, -0.625795215414769,
			 -0.180852091266161, 0.123900324598931, 16, 84, -0.028475883333615,
			 "Total", 0.714159342880544, 0.0777443918023344, -0.366275723218918,
			 -0.178798608062759, 0.104404218309722, 50, 84, -0.0371971948765183,
			 "Total", 0.606649577535735, 0.0722469465271681, -0.514861826894379,
			 -0.188137528203397, 0.0947067322524057, 50, 84, -0.0467153979754955,
			 "Total", 0.517355662512396, 0.0721554739492261, -0.647426943773773,
			 -0.0238489948296999, 0.042690011128108, 50, 16, 0.00942050814920407,
			 "Total indirect", 0.578909411060837, 0.0169745481250317, 0.554978434760925,
			 -0.0317977738496782, 0.0691942085520432, 84, 16, 0.0186982173511825,
			 "Total indirect", 0.467987587885602, 0.0257637342314281, 0.725757267297586,
			 -0.0593188757249132, 0.116966191282357, 50, 16, 0.0288236577787221,
			 "Total indirect", 0.521567152563287, 0.0449715067209869, 0.640931556008349,
			 -0.0355938529965648, 0.0557483540317564, 16, 50, 0.0100772505175958,
			 "Total indirect", 0.665405166729763, 0.0233020116055236, 0.432462685548019,
			 -0.0191478611646966, 0.0578577806038452, 50, 50, 0.0193549597195743,
			 "Total indirect", 0.324499759428659, 0.0196446573447146, 0.985253108768614,
			 -0.0373655268561928, 0.0963263271504205, 50, 50, 0.0294804001471138,
			 "Total indirect", 0.387377203022615, 0.0341056914976902, 0.864383592665476,
			 -0.0683987577539578, 0.0900928645091369, 50, 84, 0.0108470533775895,
			 "Total indirect", 0.788486055576843, 0.040432279244225, 0.268277069221588,
			 -0.0371278265762944, 0.0773773517354303, 84, 84, 0.020124762579568,
			 "Total indirect", 0.490858705968165, 0.0292110414310995, 0.688943686825974,
			 -0.0301314192193051, 0.0906318252335202, 50, 84, 0.0302502030071075,
			 "Total indirect", 0.326144272531199, 0.0308075162108565, 0.98190983005788,
			 -0.0111614244513869, 0.0125248739792022, 16, 16, 0.000681724763907671,
			 "Total indirect", 0.91017246590017, 0.00604253410200993, 0.11282100396933,
			 -0.0219510897982931, 0.0246573212684726, 84, 16, 0.00135311573508975,
			 "Total indirect", 0.909394994318069, 0.0118901192660699, 0.113801695745059,
			 -0.0339624425693739, 0.0381341498664617, 50, 16, 0.00208585364854389,
			 "Total indirect", 0.909706375100171, 0.0183923258295878, 0.113408911296492,
			 -0.0121077482669797, 0.0135662494690676, 84, 50, 0.000729250601043948,
			 "Total indirect", 0.911344670318471, 0.00654960956899219, 0.111342606511453,
			 -0.0225860567912174, 0.0253873399356695, 84, 50, 0.00140064157222602,
			 "Total indirect", 0.908883412865122, 0.0122383362922214, 0.114447057082118,
			 -0.0344755075064745, 0.0387422664778349, 84, 50, 0.00213337948568017,
			 "Total indirect", 0.909065998820149, 0.0186783467864313, 0.114216718967331,
			 -0.0137463037930299, 0.0153162201469701, 16, 84, 0.000784958176970093,
			 "Total indirect", 0.915681944904562, 0.00741404540319145, 0.105874476656455,
			 -0.0236596181200882, 0.0265723164163925, 84, 84, 0.00145634914815217,
			 "Total indirect", 0.909516442949044, 0.0128145044839354, 0.113648494951786,
			 -0.0353018660301682, 0.0396800401533808, 50, 84, 0.00218908706160632,
			 "Total indirect", 0.908887587552485, 0.0191283887803543, 0.114441790510584,
			 -0.0414441988100925, 0.023733105549237, 84, 16, -0.00885554663042771,
			 "Total indirect", 0.594313979939113, 0.0166271688851019, -0.532594977029574,
			 -0.0684086175432594, 0.0332549011965974, 84, 16, -0.017576858173331,
			 "Total indirect", 0.497945387747079, 0.0259350476696933, -0.677726079288092,
			 -0.114565091742009, 0.0603749691973923, 84, 16, -0.0270950612723083,
			 "Total indirect", 0.543767186472933, 0.0446283866232507, -0.607126166156142,
			 -0.0535094758848847, 0.0345636694694184, 16, 50, -0.00947290320773317,
			 "Total indirect", 0.673304903212539, 0.0224680519767233, -0.421616578844798,
			 -0.0589902066811679, 0.0226017771798949, 84, 50, -0.0181942147506365,
			 "Total indirect", 0.382060739632611, 0.0208146640715467, -0.874105615545709,
			 -0.0967813869058223, 0.0413565512065948, 50, 50, -0.0277124178496137,
			 "Total indirect", 0.431637392315989, 0.0352399174683901, -0.786392813617441,
			 -0.0854331111524754, 0.0650400314020803, 84, 84, -0.0101965398751975,
			 "Total indirect", 0.790526630635854, 0.0383867111185381, -0.265626816627,
			 -0.0761853210101569, 0.0383496181739552, 84, 84, -0.0189178514181008,
			 "Total indirect", 0.517335273522736, 0.0292186336298904, -0.647458456056892,
			 -0.0923677594699403, 0.0354956504357842, 84, 84, -0.0284360545170781,
			 "Total indirect", 0.383334714823004, 0.0326188161910869, -0.871768440353401,
			 16, 16, 50, 16, 84, 16, 16, 16, 50, 16, 84, 16, 16, 16, 50,
			 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 50, 50, 50, 84, 50,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84, 16, 84, 50,
			 84, 84, 84, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-60")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-60")
})


context('Model number 60 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(749.460734617717, 811.984819081431, 604.620767838661, 15, 1, 100,
			 3.70244112649263e-119, 0, 604.620767838661, 15))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 60))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962203427762637, 0.0896222921123262, 0.0400001289173499,
			 "facExperimexperimental", "<unicode>", 0.114126277791503, "facGenderm",
			 0.0253178954237882, 1.57991524365673, -0.163250218459684, 0.0341996291936553,
			 -0.0645252946330142, "contcor2", "<unicode>", 0.200191438378019,
			 "facGenderm", 0.0503707846702282, -1.28100634237592, -0.170527219882804,
			 0.0272979638570461, -0.071614628012879, "contcor2", "<unicode>",
			 0.155883914352571, "facExperimexperimental", 0.0504665354313319,
			 -1.41905180137286, 0.762423372129943, 1.34715903822193, 1.05479120517594,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.149170002791966, 7.07106781144836, 0.00473838100122817, 0.00837245096858598,
			 0.00655541598490707, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000927075700375844, 7.0710687188214, 0.0796446814141744,
			 0.140727641403157, 0.110186161408666, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.0155826740875845, 7.07106885437952, 0.180704577035333, 0.319294382901646,
			 0.249999479968489, "facGenderm", "<unicode>", 1.53721479989599e-12,
			 "facGenderm", 0.0353551919727844, 7.07108252052297, 0.18070465036388,
			 0.319294638662751, 0.249999644513316, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353552385125573, 7.07107786656628, 0.721542711628705, 1.27492675209633,
			 0.998234731862516, "contcor2", "<unicode>", 1.53765888910584e-12,
			 "contcor2", 0.141171992146959, 7.07105366072444))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0581216478015624, 0.876434140287393, "", 0.467277894044478,
			 "", "facGenderm", "contNormal", "", "<unicode>", "", 0.0251961761153083,
			 0.208757022817913, 2.23838167328176, -0.035213856445851, 0.0329315731063315,
			 16, -0.00114114166975975, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.947662956807954, 0.0173843575927173,
			 -0.0656418658943026, -0.0442834373022462, 0.0473899500962695,
			 16, 0.00155325639701166, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.947045993899797, 0.0233864979462949,
			 0.0664168017194616, -0.0210850723668037, 0.0197387102658995,
			 50, -0.000673181050452081, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.948461183590295, 0.0104144216308861,
			 -0.064639312129982, -0.0572911985033542, 0.0613336325359929,
			 50, 0.00202121701631933, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.946748396922126, 0.0302619925608442,
			 0.066790612424331, -0.00758086141098623, 0.00733154265750495,
			 84, -0.000124659376740639, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.973859269477043, 0.00380425461542108,
			 -0.0327684104621479, -0.0728639823903763, 0.0780034597704378,
			 84, 0.00256973869003077, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.94676601264849, 0.0384872996011246,
			 0.0667684851019187, -0.0339863743496975, 0.0375626299370777,
			 16, 0.00178812779369013, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.9219597088596, 0.0182526324083362,
			 0.0979654744415642, -0.0498533252701412, 0.0449855318877328,
			 16, -0.00243389669120425, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.919868744338502, 0.0241940305806512,
			 -0.100599058230121, -0.0207715528981167, 0.0228812536975842,
			 50, 0.00105485039973373, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.924534616103148, 0.0111361246788279,
			 0.094723292900915, -0.0640777762972226, 0.0577434281269013,
			 50, -0.00316717408516065, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.918826188111745, 0.0310774089179786,
			 -0.101912424343987, -0.0106564733718472, 0.0110471468564829,
			 84, 0.000195336742317853, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.971856388867889, 0.00553673955223806,
			 0.0352801031139155, -0.081527062169359, 0.073473686684206, 84,
			 -0.00402668774257652, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.918888542059083, 0.0395417339492437,
			 -0.101833868685304))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0581216478015624, 0.876434140287393, 0.467277894044478, "facGenderm",
			 "<unicode>", 0.0251961761153083, "contNormal", 0.208757022817913,
			 2.23838167328176, -3.59074803553179, 3.35309577094772, -0.118826132292034,
			 "debCollin1", "<unicode>", 0.946518378356517, "contNormal",
			 1.77142127642438, -0.0670795444728342, -3.51918447847706, 3.1134099984643,
			 -0.202887240006382, "facExperimexperimental", "<unicode>", 0.9045557610016,
			 "contNormal", 1.69201947822981, -0.119908335936323, -4.66097028341132,
			 5.2710150657672, 0.305022391177944, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.904177874477649, "contNormal", 2.53371628956469,
			 0.12038537717668, -0.04026769679703, 0.0518451301928063, 0.00578871669788815,
			 "facGenderm", "<unicode>", 0.805416706370266, "debCollin1",
			 0.0234986019427935, 0.246343025511925, -0.0489093738188001,
			 0.0420353162410795, -0.00343702878886029, "facExperimexperimental",
			 "<unicode>", 0.882229167928732, "debCollin1", 0.0232006023521962,
			 -0.148143946294348, -0.0174098639678735, 0.0258808531641579,
			 0.00423549459814219, "contcor2", "<unicode>", 0.701334622353595,
			 "debCollin1", 0.0110437532203405, 0.38351948958269, -0.0882811934917062,
			 0.0429309323193658, -0.0226751305861702, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498143571469021, "debCollin1", 0.0334730961502498,
			 -0.67741360059401, -0.0370223577402549, 0.0287644500618207,
			 -0.0041289538392171, "facGenderm:contcor2", "<unicode>", 0.805662853516718,
			 "debCollin1", 0.0167826573143674, -0.246025034169193))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0562756147285358, 0.8759978900209, 16, 0.466136752374718, 0,
			 "Total", 0.0258089099485068, 0.20911666789753, 2.2290750759434,
			 0.0561518051132134, 0.881510495769765, 16, 0.468831150441489,
			 0, "Total", 0.0259707222606944, 0.210554555381343, 2.22664928617846,
			 0.0573600626425937, 0.875849363345458, 50, 0.466604712994026,
			 1, "Total", 0.0254387502778672, 0.208802127783725, 2.23467412878727,
			 0.0546178618104618, 0.883980360311132, 50, 0.469299111060797,
			 0, "Total", 0.0265472131716078, 0.211575953701848, 2.21811176010168,
			 0.0580069621296683, 0.876299507205806, 84, 0.467153234667737,
			 0, "Total", 0.0252315513790133, 0.208751934099485, 2.23783907288306,
			 0.0522193758242009, 0.887475889644816, 84, 0.469847632734509,
			 0, "Total", 0.0274517201045263, 0.213079556667626, 2.2050338384522,
			 0.0557392708475259, 0.88239277282881, 16, 0.469066021838168,
			 1, "Total", 0.0261299232412839, 0.210884870462371, 2.22427536318621,
			 0.0565175378228441, 0.873170456883703, 16, 0.464843997353274,
			 0, "Total", 0.0256647227448834, 0.208333654470825, 2.23124774791665,
			 0.0570496784765156, 0.879615810411907, 50, 0.468332744444212,
			 0, "Total", 0.0256259713868219, 0.209842154861949, 2.23183346907736,
			 0.0550750525686441, 0.87314638734999, 50, 0.464110719959317,
			 0, "Total", 0.0261574970163301, 0.208695501864878, 2.22386546816811,
			 0.0578862408578442, 0.877060220715747, 84, 0.467473230786796,
			 1, "Total", 0.0252887975900018, 0.208976794043014, 2.23696240019155,
			 0.052675079575534, 0.873827333028269, 84, 0.463251206301901,
			 0, "Total", 0.0270068635329872, 0.209481464947795, 2.2114185921764,
			 -0.035213856445851, 0.0329315731063315, 16, -0.00114114166975975,
			 0, "Total indirect", 0.947662956807954, 0.0173843575927173,
			 -0.0656418658943026, -0.0442834373022462, 0.0473899500962695,
			 16, 0.00155325639701166, 1, "Total indirect", 0.947045993899797,
			 0.0233864979462949, 0.0664168017194616, -0.0210850723668037,
			 0.0197387102658995, 50, -0.000673181050452081, 1, "Total indirect",
			 0.948461183590295, 0.0104144216308861, -0.064639312129982, -0.0572911985033542,
			 0.0613336325359929, 50, 0.00202121701631933, 1, "Total indirect",
			 0.946748396922126, 0.0302619925608442, 0.066790612424331, -0.00758086141098623,
			 0.00733154265750495, 84, -0.000124659376740639, 0, "Total indirect",
			 0.973859269477043, 0.00380425461542108, -0.0327684104621479,
			 -0.0728639823903763, 0.0780034597704378, 84, 0.00256973869003077,
			 1, "Total indirect", 0.94676601264849, 0.0384872996011246, 0.0667684851019187,
			 -0.0339863743496975, 0.0375626299370777, 16, 0.00178812779369013,
			 1, "Total indirect", 0.9219597088596, 0.0182526324083362, 0.0979654744415642,
			 -0.0498533252701412, 0.0449855318877328, 16, -0.00243389669120425,
			 1, "Total indirect", 0.919868744338502, 0.0241940305806512,
			 -0.100599058230121, -0.0207715528981167, 0.0228812536975842,
			 50, 0.00105485039973373, 0, "Total indirect", 0.924534616103148,
			 0.0111361246788279, 0.094723292900915, -0.0640777762972226,
			 0.0577434281269013, 50, -0.00316717408516065, 1, "Total indirect",
			 0.918826188111745, 0.0310774089179786, -0.101912424343987, -0.0106564733718472,
			 0.0110471468564829, 84, 0.000195336742317853, 1, "Total indirect",
			 0.971856388867889, 0.00553673955223806, 0.0352801031139155,
			 -0.081527062169359, 0.073473686684206, 84, -0.00402668774257652,
			 1, "Total indirect", 0.918888542059083, 0.0395417339492437,
			 -0.101833868685304, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1,
			 1, 1, 0, 1, 1, 1, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-60")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-60")
})


context('Model number 61 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1198.86123793409, 1263.99049258379, 685.165756914558, 14, 1, 100,
			 3.77623045642135e-137, 0, 685.165756914558, 14))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 61))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54484837455782, 0.0642088394389893, -0.240319767559416, "contcor1",
			 "<unicode>", 0.121932677751011, "contGamma", 0.155374593309106,
			 -1.54671212610236, -0.403935745659991, 0.194627086071833, -0.104654329794079,
			 "contcor2", "<unicode>", 0.493110020447135, "contGamma", 0.152697405782252,
			 -0.685370712475084, 0.424979221803632, 0.896762596398993, 0.660870909101313,
			 "contcor2", "<unicode>", 3.99645883053523e-08, "contcor1", 0.120355113235939,
			 5.49100816186987, 0.761497827603632, 1.34552365338646, 1.05351074049505,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148988917752967, 7.07106781084103, 0.0046262120711028, 0.00817425474509757,
			 0.00640023340810018, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905129559007534, 7.07106882590154, 0.323892044987266,
			 0.572299378832106, 0.448095711909686, "debCollin1:contcor1",
			 "<unicode>", 1.53765888910584e-12, "debCollin1:contcor1", 0.0633703822632062,
			 7.07105900116776, 1.68041240023067, 2.96919639298877, 2.32480439660972,
			 "contGamma", "<unicode>", 1.53765888910584e-12, "contGamma",
			 0.328777468087133, 7.07105754580968, 0.732634196446936, 1.29452256859526,
			 1.0135783825211, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341504379781, 7.07107398451489, 0.721541609039914,
			 1.27492290628056, 0.998232257660237, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.1411712923313, 7.07107118717589
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.197085191125139, 0.178065693327254, 16, "", -0.00950974889894261,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.920847067890568,
			 0.0957035148123983, -0.0993667674336098, -0.155657904929859,
			 0.117370119725866, 50, "", -0.0191438926019964, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.783428872426678, 0.0696512861484534,
			 -0.274853396980976, -0.245506330026042, 0.186189658054435, 84,
			 "", -0.0296583359858033, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.787693821476169, 0.110128551209522, -0.269306511890614,
			 -0.0236251807620886, 0.0420231941965786, 16, 16, 0.009199006717245,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.582812220107846, 0.0167473421645737, 0.549281589093223, -0.0319214568218151,
			 0.068439106368321, 16, 16, 0.018258824773253, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.475745900165032, 0.0256026549420723,
			 0.713161381683453, -0.0591125973869522, 0.115405526803384, 50,
			 16, 0.028146464708216, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.527249622784802, 0.0445207477195788,
			 0.632210062721792, -0.0350384882258657, 0.0547187219234999,
			 16, 50, 0.0098401168488171, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.667382466625406, 0.0228976682371103,
			 0.429743183756555, -0.0199131487831268, 0.057713018592777, 84,
			 50, 0.0188999349048251, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.339881406350997, 0.0198029576023358,
			 0.954399604561883, -0.0381172291356602, 0.0956923788152364,
			 16, 50, 0.0287875748397881, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.399045734621812, 0.0341357313211798,
			 0.843326734937317, -0.0669792095485143, 0.088162402204206, 16,
			 84, 0.0105915963278458, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.788995325132933, 0.039577669022609,
			 0.267615465726274, -0.0371458400101221, 0.0764486687778297,
			 16, 84, 0.0196514143838538, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.497687682261922, 0.0289787235081794,
			 0.678132505674623, -0.0313164463637094, 0.090394555001343, 50,
			 84, 0.0295390543188168, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.341421712844188, 0.0310492953761123,
			 0.951359892744702, -0.0111877854373643, 0.0127146080473707,
			 16, 16, 0.000763411305003203, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.900367281898269, 0.00609766140430999,
			 0.125197391981064, -0.0219542974957571, 0.0249848406133837,
			 84, 16, 0.0015152715588133, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.899303192557767, 0.0119744899598643,
			 0.126541636753811, -0.033997991849753, 0.0386696547835009, 16,
			 16, 0.00233583146687396, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.899730098649428, 0.0185380055976659,
			 0.126002306697332, -0.0121762343598141, 0.0138094664414598,
			 16, 50, 0.000816616040822856, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.901959765206636, 0.00662912711821385,
			 0.123186058475054, -0.0225556763895845, 0.0256926289788504,
			 16, 50, 0.00156847629463295, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.898599539402704, 0.0123084673363927,
			 0.127430674491486, -0.0344476885645752, 0.0392257609699625,
			 50, 50, 0.00238903620269361, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.898850998517815, 0.0187945926852903,
			 0.127112954385194, -0.0139855228497365, 0.0157434831650714,
			 16, 84, 0.000878980157667449, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.90773320576288, 0.00758406946487446,
			 0.115898220834927, -0.0236708443543807, 0.0269325251773358,
			 84, 84, 0.00163084041147755, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.899469876681815, 0.0129092600504064,
			 0.126331052679213, -0.0352548306422958, 0.0401576312813722,
			 16, 84, 0.0024514003195382, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.898605292736087, 0.0192382264466367,
			 0.127423404976437, -0.0405309588899465, 0.0236450209880658,
			 16, 16, -0.00844296895094036, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.606060936195835, 0.0163717242725438,
			 -0.515704321083615, -0.0677674811084861, 0.0342511036604209,
			 50, 16, -0.0167581887240326, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.519633124475107, 0.0260256274027525,
			 -0.643911036790617, -0.112761285638368, 0.0610948970999806,
			 50, 16, -0.0258331942691935, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.560256921413806, 0.0443518820013285,
			 -0.582459934133567, -0.0518830860745277, 0.033820309607055,
			 50, 50, -0.00903138823373633, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.679547722943431, 0.0218635128904409,
			 -0.413080380952185, -0.0595857663883465, 0.0248925503746893,
			 84, 50, -0.0173466080068286, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.420871535709786, 0.0215509870154222,
			 -0.804910141443409, -0.0968902762869279, 0.0440470491829489,
			 50, 50, -0.0264216135519895, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.462417764791741, 0.0359540600188505,
			 -0.734871487062568, -0.0820438526004528, 0.0626016406996275,
			 16, 84, -0.00972110595041267, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.792208126339286, 0.0369000385826029,
			 -0.263444330245113, -0.0752584936917402, 0.0391858422447304,
			 50, 84, -0.0180363257235049, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.536722236396197, 0.0291955201317965,
			 -0.617777167253196, -0.093277782697786, 0.0390551201604543,
			 50, 84, -0.0271113312686658, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.421926059295998, 0.0337590139160886,
			 -0.803084217330925))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.155573499429283, 0.117357712671261, -0.0191078933790109, "contGamma",
			 "<unicode>", 0.783751225981933, "contNormal", 0.0696265886142271,
			 -0.274433858663966, -2.68756690458543, 2.34581790799154, -0.170874498296948,
			 "debCollin1", "<unicode>", 0.894134374164505, "contNormal",
			 1.28405033262847, -0.133074610827104, -2.93402651672869, 0.846751501107416,
			 -1.04363750781064, "contcor1", "<unicode>", 0.279231133667432,
			 "contNormal", 0.96450191117245, -1.08204814912392, -0.790596325487687,
			 4.51341286720245, 1.86140827085738, "debCollin1:contcor1", "<unicode>",
			 0.168922655017273, "contNormal", 1.35308843288129, 1.37567377388163,
			 -0.155645489942924, 0.135865697093736, -0.00988989642459379,
			 "contGamma:contcor1", "<unicode>", 0.894202350291114, "contNormal",
			 0.074366465235092, -0.132988658171788, -0.0199697475500419,
			 0.00090809258408555, -0.0095308274829782, "contGamma", "<unicode>",
			 0.0735400130770332, "debCollin1", 0.00532607749397674, -1.78946466583647,
			 -0.0336994620719086, 0.0420651292982886, 0.00418283361318999,
			 "contcor1", "<unicode>", 0.828666204604481, "debCollin1", 0.0193280570377361,
			 0.216412524291678, -0.031021394452092, 0.0494312244944816, 0.00920491502119477,
			 "contcor2", "<unicode>", 0.653795935490706, "debCollin1", 0.0205240044156866,
			 0.448495080918975, -0.023391279724777, 0.0139845235953964, -0.00470337806469031,
			 "contGamma:contcor1", "<unicode>", 0.621811602039098, "debCollin1",
			 0.0095348189086608, -0.493284467145787, -0.0182406546983279,
			 0.0175607984274695, -0.000339928135429226, "contGamma:contcor2",
			 "<unicode>", 0.970310399951293, "debCollin1", 0.00913319158111953,
			 -0.0372189866390122))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.187676638175758, 0.187055153812363, 16, 16, -0.000310742181697613,
			 "Total", 0.997406435494114, 0.0955966015049149, -0.00325055678555306,
			 -0.14953158699372, 0.129641815224218, 16, 16, -0.00994488588475141,
			 "Total", 0.888945956248138, 0.0712190133135155, -0.139638074469983,
			 -0.24057376387642, 0.199655105339303, 16, 16, -0.0204593292685583,
			 "Total", 0.855444673798761, 0.112305346600293, -0.182175914931061,
			 -0.179421348736687, 0.196919500485308, 50, 16, 0.00874907587431035,
			 "Total", 0.927389705632038, 0.0960070828317569, 0.0911294835365663,
			 -0.14475824318735, 0.142988107529864, 16, 16, -0.000885067828743449,
			 "Total", 0.990380015858779, 0.0734060301584419, -0.0120571542533099,
			 -0.236481134425048, 0.213682111999948, 16, 16, -0.0113995112125503,
			 "Total", 0.920928205401233, 0.114839673069461, -0.0992645738868946,
			 -0.179508836524175, 0.216782268142722, 84, 16, 0.0186367158092734,
			 "Total", 0.853742220333182, 0.101096527230294, 0.184345756672924,
			 -0.150839134350398, 0.168844278562837, 16, 16, 0.00900257210621956,
			 "Total", 0.91210111983699, 0.0815533896119665, 0.110388693211332,
			 -0.239417282040078, 0.236393539484904, 16, 16, -0.00151187127758733,
			 "Total", 0.990062264800939, 0.12138254204621, -0.0124554260612845,
			 -0.189306325943632, 0.189967061843381, 16, 50, 0.000330367949874493,
			 "Total", 0.997275650372744, 0.0967551931511682, 0.00341447253749299,
			 -0.15215035555996, 0.133542804053601, 50, 50, -0.00930377575317931,
			 "Total", 0.898422085148285, 0.0728822472930811, -0.127654896751003,
			 -0.242172816427992, 0.202536378154019, 16, 50, -0.0198182191369862,
			 "Total", 0.861323681166839, 0.113448307746933, -0.174689420499725,
			 -0.175855430088323, 0.194635802100088, 50, 50, 0.00939018600588246,
			 "Total", 0.92085920433504, 0.0945148061675621, 0.0993514813883754,
			 -0.140500585770199, 0.140012670375856, 50, 50, -0.000243957697171341,
			 "Total", 0.997279940258247, 0.0715608190657348, -0.00340909593205249,
			 -0.233703848705092, 0.212187046543135, 16, 50, -0.0107584010809782,
			 "Total", 0.924648798949561, 0.113749767537913, -0.0945795434473516,
			 -0.170572650925091, 0.209128302806782, 84, 50, 0.0192778259408455,
			 "Total", 0.842247912981926, 0.0968642681005633, 0.199018960436799,
			 -0.140007633581574, 0.159294998057157, 50, 50, 0.00964368223779167,
			 "Total", 0.899492823587261, 0.0763541151775218, 0.126302062637623,
			 -0.232205224750706, 0.230463702458676, 16, 50, -0.000870761146015222,
			 "Total", 0.994113692882986, 0.11802995638156, -0.00737745884782231,
			 -0.198594845244906, 0.200758540102713, 16, 84, 0.00108184742890324,
			 "Total", 0.991527362355906, 0.101877735636386, 0.0106190761126109,
			 -0.164723914109855, 0.147619321561554, 84, 84, -0.00855229627415056,
			 "Total", 0.914525697400752, 0.0796808610094705, -0.107331875757895,
			 -0.250386081140334, 0.212252601824419, 16, 84, -0.0190667396579575,
			 "Total", 0.871658588358304, 0.118022240871258, -0.161552089819715,
			 -0.179439388734336, 0.199722719704158, 50, 84, 0.0101416654849112,
			 "Total", 0.916495983107615, 0.0967268050406222, 0.104848552380615,
			 -0.145686467437294, 0.146701511001008, 84, 84, 0.000507521781857399,
			 "Total", 0.994571123393833, 0.0745901406211086, 0.00680414030100075,
			 -0.236916761261182, 0.216902918057283, 16, 84, -0.0100069216019495,
			 "Total", 0.931119735434071, 0.115772453702756, -0.0864361191449056,
			 -0.167523108400861, 0.207581719240609, 84, 84, 0.0200293054198742,
			 "Total", 0.8342057400274, 0.0956917654100405, 0.209310647933481,
			 -0.136587638701674, 0.157377962135315, 84, 84, 0.0103951617168204,
			 "Total", 0.889753735145021, 0.0749926027099866, 0.138615827977339,
			 -0.229916373241563, 0.22967780990759, 16, 84, -0.000119281666986479,
			 "Total", 0.999188259434549, 0.117245568483496, -0.00101736610201408,
			 -0.196080169686378, 0.178587494498499, 16, 16, -0.00874633759393941,
			 "Total", 0.927089109414987, 0.0955802420708259, -0.0915077991480529,
			 -0.153301195716126, 0.11654023312214, 16, 16, -0.0183804812969932,
			 "Total", 0.789462024301856, 0.0688383641145297, -0.267009269226862,
			 -0.242868628095099, 0.185078778733498, 16, 16, -0.0288949246808001,
			 "Total", 0.791261559888454, 0.10917226290998, -0.264672764955197,
			 -0.19580308460962, 0.179814129929361, 50, 16, -0.00799447734012931,
			 "Total", 0.933509569243418, 0.0958224787551713, -0.0834300828363602,
			 -0.151960248534244, 0.116703006447877, 16, 16, -0.0176286210431831,
			 "Total", 0.797016524351254, 0.0685378040365289, -0.257210181898847,
			 -0.240883855431431, 0.184597726577451, 16, 16, -0.02814306442699,
			 "Total", 0.795419353198433, 0.108543214407261, -0.259279813857322,
			 -0.196357724462477, 0.18200988959834, 84, 16, -0.00717391743206866,
			 "Total", 0.94075374764624, 0.0965241241791513, -0.0743225332845671,
			 -0.151700379158601, 0.118084256888356, 16, 16, -0.0168080611351225,
			 "Total", 0.807061629106441, 0.0688238758913387, -0.244218462233361,
			 -0.239474639594617, 0.184829630556758, 16, 16, -0.0273225045189293,
			 "Total", 0.80071759801194, 0.108242874230913, -0.252418505264769,
			 -0.196052894701333, 0.178666628985093, 16, 50, -0.00869313285811976,
			 "Total", 0.927541409092891, 0.0955934717786055, -0.0909385619789294,
			 -0.153195683157287, 0.11654113003494, 50, 50, -0.0183272765611736,
			 "Total", 0.789977651875929, 0.0688116759593227, -0.266339633582061,
			 -0.242721659779222, 0.185038219889261, 16, 50, -0.0288417199449804,
			 "Total", 0.791547808337047, 0.109124423469666, -0.264301235488294,
			 -0.19578950839368, 0.17990696318506, 50, 50, -0.00794127260430966,
			 "Total", 0.933964961744396, 0.0958426977592919, -0.0828573567936714,
			 -0.151873759841333, 0.116722927226606, 50, 50, -0.0175754163073635,
			 "Total", 0.797566747363891, 0.0685208221137212, -0.256497452383077,
			 -0.240748501841047, 0.184568782458707, 16, 50, -0.0280898596911703,
			 "Total", 0.795720413546516, 0.108501300956192, -0.25888961186292,
			 -0.196358771951895, 0.182117346559397, 84, 50, -0.007120712696249,
			 "Total", 0.941209171725694, 0.0965518043945355, -0.0737501773364269,
			 -0.151634950916506, 0.1181252381179, 50, 50, -0.0167548563993028,
			 "Total", 0.80764328369059, 0.0688176392939462, -0.2434674680969,
			 -0.239352363332886, 0.184813763766667, 16, 50, -0.0272692997831097,
			 "Total", 0.80103409015993, 0.108207633008903, -0.252009022144179,
			 -0.196078766380974, 0.178817228898423, 16, 84, -0.00863076874127516,
			 "Total", 0.92809357947645, 0.095638490869355, -0.0902436734710196,
			 -0.153152379349475, 0.116622554460817, 84, 84, -0.018264912444329,
			 "Total", 0.790704551994968, 0.0688214007854845, -0.265395825075698,
			 -0.242600048075639, 0.185041336419368, 16, 84, -0.0287793558281359,
			 "Total", 0.791931863889895, 0.109094194553621, -0.263802816876661,
			 -0.195831275781685, 0.180073458806755, 50, 84, -0.00787890848746507,
			 "Total", 0.934518591173054, 0.0958958270543562, -0.0821611193050048,
			 -0.151853098071917, 0.116826993690879, 84, 84, -0.0175130521905189,
			 "Total", 0.798330793631677, 0.0685420992125646, -0.255507963597773,
			 -0.240640804357826, 0.184585813209174, 16, 84, -0.0280274955743258,
			 "Total", 0.796121435117199, 0.108478171262618, -0.258369912104004,
			 -0.196417242760993, 0.182300545602184, 84, 84, -0.00705834857940441,
			 "Total", 0.941760270578752, 0.0966134559998181, -0.0730576140389564,
			 -0.151638621537528, 0.118253636972611, 84, 84, -0.0166924922824582,
			 "Total", 0.808437267480608, 0.0688513311058301, -0.242442549974822,
			 -0.239260140989847, 0.184846269657317, 16, 84, -0.0272069356662651,
			 "Total", 0.801452231940492, 0.108192398940098, -0.251468087710381,
			 -0.210274462506468, 0.174369026806703, 16, 16, -0.017952717849883,
			 "Total", 0.854831468522181, 0.0981251421830171, -0.182957369033908,
			 -0.164380565274603, 0.10920684216873, 16, 16, -0.0275868615529368,
			 "Total", 0.692650068251728, 0.0697939884613584, -0.395261284834156,
			 -0.249719741790387, 0.1735171319169, 16, 16, -0.0381013049367437,
			 "Total", 0.724173900746096, 0.107970574216089, -0.35288600818672,
			 -0.224565004942099, 0.172029129696149, 50, 16, -0.0262679376229752,
			 "Total", 0.79514785434528, 0.101173832214911, -0.259631735280893,
			 -0.174992165731245, 0.103188003079187, 16, 16, -0.035902081326029,
			 "Total", 0.612921236241434, 0.0709656327883272, -0.505907999624494,
			 -0.25512678936733, 0.162293739947658, 16, 16, -0.0464165247098359,
			 "Total", 0.662916542749, 0.10648678562656, -0.435889997399441,
			 -0.247728539056782, 0.17704265272051, 84, 16, -0.0353429431681361,
			 "Total", 0.744306118314259, 0.108361989079348, -0.326156279230498,
			 -0.197541970014471, 0.107587796272091, 16, 16, -0.0449770868711899,
			 "Total", 0.563392601085818, 0.0778406564338392, -0.577809706800434,
			 -0.268715504270779, 0.157732443760785, 16, 16, -0.0554915302549968,
			 "Total", 0.60999503485007, 0.108789740881805, -0.510080544408006,
			 -0.213087244748239, 0.176004970482881, 16, 50, -0.0185411371326789,
			 "Total", 0.851822492446756, 0.0992600420977705, -0.186793565072399,
			 -0.167648270048584, 0.111297708377118, 50, 50, -0.0281752808357327,
			 "Total", 0.692151405528456, 0.0711609959739037, -0.395937134523317,
			 -0.251741894878621, 0.174362446439541, 16, 50, -0.0386897242195396,
			 "Total", 0.721897182131853, 0.108702084497271, -0.355924400148103,
			 -0.223217837623556, 0.169505123812013, 50, 50, -0.0268563569057712,
			 "Total", 0.788649866410809, 0.100186269883865, -0.268064246097823,
			 -0.172364775597252, 0.099383774379602, 50, 50, -0.036490500608825,
			 "Total", 0.598631539740325, 0.0693248835489764, -0.526369446881873,
			 -0.253267904461233, 0.159258016475969, 16, 50, -0.0470049439926319,
			 "Total", 0.65512552654705, 0.105238138096198, -0.44665313205812,
			 -0.242258496659299, 0.170395771757435, 84, 50, -0.0359313624509321,
			 "Total", 0.732860508303364, 0.105270880401808, -0.341322902532836,
			 -0.189158512110579, 0.0980274998026073, 50, 50, -0.0455655061539859,
			 "Total", 0.533978954798996, 0.0732630839593159, -0.621943599579962,
			 -0.262661744840041, 0.150501845764455, 16, 50, -0.0560799495377928,
			 "Total", 0.594681854236031, 0.105400811918861, -0.53206373382554,
			 -0.222468856497135, 0.184007146798425, 16, 84, -0.0192308548493553,
			 "Total", 0.85287109495269, 0.103694763399172, -0.185456374256106,
			 -0.179759525959579, 0.122029528854761, 84, 84, -0.0288649985524091,
			 "Total", 0.70771512741255, 0.0769884184594244, -0.374926503622385,
			 -0.259728548989302, 0.18096966511687, 16, 84, -0.039379441936216,
			 "Total", 0.726134012998985, 0.112425079639816, -0.350272751083465,
			 -0.227823998433679, 0.172731849188784, 50, 84, -0.0275460746224475,
			 "Total", 0.787489568069296, 0.102184491853421, -0.269571968532771,
			 -0.178156034039171, 0.103795597388168, 84, 84, -0.0371802183255013,
			 "Total", 0.605218590657579, 0.0719277582780442, -0.516910567152355,
			 -0.25698591510719, 0.161596591688574, 16, 84, -0.0476946617093082,
			 "Total", 0.655128199351459, 0.106783213900227, -0.446649430816642,
			 -0.241672875643678, 0.168430715308461, 84, 84, -0.0366210801676084,
			 "Total", 0.726309894763097, 0.104620185418452, -0.35003837950711,
			 -0.1875111980205, 0.0950007502791755, 84, 84, -0.0462552238706622,
			 "Total", 0.521000803151485, 0.0720706988822483, -0.641803459492403,
			 -0.261358022003097, 0.147818687494159, 16, 84, -0.0567696672544691,
			 "Total", 0.586540909083515, 0.104383731722825, -0.543855506193363,
			 -0.0236251807620886, 0.0420231941965786, 16, 16, 0.009199006717245,
			 "Total indirect", 0.582812220107846, 0.0167473421645737, 0.549281589093223,
			 -0.0319214568218151, 0.068439106368321, 16, 16, 0.018258824773253,
			 "Total indirect", 0.475745900165032, 0.0256026549420723, 0.713161381683453,
			 -0.0591125973869522, 0.115405526803384, 50, 16, 0.028146464708216,
			 "Total indirect", 0.527249622784802, 0.0445207477195788, 0.632210062721792,
			 -0.0350384882258657, 0.0547187219234999, 50, 50, 0.0098401168488171,
			 "Total indirect", 0.667382466625406, 0.0228976682371103, 0.429743183756555,
			 -0.0199131487831268, 0.057713018592777, 16, 50, 0.0188999349048251,
			 "Total indirect", 0.339881406350997, 0.0198029576023358, 0.954399604561883,
			 -0.0381172291356602, 0.0956923788152364, 50, 50, 0.0287875748397881,
			 "Total indirect", 0.399045734621812, 0.0341357313211798, 0.843326734937317,
			 -0.0669792095485143, 0.088162402204206, 84, 84, 0.0105915963278458,
			 "Total indirect", 0.788995325132933, 0.039577669022609, 0.267615465726274,
			 -0.0371458400101221, 0.0764486687778297, 16, 84, 0.0196514143838538,
			 "Total indirect", 0.497687682261922, 0.0289787235081794, 0.678132505674623,
			 -0.0313164463637094, 0.090394555001343, 50, 84, 0.0295390543188168,
			 "Total indirect", 0.341421712844188, 0.0310492953761123, 0.951359892744702,
			 -0.0111877854373643, 0.0127146080473707, 16, 16, 0.000763411305003203,
			 "Total indirect", 0.900367281898269, 0.00609766140430999, 0.125197391981064,
			 -0.0219542974957571, 0.0249848406133837, 50, 16, 0.0015152715588133,
			 "Total indirect", 0.899303192557767, 0.0119744899598643, 0.126541636753811,
			 -0.033997991849753, 0.0386696547835009, 50, 16, 0.00233583146687396,
			 "Total indirect", 0.899730098649428, 0.0185380055976659, 0.126002306697332,
			 -0.0121762343598141, 0.0138094664414598, 50, 50, 0.000816616040822856,
			 "Total indirect", 0.901959765206636, 0.00662912711821385, 0.123186058475054,
			 -0.0225556763895845, 0.0256926289788504, 50, 50, 0.00156847629463295,
			 "Total indirect", 0.898599539402704, 0.0123084673363927, 0.127430674491486,
			 -0.0344476885645752, 0.0392257609699625, 50, 50, 0.00238903620269361,
			 "Total indirect", 0.898850998517815, 0.0187945926852903, 0.127112954385194,
			 -0.0139855228497365, 0.0157434831650714, 84, 84, 0.000878980157667449,
			 "Total indirect", 0.90773320576288, 0.00758406946487446, 0.115898220834927,
			 -0.0236708443543807, 0.0269325251773358, 50, 84, 0.00163084041147755,
			 "Total indirect", 0.899469876681815, 0.0129092600504064, 0.126331052679213,
			 -0.0352548306422958, 0.0401576312813722, 50, 84, 0.0024514003195382,
			 "Total indirect", 0.898605292736087, 0.0192382264466367, 0.127423404976437,
			 -0.0405309588899465, 0.0236450209880658, 16, 16, -0.00844296895094036,
			 "Total indirect", 0.606060936195835, 0.0163717242725438, -0.515704321083615,
			 -0.0677674811084861, 0.0342511036604209, 84, 16, -0.0167581887240326,
			 "Total indirect", 0.519633124475107, 0.0260256274027525, -0.643911036790617,
			 -0.112761285638368, 0.0610948970999806, 50, 16, -0.0258331942691935,
			 "Total indirect", 0.560256921413806, 0.0443518820013285, -0.582459934133567,
			 -0.0518830860745277, 0.033820309607055, 50, 50, -0.00903138823373633,
			 "Total indirect", 0.679547722943431, 0.0218635128904409, -0.413080380952185,
			 -0.0595857663883465, 0.0248925503746893, 84, 50, -0.0173466080068286,
			 "Total indirect", 0.420871535709786, 0.0215509870154222, -0.804910141443409,
			 -0.0968902762869279, 0.0440470491829489, 50, 50, -0.0264216135519895,
			 "Total indirect", 0.462417764791741, 0.0359540600188505, -0.734871487062568,
			 -0.0820438526004528, 0.0626016406996275, 84, 84, -0.00972110595041267,
			 "Total indirect", 0.792208126339286, 0.0369000385826029, -0.263444330245113,
			 -0.0752584936917402, 0.0391858422447304, 84, 84, -0.0180363257235049,
			 "Total indirect", 0.536722236396197, 0.0291955201317965, -0.617777167253196,
			 -0.093277782697786, 0.0390551201604543, 50, 84, -0.0271113312686658,
			 "Total indirect", 0.421926059295998, 0.0337590139160886, -0.803084217330925,
			 16, 16, 50, 50, 16, 50, 84, 16, 50, 16, 50, 50, 50, 50, 50,
			 84, 50, 50, 16, 84, 50, 50, 84, 50, 84, 84, 50, 16, 16, 50,
			 50, 16, 50, 84, 16, 50, 16, 50, 50, 50, 50, 50, 84, 50, 50,
			 16, 84, 50, 50, 84, 50, 84, 84, 50, 16, 16, 84, 50, 16, 84,
			 84, 16, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 84, 84,
			 50, 84, 84, 84, 84, 84, 16, 16, 84, 50, 16, 84, 84, 16, 84,
			 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 84, 84, 50, 84, 84,
			 84, 84, 84, 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 50, 84,
			 50, 50, 84, 84, 50, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84,
			 16, 16, 50, 16, 84, 16, 16, 16, 50, 16, 84, 16, 16, 16, 50,
			 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 50, 50, 50, 84, 50,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84, 16, 84, 50,
			 84, 84, 84, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-61")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-61")
})


context('Model number 61 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(750.952947729692, 816.082202379395, 604.112980950637, 14, 1, 100,
			 7.08620251363295e-120, 0, 604.112980950637, 14))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 61))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962233686174235, 0.0896223245278142, 0.0399999938330359,
			 "facExperimexperimental", "<unicode>", 0.114128721328424, "facGenderm",
			 0.0253179808844412, 1.57990457515581, -0.16325081500652, 0.034199126672323,
			 -0.0645258441670985, "contcor2", "<unicode>", 0.200187820694547,
			 "facGenderm", 0.0503708086567669, -1.28101664213465, -0.17052727828197,
			 0.0272978411413079, -0.0716147185703312, "contcor2", "<unicode>",
			 0.155883256751774, "facExperimexperimental", 0.0504665190237416,
			 -1.41905405713916, 0.758561699060153, 1.34033568000907, 1.04944868953461,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148414456984383, 7.07106781143995, 0.00473838092148437, 0.00837245069044425,
			 0.00655541580596431, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.0009270756497632, 7.07106891183987, 0.0796446913032079,
			 0.140727675895545, 0.110186183599376, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.0155826803640658, 7.07106743031639, 0.180704812029705, 0.319295202546368,
			 0.250000007288036, "facGenderm", "<unicode>", 1.53743684450092e-12,
			 "facGenderm", 0.0353553411210222, 7.07106760566333, 0.180704820323034,
			 0.319295231472934, 0.250000025897984, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553463846997, 7.07106707929676, 0.721541862269596, 1.27492378957129,
			 0.998232825920443, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171453064113, 7.07106716162437))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.039451515193305, 1.19060350284373, "", 0.615027509018516, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.0362328060104595,
			 0.293666617532404, 2.09430514842448, -0.26088818322735, 0.896654610462212,
			 "", 0.317883213617431, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.281709693078357, 0.295296955153286, 1.07648659449407,
			 -0.0357578087592235, 0.0329604312205971, 16, -0.00139868876931321,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.936407392864973, 0.0175304853869411, -0.0797860834107381,
			 -0.0440556914258018, 0.0478633477129899, 16, 0.00190382814359403,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.935291177404838, 0.0234491653580978, 0.0811895909521819, -0.0215578415928726,
			 0.0199075419979931, 50, -0.000825149797439736, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.937823681988134,
			 0.0105780983523012, -0.0780054949347516, -0.0568268672647865,
			 0.0617816014957215, 50, 0.0024773671154675, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.934745898461055,
			 0.0302578184334193, 0.0818752720365091, -0.00891700174036319,
			 0.0086112535620376, 84, -0.000152874089162796, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.972727261693517,
			 0.0044715758658479, -0.0341879672288212, -0.0722853623625417,
			 0.0785846480100305, 84, 0.00314964282374444, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.934778315063181,
			 0.0384879547692242, 0.0818345075135809, -0.0336092870428869,
			 0.0352665787905621, 16, 0.000828645873837623, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.962385171590472,
			 0.0175706968027813, 0.0471606722908367, -0.0477216636196525,
			 0.045465837491214, 16, -0.00112791306421926, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.962158077271308,
			 0.0237727585419726, -0.0474456114223281, -0.0199908619274569,
			 0.0209685733239417, 50, 0.000488855698242382, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.962684740924537,
			 0.0104490275266488, 0.0467848033700382, -0.0619251627852401,
			 0.0589897563056111, 50, -0.00146770323981451, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.962049922796412,
			 0.030846209431554, -0.0475813160469929, -0.00592418676130264,
			 0.00610532567652198, 84, 9.05694576096709e-05, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.976455533867074,
			 0.00306880956301031, 0.0295128960432552, -0.0787425422831416,
			 0.0750105633222472, 84, -0.00186598948044722, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.962056302445695,
			 0.0392234517619134, -0.0475733112876904))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.039451515193305, 1.19060350284373, 0.615027509018516, "facGenderm",
			 "<unicode>", 0.0362328060104595, "contNormal", 0.293666617532404,
			 2.09430514842448, -3.60954587891361, 3.31825726978156, -0.145644304566028,
			 "debCollin1", "<unicode>", 0.934321266703702, "contNormal",
			 1.76732919669463, -0.0824092675198379, -3.35825808634823, 3.34465481744866,
			 -0.00680163444978706, "facExperimexperimental", "<unicode>",
			 0.996826293846189, "contNormal", 1.70995818205554, -0.00397766127918451,
			 -4.72553742541013, 5.18939845333103, 0.231930513960453, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.926940300909434, "contNormal", 2.52936685493941,
			 0.0916950870560881, -1.11339429041676, 0.519105699614592, -0.297144295401085,
			 "facGenderm:facExperimexperimental", "<unicode>", 0.475538121460147,
			 "contNormal", 0.41646173167168, -0.713497238289688, -0.0402674514192686,
			 0.0518453743125625, 0.00578896144664696, "facGenderm", "<unicode>",
			 0.805408641810043, "debCollin1", 0.0234986016218679, 0.246353444336863,
			 -0.0489096977120597, 0.0420349911061252, -0.00343735330296726,
			 "facExperimexperimental", "<unicode>", 0.882218127877598, "debCollin1",
			 0.0232006020354315, -0.148157935631058, -0.0174100375836236,
			 0.0258806789573984, 0.00423532068688744, "contcor2", "<unicode>",
			 0.701346292286853, "debCollin1", 0.0110437530695701, 0.383503747340877,
			 -0.0882812838301087, 0.0429308401893821, -0.0226752218203633,
			 "facGenderm:facExperimexperimental", "<unicode>", 0.498141836761741,
			 "debCollin1", 0.0334730956932054, -0.677416335441184, -0.0370220918721347,
			 0.0287647150316491, -0.00412868842024284, "facGenderm:contcor2",
			 "<unicode>", 0.805675093373435, "debCollin1", 0.0167826570852071,
			 -0.246009222453936))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0380305949113626, 1.18922704558704, 16, 0.613628820249203, 0,
			 "Total", 0.0366661913533572, 0.293677960349315, 2.08946159772876,
			 -0.263305850124423, 0.896274899820658, 16, 0.316484524848118,
			 0, "Total", 0.284679426398795, 0.295816851506381, 1.06986645025965,
			 0.0381636169606637, 1.19569905736356, 16, 0.61693133716211,
			 0, "Total", 0.0366894621444627, 0.295295079280381, 2.08920290397504,
			 -0.260806281721935, 0.900380365243985, 16, 0.319787041761025,
			 1, "Total", 0.280349091886863, 0.296226526641615, 1.07953546694997,
			 0.0388448982386672, 1.18955982020348, 50, 0.614202359221076,
			 0, "Total", 0.0364126063806127, 0.293555119135227, 2.09228972409145,
			 -0.262084556181163, 0.896200683821145, 50, 0.317058063819991,
			 0, "Total", 0.283269291790078, 0.29548635820319, 1.07300406606916,
			 0.0371167437286007, 1.19789300853937, 50, 0.617504876133983,
			 0, "Total", 0.0370414608308474, 0.296121835392594, 2.08530679716781,
			 -0.26144120858866, 0.902162370054456, 50, 0.320360580732898,
			 1, "Total", 0.280487311736342, 0.296843102174701, 1.07922528226496,
			 0.0393415776971209, 1.19040769216159, 84, 0.614874634929353,
			 0, "Total", 0.0362652558461858, 0.293644710704872, 2.09394078120254,
			 -0.261107409531042, 0.896568088587577, 84, 0.317730339528268,
			 1, "Total", 0.281996332554478, 0.295330808946036, 1.07584555997449,
			 0.0354431141684787, 1.20091118951604, 84, 0.61817715184226,
			 1, "Total", 0.037601440319124, 0.297318747829202, 2.07917313104446,
			 -0.26263380344239, 0.904699516324741, 84, 0.321032856441175,
			 0, "Total", 0.281018329079269, 0.29779458423086, 1.07803456960218,
			 0.0392508341639748, 1.19246147562073, 16, 0.615856154892353,
			 0, "Total", 0.0363149621659762, 0.294191793969975, 2.09338318578392,
			 -0.264781968516006, 0.902205687498543, 16, 0.318711859491268,
			 0, "Total", 0.284368386009918, 0.297706403081791, 1.0705576238604,
			 0.0364407642985112, 1.19135842761008, 16, 0.613899595954297,
			 0, "Total", 0.0371921724550432, 0.29462726673077, 2.0836482745342,
			 -0.258823204327663, 0.892333805434086, 16, 0.316755300553211,
			 1, "Total", 0.28075832864475, 0.293667898706795, 1.07861738360946,
			 0.0395761390837265, 1.19145659034979, 50, 0.615516364716758,
			 0, "Total", 0.0362026246955229, 0.293852453502194, 2.09464429301477,
			 -0.262948955061573, 0.899693093692919, 50, 0.318372069315673,
			 0, "Total", 0.283085665436801, 0.296597809430496, 1.07341342111389,
			 0.0348173508986146, 1.19230226065879, 50, 0.613559805778701,
			 0, "Total", 0.0377207712848677, 0.29528218857343, 2.07787611146794,
			 -0.25891950555201, 0.891750526307242, 50, 0.316415510377616,
			 1, "Total", 0.281071100559988, 0.293543667367256, 1.07791632234991,
			 0.0395106584753183, 1.19072549847693, 84, 0.615118078476125,
			 0, "Total", 0.0362155343583632, 0.293682651590093, 2.09449919886543,
			 -0.261234978331917, 0.897182544481998, 84, 0.31797378307504,
			 1, "Total", 0.281936108652488, 0.295520104438491, 1.07598020675857,
			 0.0324742293067588, 1.19384880976938, 84, 0.613161519538069,
			 1, "Total", 0.0384923877716574, 0.296274469741126, 2.0695725827265,
			 -0.259480106838677, 0.891514555112644, 84, 0.316017224136984,
			 0, "Total", 0.281812841276805, 0.293626482688004, 1.07625586508412,
			 -0.0357578087592235, 0.0329604312205971, 16, -0.00139868876931321,
			 0, "Total indirect", 0.936407392864973, 0.0175304853869411,
			 -0.0797860834107381, -0.0440556914258018, 0.0478633477129899,
			 16, 0.00190382814359403, 0, "Total indirect", 0.935291177404838,
			 0.0234491653580978, 0.0811895909521819, -0.0215578415928726,
			 0.0199075419979931, 50, -0.000825149797439736, 0, "Total indirect",
			 0.937823681988134, 0.0105780983523012, -0.0780054949347516,
			 -0.0568268672647865, 0.0617816014957215, 50, 0.0024773671154675,
			 1, "Total indirect", 0.934745898461055, 0.0302578184334193,
			 0.0818752720365091, -0.00891700174036319, 0.0086112535620376,
			 84, -0.000152874089162796, 0, "Total indirect", 0.972727261693517,
			 0.0044715758658479, -0.0341879672288212, -0.0722853623625417,
			 0.0785846480100305, 84, 0.00314964282374444, 0, "Total indirect",
			 0.934778315063181, 0.0384879547692242, 0.0818345075135809, -0.0336092870428869,
			 0.0352665787905621, 16, 0.000828645873837623, 0, "Total indirect",
			 0.962385171590472, 0.0175706968027813, 0.0471606722908367, -0.0477216636196525,
			 0.045465837491214, 16, -0.00112791306421926, 1, "Total indirect",
			 0.962158077271308, 0.0237727585419726, -0.0474456114223281,
			 -0.0199908619274569, 0.0209685733239417, 50, 0.000488855698242382,
			 0, "Total indirect", 0.962684740924537, 0.0104490275266488,
			 0.0467848033700382, -0.0619251627852401, 0.0589897563056111,
			 50, -0.00146770323981451, 1, "Total indirect", 0.962049922796412,
			 0.030846209431554, -0.0475813160469929, -0.00592418676130264,
			 0.00610532567652198, 84, 9.05694576096709e-05, 1, "Total indirect",
			 0.976455533867074, 0.00306880956301031, 0.0295128960432552,
			 -0.0787425422831416, 0.0750105633222472, 84, -0.00186598948044722,
			 0, "Total indirect", 0.962056302445695, 0.0392234517619134,
			 -0.0475733112876904, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0,
			 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1,
			 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0,
			 1, 1, 1, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-61")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-61")
})


context('Model number 62 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1199.76473288154, 1267.49915771723, 684.069251862016, 13, 1, 100,
			 8.73845482141693e-138, 0, 684.069251862016, 13))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 62))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544847541061981, 0.0642078754678011, -0.24031983279709, "contcor1",
			 "<unicode>", 0.1219314752584, "contGamma", 0.155374134763172,
			 -1.54671711069152, -0.403937388929438, 0.194624751674823, -0.104656318627308,
			 "contcor2", "<unicode>", 0.493101304380883, "contGamma", 0.15269722947096,
			 -0.685384528520283, 0.424979507977239, 0.896762422750444, 0.660870965363842,
			 "contcor2", "<unicode>", 3.99632713588005e-08, "contcor1", 0.120354995932213,
			 5.4910139811401, 0.75319357426255, 1.33085050284894, 1.04202203855574,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147364169225269, 7.07106784528367, 0.00462620945789982, 0.00817424563040821,
			 0.00640022754415401, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905127900434613, 7.07107530447446, 0.323893460271827,
			 0.572304315174324, 0.448098887723076, "debCollin1:contcor1",
			 "<unicode>", 1.53810297831569e-12, "debCollin1:contcor1", 0.063371280508706,
			 7.07100888803274, 1.6804108943944, 2.96919114071939, 2.3248010175569,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776512346839, 7.07106782343494, 0.732633481122365, 1.29452007422585,
			 1.01357677767411, "contcor1", "<unicode>", 1.53721479989599e-12,
			 "contcor1", 0.143341050533472, 7.07108517693906, 0.721541659739198,
			 1.2749230831987, 0.99823237146895, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.141171324530579, 7.07107038053411
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.183783952444436, 0.172835120473936, "", 16, -0.00547441598525033,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.952016784639033,
			 0.090975924999474, -0.060174337169773, -0.151286773231899, 0.12103514750118,
			 "", 50, -0.0151258128653593, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.827641075487907, 0.0694711542867929, -0.217727962355663,
			 -0.241498390707395, 0.188620927878833, "", 84, -0.0264387314142813,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.809592656517626,
			 0.109726332212978, -0.240951564506539, -0.0233878420791951,
			 0.0416924717969992, 16, 16, 0.00915231485890208, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.581452914726263,
			 0.0166024259602573, 0.551263705726547, -0.0314569986322069,
			 0.0677892673622597, 16, 16, 0.0181661343650264, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.473061022851082,
			 0.0253183902299503, 0.717507479742407, -0.0583992415683076,
			 0.11440638702642, 50, 16, 0.0280035727290563, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.525275897173708, 0.044083878570677,
			 0.635233868638847, -0.0347621768040454, 0.0543424336804945,
			 16, 50, 0.00979012843822455, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.666692700593631, 0.0227311856716209,
			 0.430691499319685, -0.0193925829903574, 0.0570004788790552,
			 84, 50, 0.0188039479443489, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.334605025266103, 0.019488384090726,
			 0.964879789766519, -0.0373596219466791, 0.0946423945634366,
			 16, 50, 0.0286413863083788, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.395028399842701, 0.0336746025823257,
			 0.850533758738741, -0.0665725742588501, 0.0876480619628994,
			 16, 84, 0.0105377438520246, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.788818777814269, 0.0393427219679092,
			 0.267844809025161, -0.0366477878554416, 0.0757509145717396,
			 16, 84, 0.019551563358149, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.495324437716571, 0.0286736652596088,
			 0.681864811531098, -0.0305039514173478, 0.0892819548617055,
			 50, 84, 0.0293890017221788, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.336180759585567, 0.0305581906667442,
			 0.961738934175911, -0.0113374896584589, 0.0121019866318539,
			 16, 16, 0.000382248486697497, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.949029333974683, 0.00597956811329198,
			 0.063925768459397, -0.0224392479147998, 0.0239566732825297,
			 84, 16, 0.000758712683864959, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.948888533461932, 0.0118359116706467,
			 0.0641025976686345, -0.0346300297354212, 0.0369691807508375,
			 16, 16, 0.00116957550770813, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.948944623337549, 0.018265440347635,
			 0.0640321550123245, -0.012181270743377, 0.0129990445716989,
			 16, 50, 0.000408886914160904, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.949246382635696, 0.00642366786167884,
			 0.0636531842812372, -0.0231842137638871, 0.0247549159865438,
			 16, 50, 0.000785351111328366, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.948797230489578, 0.0122295945559634,
			 0.0642172647453313, -0.0353364195552117, 0.0377288474255547,
			 50, 50, 0.00119621393517154, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.948829696124713, 0.0186394412236898,
			 0.0641764911735234, -0.0133441627848888, 0.0142243852647184,
			 16, 84, 0.000440111239914825, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.950101977788087, 0.00703292210139175,
			 0.0625787167225599, -0.0241612501558184, 0.025794401029983,
			 84, 84, 0.000816575437082287, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.94891037184148, 0.012744022742215,
			 0.0640751710507669, -0.0362355345411196, 0.0386904110629705,
			 16, 84, 0.00122743826092546, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.94879797136258, 0.0191141128600057,
			 0.0642163342821808, -0.0428937995939105, 0.0245154709701444,
			 16, 16, -0.00918916431188309, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.593092032428693, 0.0171965584816279,
			 -0.534360658366639, -0.0707042705526406, 0.0342257192428359,
			 50, 16, -0.0182392756549023, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.495634388425505, 0.0267683464143094,
			 -0.681374761541202, -0.118492659364123, 0.0622600154714643,
			 50, 16, -0.0281163219463296, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.542027378767851, 0.0461112235381216,
			 -0.609750073603771, -0.0554301438690076, 0.0357710521003757,
			 50, 50, -0.00982954588431597, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.672671250687217, 0.0232660387356009,
			 -0.422484721014202, -0.0608356910966415, 0.023076376641971,
			 84, 50, -0.0188796572273352, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.377799668610054, 0.0214065330793066,
			 -0.881957725587331, -0.0999119410912535, 0.0423985340537286,
			 50, 50, -0.0287567035187624, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.428302046201217, 0.0363043597401557,
			 -0.792100555541683, -0.0885860313342476, 0.0674256885738355,
			 16, 84, -0.0105801713802061, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.790365624385052, 0.039799639467532,
			 -0.265835859865947, -0.0787648370940484, 0.0395042716475978,
			 50, 84, -0.0196302827232253, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.515286101890246, 0.0301712454092366,
			 -0.650628850647833, -0.0952600818762969, 0.0362454238469918,
			 50, 84, -0.0295073290146525, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.379099275048133, 0.033547939339852,
			 -0.879557123188202))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.15061550099889, 0.120968984864974, -0.0148232580669579, "contGamma",
			 "<unicode>", 0.830584316638785, "contNormal", 0.0692830296898535,
			 -0.21395222081532, -2.59460792534626, 2.41619000043599, -0.0892089624551352,
			 "debCollin1", "<unicode>", 0.944362534891402, "contNormal",
			 1.27828826583213, -0.0697878286452571, -2.70115758174919, 0.664852229654614,
			 -1.01815267604729, "contcor1", "<unicode>", 0.235739935643658,
			 "contNormal", 0.85869175095932, -1.18570217416183, -0.533074167137786,
			 0.294744086022851, -0.119165040557468, "contcor2", "<unicode>",
			 0.572565981121987, "contNormal", 0.211182006325208, -0.564276486576987,
			 -0.593539287283722, 4.46390528870608, 1.93518300071118, "debCollin1:contcor1",
			 "<unicode>", 0.133634322300358, "contNormal", 1.2901881401603,
			 1.49992310460298, -0.146760784497714, 0.12652300534043, -0.0101188895786422,
			 "contGamma:contcor2", "<unicode>", 0.884597711030644, "contNormal",
			 0.0697165335673949, -0.145143326279416, -0.0199698630495438,
			 0.000907967520391616, -0.00953094776457611, "contGamma", "<unicode>",
			 0.0735362472309986, "debCollin1", 0.00532607505408699, -1.78948806912935,
			 -0.0336994664773575, 0.0420650901879968, 0.00418281185531966,
			 "contcor1", "<unicode>", 0.828667004742429, "debCollin1", 0.0193280481842971,
			 0.216411497707148, -0.0310213638889815, 0.0494312182050721,
			 0.00920492715804529, "contcor2", "<unicode>", 0.653795360574223,
			 "debCollin1", 0.0205239950143608, 0.44849587770824, -0.023391337250758,
			 0.0139844489486988, -0.00470344415102958, "contGamma:contcor1",
			 "<unicode>", 0.621806545738372, "debCollin1", 0.00953481454105082,
			 -0.493291624161074, -0.0182406291555404, 0.017560807570703,
			 -0.000339910792418698, "contGamma:contcor2", "<unicode>", 0.970311900411758,
			 "debCollin1", 0.00913318739748296, -0.0372171047877957))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175588036892863, 0.182943834640166, 16, 16, 0.00367789887365175,
			 "Total", 0.967924522024454, 0.0914638927962663, 0.0402114841300729,
			 -0.145026496905292, 0.133079500892378, 16, 16, -0.00597349800645721,
			 "Total", 0.932899828496764, 0.0709467112639148, -0.0841969684012044,
			 -0.235411791033703, 0.200838957922944, 16, 50, -0.0172864165553792,
			 "Total", 0.876563553306096, 0.11129050135557, -0.155326971707582,
			 -0.168509386301573, 0.193892823061125, 16, 16, 0.0126917183797761,
			 "Total", 0.890809376916078, 0.0924512420180371, 0.137280128451924,
			 -0.140069343955672, 0.146149986955006, 16, 84, 0.00304032149966712,
			 "Total", 0.966786609241329, 0.0730164771312994, 0.0416388412467498,
			 -0.230190058349433, 0.213644864250923, 16, 16, -0.00827259704925489,
			 "Total", 0.94175585269849, 0.113225275081907, -0.0730631658282174,
			 -0.169996920746163, 0.215055234233775, 50, 16, 0.022529156743806,
			 "Total", 0.818594957186683, 0.098229395544301, 0.229352492896542,
			 -0.145869688358724, 0.171625208086118, 16, 16, 0.012877759863697,
			 "Total", 0.873673334238129, 0.080995084335529, 0.158994338598992,
			 -0.231972435203934, 0.235102117833484, 50, 50, 0.00156484131477499,
			 "Total", 0.989521725750466, 0.119153861173379, 0.0131329467577891,
			 -0.177377335149947, 0.186008760055896, 16, 16, 0.00431571245297423,
			 "Total", 0.962868243822038, 0.0927022379166624, 0.0465545659949868,
			 -0.147615195078618, 0.136943826224349, 50, 84, -0.00533568442713473,
			 "Total", 0.941407096014651, 0.0725929209790414, -0.0735014427739478,
			 -0.236929066279645, 0.203631860327532, 16, 16, -0.0166486029760567,
			 "Total", 0.882238321121347, 0.112390056675088, -0.14813234790144,
			 -0.164941053715811, 0.191600117634008, 84, 16, 0.0133295319590985,
			 "Total", 0.883487893632837, 0.0909560517851782, 0.146549148709538,
			 -0.135815852437841, 0.14317212259582, 16, 16, 0.00367813507898959,
			 "Total", 0.958783884922037, 0.0711717095911668, 0.0516797348288805,
			 -0.227322372354674, 0.212052805414809, 84, 50, -0.00763478346993242,
			 "Total", 0.945694522772621, 0.112087564168326, -0.0681144561092163,
			 -0.160971616121979, 0.207305556768236, 16, 16, 0.0231669703231284,
			 "Total", 0.805226833047186, 0.0939499847433774, 0.246588335127553,
			 -0.135054664656445, 0.162085811542484, 84, 84, 0.0135155734430195,
			 "Total", 0.858487570550258, 0.0758025347768465, 0.178299755843359,
			 -0.22462129386142, 0.229026603649615, 16, 16, 0.00220265489409747,
			 "Total", 0.98481483609006, 0.115728631007853, 0.0190329296641209,
			 -0.187069173407521, 0.197195829141069, 16, 16, 0.00506332786677432,
			 "Total", 0.958806348291009, 0.0980285876627385, 0.0516515435700696,
			 -0.160097150816853, 0.150921012790184, 16, 50, -0.00458806901333464,
			 "Total", 0.953887320736845, 0.0793428262101521, -0.0578258833531138,
			 -0.245044092107622, 0.213242116983108, 16, 50, -0.0159009875622566,
			 "Total", 0.891814723508791, 0.116911895500538, -0.136008294914553,
			 -0.168737608760673, 0.19689190350647, 16, 50, 0.0140771473728986,
			 "Total", 0.880037533885742, 0.093274548703747, 0.15092163477102,
			 -0.140958178364964, 0.149809679350543, 16, 84, 0.00442575049278968,
			 "Total", 0.952422560556702, 0.0741768369238023, 0.0596648586854143,
			 -0.230458220301405, 0.21668388418914, 16, 50, -0.00688716805613232,
			 "Total", 0.951855191602681, 0.114068959434343, -0.0603772322486778,
			 -0.15796310119858, 0.205792272672438, 50, 16, 0.0239145857369285,
			 "Total", 0.796630608821576, 0.092796443388826, 0.257710154221365,
			 -0.131622624399332, 0.160149002112971, 16, 50, 0.0142631888568196,
			 "Total", 0.848036132763284, 0.0744329050976857, 0.191624777215138,
			 -0.222221049057646, 0.228121589673441, 50, 50, 0.00295027030789756,
			 "Total", 0.979512491032636, 0.114885437253779, 0.0256801068823064,
			 -0.18295165717594, 0.172767322178835, 16, 50, -0.00509216749855283,
			 "Total", 0.955250733598215, 0.0907463050751547, -0.0561143232700832,
			 -0.149265264074796, 0.119778135317473, 50, 84, -0.0147435643786618,
			 "Total", 0.82991401354869, 0.0686347814333451, -0.214811850067302,
			 -0.239304502855495, 0.187191537000327, 16, 50, -0.0260564829275838,
			 "Total", 0.810729286231703, 0.108802009429757, -0.239485309730478,
			 -0.182877568586269, 0.173446161983498, 84, 16, -0.00471570330138537,
			 "Total", 0.958626228885059, 0.0909005811791449, -0.0518775924225585,
			 -0.148249892351383, 0.119515691988395, 16, 50, -0.0143671001814943,
			 "Total", 0.833413437737002, 0.0683088022157241, -0.21032575181339,
			 -0.237755571255852, 0.18639553379502, 84, 50, -0.0256800187304163,
			 "Total", 0.812400713555698, 0.108203800783209, -0.237330098800017,
			 -0.183651405882003, 0.175041724926918, 16, 50, -0.0043048404775422,
			 "Total", 0.962477481825021, 0.0915050311225734, -0.0470448501544767,
			 -0.148282328877627, 0.120369854162324, 84, 84, -0.0139562373576512,
			 "Total", 0.838637408187999, 0.0685349795095842, -0.203636704315341,
			 -0.236782389325557, 0.18624407751241, 16, 50, -0.0252691559065732,
			 "Total", 0.814865550393887, 0.107916898008011, -0.234153838490589,
			 -0.182926191845519, 0.17279513370334, 16, 16, -0.00506552907108942,
			 "Total", 0.955484878048031, 0.0907469036050517, -0.0558204067560872,
			 -0.14916674307154, 0.119732891169143, 16, 84, -0.0147169259511984,
			 "Total", 0.83012724726327, 0.0685981059758568, -0.214538371604283,
			 -0.239178223947049, 0.187118534946808, 16, 50, -0.0260298445001204,
			 "Total", 0.810832403679334, 0.108751171515505, -0.23935231351884,
			 -0.182894851516126, 0.173516721768282, 16, 84, -0.00468906487392196,
			 "Total", 0.958869867024571, 0.0909229904466964, -0.0515718285428692,
			 -0.1482079429826, 0.119527019474538, 16, 84, -0.0143404617540309,
			 "Total", 0.833699054594539, 0.0683009903674243, -0.209959792338099,
			 -0.237664673618581, 0.186357913012675, 16, 84, -0.0256533803029529,
			 "Total", 0.812535948119504, 0.108171014869633, -0.237155769813846,
			 -0.183714735629958, 0.1751583315298, 50, 16, -0.00427820205007879,
			 "Total", 0.962728185733684, 0.091550934096367, -0.0467302938228411,
			 -0.14830231291676, 0.120443115056385, 16, 84, -0.0139295989301877,
			 "Total", 0.838996297712771, 0.0685587669194369, -0.203177500939542,
			 -0.236730633777777, 0.186245598819558, 50, 50, -0.0252425174791098,
			 "Total", 0.815035614722178, 0.107904082915226, -0.233934776119095,
			 -0.182915152768999, 0.172846543278328, 16, 84, -0.0050343047453355,
			 "Total", 0.955764005719203, 0.0907572023908424, -0.0554700300661039,
			 -0.149076110799137, 0.119704707548248, 50, 84, -0.0146857016254445,
			 "Total", 0.83040838366925, 0.0685677952420284, -0.21417783047577,
			 -0.239045851427208, 0.187048611078475, 16, 84, -0.0259986201743665,
			 "Total", 0.810967020596529, 0.108699564345739, -0.239178697089099,
			 -0.182933864495075, 0.173618183398739, 84, 16, -0.00465784054816804,
			 "Total", 0.959159593490861, 0.0909588264647339, -0.0512082304620976,
			 -0.148183764038657, 0.119565289182103, 16, 84, -0.014309237428277,
			 "Total", 0.834064484988767, 0.0683045850160338, -0.209491609163836,
			 -0.237573889085254, 0.186329577130856, 84, 50, -0.025622155977199,
			 "Total", 0.812708245270647, 0.108140626450233, -0.236933674403954,
			 -0.183807544651188, 0.175313589202538, 16, 84, -0.00424697772432487,
			 "Total", 0.963025556946591, 0.0916142175791054, -0.0463571903635783,
			 -0.148350603664317, 0.12055385445545, 84, 84, -0.0138983746044338,
			 "Total", 0.839445992023364, 0.0685993365798686, -0.202602172227311,
			 -0.236685786414561, 0.186263200107849, 16, 84, -0.0252112931533558,
			 "Total", 0.815248589288254, 0.107897132258189, -0.233660456267061,
			 -0.19657066255144, 0.167243501957173, 16, 16, -0.0146635802971334,
			 "Total", 0.874462125674721, 0.0928114412760469, -0.157993239793787,
			 -0.161236594521414, 0.112606640166929, 50, 16, -0.0243149771772424,
			 "Total", 0.727797638910382, 0.0698592517128842, -0.348056650780843,
			 -0.248190528197033, 0.176934736744704, 16, 50, -0.0356278957261644,
			 "Total", 0.742524512326914, 0.108452315525966, -0.328512079741019,
			 -0.210433357501074, 0.163005974220769, 50, 16, -0.0237136916401527,
			 "Total", 0.803423814705431, 0.095266886194717, -0.248918512899477,
			 -0.172827876626783, 0.106097699586259, 16, 84, -0.0333650885202616,
			 "Total", 0.639139729870386, 0.0711557912321786, -0.468901939567963,
			 -0.255933793981779, 0.166577779843412, 50, 16, -0.0446780070691836,
			 "Total", 0.678501863217196, 0.107785545336013, -0.414508336251427,
			 -0.234716079266991, 0.167534603403832, 50, 16, -0.0335907379315799,
			 "Total", 0.743409736557659, 0.102616855677891, -0.327341329157652,
			 -0.197732932314335, 0.111248662690957, 50, 16, -0.0432421348116888,
			 "Total", 0.583282761283943, 0.0788232838568716, -0.548595956623788,
			 -0.27290238319586, 0.163792276474638, 50, 50, -0.0545550533606109,
			 "Total", 0.624342142652813, 0.11140374596551, -0.48970573554592,
			 -0.199816133394143, 0.169208209655011, 50, 16, -0.0153039618695663,
			 "Total", 0.87086097650511, 0.0941405928782291, -0.162564961635221,
			 -0.165049079819478, 0.115138362320128, 50, 84, -0.0249553587496753,
			 "Total", 0.726988052393766, 0.0714777017204625, -0.349134879116169,
			 -0.250680743429533, 0.178144188832339, 50, 16, -0.0362682772985973,
			 "Total", 0.740242943086394, 0.109396125552405, -0.331531643515321,
			 -0.208427725528743, 0.159719579103572, 84, 16, -0.0243540732125856,
			 "Total", 0.795392008901141, 0.0939168544769738, -0.25931525654489,
			 -0.16962593921458, 0.101614999029191, 50, 16, -0.0340054700926945,
			 "Total", 0.62311437531376, 0.0691953883804204, -0.491441277932284,
			 -0.253844553438315, 0.163207776155082, 84, 50, -0.0453183886416165,
			 "Total", 0.670141870012644, 0.106392855400164, -0.425953307401755,
			 -0.227512601197427, 0.159050362189401, 50, 16, -0.0342311195040128,
			 "Total", 0.728501582881247, 0.098614812934316, -0.34711944874664,
			 -0.187750168314357, 0.0999851355461138, 84, 84, -0.0438825163841217,
			 "Total", 0.549954515268025, 0.0734032120309584, -0.597828285301929,
			 -0.265949231405286, 0.155558361539198, 50, 16, -0.0551954349330437,
			 "Total", 0.607737697991604, 0.107529423058097, -0.51330541319116,
			 -0.211152773229257, 0.179043598498345, 16, 16, -0.0160545873654564,
			 "Total", 0.871868928316251, 0.0995417198492986, -0.161285010845324,
			 -0.1791853733901, 0.127773404898969, 50, 50, -0.0257059842455653,
			 "Total", 0.742706913045407, 0.0783072497021172, -0.328270809450614,
			 -0.260173976458405, 0.18613617086943, 16, 50, -0.0370189027944873,
			 "Total", 0.745078251642166, 0.113856721564343, -0.325135857469487,
			 -0.213871107943876, 0.163661710526925, 50, 50, -0.0251046987084756,
			 "Total", 0.7943528641369, 0.0963111622072475, -0.260662400215398,
			 -0.176367080140706, 0.106854888963537, 16, 84, -0.0347560955885846,
			 "Total", 0.630487329350548, 0.0722518299668418, -0.481041042206613,
			 -0.258294671790874, 0.16615664351586, 50, 50, -0.0460690141375066,
			 "Total", 0.670501099553866, 0.108280386439433, -0.425460377935349,
			 -0.226374401276239, 0.156410911276433, 50, 16, -0.0349817449999029,
			 "Total", 0.720169755294208, 0.0976511087887415, -0.358231928278279,
			 -0.185638214502219, 0.0963719307421949, 50, 50, -0.0446331418800118,
			 "Total", 0.534995389462473, 0.071942685546488, -0.62039860676553,
			 -0.264506605646241, 0.152614484788374, 50, 50, -0.0559460604289338,
			 "Total", 0.599056731474604, 0.106410396753413, -0.525757464832865,
			 -0.0233878420791951, 0.0416924717969992, 50, 50, 0.00915231485890208,
			 "Total indirect", 0.581452914726263, 0.0166024259602573, 0.551263705726547,
			 -0.0314569986322069, 0.0677892673622597, 50, 84, 0.0181661343650264,
			 "Total indirect", 0.473061022851082, 0.0253183902299503, 0.717507479742407,
			 -0.0583992415683076, 0.11440638702642, 50, 50, 0.0280035727290563,
			 "Total indirect", 0.525275897173708, 0.044083878570677, 0.635233868638847,
			 -0.0347621768040454, 0.0543424336804945, 84, 16, 0.00979012843822455,
			 "Total indirect", 0.666692700593631, 0.0227311856716209, 0.430691499319685,
			 -0.0193925829903574, 0.0570004788790552, 50, 50, 0.0188039479443489,
			 "Total indirect", 0.334605025266103, 0.019488384090726, 0.964879789766519,
			 -0.0373596219466791, 0.0946423945634366, 84, 50, 0.0286413863083788,
			 "Total indirect", 0.395028399842701, 0.0336746025823257, 0.850533758738741,
			 -0.0665725742588501, 0.0876480619628994, 50, 50, 0.0105377438520246,
			 "Total indirect", 0.788818777814269, 0.0393427219679092, 0.267844809025161,
			 -0.0366477878554416, 0.0757509145717396, 84, 84, 0.019551563358149,
			 "Total indirect", 0.495324437716571, 0.0286736652596088, 0.681864811531098,
			 -0.0305039514173478, 0.0892819548617055, 50, 50, 0.0293890017221788,
			 "Total indirect", 0.336180759585567, 0.0305581906667442, 0.961738934175911,
			 -0.0113374896584589, 0.0121019866318539, 16, 16, 0.000382248486697497,
			 "Total indirect", 0.949029333974683, 0.00597956811329198, 0.063925768459397,
			 -0.0224392479147998, 0.0239566732825297, 50, 84, 0.000758712683864959,
			 "Total indirect", 0.948888533461932, 0.0118359116706467, 0.0641025976686345,
			 -0.0346300297354212, 0.0369691807508375, 16, 50, 0.00116957550770813,
			 "Total indirect", 0.948944623337549, 0.018265440347635, 0.0640321550123245,
			 -0.012181270743377, 0.0129990445716989, 50, 84, 0.000408886914160904,
			 "Total indirect", 0.949246382635696, 0.00642366786167884, 0.0636531842812372,
			 -0.0231842137638871, 0.0247549159865438, 16, 84, 0.000785351111328366,
			 "Total indirect", 0.948797230489578, 0.0122295945559634, 0.0642172647453313,
			 -0.0353364195552117, 0.0377288474255547, 50, 84, 0.00119621393517154,
			 "Total indirect", 0.948829696124713, 0.0186394412236898, 0.0641764911735234,
			 -0.0133441627848888, 0.0142243852647184, 50, 16, 0.000440111239914825,
			 "Total indirect", 0.950101977788087, 0.00703292210139175, 0.0625787167225599,
			 -0.0241612501558184, 0.025794401029983, 50, 84, 0.000816575437082287,
			 "Total indirect", 0.94891037184148, 0.012744022742215, 0.0640751710507669,
			 -0.0362355345411196, 0.0386904110629705, 50, 50, 0.00122743826092546,
			 "Total indirect", 0.94879797136258, 0.0191141128600057, 0.0642163342821808,
			 -0.0428937995939105, 0.0245154709701444, 50, 84, -0.00918916431188309,
			 "Total indirect", 0.593092032428693, 0.0171965584816279, -0.534360658366639,
			 -0.0707042705526406, 0.0342257192428359, 50, 84, -0.0182392756549023,
			 "Total indirect", 0.495634388425505, 0.0267683464143094, -0.681374761541202,
			 -0.118492659364123, 0.0622600154714643, 50, 84, -0.0281163219463296,
			 "Total indirect", 0.542027378767851, 0.0461112235381216, -0.609750073603771,
			 -0.0554301438690076, 0.0357710521003757, 84, 16, -0.00982954588431597,
			 "Total indirect", 0.672671250687217, 0.0232660387356009, -0.422484721014202,
			 -0.0608356910966415, 0.023076376641971, 50, 84, -0.0188796572273352,
			 "Total indirect", 0.377799668610054, 0.0214065330793066, -0.881957725587331,
			 -0.0999119410912535, 0.0423985340537286, 84, 50, -0.0287567035187624,
			 "Total indirect", 0.428302046201217, 0.0363043597401557, -0.792100555541683,
			 -0.0885860313342476, 0.0674256885738355, 50, 84, -0.0105801713802061,
			 "Total indirect", 0.790365624385052, 0.039799639467532, -0.265835859865947,
			 -0.0787648370940484, 0.0395042716475978, 84, 84, -0.0196302827232253,
			 "Total indirect", 0.515286101890246, 0.0301712454092366, -0.650628850647833,
			 -0.0952600818762969, 0.0362454238469918, 50, 84, -0.0295073290146525,
			 "Total indirect", 0.379099275048133, 0.033547939339852, -0.879557123188202,
			 16, 16, 84, 16, 16, 50, 84, 16, 16, 84, 84, 16, 50, 16, 84,
			 16, 50, 50, 84, 16, 50, 84, 84, 16, 84, 16, 84, 16, 84, 50,
			 84, 16, 84, 84, 84, 16, 16, 16, 84, 50, 16, 50, 84, 50, 16,
			 84, 84, 50, 50, 16, 84, 50, 50, 50, 84, 50, 50, 84, 84, 50,
			 84, 16, 84, 50, 84, 50, 84, 50, 84, 84, 84, 50, 16, 16, 84,
			 84, 16, 50, 84, 84, 16, 84, 84, 84, 50, 16, 84, 84, 50, 50,
			 84, 84, 50, 84, 84, 84, 84, 16, 84, 84, 84, 50, 84, 84, 84,
			 84, 84, 84, 16, 16, 16, 16, 50, 16, 16, 50, 84, 50, 16, 50,
			 16, 84, 16, 84, 50, 84, 16, 16, 84, 16, 16, 16, 16, 50, 16,
			 50, 50, 50, 16, 84, 84, 84, 16, 84, 16, 16, 50, 16, 50, 16,
			 50, 50, 84, 50, 50, 50, 16, 84, 50, 84, 50, 84, 50, 84, 50,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84, 16, 84, 50,
			 84, 84, 84, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-62")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-62")
})


context('Model number 62 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(753.030601947551, 820.765026783241, 604.190635168497, 13, 1, 100,
			 9.79931707452917e-121, 0, 604.190635168497, 13))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 62))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962255885071645, 0.0896220741792521, 0.0399997576642678,
			 "facExperimexperimental", "<unicode>", 0.114130754485515, "facGenderm",
			 0.0253179736497195, 1.57989569851342, -0.163250714364469, 0.034199182450608,
			 -0.0645257659569305, "contcor2", "<unicode>", 0.200188263823381,
			 "facGenderm", 0.0503707972117183, -1.28101538051336, -0.170527322136758,
			 0.0272977418370282, -0.0716147901498649, "contcor2", "<unicode>",
			 0.155882727320534, "facExperimexperimental", 0.0504665048782031,
			 -1.41905587325101, 0.759150982985588, 1.34137691142338, 1.05026394720448,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148529751829706, 7.07106781144189, 0.00473838323127365, 0.00837245874686193,
			 0.00655542098906779, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000927077115766771, 7.07106332103333, 0.0796446669605097,
			 0.140727590989643, 0.110186128975076, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.0155826649139851, 7.071070935767, 0.180704820151711, 0.31929523087552,
			 0.250000025513616, "facGenderm", "<unicode>", 1.53743684450092e-12,
			 "facGenderm", 0.0353553462760012, 7.07106709016489, 0.180704813228784,
			 0.31929520672884, 0.250000009978812, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.035355341882106, 7.07106752955321, 0.721541745069201, 1.27492338078227,
			 0.998232562925736, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.141171378677893, 7.07106902457459))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.143610209034574, 1.01999494403077, 16, 0.438192367498097, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.139897454040528,
			 0.296843503820405, 1.47617300651191, 0.0679150327102048, 0.889736447510732,
			 50, 0.478825740110469, "", "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.0223770880735297, 0.209652172510044, 2.28390545338866,
			 -0.0768017820435593, 1.1297103614061, 84, 0.526454289681271,
			 "", "facGenderm", "contNormal", "", "<unicode>", "", 0.0871851118023483,
			 0.307789365765513, 1.71043690340603, -0.0350116991468384, 0.0328543661126337,
			 16, -0.00107866651710238, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.950321121903098, 0.0173130898819547,
			 -0.0623035243539434, -0.0442358762213644, 0.0471724235944712,
			 16, 0.00146827368655337, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.949794344525844, 0.0233188723203214,
			 0.0629650382052924, -0.0209350094361828, 0.0196622913232451,
			 50, -0.000636359056468847, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.951005197378704, 0.0103566445811388,
			 -0.0614445201322989, -0.0572625890543551, 0.0610837513487289,
			 50, 0.0019105811471869, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.9495409574271, 0.0301909477257197,
			 0.0632832451814447, -0.00726310011393019, 0.00702728646940996,
			 84, -0.000117906822260119, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.974198949060857, 0.00364557376973784,
			 -0.0323424595708011, -0.0728236674235535, 0.0776817341863447,
			 84, 0.00242903338139563, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.949555953267419, 0.0383949406206098,
			 0.0632644130224741, -0.0336646501656937, 0.0360662992543764,
			 16, 0.00120082454434136, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.946180161432928, 0.0177888343791261,
			 0.067504397351096, -0.0485073446042107, 0.0452382358432191,
			 16, -0.00163455438049583, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.945508508812247, 0.0239151283357457,
			 -0.0683481333467349, -0.0201976169306971, 0.02161446924215,
			 50, 0.000708426155726477, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.947046860912203, 0.0106665445137399,
			 0.0664157126812652, -0.062758317165314, 0.0585044116270926,
			 50, -0.00212695276911071, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.945184095009365, 0.0309349380266453,
			 -0.0687556822411831, -0.00766271776710723, 0.00792523709791132,
			 84, 0.000131259665402044, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.973668145657469, 0.0039765921690333,
			 0.0330080782294436, -0.0798153987257621, 0.0744071602068918,
			 84, -0.00270411925943515, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.945203318780371, 0.0393432124643978,
			 -0.0687315318209499))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0658874068444434, 0.8892164997948, 0.477551953319622, "facGenderm",
			 "<unicode>", 0.0229865222182302, "contNormal", 0.210036791350421,
			 2.27365858261891, -3.5776485168458, 3.35300340473317, -0.112322556056315,
			 "debCollin1", "<unicode>", 0.949345388645253, "contNormal",
			 1.76805593782515, -0.0635288475060808, -3.45404156826821, 3.18282340693496,
			 -0.135609080666627, "facExperimexperimental", "<unicode>", 0.936161923729214,
			 "contNormal", 1.69310891107028, -0.0800947179357189, -0.228515215663692,
			 0.321188551560567, 0.0463366679484375, "contcor2", "<unicode>",
			 0.741078120983737, "contNormal", 0.140233129679997, 0.33042597034078,
			 -4.73027950335444, 5.20501058746499, 0.237365542055277, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.92538591772709, "contNormal", 2.53455935139312,
			 0.0936516013818373, -0.369790588935655, 0.4549937187582, 0.0426015649112727,
			 "facGenderm:contcor2", "<unicode>", 0.839548373761728, "contNormal",
			 0.210408026422845, 0.202471196729248, -0.0402675257785718, 0.0518453363681163,
			 0.00578890529477227, "facGenderm", "<unicode>", 0.805410566818529,
			 "debCollin1", 0.0234986109115429, 0.246350957363554, -0.0489096505256983,
			 0.0420350742453054, -0.00343728814019643, "facExperimexperimental",
			 "<unicode>", 0.882220390630698, "debCollin1", 0.0232006112072375,
			 -0.148155068394239, -0.0174101053261201, 0.0258806283289966,
			 0.00423526150143821, "contcor2", "<unicode>", 0.701350377523295,
			 "debCollin1", 0.0110437574354908, 0.383498236553762, -0.0882813216037399,
			 0.0429308542874727, -0.0226752336581336, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498141782307868, "debCollin1", 0.0334731089260307,
			 -0.677416421290345, -0.0370219894640779, 0.0287648434471785,
			 -0.00412857300844966, "facGenderm:contcor2", "<unicode>", 0.80568049204338,
			 "debCollin1", 0.0167826637198884, -0.246002248353286))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.145651168849012, 1.019878570811, 16, 0.437113700980994, 0,
			 "Total", 0.141532592518097, 0.297334478810214, 1.47010768051559,
			 0.0660729909366755, 0.889421156250057, 16, 0.477747073593366,
			 0, "Total", 0.0229338467348157, 0.210041656838556, 2.27453487457765,
			 -0.0779222235426573, 1.128673469871, 50, 0.525375623164169,
			 0, "Total", 0.08785660204942, 0.30781067992349, 1.70681414723738,
			 -0.143970257308049, 1.02329153967735, 16, 0.43966064118465,
			 0, "Total", 0.139815230664265, 0.297776338288002, 1.47647943994604,
			 0.0659884781470388, 0.894599549447005, 84, 0.480294013797022,
			 0, "Total", 0.0230782322711023, 0.211384259566998, 2.27213707766539,
			 -0.078299751591374, 1.13414487832702, 16, 0.527922563367825,
			 0, "Total", 0.0878564832701734, 0.309302782980199, 1.70681478608494,
			 -0.144584958690446, 1.0196969755737, 16, 0.437556008441628,
			 1, "Total", 0.140704549609414, 0.297016155257917, 1.47317242074483,
			 0.0671531294118165, 0.889225632696183, 16, 0.478189381054, 0,
			 "Total", 0.022597400930648, 0.20971622687171, 2.2801734905641,
			 -0.0772412380323075, 1.12887709928191, 50, 0.525817930624803,
			 1, "Total", 0.0874644384968328, 0.307688903170652, 1.70892718328932,
			 -0.144747671624529, 1.0249535689151, 16, 0.440102948645284,
			 0, "Total", 0.1402441433756, 0.298398656752389, 1.47488247244518,
			 0.0644715774320992, 0.897001065083212, 84, 0.480736321257655,
			 1, "Total", 0.0236033125354025, 0.212383873943093, 2.26352553201128,
			 -0.0793929546776471, 1.13612269633456, 16, 0.528364870828458,
			 0, "Total", 0.0883943727942218, 0.310086221124481, 1.70392889084985,
			 -0.143769097061823, 1.0199180184135, 16, 0.438074460675837,
			 0, "Total", 0.140032003557192, 0.296864412982671, 1.47567186068008,
			 0.067804633667069, 0.889611032909348, 50, 0.478707833288208,
			 0, "Total", 0.0224077129539137, 0.209648341940103, 2.28338478071521,
			 -0.0768622483401477, 1.12953501405817, 50, 0.526336382859011,
			 0, "Total", 0.0872258143029068, 0.307760058836342, 1.71021666960007,
			 -0.146086835319845, 1.02732963707883, 50, 0.440621400879492,
			 0, "Total", 0.14103581242577, 0.29934643739743, 1.47194469628679,
			 0.0621015048969613, 0.900408042086767, 84, 0.481254773491864,
			 0, "Total", 0.0244266658650791, 0.213857638151073, 2.25035111045178,
			 -0.081084125716237, 1.13885077184157, 50, 0.528883323062667,
			 0, "Total", 0.0892396492114824, 0.311213600652997, 1.69942226802733,
			 -0.144144466862325, 1.0229308509472, 16, 0.439393192042438,
			 1, "Total", 0.139993009983873, 0.297728766195519, 1.47581705878527,
			 0.0653489369139524, 0.894704192395667, 50, 0.48002656465481,
			 0, "Total", 0.0232784111572335, 0.211574105958978, 2.2688341868635,
			 -0.0792246717223462, 1.13453490017357, 50, 0.527655114225613,
			 1, "Total", 0.0883620444023177, 0.309638233526202, 1.70410193927476,
			 -0.146188859711258, 1.01930448594646, 50, 0.436557813117601,
			 0, "Total", 0.142027106807977, 0.297325194455352, 1.46828395729228,
			 0.066744932892347, 0.887637438567598, 84, 0.477191185729973,
			 1, "Total", 0.0226858234067389, 0.209415201542056, 2.27868455688085,
			 -0.0766788334920059, 1.12631830409356, 50, 0.524819735300776,
			 0, "Total", 0.0872458222397272, 0.306892664118997, 1.71010844070642,
			 -0.143685691404907, 1.02148727871255, 16, 0.438900793653823,
			 0, "Total", 0.139790928191958, 0.297243464499398, 1.47657003794178,
			 0.0667361185636735, 0.892332213968717, 84, 0.479534166266195,
			 0, "Total", 0.0227965650753232, 0.210615118930052, 2.27682689021701,
			 -0.0780024242235162, 1.13232785589751, 50, 0.527162715836998,
			 0, "Total", 0.087759708285025, 0.308763398120567, 1.70733551659886,
			 -0.147665808078696, 1.01979663753667, 84, 0.436065414728986,
			 0, "Total", 0.143151827397434, 0.297827525103563, 1.4641541764058,
			 0.0653978485129985, 0.887999726169717, 84, 0.476698787341358,
			 0, "Total", 0.0231104983423303, 0.209851273835973, 2.27160301973655,
			 -0.0773203531743212, 1.12597502699864, 84, 0.524327336912161,
			 0, "Total", 0.0876214037939471, 0.306968747809757, 1.70808051520968,
			 -0.143606889047513, 1.02025414337451, 16, 0.438323627163499,
			 1, "Total", 0.139865909480887, 0.296908780365969, 1.47629055167457,
			 0.0677205468372535, 0.890193452714488, 84, 0.478956999775871,
			 0, "Total", 0.0224467531429549, 0.209818372267245, 2.28272193040286,
			 -0.0770079355472142, 1.13017903424056, 50, 0.526585549346673,
			 1, "Total", 0.0872830759434873, 0.307961518504909, 1.70990697767416,
			 -0.149853154047887, 1.02082965052521, 84, 0.435488248238662,
			 0, "Total", 0.144787095290289, 0.298649060341744, 1.45819393417924,
			 0.0631713115578769, 0.88907193014419, 84, 0.476121620851033,
			 1, "Total", 0.0238342497970114, 0.210692804842567, 2.25979060465211,
			 -0.0785176229010238, 1.1260179637447, 84, 0.523750170421836,
			 0, "Total", 0.0882982489644406, 0.30728513282564, 1.70444357527386,
			 -0.0350116991468384, 0.0328543661126337, 16, -0.00107866651710238,
			 0, "Total indirect", 0.950321121903098, 0.0173130898819547,
			 -0.0623035243539434, -0.0442358762213644, 0.0471724235944712,
			 16, 0.00146827368655337, 1, "Total indirect", 0.949794344525844,
			 0.0233188723203214, 0.0629650382052924, -0.0209350094361828,
			 0.0196622913232451, 50, -0.000636359056468847, 0, "Total indirect",
			 0.951005197378704, 0.0103566445811388, -0.0614445201322989,
			 -0.0572625890543551, 0.0610837513487289, 16, 0.0019105811471869,
			 1, "Total indirect", 0.9495409574271, 0.0301909477257197, 0.0632832451814447,
			 -0.00726310011393019, 0.00702728646940996, 84, -0.000117906822260119,
			 0, "Total indirect", 0.974198949060857, 0.00364557376973784,
			 -0.0323424595708011, -0.0728236674235535, 0.0776817341863447,
			 16, 0.00242903338139563, 1, "Total indirect", 0.949555953267419,
			 0.0383949406206098, 0.0632644130224741, -0.0336646501656937,
			 0.0360662992543764, 16, 0.00120082454434136, 1, "Total indirect",
			 0.946180161432928, 0.0177888343791261, 0.067504397351096, -0.0485073446042107,
			 0.0452382358432191, 16, -0.00163455438049583, 1, "Total indirect",
			 0.945508508812247, 0.0239151283357457, -0.0683481333467349,
			 -0.0201976169306971, 0.02161446924215, 50, 0.000708426155726477,
			 1, "Total indirect", 0.947046860912203, 0.0106665445137399,
			 0.0664157126812652, -0.062758317165314, 0.0585044116270926,
			 16, -0.00212695276911071, 1, "Total indirect", 0.945184095009365,
			 0.0309349380266453, -0.0687556822411831, -0.00766271776710723,
			 0.00792523709791132, 84, 0.000131259665402044, 1, "Total indirect",
			 0.973668145657469, 0.0039765921690333, 0.0330080782294436, -0.0798153987257621,
			 0.0744071602068918, 16, -0.00270411925943515, 1, "Total indirect",
			 0.945203318780371, 0.0393432124643978, -0.0687315318209499,
			 16, 0, 50, 1, 50, 0, 50, 1, 84, 0, 50, 1, 16, 1, 50, 1, 50,
			 1, 50, 1, 84, 1, 50, 1, 16, 0, 84, 1, 50, 0, 84, 1, 84, 0, 84,
			 1, 16, 1, 84, 1, 50, 1, 84, 1, 84, 1, 84, 1, 16, 0, 16, 0, 50,
			 1, 50, 0, 84, 0, 84, 0, 16, 1, 16, 0, 50, 0, 50, 0, 84, 1, 84,
			 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-62")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-62")
})


context('Model number 63 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1201.55680928092, 1271.8964043026, 683.861328261395, 12, 1, 100,
			 1.25396921804591e-138, 0, 683.861328261395, 12))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 63))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848666960406, 0.0642076288962032, -0.240320519032101, "contcor1",
			 "<unicode>", 0.121930948490427, "contGamma", 0.155374359085363,
			 -1.54671929426959, -0.403933880875874, 0.194628013056609, -0.104652933909633,
			 "contcor2", "<unicode>", 0.493115110127841, "contGamma", 0.15269716654333,
			 -0.685362644760901, 0.42497899512842, 0.896762416004367, 0.660870705566394,
			 "contcor2", "<unicode>", 3.99650930127393e-08, "contcor1", 0.120355125042428,
			 5.4910059320982, 0.751629123318987, 1.32808618709022, 1.0398576552046,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147058075637678, 7.07106801646588, 0.00462619980221284, 0.00817421195214613,
			 0.00640020587717949, "debCollin1", "<unicode>", 1.53721479989599e-12,
			 "debCollin1", 0.00090512177211407, 7.07109924251483, 0.323892133320981,
			 0.57229968686444, 0.44809591009271, "debCollin1:contcor1", "<unicode>",
			 1.53765888910584e-12, "debCollin1:contcor1", 0.0633704383098023,
			 7.07105587469793, 1.68041056053647, 2.96918997623569, 2.32480026838608,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776300448616, 7.07107010211468, 0.732634231222931, 1.29452269155161,
			 1.01357846138727, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341526875185, 7.07107342500859, 0.7215417546278,
			 1.27492341426375, 0.998232584445773, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.141171384780779, 7.07106887132897
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209495052165261, 0.168873671774603, 16, 16, -0.0203106901953291,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.833339686982954,
			 0.0965244073167639, -0.210420252865947, -0.218425966457141,
			 0.292836926175374, 50, 16, 0.0372054798591166, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.775445032986538, 0.130426603923667,
			 0.285259898976526, -0.386808969170994, 0.586763107884821, 84,
			 16, 0.0999770693569136, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.687285744668666, 0.248364787499982, 0.402541239292712,
			 -0.347625625199141, 0.205319085867209, 16, 50, -0.071153269665966,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.613967129710192,
			 0.141059916260683, -0.504418771484824, -0.14980680585857, 0.12253260663553,
			 50, 50, -0.0136370996115202, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.84438622016299, 0.069475616552722, -0.196286125811804,
			 -0.258620632731912, 0.356889612504466, 84, 50, 0.0491344898862768,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.754343670061915,
			 0.157020804997297, 0.312917067818641, -0.627708563111051, 0.366211409712916,
			 16, 84, -0.130748576699067, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.606091735153557, 0.253555672620487, -0.51566023093779,
			 -0.367456618146683, 0.22099180485744, 50, 84, -0.0732324066446215,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.62566669088219,
			 0.150117152061398, -0.487835038428317, -0.235995789192753, 0.215074154899104,
			 84, 84, -0.0104608171468245, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.927566075283297, 0.115070977744959, -0.0909075194443004,
			 -0.0248324421649118, 0.0446236461995352, 16, 16, 0.00989560201731173,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.576514585087726, 0.0177187154744444, 0.558483036289178, -0.0328310165607292,
			 0.0721139664148428, 16, 16, 0.0196414749270568, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.463160451723074,
			 0.0267721712754328, 0.73365266959429, -0.0615347368665301, 0.122090449945633,
			 50, 16, 0.0302778565395514, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.518049620574368, 0.0468440206709345,
			 0.646354777106868, -0.0372063544523193, 0.0583769026924447,
			 16, 50, 0.0105852741200627, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.664209594831128, 0.0243839320259741,
			 0.434108580551616, -0.019308462395093, 0.0599707564547086, 84,
			 50, 0.0203311470298078, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.314769215320925, 0.0202246621558218,
			 1.00526510026054, -0.038176620148585, 0.10011167743319, 16,
			 50, 0.0309675286423024, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.380048284414916, 0.0352782751807113,
			 0.877807332803906, -0.0717265048513784, 0.0945138562176845,
			 16, 84, 0.0113936756831531, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.78819016644809, 0.0424090346507246,
			 0.268661519343459, -0.038417806299634, 0.0806969034854303, 16,
			 84, 0.0211395485928982, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.486630376168662, 0.0303869639250073,
			 0.69567820744017, -0.030397121723066, 0.0939489821338516, 50,
			 84, 0.0317759302053928, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.316481259460305, 0.031721527751975,
			 1.00171500105049, -0.0115357990789501, 0.0118569607729828, 16,
			 16, 0.000160580847016378, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978532670480156, 0.00596765043553148,
			 0.0269085545058532, -0.022885716837691, 0.0235231807686211,
			 84, 16, 0.000318731965465054, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978522186939829, 0.0118392220398894,
			 0.0269216984351813, -0.0352858859414991, 0.0362685535630254,
			 16, 16, 0.000491333810763175, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978526354634241, 0.0182540189689547,
			 0.0269164731119653, -0.0123492944403112, 0.0126928394375992,
			 16, 50, 0.000171772498643997, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978548971476218, 0.00638841684730932,
			 0.0268881168448399, -0.0236817447456158, 0.0243415919798011,
			 16, 50, 0.000329923617092674, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.97851542686476, 0.0122510763218658,
			 0.0269301740046973, -0.0360751025278085, 0.0370801534525901,
			 50, 50, 0.000502525462390794, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978517827194803, 0.0186623980229836,
			 0.0269271645461591, -0.0133339953723917, 0.0137037770367371,
			 16, 84, 0.000184890832172701, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978614933218135, 0.00689751766420184,
			 0.0268054162633444, -0.024633117592334, 0.0253192014935767,
			 84, 84, 0.000343041950621378, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978523808143225, 0.0127431727011129,
			 0.0269196658216378, -0.0370127377023331, 0.0380440252941721,
			 16, 84, 0.000515643795919498, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.978515481591739, 0.0191474852570107,
			 0.0269301053897247, -0.0479956090770471, 0.0270676941348684,
			 16, 16, -0.0104639574710893, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.584760150171644, 0.0191491537099675,
			 -0.546444904541274, -0.0783489985647563, 0.036809826325082,
			 50, 16, -0.0207695861198371, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.479577311935404, 0.0293777910712126,
			 -0.70698256616677, -0.131957105528563, 0.0679233655718944, 50,
			 16, -0.0320168699783341, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.530073134036529, 0.0509908530659463,
			 -0.627894378172626, -0.062405342445672, 0.0400188604472278,
			 50, 50, -0.0111932409992221, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.668372930948188, 0.0261291033153693,
			 -0.428382132525696, -0.0663380642056765, 0.0233403249097366,
			 84, 50, -0.0214988696479699, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.347352938467209, 0.0228775604610046,
			 -0.939736108865948, -0.10977969947698, 0.0442873924640466, 50,
			 50, -0.0327461535064669, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.40475440807355, 0.0393035517887799,
			 -0.833160160243201, -0.100394137136379, 0.0762979906706411,
			 16, 84, -0.0120480732328691, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.789247888198826, 0.0450753506698963,
			 -0.267287398851351, -0.0874718677911327, 0.0427644640278989,
			 50, 84, -0.0223537018816169, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.501065269071811, 0.0332241645372872,
			 -0.672814567136203, -0.103898091156631, 0.0366961196764037,
			 50, 84, -0.0336009857401138, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.348843927927802, 0.0358665291663582,
			 -0.936834048933583))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.148356110863549, 0.123839734393424, -0.0122581882350625, "contGamma",
			 "<unicode>", 0.859876190110688, "contNormal", 0.0694389915845444,
			 -0.176531772068403, -2.55321984432208, 2.46854646043187, -0.0423366919451033,
			 "debCollin1", "<unicode>", 0.973636714992508, "contNormal",
			 1.28108637310813, -0.0330474922173962, -3.22917805884669, 0.713616028031939,
			 -1.25778101540738, "contcor1", "<unicode>", 0.211121864977928,
			 "contNormal", 1.00583330050422, -1.25048655157556, -0.561889656077529,
			 0.465447646830435, -0.0482210046235471, "contcor2", "<unicode>",
			 0.854018952211112, "contNormal", 0.262080658372161, -0.183992992550683,
			 -0.538518222229429, 4.8347825507238, 2.14813216424718, "debCollin1:contcor1",
			 "<unicode>", 0.117090287948059, "contNormal", 1.37076518123219,
			 1.56710441267279, -0.194609303174406, 0.312695348413172, 0.059043022619383,
			 "contGamma:contcor1", "<unicode>", 0.648229137840698, "contNormal",
			 0.129416830000228, 0.456223681412063, -0.283640868798273, 0.177030301654979,
			 -0.0533052835716469, "contGamma:contcor2", "<unicode>", 0.65012858452128,
			 "contNormal", 0.11752031519124, -0.453583565402318, -0.0199697707344392,
			 0.000908024496093666, -0.00953087311917277, "contGamma", "<unicode>",
			 0.073538014992182, "debCollin1", 0.00532606603876762, -1.7894770830476,
			 -0.03369936994822, 0.0420650584706457, 0.00418284426121286,
			 "contcor1", "<unicode>", 0.828665412433239, "debCollin1", 0.019328015467755,
			 0.216413540655072, -0.0310212719488902, 0.0494311739646223,
			 0.00920495100786601, "contcor2", "<unicode>", 0.653793974342891,
			 "debCollin1", 0.0205239602737885, 0.448497798917581, -0.0233912588407908,
			 0.0139844640931809, -0.00470339737380497, "contGamma:contcor1",
			 "<unicode>", 0.621809421794095, "debCollin1", 0.00953479840159989,
			 -0.493287553202568, -0.0182406244438115, 0.0175607516821871,
			 -0.000339936380812209, "contGamma:contcor2", "<unicode>", 0.970309616298351,
			 "debCollin1", 0.00913317193795277, -0.0372199694828483))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.199820128355262, 0.178989951999227, 16, 16, -0.0104150881780174,
			 "Total", 0.91417388330545, 0.0966370003077848, -0.107775367042083,
			 -0.211760348111601, 0.305962511864458, 16, 16, 0.0471010818764283,
			 "Total", 0.721372655729221, 0.132074585058652, 0.356624871132562,
			 -0.380377181245113, 0.600122523993563, 16, 16, 0.109872671374225,
			 "Total", 0.660474146499076, 0.250132072061715, 0.439258630325169,
			 -0.336654116677004, 0.214138781379696, 50, 16, -0.0612576676486542,
			 "Total", 0.662863152541978, 0.140510974283529, -0.435963581926676,
			 -0.143479419512, 0.135996424323583, 16, 16, -0.00374149759420849,
			 "Total", 0.958147631525634, 0.0712961682051436, -0.0524782423571897,
			 -0.253091968383913, 0.37115215219109, 16, 16, 0.0590300919035885,
			 "Total", 0.710877203882329, 0.159248875361731, 0.37067823411313,
			 -0.616414840300433, 0.374708890936922, 84, 50, -0.120852974681755,
			 "Total", 0.632666138738255, 0.252842332577336, -0.477977613360257,
			 -0.357884726626443, 0.231211117371824, 16, 16, -0.0633368046273098,
			 "Total", 0.673424942744231, 0.150282313513151, -0.421452153261982,
			 -0.23030220047066, 0.229171770211634, 16, 50, -0.000565215129512757,
			 "Total", 0.996152582376356, 0.117214901474355, -0.00482204158689173,
			 -0.191237019984634, 0.189898589448089, 16, 16, -0.000669215268272301,
			 "Total", 0.99450837297704, 0.0972302584228772, -0.00688278812714584,
			 -0.205841902301918, 0.319535811874265, 16, 50, 0.0568469547861734,
			 "Total", 0.671460572261956, 0.134027389870502, 0.424144309913812,
			 -0.374382992521046, 0.613620081088987, 16, 16, 0.11961854428397,
			 "Total", 0.635079452719831, 0.252046231819379, 0.474589694995683,
			 -0.326499004709156, 0.223475415231338, 50, 84, -0.0515117947389091,
			 "Total", 0.713507924104113, 0.140302175008985, -0.367148939320507,
			 -0.138411084676215, 0.150419835307288, 16, 16, 0.00600437531553658,
			 "Total", 0.935052588213884, 0.0736827110757558, 0.081489608998823,
			 -0.248155768294091, 0.385707697920758, 16, 84, 0.0687759648133336,
			 "Total", 0.670601094582292, 0.161702835157861, 0.425323184631807,
			 -0.605651771602735, 0.383437568058715, 84, 16, -0.11110710177201,
			 "Total", 0.659693629857825, 0.252323345597996, -0.440336194451969,
			 -0.349066350169684, 0.241884486734555, 16, 84, -0.0535909317175647,
			 "Total", 0.722228265411133, 0.150755534684715, -0.355482349816496,
			 -0.225388589263623, 0.243749904824087, 16, 16, 0.00918065778023232,
			 "Total", 0.938854413069707, 0.119680386422458, 0.0767097939325297,
			 -0.191987676265077, 0.211922008953521, 16, 16, 0.00996716634422229,
			 "Total", 0.922940047632191, 0.103040078390365, 0.0967309662407469,
			 -0.206690897559989, 0.341657570357325, 16, 16, 0.067483336398668,
			 "Total", 0.629513380224086, 0.139887383707715, 0.482411884546141,
			 -0.371795871716408, 0.632305723509338, 16, 16, 0.130254925896465,
			 "Total", 0.611099760373786, 0.256153073001844, 0.508504248533952,
			 -0.322583821753361, 0.240832995500532, 50, 16, -0.0408754131264146,
			 "Total", 0.776113471212168, 0.143731421010298, -0.284387455708005,
			 -0.145513156370941, 0.178794670227003, 16, 16, 0.0166407569280312,
			 "Total", 0.840590811950387, 0.0827331086581291, 0.201137817712064,
			 -0.248818060534667, 0.407642753386324, 16, 16, 0.0794123464258282,
			 "Total", 0.635360595499188, 0.1674675706031, 0.474195368929284,
			 -0.597927004365996, 0.396985564046965, 84, 50, -0.100470720159516,
			 "Total", 0.69221431984549, 0.253808890433882, -0.39585185525914,
			 -0.346088929246777, 0.260179829036637, 16, 16, -0.0429545501050701,
			 "Total", 0.781219983952832, 0.154663239494599, -0.27772953835336,
			 -0.228091957330525, 0.267726036115979, 16, 50, 0.0198170393927269,
			 "Total", 0.875502448720647, 0.126486506220893, 0.156673150241963,
			 -0.201751560621251, 0.182300728470718, 16, 16, -0.00972541607526639,
			 "Total", 0.920927908413864, 0.0979743230287202, -0.0992649479437125,
			 -0.213205428368743, 0.308786936327102, 50, 50, 0.0477907539791793,
			 "Total", 0.719679568704928, 0.133163764439871, 0.358887075475843,
			 -0.38094018170599, 0.602064868659942, 16, 16, 0.110562343476976,
			 "Total", 0.659293130012954, 0.250771202460798, 0.440889314211667,
			 -0.337688493519602, 0.216552502427796, 50, 84, -0.0605679955459032,
			 "Total", 0.668379182685427, 0.141390607255843, -0.42837354419383,
			 -0.146541370064432, 0.140437719081517, 50, 16, -0.00305182549145751,
			 "Total", 0.966749220786309, 0.0732102965691214, -0.0416857414117443,
			 -0.254291048070535, 0.373730576083214, 16, 84, 0.0597197640063395,
			 "Total", 0.70933201516321, 0.16021254194146, 0.372753364266328,
			 -0.616629613398818, 0.376303008240809, 84, 16, -0.120163302579004,
			 "Total", 0.635225998726864, 0.253303792690007, -0.474384142862244,
			 -0.358899912760745, 0.233605647711628, 50, 84, -0.0626471325245588,
			 "Total", 0.678534298952121, 0.151152155127844, -0.414464037721274,
			 -0.232052977073458, 0.232301891019935, 16, 16, 0.000124456973238228,
			 "Total", 0.999161723482988, 0.118460051244861, 0.0010506240030318,
			 -0.187211465397309, 0.187252379066266, 16, 16, 2.04568344786826e-05,
			 "Total", 0.999829137528398, 0.0955282462885283, 0.000214144352832522,
			 -0.202953558082669, 0.318026811860518, 50, 16, 0.0575366268889244,
			 "Total", 0.665077615394549, 0.132905597769299, 0.432913495402938,
			 -0.372649455424168, 0.613265888197611, 16, 16, 0.120308216386721,
			 "Total", 0.632410542889883, 0.251513637852163, 0.478336751096723,
			 -0.323421582412827, 0.221777337140511, 50, 16, -0.0508221226361582,
			 "Total", 0.714808221316914, 0.139083912728448, -0.365406189969541,
			 -0.133514087966329, 0.146902182802904, 50, 16, 0.00669404741828757,
			 "Total", 0.925446114694946, 0.0715360774435451, 0.0935758243603779,
			 -0.245761688354243, 0.384692962186412, 16, 16, 0.0694656369160846,
			 "Total", 0.665806106026422, 0.160833223343286, 0.431910991224839,
			 -0.603582309952819, 0.3827474506143, 84, 50, -0.110417429669259,
			 "Total", 0.660786717782692, 0.251619358403308, -0.438827244334185,
			 -0.346248984877279, 0.240446465647651, 50, 16, -0.0529012596148137,
			 "Total", 0.723749037003232, 0.149669956987146, -0.353452761527532,
			 -0.222271746589886, 0.242012406355853, 16, 50, 0.0098703298829833,
			 "Total", 0.933585406940346, 0.11844201133489, 0.0833347033855692,
			 -0.181850012582247, 0.203163689476194, 16, 16, 0.0106568384469733,
			 "Total", 0.913598972526514, 0.098219585945298, 0.108500136142993,
			 -0.199323974896051, 0.335669991898889, 50, 50, 0.068173008501419,
			 "Total", 0.617422188985766, 0.13648056061614, 0.499507096055677,
			 -0.367611493074656, 0.629500689073088, 16, 16, 0.130944597999216,
			 "Total", 0.606706774625968, 0.254370026697643, 0.514779982921743,
			 -0.315114008115429, 0.234742526068102, 50, 84, -0.0401857410236636,
			 "Total", 0.774507291922857, 0.140272101559194, -0.286484201612288,
			 -0.133101656885804, 0.167762514947369, 50, 16, 0.0173304290307822,
			 "Total", 0.821359811843132, 0.0767524745878881, 0.225796355411803,
			 -0.242684548620217, 0.402888585677375, 16, 84, 0.0801020185285792,
			 "Total", 0.626697458645379, 0.164690050273829, 0.486380436434344,
			 -0.593373337416393, 0.393811241302863, 84, 16, -0.0997810480567648,
			 "Total", 0.69194853129799, 0.25183742826553, -0.396212146637547,
			 -0.33920096802251, 0.254671212017871, 50, 84, -0.0422648780023191,
			 "Total", 0.780264287095824, 0.151500788974892, -0.278974639592957,
			 -0.220033321343937, 0.261046744334893, 16, 16, 0.0205067114954779,
			 "Total", 0.867297330857672, 0.122726761683768, 0.167092419079043,
			 -0.212404766487866, 0.194570737463514, 16, 16, -0.00891701451217602,
			 "Total", 0.931555953841219, 0.103822189377343, -0.0858873672926216,
			 -0.221180689490191, 0.31837900057473, 84, 50, 0.0485991555422697,
			 "Total", 0.724032004034599, 0.137645307342609, 0.353075280810721,
			 -0.38499364062908, 0.607735130709213, 16, 16, 0.111370745040067,
			 "Total", 0.660108829677305, 0.253251789106538, 0.439762915132716,
			 -0.344844957121507, 0.225325769155882, 50, 50, -0.0597595939828129,
			 "Total", 0.68118424956696, 0.145454388645614, -0.410847651550835,
			 -0.160976142203818, 0.156489294347084, 84, 16, -0.00224342392836713,
			 "Total", 0.977900751377417, 0.0809875689183652, -0.0277008429605843,
			 -0.260953295893687, 0.382009627032547, 16, 50, 0.0605281655694299,
			 "Total", 0.712112966569261, 0.164024167790287, 0.369019799855459,
			 -0.620245942134937, 0.381536140103109, 84, 50, -0.119354901015914,
			 "Total", 0.640478179685459, 0.255561349631926, -0.467030328286402,
			 -0.36566052027645, 0.241983058353513, 84, 50, -0.0618387309614684,
			 "Total", 0.689949490597502, 0.155013965415431, -0.398923611790353,
			 -0.241118880270324, 0.242984597342981, 16, 50, 0.000932858536328603,
			 "Total", 0.993973133025688, 0.123498054411166, 0.00755362941364899,
			 -0.191368625856201, 0.19302634265134, 16, 50, 0.000828858397569063,
			 "Total", 0.993256030081505, 0.098061742853338, 0.00845241348411184,
			 -0.205980810784386, 0.322670867688415, 84, 50, 0.0583450284520148,
			 "Total", 0.665286706785741, 0.134862600191314, 0.432625712163694,
			 -0.374020729189983, 0.616253965089606, 16, 50, 0.121116617949812,
			 "Total", 0.631632021826146, 0.252625737536697, 0.479431031575783,
			 -0.325947072781784, 0.225919630635648, 50, 84, -0.0500137210730678,
			 "Total", 0.722402937300884, 0.14078490925611, -0.355249162266993,
			 -0.139521368522212, 0.154526266484968, 84, 50, 0.00750244898137795,
			 "Total", 0.92033272633349, 0.0750135301787661, 0.100014610210968,
			 -0.24826428228665, 0.388812359245, 16, 84, 0.0702740384791749,
			 "Total", 0.66545387867928, 0.162522537800906, 0.432395650659002,
			 -0.604559017171028, 0.38534096095869, 84, 50, -0.109609028106169,
			 "Total", 0.664256967497614, 0.252530144925602, -0.434043342185786,
			 -0.348649282729209, 0.244463566625762, 84, 84, -0.0520928580517233,
			 "Total", 0.730631464392083, 0.151307078607916, -0.344285664167189,
			 -0.225802731429762, 0.247160194321909, 16, 50, 0.0106787314460737,
			 "Total", 0.929474849533979, 0.120656024672479, 0.088505580016092,
			 -0.178407778430422, 0.201338258450549, 16, 16, 0.0114652400100637,
			 "Total", 0.905790400888411, 0.0968757691152386, 0.118349925009887,
			 -0.196869006779032, 0.334831826908051, 84, 50, 0.0689814100645094,
			 "Total", 0.611060167995812, 0.135640460202604, 0.508560719725317,
			 -0.366062927734045, 0.629568926858658, 16, 16, 0.131752999562306,
			 "Total", 0.603950329874417, 0.253992385178024, 0.518728147971682,
			 -0.312366526697726, 0.23361184777658, 50, 50, -0.0393773394605732,
			 "Total", 0.777395235156135, 0.139282756923319, -0.282715106524291,
			 -0.129157772714416, 0.165435433902161, 84, 16, 0.0181388305938725,
			 "Total", 0.809276393205683, 0.0751527091671814, 0.241359636863146,
			 -0.240645731021285, 0.402466571204624, 16, 50, 0.0809104200916695,
			 "Total", 0.621893215388871, 0.164062275454727, 0.493168949823549,
			 -0.591421665005369, 0.39347637201802, 84, 50, -0.0989726464936744,
			 "Total", 0.693644144165677, 0.251254116094005, -0.393914527778899,
			 -0.336706644677886, 0.253793691799428, 84, 50, -0.0414564764392287,
			 "Total", 0.783161664701663, 0.150640608994631, -0.275201200499039,
			 -0.217435470607299, 0.260065696724436, 16, 50, 0.0213151130585683,
			 "Total", 0.861094437852214, 0.121813760634941, 0.17498115933262,
			 -0.209231828298439, 0.168931609601813, 16, 50, -0.0201501093483127,
			 "Total", 0.834549765552654, 0.0964720374667997, -0.208869946954808,
			 -0.217267023834385, 0.291999145246651, 16, 50, 0.037366060706133,
			 "Total", 0.773641946705648, 0.129917226310805, 0.287614366217617,
			 -0.385596450081619, 0.585871750489479, 16, 50, 0.10013765020393,
			 "Total", 0.686167890813802, 0.247828074452877, 0.40406096212062,
			 -0.347492840504814, 0.205507462866915, 50, 84, -0.0709926888189496,
			 "Total", 0.614802722605252, 0.141074098231836, -0.503229789938354,
			 -0.147964277231079, 0.121011239702071, 16, 50, -0.0134765187645038,
			 "Total", 0.844296539615131, 0.0686174641612792, -0.19640071123626,
			 -0.256881971602239, 0.355472113068825, 16, 84, 0.0492950707332932,
			 "Total", 0.752338149621837, 0.156215647200978, 0.315557830579372,
			 -0.627627356130708, 0.366451364426606, 84, 50, -0.130587995852051,
			 "Total", 0.606591685596005, 0.253596170235392, -0.514944668647152,
			 -0.366629625856368, 0.220485974261158, 16, 84, -0.0730718257976051,
			 "Total", 0.625641676839449, 0.149777139975178, -0.487870350640393,
			 -0.23381917606718, 0.213218703467564, 16, 50, -0.0103002362998081,
			 "Total", 0.928033419645213, 0.114042370946844, -0.0903193805450529,
			 -0.209677390898114, 0.169693474438386, 16, 16, -0.0199919582298641,
			 "Total", 0.836344874988227, 0.0967800603299167, -0.206571045334264,
			 -0.216647370105554, 0.291695793754718, 16, 50, 0.0375242118245817,
			 "Total", 0.77230886762512, 0.129681761468583, 0.289356123788251,
			 -0.384675301147904, 0.585266903792662, 16, 16, 0.100295801322379,
			 "Total", 0.685230681732428, 0.247438782699924, 0.405335817724299,
			 -0.34784424446656, 0.206175169065558, 50, 50, -0.0708345377005009,
			 "Total", 0.616240846463319, 0.141334080090796, -0.501185118656416,
			 -0.147129874365465, 0.120493139073355, 16, 16, -0.0133183676460552,
			 "Total", 0.84533282231797, 0.0682724314196068, -0.195076802878157,
			 -0.255599416457238, 0.354505860160722, 16, 50, 0.0494532218517418,
			 "Total", 0.750684383830219, 0.155641961135611, 0.317737077398127,
			 -0.627815746493913, 0.366956057026709, 84, 50, -0.130429844733602,
			 "Total", 0.607278073196956, 0.253772980362715, -0.513962694323014,
			 -0.36626893706912, 0.220441587710807, 16, 50, -0.0729136746791564,
			 "Total", 0.626151648293063, 0.149673802531022, -0.487150546362608,
			 -0.232259201055067, 0.211975030692348, 16, 50, -0.0101420851813594,
			 "Total", 0.928689420092281, 0.113327141532058, -0.0894938762616757,
			 -0.210956341303093, 0.171317628533961, 16, 50, -0.0198193563845659,
			 "Total", 0.838953403854226, 0.097520661821437, -0.203232381880834,
			 -0.216567115016145, 0.291960742355905, 16, 50, 0.0376968136698798,
			 "Total", 0.77137140066755, 0.129728878026141, 0.290581513102147,
			 -0.383981668627706, 0.584918474963059, 16, 50, 0.100468403167677,
			 "Total", 0.684397248302621, 0.247172945838119, 0.406470064217613,
			 -0.34877237311188, 0.207448501401475, 50, 84, -0.0706619358552028,
			 "Total", 0.618494555788581, 0.141895687599557, -0.497985083624371,
			 -0.14734981094017, 0.121058279338655, 16, 50, -0.013145765800757,
			 "Total", 0.847753582090293, 0.068472709803852, -0.191985476234468,
			 -0.254693528303219, 0.353945175697299, 16, 84, 0.04962582369704,
			 "Total", 0.749260706621122, 0.155267828593123, 0.319614334448405,
			 -0.628325567121582, 0.367811081344974, 84, 50, -0.130257242888304,
			 "Total", 0.608245647624366, 0.25412116149173, -0.512579283534178,
			 -0.366391884239671, 0.220909738571954, 16, 84, -0.0727410728338583,
			 "Total", 0.627315882752248, 0.149824595616089, -0.485508220694619,
			 -0.231232791846052, 0.211293825173929, 16, 50, -0.00996948333606131,
			 "Total", 0.929630055851967, 0.112891517525469, -0.0883102960664176,
			 -0.209241079606187, 0.168963244212817, 16, 16, -0.0201389176966851,
			 "Total", 0.834657949583599, 0.0964824677397725, -0.208731370252705,
			 -0.217206604960576, 0.291961109676097, 50, 84, 0.0373772523577606,
			 "Total", 0.773533411964947, 0.129892109919601, 0.287756141469223,
			 -0.385522604097591, 0.585820287808706, 16, 16, 0.100148841855558,
			 "Total", 0.686096350462307, 0.247796107369351, 0.404158253003875,
			 -0.347502458979315, 0.205539464644671, 50, 84, -0.070981497167322,
			 "Total", 0.614885113657673, 0.141084715838227, -0.503112592640523,
			 -0.147873909737795, 0.120943255512042, 50, 16, -0.0134653271128762,
			 "Total", 0.844333719051871, 0.0685770675814026, -0.196353206513133,
			 -0.256777542689368, 0.35539006745921, 16, 84, 0.0493062623849208,
			 "Total", 0.752210780284356, 0.156168076295605, 0.315725617901515,
			 -0.627632195089656, 0.36647858668881, 84, 50, -0.130576804200423,
			 "Total", 0.606634130570832, 0.253604349268631, -0.514883930725137,
			 -0.366589711731016, 0.220468443439061, 50, 84, -0.0730606341459775,
			 "Total", 0.625660795753168, 0.149762485382568, -0.487843360500759,
			 -0.233690160171041, 0.21311207087468, 16, 50, -0.0102890446481805,
			 "Total", 0.928073590386722, 0.113982255431743, -0.0902688283295288,
			 -0.209734387159345, 0.169772854002872, 16, 84, -0.0199807665782364,
			 "Total", 0.836493142784512, 0.0968148507206567, -0.206381215583213,
			 -0.216622554661477, 0.291693361613895, 50, 50, 0.0375354034762093,
			 "Total", 0.772230961990398, 0.12967481042634, 0.289457939848161,
			 -0.384620062803084, 0.585234048751097, 16, 84, 0.100306992974006,
			 "Total", 0.685170378292371, 0.247416309484324, 0.405417869109238,
			 -0.347886566345482, 0.206239874247736, 50, 84, -0.0708233460488733,
			 "Total", 0.61636468584301, 0.14136138341421, -0.501009146474963,
			 -0.14710691887826, 0.120492566889405, 50, 84, -0.0133071759944275,
			 "Total", 0.845447737501585, 0.0682664293523899, -0.194930013487833,
			 -0.255524387232126, 0.354453214238865, 16, 84, 0.0494644135033694,
			 "Total", 0.750579373993922, 0.155609390346562, 0.317875504770027,
			 -0.627838810670239, 0.36700150450629, 84, 84, -0.130418653081975,
			 "Total", 0.607333653006887, 0.253790458147115, -0.513883201260367,
			 -0.366259925994044, 0.220454959938987, 50, 84, -0.0729024830275288,
			 "Total", 0.626207200266339, 0.149674915090523, -0.487072152226962,
			 -0.232170297928068, 0.211908510868604, 16, 84, -0.0101308935297318,
			 "Total", 0.928743036710399, 0.113287492091566, -0.0894264083588625,
			 -0.211064588948515, 0.171448259482638, 16, 16, -0.0198081647329383,
			 "Total", 0.839142243817629, 0.0975816013580774, -0.202990773437422,
			 -0.216581238842667, 0.291997249485682, 50, 84, 0.0377080053215074,
			 "Total", 0.771327547444953, 0.129741794323761, 0.29063884554741,
			 -0.383946819508849, 0.584906009147458, 16, 16, 0.100479594819304,
			 "Total", 0.684349402157561, 0.247160875479982, 0.406535195443756,
			 -0.348850070860731, 0.207548582453581, 50, 84, -0.0706507442035752,
			 "Total", 0.618662290516777, 0.141941040167859, -0.497747121762839,
			 -0.147400642982352, 0.121131494684093, 50, 16, -0.0131345741491294,
			 "Total", 0.84795102790528, 0.068504355127082, -0.191733417893849,
			 -0.254650881353698, 0.353924912051033, 16, 84, 0.0496370153486676,
			 "Total", 0.749181005634325, 0.155251779676846, 0.319719461200292,
			 -0.628368459036855, 0.367876356563502, 84, 50, -0.130246051236676,
			 "Total", 0.608315397893909, 0.254148755655361, -0.512479594483227,
			 -0.366416581688307, 0.220956819323846, 50, 84, -0.0727298811822307,
			 "Total", 0.627410929220809, 0.149842906718001, -0.485374201390166,
			 -0.231188342258913, 0.211271758890045, 16, 50, -0.00995829168443369,
			 "Total", 0.929698308097091, 0.112874548879221, -0.088224420680426,
			 -0.209258723320753, 0.16900712459444, 16, 84, -0.0201257993631564,
			 "Total", 0.834790586322185, 0.0964981629506731, -0.208561476693024,
			 -0.217140827352741, 0.291921568735319, 84, 50, 0.0373903706912893,
			 "Total", 0.773410511217103, 0.129865242449218, 0.287916689532307,
			 -0.385438684421368, 0.58576260479954, 16, 84, 0.100161960189086,
			 "Total", 0.686014089780522, 0.24775998357154, 0.404270127666378,
			 -0.347518383559955, 0.205581625892368, 50, 84, -0.0709683788337933,
			 "Total", 0.614987625435515, 0.141099533923864, -0.502966784228267,
			 -0.147777504091113, 0.120873086532418, 84, 84, -0.0134522087793475,
			 "Total", 0.844388242552117, 0.0685345732734411, -0.196283541821666,
			 -0.256659304596932, 0.355298066033831, 16, 84, 0.0493193807184495,
			 "Total", 0.752064660651211, 0.156114442780022, 0.315918116480386,
			 -0.627640454708593, 0.366513082974804, 84, 84, -0.130563685866894,
			 "Total", 0.606685753702726, 0.25361525658766, -0.514810061601188,
			 -0.366547306242906, 0.220452274618008, 84, 84, -0.0730475158124488,
			 "Total", 0.625688368010361, 0.149747542682185, -0.48780443741558,
			 -0.233544617072844, 0.212992764443541, 16, 84, -0.0102759263146518,
			 "Total", 0.928122555610591, 0.113914690534779, -0.0902072091528395,
			 -0.209807941571952, 0.169872645082537, 16, 16, -0.0199676482447077,
			 "Total", 0.836672529534231, 0.0968590723220839, -0.206151553654258,
			 -0.216598528569361, 0.291695572188837, 84, 84, 0.037548521809738,
			 "Total", 0.772144049402659, 0.129669245141124, 0.289571530773334,
			 -0.384557963281878, 0.585198185896947, 16, 16, 0.100320111307535,
			 "Total", 0.685101309703915, 0.247391318623234, 0.405511850075539,
			 -0.347940803427895, 0.206320347997206, 50, 84, -0.0708102277153446,
			 "Total", 0.616515685795548, 0.14139574905382, -0.500794600892788,
			 -0.147089626474539, 0.120501511152741, 84, 16, -0.0132940576608988,
			 "Total", 0.84559342297541, 0.0682642996856077, -0.194743925040245,
			 -0.255440643865506, 0.354395707539302, 16, 84, 0.0494775318368982,
			 "Total", 0.750459561087323, 0.155573356504283, 0.318033453469497,
			 -0.627868428687503, 0.367057359190611, 84, 50, -0.130405534748446,
			 "Total", 0.607400659789166, 0.253812262808389, -0.513787369079536,
			 -0.366253749205282, 0.220475019817282, 84, 84, -0.0728893646940001,
			 "Total", 0.626277476465625, 0.149678456760075, -0.486972983766377,
			 -0.232071851803547, 0.211836301411141, 16, 50, -0.0101177751962031,
			 "Total", 0.928807775130669, 0.113243956704353, -0.0893449459967008,
			 -0.211198098807667, 0.171608006008847, 16, 84, -0.0197950463994096,
			 "Total", 0.839368790975999, 0.0976564130351475, -0.202700936724813,
			 -0.216602849752506, 0.292045097062578, 84, 50, 0.0377211236550361,
			 "Total", 0.77128057686247, 0.129759513651076, 0.2907002545992,
			 -0.383908625524369, 0.584894051830035, 16, 84, 0.100492713152833,
			 "Total", 0.684294951615252, 0.247148081545425, 0.406609319095049,
			 -0.348945731261664, 0.207670479521571, 50, 84, -0.0706376258700465,
			 "Total", 0.618864570436634, 0.141996540542008, -0.497460188821636,
			 -0.147469766184016, 0.121226854552815, 84, 84, -0.0131214558156007,
			 "Total", 0.848192894462618, 0.0685463158650556, -0.191424668853574,
			 -0.254605117052594, 0.353905384416986, 16, 84, 0.0496501336821963,
			 "Total", 0.749090932917983, 0.155235123264875, 0.31983827266642,
			 -0.628421309969764, 0.367955444163469, 84, 84, -0.130232932903148,
			 "Total", 0.608398994281221, 0.254182414062841, -0.512360122879903,
			 -0.366449905395659, 0.221016379698255, 84, 84, -0.072716762848702,
			 "Total", 0.627527441983592, 0.149866602072225, -0.485209925648795,
			 -0.231142050622652, 0.211251703920842, 16, 84, -0.00994517335090499,
			 "Total", 0.929780176710727, 0.112857623413756, -0.0881214139557432,
			 -0.225856918021415, 0.164307622688578, 16, 16, -0.0307746476664184,
			 "Total", 0.757178115885518, 0.0995335995425327, -0.309188533398391,
			 -0.228027262764515, 0.28151030754057, 16, 16, 0.0267415223880273,
			 "Total", 0.837005384282006, 0.129986462589173, 0.205725441368035,
			 -0.393773921389764, 0.572800145161413, 16, 16, 0.0895131118858243,
			 "Total", 0.716590536750499, 0.246579547934398, 0.363019206725283,
			 -0.36367373159656, 0.20043927732245, 50, 16, -0.0816172271370553,
			 "Total", 0.570615937924698, 0.143909024188368, -0.567144608181231,
			 -0.161776128837562, 0.113574014672343, 16, 16, -0.0241010570826096,
			 "Total", 0.731518385783903, 0.070243674292444, -0.343106440905556,
			 -0.264927003255518, 0.342268068085893, 16, 16, 0.0386705324151874,
			 "Total", 0.802858726115519, 0.154899548188357, 0.249649097543941,
			 -0.642298797127512, 0.359873728787199, 84, 50, -0.141212534170157,
			 "Total", 0.580713386907698, 0.255660954440929, -0.552342982834261,
			 -0.380309630193697, 0.212916901962275, 16, 16, -0.0836963641157108,
			 "Total", 0.58022942111556, 0.151336079855362, -0.553049637572898,
			 -0.243013896997789, 0.201164347761962, 16, 50, -0.0209247746179138,
			 "Total", 0.853492799980983, 0.113312858874799, -0.184663725067902,
			 -0.243091717008395, 0.160931164378062, 16, 16, -0.0410802763151662,
			 "Total", 0.690209478820056, 0.103068955494422, -0.398570802605926,
			 -0.238501248137271, 0.27137303561583, 16, 50, 0.0164358937392795,
			 "Total", 0.899447266288663, 0.130072360455326, 0.126359617690835,
			 -0.401149547581743, 0.559564514055896, 16, 16, 0.0792074832370765,
			 "Total", 0.746555727487338, 0.245084621252132, 0.323184224421781,
			 -0.380275141979652, 0.196429430408046, 50, 84, -0.0919228557858031,
			 "Total", 0.532095550960436, 0.147121216751091, -0.62481032862394,
			 -0.175402703703583, 0.106589332240869, 16, 16, -0.0344066857313574,
			 "Total", 0.632449468716661, 0.0719380657422201, -0.478282052434505,
			 -0.271947639213851, 0.32867744674673, 16, 84, 0.0283649037664396,
			 "Total", 0.853134048289613, 0.153223500711808, 0.185121105017631,
			 -0.657149251939001, 0.354112926301193, 84, 16, -0.151518162818904,
			 "Total", 0.556984972253094, 0.257979785908542, -0.587325717343683,
			 -0.393817048139678, 0.20581306261076, 16, 84, -0.0940019927644586,
			 "Total", 0.538875787733626, 0.152969675841047, -0.614513904456053,
			 -0.251057435727024, 0.188596629193701, 16, 16, -0.0312304032666616,
			 "Total", 0.780668239351981, 0.11215871015709, -0.278448309747145,
			 -0.272334921289591, 0.167679800942265, 16, 16, -0.0523275601736632,
			 "Total", 0.641096092559497, 0.112250716263828, -0.466166826505367,
			 -0.258777810686485, 0.26915503044805, 16, 16, 0.00518860988078254,
			 "Total", 0.969268549005675, 0.134679219949653, 0.0385256900264362,
			 -0.413966226119849, 0.549886624877008, 16, 16, 0.0679601993785795,
			 "Total", 0.782248698417789, 0.245885347536895, 0.276389789222321,
			 -0.405920890737509, 0.199580611448909, 50, 16, -0.1031701396443,
			 "Total", 0.504192089941141, 0.154467507301802, -0.667908361094506,
			 -0.205283420265403, 0.113975481085694, 16, 16, -0.0456539695898543,
			 "Total", 0.575104996239524, 0.0814450938561553, -0.560549045108676,
			 -0.287208168627881, 0.321443408443766, 16, 16, 0.0171176199079427,
			 "Total", 0.912216320640131, 0.155271112600184, 0.110243429194842,
			 -0.677787668214148, 0.352256774859345, 84, 50, -0.162765446677401,
			 "Total", 0.535640541530966, 0.262771268043278, -0.619418735881709,
			 -0.415998155826383, 0.205499602580472, 16, 16, -0.105249276622956,
			 "Total", 0.506798374486501, 0.158548259893843, -0.663831168462058,
			 -0.270127858121314, 0.185172483870997, 16, 50, -0.0424776871251586,
			 "Total", 0.714578884204897, 0.116150180713437, -0.365713482874025,
			 -0.229824194919046, 0.166816332529944, 16, 16, -0.0315039311945512,
			 "Total", 0.755536260547488, 0.101185667333084, -0.311347763224671,
			 -0.230877480121006, 0.282901957840795, 50, 50, 0.0260122388598945,
			 "Total", 0.842682991996057, 0.131068591569648, 0.198462793781315,
			 -0.395412074890745, 0.572979731606128, 16, 16, 0.0887838283576915,
			 "Total", 0.71930653635599, 0.24704326562514, 0.359385746189134,
			 -0.366756644168086, 0.20206362283771, 50, 84, -0.0823465106651881,
			 "Total", 0.570390182460824, 0.145109877398916, -0.567476950165236,
			 -0.166601412226368, 0.116940731004883, 50, 16, -0.0248303406107424,
			 "Total", 0.731391009714086, 0.0723335085409211, -0.343275766814147,
			 -0.267198387001014, 0.343080884775123, 16, 84, 0.0379412488870546,
			 "Total", 0.80746075669016, 0.155686348471182, 0.243703120149149,
			 -0.644425988320705, 0.360542352924126, 84, 16, -0.141941817698289,
			 "Total", 0.579817733330943, 0.25637418574318, -0.5536509742072,
			 -0.383078769924641, 0.214227474636954, 50, 84, -0.0844256476438436,
			 "Total", 0.579538975888024, 0.152376841940227, -0.554058258255289,
			 -0.246001909649796, 0.202693793357702, 16, 16, -0.0216540581460466,
			 "Total", 0.849955069628924, 0.114465292869347, -0.189175754529917,
			 -0.240715485186509, 0.157096365499911, 16, 16, -0.041809559843299,
			 "Total", 0.680354199023475, 0.101484479772156, -0.411979841027575,
			 -0.236402989580212, 0.267816210002506, 50, 16, 0.0157066102111467,
			 "Total", 0.902814141736664, 0.12862971043344, 0.122107172271636,
			 -0.400169168837164, 0.557125568255051, 16, 16, 0.0784781997089437,
			 "Total", 0.74794340731645, 0.244212328553798, 0.321352325550818,
			 -0.378941160153423, 0.193636881525551, 50, 16, -0.0926521393139359,
			 "Total", 0.525881113110623, 0.146068511002089, -0.634306043638733,
			 -0.171171253715866, 0.100899315196886, 50, 16, -0.0351359692594901,
			 "Total", 0.612694720988373, 0.0694070327462164, -0.506230678207541,
			 -0.27003444437125, 0.325305684847864, 16, 16, 0.0276356202383069,
			 "Total", 0.855612072882376, 0.151875272687427, 0.181962604901348,
			 -0.65677376603224, 0.352278873338165, 84, 50, -0.152247446347037,
			 "Total", 0.554222372973, 0.25741611767606, -0.591444885897276,
			 -0.392362651374345, 0.202900098789162, 50, 16, -0.0947312762925914,
			 "Total", 0.532742525649611, 0.1518555327697, -0.623824990533986,
			 -0.248323765523232, 0.184404391933643, 16, 50, -0.0319596867947944,
			 "Total", 0.772190171417789, 0.110391864562354, -0.28951125086525,
			 -0.263791595944404, 0.157677908540812, 16, 16, -0.053056843701796,
			 "Total", 0.621686483682459, 0.107519706435861, -0.493461575189902,
			 -0.251461612762821, 0.260380265468121, 50, 50, 0.00445932635264975,
			 "Total", 0.972756232001436, 0.130574307045508, 0.0341516371294666,
			 -0.41012058759812, 0.544582419299014, 16, 16, 0.0672309158504467,
			 "Total", 0.782514021653979, 0.243551160742674, 0.276044325329576,
			 -0.400080671193622, 0.192281824848757, 50, 84, -0.103899423172433,
			 "Total", 0.491736819971488, 0.151115658429149, -0.687549022070046,
			 -0.192527821775035, 0.0997613155390611, 50, 16, -0.0463832531179871,
			 "Total", 0.533907746225905, 0.074564925585275, -0.622051893083989,
			 -0.280739550822308, 0.313516223581927, 16, 84, 0.0163883363798099,
			 "Total", 0.913913633163735, 0.151598646478111, 0.108103447890454,
			 -0.674750878861802, 0.347761418450734, 84, 16, -0.163494730205534,
			 "Total", 0.530805181249243, 0.260849766979899, -0.626777367288708,
			 -0.410135075487306, 0.198177955185129, 50, 84, -0.105978560151088,
			 "Total", 0.494658239727805, 0.155184747135848, -0.682918663767356,
			 -0.261301084764905, 0.174887143458322, 16, 16, -0.0432069706532914,
			 "Total", 0.697800273697121, 0.111274551895806, -0.388291571767001,
			 -0.243506452035842, 0.178788925179446, 16, 16, -0.0323587634281982,
			 "Total", 0.763896462567946, 0.107730392126157, -0.300368009338579,
			 -0.241345184263068, 0.291659997515564, 84, 50, 0.0251574066262475,
			 "Total", 0.853215404227434, 0.135973208177015, 0.185017379258249,
			 -0.40118822475558, 0.577046217003669, 16, 16, 0.0879289961240445,
			 "Total", 0.724580067736999, 0.249554188106373, 0.352344301617429,
			 -0.376818763890915, 0.210416078093245, 50, 50, -0.083201342898835,
			 "Total", 0.578629197812557, 0.149807559377671, -0.555388147597286,
			 -0.184430208829714, 0.133059863140936, 84, 16, -0.0256851728443893,
			 "Total", 0.751148783760117, 0.0809938535797012, -0.317124963304951,
			 -0.275914904268163, 0.350087737574979, 16, 50, 0.0370864166534077,
			 "Total", 0.816360012696546, 0.159697485969378, 0.232229182746929,
			 -0.650629342804626, 0.365036042940754, 84, 50, -0.142796649931936,
			 "Total", 0.581552040625035, 0.259103073769931, -0.551119088840805,
			 -0.392487695782871, 0.22192673602789, 84, 50, -0.0852804798774906,
			 "Total", 0.586383360454582, 0.156741255619283, -0.544084450137575,
			 -0.257611472961043, 0.212593692201656, 16, 50, -0.0225088903796936,
			 "Total", 0.851152312356508, 0.119952501390744, -0.187648361799234,
			 -0.247270015233763, 0.161941231079871, 16, 50, -0.042664392076946,
			 "Total", 0.682765739311226, 0.104392542297063, -0.408691953832667,
			 -0.241347418019961, 0.27105097397496, 84, 50, 0.0148517779774997,
			 "Total", 0.909540278400494, 0.130716277451181, 0.113618428149061,
			 -0.402939595043357, 0.558186329993951, 16, 50, 0.0776233674752967,
			 "Total", 0.751558552005759, 0.245189690376595, 0.316584956553729,
			 -0.383904877556374, 0.196890934461208, 50, 84, -0.0935069715475828,
			 "Total", 0.527974740264556, 0.148164919508426, -0.631100613139841,
			 -0.179705876590429, 0.107724273604154, 84, 50, -0.0359908014931371,
			 "Total", 0.623541746380378, 0.0733253652775754, -0.490836988767704,
			 -0.274075608576096, 0.327637184585415, 16, 84, 0.0267807880046599,
			 "Total", 0.861498810518186, 0.153500982137362, 0.174466558009999,
			 -0.660051964416941, 0.353847407255573, 84, 50, -0.153102278580684,
			 "Total", 0.553902451174421, 0.258652551697384, -0.591922552381425,
			 -0.396940544331447, 0.20576832727897, 84, 84, -0.0955861085262383,
			 "Total", 0.534153823096608, 0.153755088451754, -0.621677692027941,
			 -0.25372661674206, 0.188097578685177, 16, 50, -0.0328145190284414,
			 "Total", 0.770947962171841, 0.112712325050942, -0.291135144391798,
			 -0.262446381334373, 0.154623029463488, 16, 16, -0.0539116759354429,
			 "Total", 0.612363957725945, 0.106397212930353, -0.506701956288398,
			 -0.250072462782575, 0.25728145102058, 84, 50, 0.0036044941190028,
			 "Total", 0.977782493313001, 0.12942939712288, 0.0278491146457299,
			 -0.40952265459913, 0.542274821832729, 16, 16, 0.0663760836167998,
			 "Total", 0.784571564649193, 0.24280994037123, 0.273366417846477,
			 -0.399492386130223, 0.189983875318063, 50, 50, -0.10475425540608,
			 "Total", 0.486053185677167, 0.150379360564275, -0.69659995236717,
			 -0.18966123235858, 0.0951850616553115, 84, 16, -0.047238085351634,
			 "Total", 0.515647320285841, 0.0726662061805019, -0.650069514215387,
			 -0.279372886110826, 0.310439894403152, 16, 50, 0.015533504146163,
			 "Total", 0.917775258065811, 0.15046520884219, 0.103236517369638,
			 -0.674851002119364, 0.346151877241002, 84, 50, -0.164349562439181,
			 "Total", 0.528049727306213, 0.260464704304239, -0.630985925245406,
			 -0.409354366914114, 0.195687582144643, 84, 50, -0.106833392384735,
			 "Total", 0.488843738879991, 0.15435027220685, -0.692149037752033,
			 -0.259309280513669, 0.171185674739792, 16, 50, -0.0440618028869383,
			 "Total", 0.688265155490339, 0.109822159654246, -0.401210493634967,
			 -0.0248324421649118, 0.0446236461995352, 16, 50, 0.00989560201731173,
			 "Total indirect", 0.576514585087726, 0.0177187154744444, 0.558483036289178,
			 -0.0328310165607292, 0.0721139664148428, 16, 50, 0.0196414749270568,
			 "Total indirect", 0.463160451723074, 0.0267721712754328, 0.73365266959429,
			 -0.0615347368665301, 0.122090449945633, 50, 50, 0.0302778565395514,
			 "Total indirect", 0.518049620574368, 0.0468440206709345, 0.646354777106868,
			 -0.0372063544523193, 0.0583769026924447, 50, 84, 0.0105852741200627,
			 "Total indirect", 0.664209594831128, 0.0243839320259741, 0.434108580551616,
			 -0.019308462395093, 0.0599707564547086, 16, 50, 0.0203311470298078,
			 "Total indirect", 0.314769215320925, 0.0202246621558218, 1.00526510026054,
			 -0.038176620148585, 0.10011167743319, 50, 84, 0.0309675286423024,
			 "Total indirect", 0.380048284414916, 0.0352782751807113, 0.877807332803906,
			 -0.0717265048513784, 0.0945138562176845, 84, 50, 0.0113936756831531,
			 "Total indirect", 0.78819016644809, 0.0424090346507246, 0.268661519343459,
			 -0.038417806299634, 0.0806969034854303, 16, 84, 0.0211395485928982,
			 "Total indirect", 0.486630376168662, 0.0303869639250073, 0.69567820744017,
			 -0.030397121723066, 0.0939489821338516, 50, 50, 0.0317759302053928,
			 "Total indirect", 0.316481259460305, 0.031721527751975, 1.00171500105049,
			 -0.0115357990789501, 0.0118569607729828, 16, 16, 0.000160580847016378,
			 "Total indirect", 0.978532670480156, 0.00596765043553148, 0.0269085545058532,
			 -0.022885716837691, 0.0235231807686211, 16, 50, 0.000318731965465054,
			 "Total indirect", 0.978522186939829, 0.0118392220398894, 0.0269216984351813,
			 -0.0352858859414991, 0.0362685535630254, 50, 16, 0.000491333810763175,
			 "Total indirect", 0.978526354634241, 0.0182540189689547, 0.0269164731119653,
			 -0.0123492944403112, 0.0126928394375992, 50, 50, 0.000171772498643997,
			 "Total indirect", 0.978548971476218, 0.00638841684730932, 0.0268881168448399,
			 -0.0236817447456158, 0.0243415919798011, 16, 16, 0.000329923617092674,
			 "Total indirect", 0.97851542686476, 0.0122510763218658, 0.0269301740046973,
			 -0.0360751025278085, 0.0370801534525901, 50, 50, 0.000502525462390794,
			 "Total indirect", 0.978517827194803, 0.0186623980229836, 0.0269271645461591,
			 -0.0133339953723917, 0.0137037770367371, 84, 50, 0.000184890832172701,
			 "Total indirect", 0.978614933218135, 0.00689751766420184, 0.0268054162633444,
			 -0.024633117592334, 0.0253192014935767, 16, 50, 0.000343041950621378,
			 "Total indirect", 0.978523808143225, 0.0127431727011129, 0.0269196658216378,
			 -0.0370127377023331, 0.0380440252941721, 50, 50, 0.000515643795919498,
			 "Total indirect", 0.978515481591739, 0.0191474852570107, 0.0269301053897247,
			 -0.0479956090770471, 0.0270676941348684, 16, 50, -0.0104639574710893,
			 "Total indirect", 0.584760150171644, 0.0191491537099675, -0.546444904541274,
			 -0.0783489985647563, 0.036809826325082, 16, 50, -0.0207695861198371,
			 "Total indirect", 0.479577311935404, 0.0293777910712126, -0.70698256616677,
			 -0.131957105528563, 0.0679233655718944, 50, 50, -0.0320168699783341,
			 "Total indirect", 0.530073134036529, 0.0509908530659463, -0.627894378172626,
			 -0.062405342445672, 0.0400188604472278, 50, 84, -0.0111932409992221,
			 "Total indirect", 0.668372930948188, 0.0261291033153693, -0.428382132525696,
			 -0.0663380642056765, 0.0233403249097366, 16, 50, -0.0214988696479699,
			 "Total indirect", 0.347352938467209, 0.0228775604610046, -0.939736108865948,
			 -0.10977969947698, 0.0442873924640466, 50, 84, -0.0327461535064669,
			 "Total indirect", 0.40475440807355, 0.0393035517887799, -0.833160160243201,
			 -0.100394137136379, 0.0762979906706411, 84, 50, -0.0120480732328691,
			 "Total indirect", 0.789247888198826, 0.0450753506698963, -0.267287398851351,
			 -0.0874718677911327, 0.0427644640278989, 16, 84, -0.0223537018816169,
			 "Total indirect", 0.501065269071811, 0.0332241645372872, -0.672814567136203,
			 -0.103898091156631, 0.0366961196764037, 50, 50, -0.0336009857401138,
			 "Total indirect", 0.348843927927802, 0.0358665291663582, -0.936834048933583,
			 16, 16, 50, 84, 50, 16, 50, 84, 50, 16, 50, 84, 84, 50, 50,
			 84, 50, 50, 16, 84, 50, 50, 50, 84, 50, 84, 50, 84, 50, 84,
			 84, 84, 50, 84, 50, 84, 16, 16, 50, 84, 50, 16, 50, 84, 50,
			 16, 50, 84, 84, 50, 50, 84, 50, 50, 16, 84, 84, 50, 50, 84,
			 50, 84, 84, 84, 50, 84, 84, 84, 84, 84, 50, 84, 16, 16, 84,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 84, 50, 84, 84, 50, 50,
			 16, 84, 84, 50, 50, 84, 50, 84, 84, 84, 50, 84, 84, 84, 84,
			 84, 50, 84, 16, 16, 16, 16, 50, 16, 50, 16, 16, 16, 50, 16,
			 84, 50, 16, 16, 50, 50, 16, 16, 16, 50, 50, 16, 50, 84, 16,
			 16, 50, 84, 84, 16, 16, 84, 50, 16, 16, 16, 16, 16, 50, 16,
			 50, 16, 16, 16, 50, 16, 84, 50, 16, 16, 50, 50, 16, 16, 50,
			 50, 50, 16, 50, 84, 50, 16, 50, 84, 84, 16, 50, 84, 50, 16,
			 16, 16, 50, 16, 50, 16, 50, 16, 50, 16, 50, 16, 84, 50, 50,
			 16, 50, 50, 16, 16, 50, 50, 50, 16, 50, 84, 50, 16, 50, 84,
			 84, 16, 50, 84, 50, 16, 16, 16, 84, 50, 50, 16, 50, 50, 84,
			 16, 50, 50, 84, 50, 84, 50, 50, 50, 16, 50, 84, 50, 50, 50,
			 50, 84, 84, 50, 50, 84, 84, 50, 84, 84, 50, 50, 16, 16, 84,
			 50, 50, 16, 50, 50, 84, 16, 50, 50, 84, 50, 84, 50, 50, 50,
			 16, 50, 16, 50, 50, 50, 50, 84, 16, 50, 50, 84, 84, 50, 16,
			 84, 50, 50, 16, 16, 16, 50, 50, 16, 50, 50, 16, 16, 50, 50,
			 84, 50, 16, 50, 50, 50, 16, 50, 16, 50, 50, 50, 50, 84, 16,
			 50, 50, 84, 84, 50, 16, 84, 50, 50, 16, 16, 50, 84, 50, 16,
			 50, 84, 50, 16, 50, 84, 84, 50, 50, 84, 50, 50, 16, 84, 50,
			 50, 50, 84, 50, 84, 50, 84, 50, 84, 84, 84, 50, 84, 50, 84,
			 16, 16, 50, 84, 50, 16, 50, 84, 50, 16, 50, 84, 84, 50, 50,
			 84, 50, 50, 16, 84, 84, 50, 50, 84, 50, 84, 84, 84, 50, 84,
			 84, 84, 84, 84, 50, 84, 16, 16, 84, 84, 50, 16, 50, 84, 84,
			 16, 50, 84, 84, 50, 84, 84, 50, 50, 16, 84, 84, 50, 50, 84,
			 50, 84, 84, 84, 50, 84, 84, 84, 84, 84, 50, 84, 16, 16, 16,
			 16, 84, 16, 50, 50, 16, 50, 84, 50, 84, 84, 16, 84, 84, 84,
			 16, 16, 16, 16, 84, 16, 50, 50, 16, 50, 84, 50, 84, 84, 16,
			 84, 84, 84, 16, 16, 16, 16, 84, 16, 50, 50, 16, 50, 84, 50,
			 84, 84, 16, 84, 84, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84,
			 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 50, 84, 50, 50, 84,
			 84, 50, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 84, 84,
			 50, 84, 84, 84, 84, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84,
			 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 16, 84, 50, 16, 84,
			 84, 16, 84, 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 50, 84,
			 50, 50, 84, 84, 50, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84,
			 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 84, 84, 50, 84, 84,
			 84, 84, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 84, 84,
			 50, 84, 84, 84, 84, 84, 16, 16, 84, 50, 16, 84, 84, 16, 84,
			 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 16, 84, 50, 16, 84,
			 84, 16, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 50, 84,
			 50, 50, 84, 84, 50, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84,
			 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 84, 84, 50, 84, 84,
			 84, 84, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 16, 50,
			 16, 84, 16, 16, 16, 50, 16, 84, 16, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 50, 50, 50, 84, 50, 16, 50, 50,
			 50, 84, 50, 16, 84, 50, 84, 84, 84, 16, 84, 50, 84, 84, 84,
			 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-63")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-63")
})


context('Model number 63 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(754.654502608921, 824.994097630599, 603.814535829865, 12, 1, 100,
			 1.62462961881764e-121, 0, 603.814535829865, 12))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 63))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962230507254742, 0.0896223147054212, 0.0400000048164369,
			 "facExperimexperimental", "<unicode>", 0.114128470240019, "facGenderm",
			 0.0253179702690451, 1.57990567140142, -0.163250491605493, 0.0341993663687201,
			 -0.0645255626183865, "contcor2", "<unicode>", 0.200189593206828,
			 "facGenderm", 0.0503707873031526, -1.28101159567041, -0.17052724858673,
			 0.0272978714655291, -0.0716146885606005, "contcor2", "<unicode>",
			 0.155883431418112, "facExperimexperimental", 0.0504665191841989,
			 -1.41905345798097, 0.756301183557123, 1.33634147678664, 1.04632133017188,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147972181582111, 7.07106781142688, 0.00473837838825563, 0.00837244185469961,
			 0.00655541012147762, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000927074041948987, 7.07107504347354, 0.0796446933543839,
			 0.140727683049912, 0.110186188202148, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.0155826816659241, 7.07106713493997, 0.180704770254056, 0.319295056835718,
			 0.249999913544887, "facGenderm", "<unicode>", 1.53743684450092e-12,
			 "facGenderm", 0.0353553146065041, 7.07107025711196, 0.180704812624588,
			 0.319295204621124, 0.250000008622856, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553414985478, 7.0710675679126, 0.721541902114498, 1.27492392854912,
			 0.99823291533181, "contcor2", "<unicode>", 1.53743684450092e-12,
			 "contcor2", 0.14117147835359, 7.07106652826538))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161366436505255, 1.33152243760883, 16, 0.585078000551786, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.124474928370373,
			 0.38084599663305, 1.53625876528647, -0.35983484300909, 1.00920730485536,
			 16, 0.324686230923135, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.352546048471936, 0.349251863468737, 0.929662128924328,
			 0.0271162726691306, 1.18765979871386, 50, 0.607388035691498,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0.0402130570669657,
			 0.296062462167406, 2.0515536864922, -0.24070133256101, 0.934693864686703,
			 50, 0.346996266062846, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.247179173917262, 0.299851223420196, 1.15722811501284,
			 -0.0588887745058192, 1.3259664170488, 84, 0.633538821271491,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0.072928922266785,
			 0.353285877311568, 1.7932752537197, -0.402842727184242, 1.14913683046992,
			 84, 0.37314705164284, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.345946988560721, 0.395920427593563, 0.942479916762209,
			 -0.0354522660516391, 0.0328680462027234, 16, -0.00129210992445785,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.940902366303098, 0.017428971346735, -0.0741357535538032, -0.0440455344192379,
			 0.047563072779451, 16, 0.00175876918010654, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.940009716263769,
			 0.0233699720814479, 0.0752576500295746, -0.0213126225558571,
			 0.0197880781294262, 50, -0.00076227221321548, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.942044243908374,
			 0.010485065289332, -0.0727007598122498, -0.0568858391573637,
			 0.0614630529400615, 50, 0.0022886068913489, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.939576010201095,
			 0.0301915986801151, 0.0758027726718637, -0.00835427954957851,
			 0.00807183736925568, 84, -0.000141221090161415, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.973115584704253,
			 0.00419041294850347, -0.0337009960347345, -0.0723548716242303,
			 0.0781741876530362, 84, 0.00290965801440297, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.939601750996216,
			 0.0384009758507352, 0.0757704185881324, -0.0338014868231421,
			 0.0345869587945589, 16, 0.000392735985708396, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.982040285290433,
			 0.0174463526261555, 0.022511065442963, -0.0470148670396605,
			 0.0459457135032499, 16, -0.000534576768205313, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.982015737898985,
			 0.0237148695782605, -0.022541838842553, -0.0199780174839464,
			 0.0204414017879729, 50, 0.000231692152013239, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.9820731965036,
			 0.0103112658168065, 0.0224698069208536, -0.0611394279132941,
			 0.0597481867094931, 50, -0.00069562060190047, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.98200416718539,
			 0.0308392438780338, -0.022556344268737, -0.00430576334969988,
			 0.00439161146989078, 84, 4.29240600954513e-05, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.984565105476263,
			 0.00221875883643639, 0.0193459782066233, -0.077733523355258,
			 0.0759647459676215, 84, -0.000884388693818257, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.982004847583395,
			 0.0392094626572815, -0.0225554912993438))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0245871637464371, 1.18879014468693, 0.606688654216684, "facGenderm",
			 "<unicode>", 0.0410771767219218, "contNormal", 0.296996013733818,
			 2.0427501587965, -3.59409023279041, 3.3249965236407, -0.134546854574857,
			 "debCollin1", "<unicode>", 0.939239335646912, "contNormal",
			 1.76510558638015, -0.0762259524943114, -3.32425475412207, 3.38379641175764,
			 0.0297708288177846, "facExperimexperimental", "<unicode>", 0.986119957342349,
			 "contNormal", 1.71126898728547, 0.017396931189064, -0.228143894885509,
			 0.320527905237947, 0.0461920051762192, "contcor2", "<unicode>",
			 0.741389442125646, "contNormal", 0.139969867929031, 0.33001392270828,
			 -4.78681036068573, 5.13769493074473, 0.175442285029501, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.944754603012839, "contNormal", 2.53180807650388,
			 0.069295254509088, -1.09180242618256, 0.571018886925262, -0.260391769628651,
			 "facGenderm:facExperimexperimental", "<unicode>", 0.539316791112846,
			 "contNormal", 0.424196905204368, -0.613846462418674, -0.392771929892232,
			 0.439553299444993, 0.0233906847763803, "facGenderm:contcor2",
			 "<unicode>", 0.912281672521624, "contNormal", 0.212331766272875,
			 0.110161023887119, -0.0402674673779428, 0.0518453184166156,
			 0.00578892551933639, "facGenderm", "<unicode>", 0.805409742569032,
			 "debCollin1", 0.0234985914336009, 0.246352022234777, -0.0489096301656175,
			 0.0420350192215097, -0.00343730547205392, "facExperimexperimental",
			 "<unicode>", 0.882219704166854, "debCollin1", 0.0232005919763034,
			 -0.148155938243503, -0.0174100213010424, 0.0258806764704286,
			 0.00423532758469313, "contcor2", "<unicode>", 0.701345706006481,
			 "debCollin1", 0.0110437482813313, 0.383504538205806, -0.0882812504193306,
			 0.0429308167104998, -0.0226752168544154, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498141744565919, "debCollin1", 0.0334730811802703,
			 -0.677416480792353, -0.0370220765590252, 0.0287647018217221,
			 -0.00412868736865157, "facGenderm:contcor2", "<unicode>", 0.805675059311185,
			 "debCollin1", 0.0167826498087886, -0.246009266456212))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.162991404912731, 1.33056318616739, 16, 0.583785890627328, 0,
			 "Total", 0.125477334158525, 0.381015825510338, 1.53218279016468,
			 -0.362316666023561, 1.00910490802091, 16, 0.323394120998677,
			 0, "Total", 0.355301033437679, 0.349858871097141, 0.924355926675599,
			 0.0257501520506465, 1.18644169948343, 16, 0.60609592576704,
			 0, "Total", 0.0406651253594486, 0.296100223419454, 2.0469282959927,
			 -0.243029668945791, 0.934437981222568, 16, 0.345704156138389,
			 1, "Total", 0.249777615721879, 0.300379920104674, 1.15088970001031,
			 -0.0598948652396218, 1.32438828793369, 50, 0.632246711347033,
			 0, "Total", 0.0733964763705617, 0.353139946471557, 1.79035738568861,
			 -0.404609658086803, 1.14831954152357, 16, 0.371854941718382,
			 0, "Total", 0.347914575760689, 0.396162687646221, 0.938642010755069,
			 -0.161621079846629, 1.33529461931041, 50, 0.586836769731893,
			 0, "Total", 0.124359015163206, 0.38187326679585, 1.53673173997178,
			 -0.359147119700326, 1.01203711990681, 16, 0.326445000103241,
			 0, "Total", 0.350697230920789, 0.34979832548528, 0.933237743921044,
			 0.0258074588959496, 1.19248615084726, 84, 0.609146804871604,
			 0, "Total", 0.0406900487740611, 0.297627584270406, 2.04667455929815,
			 -0.240664628602416, 0.938174699088322, 16, 0.348755035242953,
			 1, "Total", 0.246172819053377, 0.300729844269913, 1.15969546052083,
			 -0.0601744851310926, 1.33076966603429, 84, 0.635297590451597,
			 0, "Total", 0.073392588715202, 0.354839211877609, 1.79038158463368,
			 -0.402810816817379, 1.15262245846327, 16, 0.374905820822946,
			 0, "Total", 0.344750994232977, 0.396801494198289, 0.944819579322448,
			 -0.162146876333132, 1.33077833301027, 16, 0.584315728338571,
			 0, "Total", 0.124975563414846, 0.380855265994531, 1.53421990060382,
			 -0.361105032468828, 1.00895294988867, 16, 0.323923958709919,
			 0, "Total", 0.354034612171418, 0.349511009682917, 0.926791859872423,
			 0.0265396526963286, 1.18671187426024, 16, 0.606625763478282,
			 0, "Total", 0.0404000870876116, 0.295967739896038, 2.04963474631176,
			 -0.241848942416574, 0.934316930115836, 16, 0.346233993849631,
			 1, "Total", 0.248529136673224, 0.300047827870782, 1.1539293462199,
			 -0.0592901035732072, 1.32484320168976, 50, 0.632776549058275,
			 0, "Total", 0.0731246790100868, 0.353101719261382, 1.79205173620201,
			 -0.403713737946159, 1.14848329680541, 16, 0.372384779429624,
			 0, "Total", 0.347000721548139, 0.395975907464397, 0.940422819696691,
			 -0.162211556485898, 1.33694477137217, 50, 0.587366607443135,
			 0, "Total", 0.124582447833332, 0.382444866253467, 1.53582034764157,
			 -0.359501797081304, 1.01345147271027, 16, 0.326974837814484,
			 1, "Total", 0.350537087052446, 0.350249616988183, 0.933548023909803,
			 0.0247564329650413, 1.19459685220065, 84, 0.609676642582847,
			 0, "Total", 0.0410605160489226, 0.298434162174194, 2.04291840498804,
			 -0.241306139050897, 0.939875884959288, 16, 0.349284872954195,
			 1, "Total", 0.246393530117051, 0.301327481863748, 1.15915372469124,
			 -0.0611129407098199, 1.3327677970355, 84, 0.63582742816284,
			 1, "Total", 0.0737599251555698, 0.355588354872863, 1.78809969294459,
			 -0.403295991387154, 1.15416730845553, 16, 0.375435658534188,
			 0, "Total", 0.344698894864157, 0.397319367123007, 0.944921616211968,
			 -0.161503798831381, 1.33137735775463, 16, 0.584936779461625,
			 0, "Total", 0.12456391480364, 0.380844027839712, 1.53589589622713,
			 -0.360062313876917, 1.00915233354286, 50, 0.324545009832973,
			 1, "Total", 0.3528161723545, 0.349295869265959, 0.929140703882359,
			 0.0270187357700042, 1.18747489343267, 16, 0.607246814601336,
			 0, "Total", 0.0402444456039492, 0.296040173905285, 2.05123111026012,
			 -0.240904786627229, 0.934614876572599, 50, 0.346855044972685,
			 1, "Total", 0.247421653203701, 0.299882975522045, 1.15663466513519,
			 -0.0589553512875586, 1.32575055165022, 50, 0.633397600181329,
			 1, "Total", 0.072961921796286, 0.353247792780929, 1.79306881210759,
			 -0.402997145323534, 1.14900880642889, 50, 0.373005830552678,
			 0, "Total", 0.346137756572075, 0.395927160905621, 0.942107204010672,
			 -0.163246351256885, 1.33922166838926, 50, 0.587987658566189,
			 0, "Total", 0.125016009579045, 0.3832897011112, 1.53405545951677,
			 -0.360292645714836, 1.01548442358991, 50, 0.327595888937538,
			 1, "Total", 0.350612740934624, 0.350969987243823, 0.933401432726934,
			 0.0230887223098541, 1.19750666510195, 84, 0.610297693705901,
			 0, "Total", 0.0416471708287014, 0.299601919233147, 2.03702865211278,
			 -0.242492438599908, 0.942304286754407, 50, 0.349905924077249,
			 1, "Total", 0.246997906410054, 0.302249616498017, 1.15767202000584,
			 -0.0625795833939919, 1.33547654196578, 84, 0.636448479285894,
			 1, "Total", 0.0743423341387752, 0.356653524347248, 1.78450074326541,
			 -0.404194973719066, 1.15630839303355, 50, 0.376056709657243,
			 0, "Total", 0.344842268501866, 0.398094908646707, 0.944640841892749,
			 -0.160673803090041, 1.33161527616503, 16, 0.585470736537495,
			 0, "Total", 0.12407114343056, 0.380692984928819, 1.53790786727253,
			 -0.362243309861692, 1.01240124367938, 50, 0.325078966908843,
			 0, "Total", 0.353930072068062, 0.350681074852419, 0.926993186175359,
			 0.0267011726308786, 1.18886037072353, 16, 0.607780771677206,
			 0, "Total", 0.0403618707101343, 0.296474630977819, 2.05002623554215,
			 -0.244740277737646, 0.939518281834756, 50, 0.347389002048555,
			 1, "Total", 0.250198644715424, 0.302112326786023, 1.14986702377953,
			 -0.06034398826124, 1.32820710277564, 50, 0.633931557257199,
			 0, "Total", 0.073516499577378, 0.354228726137213, 1.78961080929287,
			 -0.406853145220159, 1.15393272047725, 50, 0.373539787628548,
			 0, "Total", 0.348168053393511, 0.398166976028308, 0.938148591213127,
			 -0.164816658373321, 1.33390350594048, 50, 0.584543423783581,
			 0, "Total", 0.126293395904024, 0.382333597998616, 1.52888322356043,
			 -0.359288441522868, 1.00759174983273, 50, 0.32415165415493,
			 0, "Total", 0.35257848911536, 0.348700333816685, 0.929599494806732,
			 0.0244530375971712, 1.18925388024941, 84, 0.606853458923292,
			 0, "Total", 0.0411261155024039, 0.297148532279175, 2.04225628936691,
			 -0.238366001426276, 0.931289380015558, 50, 0.346461689294641,
			 1, "Total", 0.245594976284245, 0.298386957787981, 1.1611153914469,
			 -0.0596138827320545, 1.32562237173863, 84, 0.633004244503286,
			 0, "Total", 0.0732501055761019, 0.353383089025423, 1.79126920376698,
			 -0.399776067396095, 1.14500101714536, 50, 0.372612474874634,
			 0, "Total", 0.344394643419977, 0.394083028240943, 0.945517690873047,
			 -0.160769303434841, 1.33138868884244, 16, 0.585309692703799,
			 0, "Total", 0.124141576885537, 0.380659543758771, 1.53761990813165,
			 -0.361052037648938, 1.01088788379923, 84, 0.324917923075148,
			 0, "Total", 0.353220592256995, 0.349991105007505, 0.928360516671361,
			 0.0271135376051637, 1.18812591808186, 16, 0.607619727843511,
			 0, "Total", 0.0402175533917033, 0.296182070087668, 2.05150746520091,
			 -0.242849749265132, 0.937305665694851, 84, 0.34722795821486,
			 1, "Total", 0.248774981800259, 0.301065586987541, 1.15332994942803,
			 -0.0595449876290927, 1.3270860144761, 50, 0.633770513423504,
			 0, "Total", 0.073191669425767, 0.353738898531494, 1.79163364858807,
			 -0.40503095613354, 1.15178844372325, 84, 0.373378743794853,
			 0, "Total", 0.347149182805583, 0.397155103904148, 0.940133313469809,
			 -0.16641491370664, 1.33517967360641, 50, 0.584382379949886,
			 0, "Total", 0.127125422325896, 0.383066882646171, 1.52553615680128,
			 -0.359739664143308, 1.00772088478578, 84, 0.323990610321234,
			 1, "Total", 0.35302212282427, 0.348848386938597, 0.928743323609698,
			 0.0229304462987616, 1.19045438388043, 84, 0.606692415089597,
			 0, "Total", 0.0416548226037976, 0.297843212117914, 2.03695229706767,
			 -0.238380373289609, 0.930981664211501, 84, 0.346300645460946,
			 1, "Total", 0.245696065426668, 0.298312123774949, 1.16086681653676,
			 -0.0604399810378459, 1.32612638237703, 84, 0.63284320066959,
			 1, "Total", 0.0735994227055143, 0.353722408766674, 1.78909558734525,
			 -0.399394693845372, 1.14429755592725, 84, 0.372451431040939,
			 0, "Total", 0.344264270120977, 0.393806279592143, 0.945773214755943,
			 -0.161217800858153, 1.33145965008192, 16, 0.585120924611882,
			 0, "Total", 0.124393967279052, 0.380792061158807, 1.53658908442385,
			 -0.360019133857393, 1.00947744382385, 84, 0.32472915498323,
			 1, "Total", 0.352642194161835, 0.349367791572616, 0.92947650818503,
			 0.0271646622814391, 1.18769725722175, 16, 0.607430959751593,
			 0, "Total", 0.0401970769140754, 0.296059673569117, 2.05171799464875,
			 -0.241051829479369, 0.935130209725253, 84, 0.347039190122942,
			 1, "Total", 0.24743704513947, 0.30005195209764, 1.15659700827413,
			 -0.058969457492929, 1.3261329481561, 50, 0.633581745331586,
			 1, "Total", 0.0729606660610196, 0.353348943290423, 1.79307666645782,
			 -0.403212144898138, 1.14959209630401, 84, 0.373189975702935,
			 0, "Total", 0.346147725657433, 0.396130809915505, 0.942087730521482,
			 -0.168618488042302, 1.33700571175824, 50, 0.584193611857968,
			 0, "Total", 0.128269426218433, 0.384094863904825, 1.52096179032148,
			 -0.360635428242574, 1.00823911270121, 84, 0.323801842229317,
			 1, "Total", 0.353800168549702, 0.349209105815538, 0.927243410429159,
			 0.0207208952726644, 1.19228639872269, 84, 0.606503646997679,
			 0, "Total", 0.0424283747170975, 0.298874242764456, 2.02929379724323,
			 -0.238826663929566, 0.931050418667623, 84, 0.346111877369028,
			 1, "Total", 0.24616150923865, 0.29844351524442, 1.1597232296556,
			 -0.0617692216202187, 1.32707808677556, 84, 0.632654432577673,
			 1, "Total", 0.074160074424185, 0.354304293178557, 1.7856245175636,
			 -0.399272747366373, 1.14379807326442, 84, 0.372262662949021,
			 0, "Total", 0.344314600330164, 0.393647748836799, 0.945674563233325,
			 -0.0354522660516391, 0.0328680462027234, 16, -0.00129210992445785,
			 0, "Total indirect", 0.940902366303098, 0.017428971346735, -0.0741357535538032,
			 -0.0440455344192379, 0.047563072779451, 16, 0.00175876918010654,
			 0, "Total indirect", 0.940009716263769, 0.0233699720814479,
			 0.0752576500295746, -0.0213126225558571, 0.0197880781294262,
			 16, -0.00076227221321548, 0, "Total indirect", 0.942044243908374,
			 0.010485065289332, -0.0727007598122498, -0.0568858391573637,
			 0.0614630529400615, 16, 0.0022886068913489, 1, "Total indirect",
			 0.939576010201095, 0.0301915986801151, 0.0758027726718637, -0.00835427954957851,
			 0.00807183736925568, 50, -0.000141221090161415, 0, "Total indirect",
			 0.973115584704253, 0.00419041294850347, -0.0337009960347345,
			 -0.0723548716242303, 0.0781741876530362, 16, 0.00290965801440297,
			 0, "Total indirect", 0.939601750996216, 0.0384009758507352,
			 0.0757704185881324, -0.0338014868231421, 0.0345869587945589,
			 50, 0.000392735985708396, 0, "Total indirect", 0.982040285290433,
			 0.0174463526261555, 0.022511065442963, -0.0470148670396605,
			 0.0459457135032499, 16, -0.000534576768205313, 0, "Total indirect",
			 0.982015737898985, 0.0237148695782605, -0.022541838842553, -0.0199780174839464,
			 0.0204414017879729, 84, 0.000231692152013239, 0, "Total indirect",
			 0.9820731965036, 0.0103112658168065, 0.0224698069208536, -0.0611394279132941,
			 0.0597481867094931, 16, -0.00069562060190047, 1, "Total indirect",
			 0.98200416718539, 0.0308392438780338, -0.022556344268737, -0.00430576334969988,
			 0.00439161146989078, 84, 4.29240600954513e-05, 0, "Total indirect",
			 0.984565105476263, 0.00221875883643639, 0.0193459782066233,
			 -0.077733523355258, 0.0759647459676215, 16, -0.000884388693818257,
			 0, "Total indirect", 0.982004847583395, 0.0392094626572815,
			 -0.0225554912993438, 16, 0, 16, 0, 16, 0, 16, 1, 50, 0, 16,
			 0, 50, 0, 16, 1, 84, 0, 16, 1, 84, 1, 16, 0, 16, 0, 50, 1, 16,
			 0, 50, 1, 50, 1, 50, 0, 50, 0, 50, 1, 84, 0, 50, 1, 84, 1, 50,
			 0, 16, 0, 50, 0, 16, 1, 50, 1, 50, 0, 50, 1, 50, 0, 50, 0, 84,
			 1, 50, 1, 84, 0, 50, 1, 16, 0, 84, 0, 16, 1, 84, 1, 50, 0, 84,
			 1, 50, 0, 84, 1, 84, 1, 84, 1, 84, 1, 84, 1, 16, 0, 84, 1, 16,
			 1, 84, 1, 50, 1, 84, 1, 50, 0, 84, 1, 84, 1, 84, 1, 84, 1, 84,
			 1, 16, 0, 16, 0, 50, 1, 50, 1, 84, 0, 84, 1, 16, 0, 16, 0, 50,
			 1, 50, 1, 84, 0, 84, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,
			 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0,
			 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1,
			 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
			 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-63")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-63")
})


context('Model number 64 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1401.09592919066, 1468.83035402635, 1019.15858565359, 16, 1, 100,
			 8.84243941084213e-207, 0, 1019.15858565359, 16))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 64))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848093601905, 0.0642087175102868, -0.240319688045809, "contcor1",
			 "<unicode>", 0.121932554384435, "contGamma", 0.155374490530529,
			 -1.54671263748144, -0.403934373566525, 0.194627776190505, -0.10465329868801,
			 "contcor2", "<unicode>", 0.49311378783577, "contGamma", 0.152697231805893,
			 -0.685364740737698, 0.424979154501129, 0.896763032536046, 0.660871093518588,
			 "contcor2", "<unicode>", 3.996556752206e-08, "contcor1", 0.120355241666757,
			 5.49100383470148, 0.744754608186839, 1.31593933085617, 1.0303469695215,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145713065947834, 7.07106780589169, 0.00465468577822901, 0.00822456694768606,
			 0.00643962636295753, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700706139455, 7.07106771691845, 0.323891811011924,
			 0.572298563052616, 0.44809518703227, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702338410534,
			 7.07106727988714, 0.318532852918522, 0.562829541630995, 0.440681197274758,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217290316183, 7.07106821524774, 1.68041084665529, 2.96919097430554,
			 2.32480091048041, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776482072116, 7.07106814887835, 0.732634574875288,
			 1.2945238888519, 1.01357923186359, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341744646515, 7.07106805741139,
			 0.721541807970411, 1.27492360117737, 0.998232704573888, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171418855642,
			 7.07106801550709))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732365655787, 0.122660936763302, "", "", -0.0120357144462428,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.860976655752482,
			 0.0687240440497962, -0.175131056570564, -0.0197124011037909,
			 0.0335574985830838, 16, 16, 0.00692254873964644, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.610469172587917,
			 0.013589509834635, 0.509403858114386, -0.0239436114944225, 0.0477862309293021,
			 16, 16, 0.0119213097174398, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.514735625041815, 0.0182987654338346,
			 0.65148164014372, -0.0351161086985275, 0.0698697526956692, 50,
			 16, 0.0173768219985709, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.516461107820964, 0.0267825996350728,
			 0.648810131777322, -0.0436616186258013, 0.0244289788393373,
			 16, 16, -0.00961631989323198, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.579849343153876, 0.0173703695583767,
			 -0.553604795851599, -0.0596848279804465, 0.0265643308627762,
			 84, 16, -0.0165602485588352, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.451663384705157, 0.0220027407451221,
			 -0.752644806875091, -0.0873434260363278, 0.0390660977427772,
			 16, 16, -0.0241386641467753, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.454138133293808, 0.0322479200577682,
			 -0.748533986177522, -0.109447270616674, 0.0541144846765876,
			 16, 16, -0.027666392970043, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.507296003339487, 0.0417257042944196,
			 -0.663053948108987, -0.129958269399643, 0.0346697703902079,
			 50, 16, -0.0476442495047174, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.256606481500315, 0.0419977206439546,
			 -1.13444845992078, -0.190922524790561, 0.0520274432060564, 50,
			 16, -0.0694475407922521, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.262493883576031, 0.061978171515644,
			 -1.12051612840374, -0.0304623535467275, 0.061835659435437, 50,
			 50, 0.0156866529443547, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.505272101628842, 0.0235458441354534,
			 0.66621747999831, -0.0190057554627318, 0.0730336735642352, 84,
			 50, 0.0270139590507517, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.249931685773826, 0.0234798776286101,
			 1.15051532542211, -0.028561000444446, 0.107313548449281, 50,
			 50, 0.0393762740024177, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.255960660218165, 0.0346625116495733,
			 1.13599021330304, -0.0146280822218584, 0.0129236508448111, 16,
			 50, -0.000852215688523682, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.903493698122169, 0.00702863248610538,
			 -0.121249146289608, -0.0249283921505803, 0.0219931936995339,
			 84, 50, -0.00146759922552324, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.902418844813651, 0.0119700122604868,
			 -0.122606326007518, -0.0363412925576272, 0.0320628682717704,
			 50, 50, -0.00213921214292843, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.902433030409756, 0.0174503616823985,
			 -0.122588412885801, -0.0746771901350984, 0.036872612604429,
			 84, 50, -0.0189022887653347, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.506538038652671, 0.0284571052374988,
			 -0.664237933112979, -0.0884963968184928, 0.0233931964756818,
			 84, 50, -0.0325516001714055, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.254115838072524, 0.0285437880942572,
			 -1.14040925696035, -0.130019286331464, 0.035123108754654, 84,
			 50, -0.0474480887884052, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.260055953878401, 0.0421289361408528,
			 -1.12625888842217, -0.0503103934621815, 0.102229450034187, 16,
			 84, 0.0259595282860027, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.50470762622897, 0.0389139404345139,
			 0.667100992501352, -0.0311510437742125, 0.120560765093671, 16,
			 84, 0.0447048606597292, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.24805616291256, 0.0387027032293876,
			 1.1550836745115, -0.0468315543950166, 0.177157571345754, 50,
			 84, 0.0651630084753689, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.25412508352632, 0.0571411330788649,
			 1.14038705507349, -0.0233839962193857, 0.0422253155256344, 16,
			 84, 0.00942065965312433, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.573535928032725, 0.016737376875937,
			 0.562851617846296, -0.0247317630069382, 0.0571783677738466,
			 84, 84, 0.0162233023834542, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.437518961125773, 0.0208958254914074,
			 0.77638963773532, -0.0363984818839073, 0.0836935265439528, 16,
			 84, 0.0236475223300227, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.440185677885856, 0.0306362793845016,
			 0.771879706188658, -0.0392933323743397, 0.0220345055269663,
			 16, 84, -0.00862941342368669, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.581242062222051, 0.0156451440906701,
			 -0.551571361291125, -0.0538227641584742, 0.0241013670336182,
			 50, 84, -0.014860698562428, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.454726339502592, 0.0198789701766838,
			 -0.747558773434763, -0.0787612131987045, 0.0354385045677964,
			 50, 84, -0.0216613543154541, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.457160693447784, 0.0291331163907331,
			 -0.743530284399793))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732365655787, 0.122660936763302, -0.0120357144462428, "contGamma",
			 "<unicode>", 0.860976655752482, "contNormal", 0.0687240440497962,
			 -0.175131056570564, -2.33172276888643, 2.72584288948729, 0.197060060300428,
			 "debCollin1", "<unicode>", 0.878608201775022, "contNormal",
			 1.29021902909113, 0.152733803995468, -3.92782190795571, 0.322249450431128,
			 -1.80278622876229, "contcor1", "<unicode>", 0.0963631482401062,
			 "contNormal", 1.0842217999695, -1.66274670811175, -1.07379992614908,
			 3.00630236339017, 0.966251218620543, "contcor2", "<unicode>",
			 0.353242286424109, "contNormal", 1.04086154687601, 0.928318681308388,
			 -0.0857625814566112, 6.36779117228047, 3.14101429541193, "debCollin1:contcor1",
			 "<unicode>", 0.0564078565629411, "contNormal", 1.64634498507164,
			 1.90787126871544, -4.80094238458468, 1.40104583922212, -1.69994827268128,
			 "debCollin1:contcor2", "<unicode>", 0.282624760578582, "contNormal",
			 1.58216892573723, -1.07444170153271, -0.0197475195519045, 0.00115999912261539,
			 -0.00929376021464453, "contGamma", "<unicode>", 0.0814250110626391,
			 "debCollin1", 0.00533364868932177, -1.74247700889095, -0.018547604115988,
			 0.035078755958543, 0.00826557592127753, "contcor1", "<unicode>",
			 0.545717926853616, "debCollin1", 0.0136804452779563, 0.604189100086973,
			 -0.0145563069870721, 0.0065428580152728, -0.00400672448589964,
			 "contGamma:contcor1", "<unicode>", 0.456638734167718, "debCollin1",
			 0.00538253895703503, -0.744393030479197))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.140911169241372, 0.130684837828179, 16, 16, -0.00511316570659636,
			 "Total", 0.941171120993338, 0.0692859688269442, -0.0737979968118442,
			 -0.136938447338168, 0.136709637880562, 16, 16, -0.000114404728803006,
			 "Total", 0.998692416245946, 0.0698094677701301, -0.00163881393824288,
			 -0.135604737097414, 0.14628695220207, 50, 16, 0.00534110755232805,
			 "Total", 0.940793681505441, 0.0719124666379103, 0.0742723452836253,
			 -0.157798348275141, 0.114494279596192, 16, 16, -0.0216520343394748,
			 "Total", 0.755266286857315, 0.0694636814806656, -0.311702948619292,
			 -0.165281779699755, 0.108089853689599, 84, 16, -0.028595963005078,
			 "Total", 0.6817744300472, 0.0697389430483606, -0.410042965309182,
			 -0.178350681572221, 0.106001924386184, 16, 16, -0.0361743785930181,
			 "Total", 0.618004834271838, 0.0725402630357859, -0.498680003064951,
			 -0.193576977467667, 0.114172762635096, 16, 16, -0.0397021074162858,
			 "Total", 0.613066452159945, 0.0785090293827473, -0.505701162381337,
			 -0.211112414364851, 0.0917524864629309, 50, 16, -0.0596799639509602,
			 "Total", 0.439861307273068, 0.0772628740162426, -0.772427439580023,
			 -0.254697160027603, 0.0917306495506134, 50, 16, -0.0814832552384949,
			 "Total", 0.356525487829883, 0.0883760651498689, -0.92200591981907,
			 -0.137699021946016, 0.14500089894224, 50, 50, 0.00365093849811193,
			 "Total", 0.959625095440068, 0.0721186519543617, 0.050624053544738,
			 -0.125578656061526, 0.155535145270543, 84, 50, 0.0149782446045089,
			 "Total", 0.834556943745699, 0.0717140221834327, 0.208860752032524,
			 -0.12106061920282, 0.17574173831517, 50, 50, 0.0273405595561749,
			 "Total", 0.718030504173655, 0.0757162784263204, 0.361092226459334,
			 -0.14587256923943, 0.120096708969897, 16, 50, -0.0128879301347665,
			 "Total", 0.849351571657225, 0.0678505524354678, -0.189945839380219,
			 -0.146083832898292, 0.11907720555476, 84, 50, -0.013503313671766,
			 "Total", 0.841776102227156, 0.0676443650354312, -0.199622151301046,
			 -0.147164605718585, 0.118814752540242, 50, 50, -0.0141749265891712,
			 "Total", 0.834521598521011, 0.0678531239239185, -0.208906027747007,
			 -0.173130150020244, 0.111254143597089, 84, 50, -0.0309380032115775,
			 "Total", 0.669782377068255, 0.0725483467707876, -0.426446701939665,
			 -0.184193588034999, 0.0950189587997028, 84, 50, -0.0445873146176483,
			 "Total", 0.531333717488448, 0.0712289993686351, -0.625971374199618,
			 -0.209023433385079, 0.090055826915783, 84, 50, -0.059483803234648,
			 "Total", 0.435606604973249, 0.0762971316462857, -0.779633545208693,
			 -0.140368014622083, 0.168215642301603, 16, 84, 0.0139238138397599,
			 "Total", 0.859607561238805, 0.0787217671747427, 0.176873745845321,
			 -0.121056424339885, 0.186394716766858, 16, 84, 0.0326691462134864,
			 "Total", 0.677026797463933, 0.0784328547697503, 0.416523742625343,
			 -0.120937631373353, 0.227192219431605, 50, 84, 0.0531272940291261,
			 "Total", 0.549699038386119, 0.0888102673189308, 0.598211171218955,
			 -0.139399820155162, 0.134169710568925, 16, 84, -0.00261505479311847,
			 "Total", 0.970109746603242, 0.0697894279899957, -0.0374706437412461,
			 -0.133447826322213, 0.141823002196635, 84, 84, 0.00418758793721142,
			 "Total", 0.952448462218182, 0.0702234405045575, 0.0596323379646949,
			 -0.131462909020924, 0.154686524788484, 16, 84, 0.0116118078837799,
			 "Total", 0.873614659729111, 0.0729986459104653, 0.15906881201635,
			 -0.15552368253312, 0.114193426793261, 16, 84, -0.0206651278699295,
			 "Total", 0.763920720473973, 0.0688066493705689, -0.300336203825799,
			 -0.16149633301101, 0.107703506993668, 50, 84, -0.0268964130086708,
			 "Total", 0.695317156261814, 0.0686746904861752, -0.391649570143826,
			 -0.172090969463177, 0.104696831939783, 50, 84, -0.0336970687616969,
			 "Total", 0.633201849570517, 0.0706104304941893, -0.477225085951996,
			 -0.0197124011037909, 0.0335574985830838, 50, 16, 0.00692254873964644,
			 "Total indirect", 0.610469172587917, 0.013589509834635, 0.509403858114386,
			 -0.0239436114944225, 0.0477862309293021, 84, 16, 0.0119213097174398,
			 "Total indirect", 0.514735625041815, 0.0182987654338346, 0.65148164014372,
			 -0.0351161086985275, 0.0698697526956692, 50, 16, 0.0173768219985709,
			 "Total indirect", 0.516461107820964, 0.0267825996350728, 0.648810131777322,
			 -0.0436616186258013, 0.0244289788393373, 16, 16, -0.00961631989323198,
			 "Total indirect", 0.579849343153876, 0.0173703695583767, -0.553604795851599,
			 -0.0596848279804465, 0.0265643308627762, 84, 16, -0.0165602485588352,
			 "Total indirect", 0.451663384705157, 0.0220027407451221, -0.752644806875091,
			 -0.0873434260363278, 0.0390660977427772, 50, 16, -0.0241386641467753,
			 "Total indirect", 0.454138133293808, 0.0322479200577682, -0.748533986177522,
			 -0.109447270616674, 0.0541144846765876, 84, 16, -0.027666392970043,
			 "Total indirect", 0.507296003339487, 0.0417257042944196, -0.663053948108987,
			 -0.129958269399643, 0.0346697703902079, 84, 16, -0.0476442495047174,
			 "Total indirect", 0.256606481500315, 0.0419977206439546, -1.13444845992078,
			 -0.190922524790561, 0.0520274432060564, 84, 16, -0.0694475407922521,
			 "Total indirect", 0.262493883576031, 0.061978171515644, -1.12051612840374,
			 -0.0304623535467275, 0.061835659435437, 16, 50, 0.0156866529443547,
			 "Total indirect", 0.505272101628842, 0.0235458441354534, 0.66621747999831,
			 -0.0190057554627318, 0.0730336735642352, 16, 50, 0.0270139590507517,
			 "Total indirect", 0.249931685773826, 0.0234798776286101, 1.15051532542211,
			 -0.028561000444446, 0.107313548449281, 50, 50, 0.0393762740024177,
			 "Total indirect", 0.255960660218165, 0.0346625116495733, 1.13599021330304,
			 -0.0146280822218584, 0.0129236508448111, 16, 50, -0.000852215688523682,
			 "Total indirect", 0.903493698122169, 0.00702863248610538, -0.121249146289608,
			 -0.0249283921505803, 0.0219931936995339, 84, 50, -0.00146759922552324,
			 "Total indirect", 0.902418844813651, 0.0119700122604868, -0.122606326007518,
			 -0.0363412925576272, 0.0320628682717704, 16, 50, -0.00213921214292843,
			 "Total indirect", 0.902433030409756, 0.0174503616823985, -0.122588412885801,
			 -0.0746771901350984, 0.036872612604429, 16, 50, -0.0189022887653347,
			 "Total indirect", 0.506538038652671, 0.0284571052374988, -0.664237933112979,
			 -0.0884963968184928, 0.0233931964756818, 50, 50, -0.0325516001714055,
			 "Total indirect", 0.254115838072524, 0.0285437880942572, -1.14040925696035,
			 -0.130019286331464, 0.035123108754654, 50, 50, -0.0474480887884052,
			 "Total indirect", 0.260055953878401, 0.0421289361408528, -1.12625888842217,
			 -0.0503103934621815, 0.102229450034187, 50, 84, 0.0259595282860027,
			 "Total indirect", 0.50470762622897, 0.0389139404345139, 0.667100992501352,
			 -0.0311510437742125, 0.120560765093671, 84, 84, 0.0447048606597292,
			 "Total indirect", 0.24805616291256, 0.0387027032293876, 1.1550836745115,
			 -0.0468315543950166, 0.177157571345754, 50, 84, 0.0651630084753689,
			 "Total indirect", 0.25412508352632, 0.0571411330788649, 1.14038705507349,
			 -0.0233839962193857, 0.0422253155256344, 16, 84, 0.00942065965312433,
			 "Total indirect", 0.573535928032725, 0.016737376875937, 0.562851617846296,
			 -0.0247317630069382, 0.0571783677738466, 84, 84, 0.0162233023834542,
			 "Total indirect", 0.437518961125773, 0.0208958254914074, 0.77638963773532,
			 -0.0363984818839073, 0.0836935265439528, 50, 84, 0.0236475223300227,
			 "Total indirect", 0.440185677885856, 0.0306362793845016, 0.771879706188658,
			 -0.0392933323743397, 0.0220345055269663, 84, 84, -0.00862941342368669,
			 "Total indirect", 0.581242062222051, 0.0156451440906701, -0.551571361291125,
			 -0.0538227641584742, 0.0241013670336182, 84, 84, -0.014860698562428,
			 "Total indirect", 0.454726339502592, 0.0198789701766838, -0.747558773434763,
			 -0.0787612131987045, 0.0354385045677964, 84, 84, -0.0216613543154541,
			 "Total indirect", 0.457160693447784, 0.0291331163907331, -0.743530284399793,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50,
			 16, 84, 50, 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50,
			 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-64")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-64")
})


context('Model number 64 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(23004.5630930626, 23156.6455123317, 24958.9636417317, 16, 1, 2564,
			 0, 0, 24958.9636417317, 16))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 64))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678663313496542, 0.0881399923704071, 0.0780031618600307, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517194733695847, 15.081971408066,
			 -0.0939551943695201, -0.0542197086163946, -0.0740874514929574,
			 "contcor2", "<unicode>", 2.69562150378988e-13, "facGenderm",
			 0.0101367897743412, -7.30876866762013, -0.0997949157536703,
			 -0.0599920728415011, -0.0798934942975857, "contcor2", "<unicode>",
			 3.5527136788005e-15, "facExperimexperimental", 0.0101539730388234,
			 -7.86820035784173, 0.964858873476119, 1.0766086201982, 1.02073374683716,
			 "contNormal", "<unicode>", 0, "contNormal", 0.0285081122927645,
			 35.8050275779301, 0.00607839477909073, 0.00678239298629265,
			 0.00643039388269169, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000179594679482624, 35.8050355456874, 0.103586058548533, 0.115583365658398,
			 0.109584712103466, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.00306059376715538,
			 35.8050497519366, 0.426153819537444, 0.475510865157342, 0.450832342347393,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.012591314434658, 35.8050261302713, 0.236315066491174, 0.263685032265075,
			 0.250000049378124, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698226242670563, 35.8050205076694, 0.23631504423504, 0.263685004536622,
			 0.250000024385831, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698226103068037, 35.8050240870858,
			 0.97540827670731, 1.08837985005982, 1.03189406338357, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288198084872018, 35.8050284699778
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.391909535405872, 0.55790953262134, "", 0.474909534013606, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0423477162143934,
			 11.2145252794575, -0.00824492764010926, 0.00376619322567151,
			 16, -0.00223936720721887, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.46487940173832, 0.00306411774923492,
			 -0.73083588506937, -0.00808064186704963, 0.0239975154218762,
			 16, 0.0079584367774133, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.330794254670896, 0.00818335376107783,
			 0.972515304821076, -0.00789998300865004, 0.0038244480191575,
			 16, -0.00203776749474627, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.495679150633037, 0.00299098124258618,
			 -0.681304003426077, -0.00918538545572257, 0.0236693376380419,
			 16, 0.00724197609115966, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.387562077052581, 0.00838146092298592,
			 0.864046991056028, -0.00402373452404498, 0.00300481657223386,
			 50, -0.000509458975905558, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.776308547721461, 0.001793030676002,
			 -0.284132883348946, -0.0102609308206812, 0.0138820404246443,
			 50, 0.00181055480198153, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.76878288008022, 0.00615903440975504,
			 0.293967313953283, -0.00391360331544369, 0.00329788478857778,
			 50, -0.000307859263432953, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.867100817529795, 0.00183969913756191,
			 -0.16734217957016, -0.0115732206291835, 0.0137614088606393,
			 50, 0.0010940941157279, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.865572555560861, 0.00646303444595389,
			 0.169284896263062, -0.00342240483484985, 0.00612659732915889,
			 84, 0.00135209624715452, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.578864311515848, 0.00243601470213995,
			 0.555044370613509, -0.0194895703043398, 0.00987920138827361,
			 84, -0.00480518445803307, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.521288338552898, 0.00749217126545959,
			 -0.641360733461331, -0.00354322303885881, 0.00665061495811306,
			 84, 0.00155369595962713, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.550202544672392, 0.00260051666188245,
			 0.597456644827817, -0.0207750910847323, 0.00973180079615886,
			 84, -0.00552164514428671, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.47801808562423, 0.00778251338328806,
			 -0.70949381932882))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.391909535405872, 0.55790953262134, 0.474909534013606, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0423477162143934, 11.2145252794575,
			 -0.776014955268681, 0.575082143784312, -0.100466405742184, "debCollin1",
			 "<unicode>", 0.770682374955959, "contNormal", 0.34467396077435,
			 -0.291482436086773, -0.675068033153949, 0.631177064893845, -0.0219454841300522,
			 "facExperimexperimental", "<unicode>", 0.947492081413305, "contNormal",
			 0.333231913532924, -0.0658564898463242, -0.476785799220298,
			 0.127654857394011, -0.174565470913144, "contcor2", "<unicode>",
			 0.257594617267734, "contNormal", 0.154196878458497, -1.13209471331891,
			 -0.936851659760003, 1.01730457254931, 0.0402264563946557, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.935686884160387, "contNormal", 0.498518403328697,
			 0.0806920188423465, -0.132286199249756, 0.782090795977404, 0.324902298363824,
			 "debCollin1:contcor2", "<unicode>", 0.16366396119599, "contNormal",
			 0.233263723833614, 1.39285394670101, -0.00422884018094864, 0.0142520801350097,
			 0.00501161997703054, "facGenderm", "<unicode>", 0.287782662400327,
			 "debCollin1", 0.00471460712077709, 1.06299843203149, -0.012586669159276,
			 0.00589425115670451, -0.00334620900128575, "facExperimexperimental",
			 "<unicode>", 0.477856996622368, "debCollin1", 0.00471460712078274,
			 -0.709753520401545, -0.0358902876316273, -0.00975431947565987,
			 -0.0228223035536436, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619483146884425, "debCollin1", 0.00666746133146441, -3.42293751985375
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.389573777115012, 0.555766556497762, 16, 0.472670166806387, 0,
			 "Total", 0, 0.0423968962423946, 11.1486973976586, 0.397911921460471,
			 0.567824020121568, 16, 0.48286797079102, 0, "Total", 0, 0.0433457196156008,
			 11.1399228129836, 0.389474057187665, 0.556269475850055, 16,
			 0.47287176651886, 1, "Total", 0, 0.0425506335774667, 11.1131545352424,
			 0.398212246611014, 0.566090773598518, 16, 0.482151510104766,
			 0, "Total", 0, 0.0428269417988564, 11.2581354132001, 0.391396594537951,
			 0.557403555537451, 50, 0.474400075037701, 0, "Total", 0, 0.0423494927225557,
			 11.2020249721913, 0.392597813349952, 0.560842364281224, 50,
			 0.476720088815588, 1, "Total", 0, 0.0429203169696901, 11.1070961836615,
			 0.391282420313134, 0.557920929187213, 50, 0.474601674750173,
			 1, "Total", 0, 0.0425106048347067, 11.1643124485186, 0.392895500959875,
			 0.559111755298793, 50, 0.476003628129334, 1, "Total", 0, 0.0424028848616633,
			 11.2257368733817, 0.393141606374904, 0.559381654146618, 84,
			 0.476261630260761, 0, "Total", 0, 0.0424089547264628, 11.2302138388612,
			 0.385755162813617, 0.554453536297529, 84, 0.470104349555573,
			 0, "Total", 0, 0.0430360901563966, 10.923491140742, 0.393012704385842,
			 0.559913755560625, 84, 0.476463229973233, 1, "Total", 0, 0.0425775811421222,
			 11.1904720087978, 0.386036312976633, 0.552739464762007, 84,
			 0.46938788886932, 0, "Total", 0, 0.0425270956763254, 11.0373840819472,
			 -0.00824492764010926, 0.00376619322567151, 16, -0.00223936720721887,
			 0, "Total indirect", 0.46487940173832, 0.00306411774923492,
			 -0.73083588506937, -0.00808064186704963, 0.0239975154218762,
			 16, 0.0079584367774133, 1, "Total indirect", 0.330794254670896,
			 0.00818335376107783, 0.972515304821076, -0.00789998300865004,
			 0.0038244480191575, 16, -0.00203776749474627, 1, "Total indirect",
			 0.495679150633037, 0.00299098124258618, -0.681304003426077,
			 -0.00918538545572257, 0.0236693376380419, 16, 0.00724197609115966,
			 1, "Total indirect", 0.387562077052581, 0.00838146092298592,
			 0.864046991056028, -0.00402373452404498, 0.00300481657223386,
			 50, -0.000509458975905558, 0, "Total indirect", 0.776308547721461,
			 0.001793030676002, -0.284132883348946, -0.0102609308206812,
			 0.0138820404246443, 50, 0.00181055480198153, 0, "Total indirect",
			 0.76878288008022, 0.00615903440975504, 0.293967313953283, -0.00391360331544369,
			 0.00329788478857778, 50, -0.000307859263432953, 1, "Total indirect",
			 0.867100817529795, 0.00183969913756191, -0.16734217957016, -0.0115732206291835,
			 0.0137614088606393, 50, 0.0010940941157279, 0, "Total indirect",
			 0.865572555560861, 0.00646303444595389, 0.169284896263062, -0.00342240483484985,
			 0.00612659732915889, 84, 0.00135209624715452, 0, "Total indirect",
			 0.578864311515848, 0.00243601470213995, 0.555044370613509, -0.0194895703043398,
			 0.00987920138827361, 84, -0.00480518445803307, 1, "Total indirect",
			 0.521288338552898, 0.00749217126545959, -0.641360733461331,
			 -0.00354322303885881, 0.00665061495811306, 84, 0.00155369595962713,
			 1, "Total indirect", 0.550202544672392, 0.00260051666188245,
			 0.597456644827817, -0.0207750910847323, 0.00973180079615886,
			 84, -0.00552164514428671, 1, "Total indirect", 0.47801808562423,
			 0.00778251338328806, -0.70949381932882, 0, 0, 1, 0, 0, 1, 1,
			 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-64")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-64")
})


context('Model number 65 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1403.04678023839, 1473.38637526007, 1019.10943670132, 15, 1, 100,
			 1.07986545550204e-207, 0, 1019.10943670132, 15))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 65))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544857894297983, 0.0642105505083614, -0.240323671894811, "contcor1",
			 "<unicode>", 0.121933496111051, "contGamma", 0.155377458364184,
			 -1.54670873384686, -0.403948648564471, 0.194622272532245, -0.104663188016113,
			 "contcor2", "<unicode>", 0.493079267127538, "contGamma", 0.152699469433665,
			 -0.685419460881496, 0.424981923547395, 0.896773736604286, 0.66087783007584,
			 "contcor2", "<unicode>", 3.99738018241891e-08, "contcor1", 0.120357265944253,
			 5.49096745336458, 0.744389066454191, 1.3152941414291, 1.02984160394165,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145641725939389, 7.07106151962404, 0.00465468533874082, 0.00822456541477661,
			 0.00643962537675871, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910700427200332, 7.07106879981967, 0.323889593289823,
			 0.572290827345728, 0.448090210317775, "debCollin1:contcor1",
			 "<unicode>", 1.53654866608122e-12, "debCollin1:contcor1", 0.0633688261660068,
			 7.07114582087914, 0.318530965898305, 0.562822959927098, 0.440676962912701,
			 "debCollin1:contcor2", "<unicode>", 1.53677071068614e-12, "debCollin1:contcor2",
			 0.0623205313862236, 7.07113615867075, 1.68041981289365, 2.96922224826198,
			 2.32482103057781, "contGamma", "<unicode>", 1.53810297831569e-12,
			 "contGamma", 0.328782172921095, 7.07100695248386, 0.732639137449832,
			 1.29453980440852, 1.01358947092918, "contcor1", "<unicode>",
			 1.53832502292062e-12, "contcor1", 0.143344640868631, 7.07099661896732,
			 0.721544110708485, 1.27493163326374, 0.99823787198611, "contcor2",
			 "<unicode>", 1.53788093371077e-12, "contcor2", 0.141172880450942,
			 7.07103141054772))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.214334400063963, 0.160729003796605, 16, "", -0.026802698133679,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.779381584427409,
			 0.095681197924814, -0.280125026807675, -0.145837648319071, 0.125266777602695,
			 50, "", -0.010285435358188, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.881775989235203, 0.069160563168559, -0.14871821290871,
			 -0.212952200800358, 0.228434316142994, 84, "", 0.0077410576713182,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.945190303481518,
			 0.1126006703248, 0.068747882663477, -0.0202410037155962, 0.0348504012079158,
			 16, 16, 0.00730469874615981, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.60323612183143, 0.0140541880764305,
			 0.519752454317167, -0.0240254044030977, 0.0491832377649295,
			 16, 16, 0.0125789166809159, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.500608166769765, 0.0186760171986546,
			 0.673533149338828, -0.0352543978369138, 0.0719245082787054,
			 50, 16, 0.0183350552208958, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.502487741030129, 0.0273420600993265,
			 0.670580605641614, -0.0447236346384332, 0.0248550298309785,
			 16, 16, -0.00993430240372733, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.575698090168735, 0.0177499854635696,
			 -0.559679467012336, -0.0607603809801409, 0.0265460303102508,
			 84, 16, -0.017107175334945, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.442435666144191, 0.0222724529580782,
			 -0.768086719821325, -0.0889285553466833, 0.0390576463652074,
			 16, 16, -0.0249354544907379, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.445036152446038, 0.0326501412070399,
			 -0.763716589543002, -0.113639449969041, 0.0561424876924285,
			 16, 16, -0.028748481138306, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.506853294900546, 0.0433125146688121,
			 -0.663745371473591, -0.134784642445383, 0.0357730989147896,
			 50, 16, -0.0495057717652965, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.255207773072518, 0.0435104274123173,
			 -1.13779097815256, -0.198017908090214, 0.0536984754880605, 50,
			 16, -0.0721597163010767, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.261128194966773, 0.0642145431150218,
			 -1.12372856366545, -0.0313505877875448, 0.0637156998319452,
			 50, 50, 0.0161825560222002, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.504602559106742, 0.0242520496216667,
			 0.667265500221586, -0.0193887157352401, 0.0751224375384903,
			 84, 50, 0.0278668609016251, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.247762555292482, 0.0241104311148629,
			 1.15580102109607, -0.0291503280327114, 0.110387917314066, 50,
			 50, 0.0406187946406775, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.253841260805793, 0.03559714526579,
			 1.14106887890568, -0.015045514225133, 0.0129326239697591, 16,
			 50, -0.00105644512768697, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.882330798368375, 0.00713741130336579,
			 -0.148015167234202, -0.0255104081968648, 0.021871945968393,
			 84, 50, -0.00181923111423592, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.880366643906552, 0.0120875573579422,
			 -0.150504445221149, -0.0371916320534951, 0.0318882019115827,
			 50, 50, -0.00265171507095621, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.88039279617149, 0.0176227304455517,
			 -0.150471294964711, -0.0785801701279456, 0.0388389224034142,
			 84, 50, -0.0198706238622657, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.507098463417757, 0.0299544005546905,
			 -0.663362427366426, -0.0932615464036052, 0.0248258913144304,
			 84, 50, -0.0342178275445874, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.256012955657315, 0.0301248999087469,
			 -1.13586526920384, -0.137011593432467, 0.0372596396698774, 84,
			 50, -0.049875976881295, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.261916330677679, 0.0444577641418348,
			 -1.12187326205102, -0.0513786666337711, 0.104556201480883, 16,
			 84, 0.0265887674235559, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.503881621688647, 0.0397800340579338,
			 0.668394787818262, -0.0314623929910987, 0.123035749180494, 16,
			 84, 0.0457866780946978, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.245357376454842, 0.0394135156029026,
			 1.16169992436112, -0.0473281693005111, 0.180805684502009, 50,
			 84, 0.0667387576007488, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.251487449717831, 0.0581984810950637,
			 1.14674397587344, -0.0233147482669857, 0.0420142808143232, 16,
			 84, 0.00934976627366878, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.574788928266291, 0.0166658748825529,
			 0.561012628473337, -0.0247999845827842, 0.0570011567404579,
			 84, 84, 0.0161005860788368, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.440384857540377, 0.0208680215474568,
			 0.771543485434012, -0.0364927162932693, 0.0834292120714994,
			 16, 84, 0.0234682478891151, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.443013485324179, 0.0305928908160297,
			 0.767114426362691, -0.0426374897502842, 0.0237086648284643,
			 16, 84, -0.00946441246090993, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.576035050855226, 0.0169253504406404,
			 -0.559185612971677, -0.0579555799010765, 0.0253595591980472,
			 50, 84, -0.0162980103515146, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.443193456393936, 0.0212542525669611,
			 -0.766811738035391, -0.0848224772101565, 0.0373104493677091,
			 50, 84, -0.0237560139212237, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.445783591899742, 0.0311569313368089,
			 -0.762463211297009))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.14583808320838, 0.125143774718167, -0.0103471542451065, "contGamma",
			 "<unicode>", 0.88101844248136, "contNormal", 0.0691292952482844,
			 -0.149678283395538, -2.31531250696746, 2.78532753742501, 0.235007515228776,
			 "debCollin1", "<unicode>", 0.856675870915007, "contNormal",
			 1.3012075947889, 0.180607242203272, -4.28111478431525, 0.442180771850385,
			 -1.91946700623243, "contcor1", "<unicode>", 0.111161968216788,
			 "contNormal", 1.20494447689406, -1.59299207809157, -1.06801200723661,
			 3.01245420843269, 0.972221100598041, "contcor2", "<unicode>",
			 0.350318906447238, "contNormal", 1.04095438688045, 0.933970895220117,
			 -0.159128439649018, 6.70675943081786, 3.27381549558442, "debCollin1:contcor1",
			 "<unicode>", 0.061607081549071, "contNormal", 1.75153419262398,
			 1.86911309489192, -0.132929690303591, 0.166841166632437, 0.0169557381644229,
			 "contGamma:contcor1", "<unicode>", 0.824531657621127, "contNormal",
			 0.0764735626012983, 0.221720259755952, -4.82823897887557, 1.38438828658848,
			 -1.72192534614354, "debCollin1:contcor2", "<unicode>", 0.277271805575083,
			 "contNormal", 1.58488301684839, -1.08646841933335, -0.0197476264485873,
			 0.00115989062507768, -0.00929386791175483, "contGamma", "<unicode>",
			 0.081421457499129, "debCollin1", 0.00533364828093292, -1.74249733432539,
			 -0.0185477645178422, 0.0350785914505509, 0.00826541346635433,
			 "contcor1", "<unicode>", 0.545725790259033, "debCollin1", 0.0136804442304529,
			 0.604177271375103, -0.0145561348283308, 0.00654302855870201,
			 -0.0040065531348144, "contGamma:contcor1", "<unicode>", 0.456657953615678,
			 "debCollin1", 0.00538253854495805, -0.744361252845542))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.205601718891591, 0.166605720116553, 16, 16, -0.0194979993875192,
			 "Total", 0.8373029731496, 0.0949526220747086, -0.205344507202531,
			 -0.140190194472091, 0.134228721248034, 16, 16, -0.00298073661202823,
			 "Total", 0.966037746485406, 0.0700061118175403, -0.0425782340232957,
			 -0.209081841218198, 0.239173354053154, 16, 16, 0.015045756417478,
			 "Total", 0.895322041666415, 0.114352916381916, 0.131573001314878,
			 -0.199379437359668, 0.170931874454142, 50, 16, -0.0142237814527631,
			 "Total", 0.880318284382709, 0.0944689072694137, -0.150565745533592,
			 -0.136220327919156, 0.140807290564612, 16, 16, 0.0022934813227279,
			 "Total", 0.974111072375611, 0.0706716094451036, 0.0324526544780253,
			 -0.206328343816902, 0.24696829252137, 16, 16, 0.0203199743522341,
			 "Total", 0.860514700522321, 0.115639021919234, 0.175719009163069,
			 -0.195005100293499, 0.178069814467932, 84, 16, -0.0084676429127832,
			 "Total", 0.929105592054903, 0.0951739209761502, -0.0889702013527962,
			 -0.135045878057237, 0.151145117782652, 16, 16, 0.00804961986270776,
			 "Total", 0.91220730570303, 0.0730092486640896, 0.110254796618213,
			 -0.205240359164606, 0.257392584949034, 16, 16, 0.026076112892214,
			 "Total", 0.825135176723861, 0.118020776851725, 0.220945104648604,
			 -0.227380424651945, 0.153906423577132, 16, 16, -0.0367370005374063,
			 "Total", 0.7056644706257, 0.0972688404574317, -0.377685190495139,
			 -0.157083198737802, 0.116643723213971, 50, 16, -0.0202197377619154,
			 "Total", 0.772154135161834, 0.0698295795511794, -0.289558348938589,
			 -0.221665932803487, 0.217279443338669, 16, 16, -0.00219324473240913,
			 "Total", 0.984373309974794, 0.111977918881291, -0.0195864037688914,
			 -0.236305341660484, 0.148485594723236, 50, 16, -0.043909873468624,
			 "Total", 0.654646168303471, 0.0981627569228062, -0.447317035962571,
			 -0.164545635120712, 0.109760413734446, 50, 16, -0.0273926106931331,
			 "Total", 0.695464753346434, 0.0699773187208668, -0.391449846805359,
			 -0.22754443843336, 0.208812203106106, 16, 16, -0.00936611766362684,
			 "Total", 0.932946108129093, 0.111317515265942, -0.0841387596664445,
			 -0.249675303025959, 0.146198997777125, 84, 16, -0.051738152624417,
			 "Total", 0.608435007166586, 0.100990197760186, -0.512308657393421,
			 -0.177797974695586, 0.107356194997734, 50, 16, -0.035220889848926,
			 "Total", 0.62826458660035, 0.0727447473378542, -0.484170900825964,
			 -0.237226702010465, 0.202837908371625, 16, 16, -0.0171943968194197,
			 "Total", 0.878271202536771, 0.112263443066624, -0.153161139100425,
			 -0.264632269118968, 0.153529910574998, 16, 16, -0.0555511792719851,
			 "Total", 0.602543160468945, 0.106675985628403, -0.520746810491096,
			 -0.194377094933604, 0.116309261940616, 84, 16, -0.0390339164964941,
			 "Total", 0.62237249559851, 0.0792581800800612, -0.492490698840986,
			 -0.247762915549241, 0.205748068615266, 16, 16, -0.0210074234669878,
			 "Total", 0.855913968360905, 0.115693703491938, -0.181577932358711,
			 -0.287847212032572, 0.135230272234621, 50, 16, -0.0763084698989755,
			 "Total", 0.479554838561324, 0.107929912897475, -0.70701872956631,
			 -0.211945793378382, 0.0923633791314125, 84, 16, -0.0597912071234846,
			 "Total", 0.441184576363281, 0.0776313174400515, -0.770194415026598,
			 -0.261399184577851, 0.177869756389894, 16, 16, -0.0417647140939783,
			 "Total", 0.709373199507705, 0.112060462445392, -0.372698034459125,
			 -0.33214172376899, 0.134216894899478, 84, 16, -0.0989624144347557,
			 "Total", 0.405511630427366, 0.118971221498723, -0.831818091703952,
			 -0.257307101209005, 0.0924167978904754, 84, 16, -0.0824451516592648,
			 "Total", 0.355435443087553, 0.0892169197643574, -0.924097714615362,
			 -0.295212623494595, 0.166375306235078, 16, 16, -0.0644186586297585,
			 "Total", 0.584337200917376, 0.117754186651035, -0.547060452471752,
			 -0.200336075750656, 0.179095791527698, 16, 50, -0.0106201421114788,
			 "Total", 0.912633679983115, 0.0967956223357329, -0.109717173723448,
			 -0.137198864958073, 0.148993106286097, 16, 50, 0.00589712066401213,
			 "Total", 0.935623302936667, 0.0730094974962844, 0.0807719661994967,
			 -0.204554866005715, 0.252402093392751, 50, 50, 0.0239236136935184,
			 "Total", 0.837396593638849, 0.116572794960235, 0.205224672717842,
			 -0.185829977310649, 0.187958302846541, 50, 50, 0.00106416276794606,
			 "Total", 0.99109586956418, 0.0953559052884607, 0.0111599042002367,
			 -0.125024835670829, 0.160187686757703, 16, 50, 0.017581425543437,
			 "Total", 0.809061385941769, 0.072759633513231, 0.241637082191184,
			 -0.194760525016141, 0.265976362162028, 50, 50, 0.0356079185729433,
			 "Total", 0.76192757588242, 0.117537079969939, 0.302950512145191,
			 -0.177058091152562, 0.204690284166559, 84, 50, 0.0138160965069985,
			 "Total", 0.8871838061608, 0.0973865791234695, 0.141868588375839,
			 -0.120819547193435, 0.181486265758414, 16, 50, 0.0303333592824895,
			 "Total", 0.694079090442879, 0.0771202469372904, 0.393325494758267,
			 -0.189714543855874, 0.286434248479866, 50, 50, 0.0483598523119957,
			 "Total", 0.690537428243563, 0.121468760674059, 0.398125839463872,
			 -0.215441708021528, 0.159723421498796, 16, 50, -0.027859143261366,
			 "Total", 0.770984491026582, 0.095707148825075, -0.291087380654129,
			 -0.145007115703382, 0.122323354731632, 50, 50, -0.011341880485875,
			 "Total", 0.867914103587614, 0.0681978017309714, -0.16630859350301,
			 -0.211540635430631, 0.224909860517893, 50, 50, 0.00668461254363123,
			 "Total", 0.952126127314941, 0.111341458157188, 0.0600370486813109,
			 -0.216837962489943, 0.159594103994113, 50, 50, -0.0286219292479149,
			 "Total", 0.765664346265569, 0.0960303529690606, -0.298050859577039,
			 -0.145235725221479, 0.121026392276631, 50, 50, -0.012104666472424,
			 "Total", 0.858561452213249, 0.0679252577083947, -0.178205676073982,
			 -0.211021473947583, 0.222865127061747, 50, 50, 0.00592182655708229,
			 "Total", 0.957333162666452, 0.110687391307129, 0.0535004618606534,
			 -0.21897442778394, 0.16006560137467, 84, 50, -0.0294544132046352,
			 "Total", 0.76066361513586, 0.0966956617949179, -0.304609458768741,
			 -0.146357885860174, 0.120483585001885, 50, 50, -0.0129371504291443,
			 "Total", 0.849271488100777, 0.0680730546496951, -0.190048037299325,
			 -0.21098543867221, 0.221164123872933, 50, 50, 0.00508934260036199,
			 "Total", 0.96317934389725, 0.110244261107317, 0.0461642406529241,
			 -0.246203127770199, 0.152856483778309, 16, 50, -0.0466733219959447,
			 "Total", 0.646616250516235, 0.101802791963587, -0.458467995775979,
			 -0.173408385760801, 0.113096267319894, 84, 50, -0.0301560592204537,
			 "Total", 0.679905430115844, 0.0730892647366499, -0.412592182027141,
			 -0.231508209295907, 0.207249076914012, 50, 50, -0.0121295661909475,
			 "Total", 0.913704188565841, 0.111929935874021, -0.108367489860795,
			 -0.26280234809009, 0.140761296733557, 50, 50, -0.0610205256782664,
			 "Total", 0.553375484463866, 0.102951801157293, -0.592709646575657,
			 -0.184581634738631, 0.0955751089330805, 84, 50, -0.0445032629027754,
			 "Total", 0.53349111231963, 0.0714698703347492, -0.622685653329605,
			 -0.239220564256233, 0.186267024509695, 50, 50, -0.0264767698732692,
			 "Total", 0.807288960080127, 0.1085447467714, -0.243924931061201,
			 -0.290607992879468, 0.13725064284952, 84, 50, -0.076678675014974,
			 "Total", 0.482361294891514, 0.109149616805177, -0.702509795813936,
			 -0.210839915162896, 0.0905170906839302, 84, 50, -0.060161412239483,
			 "Total", 0.433888532614003, 0.0768781998607862, -0.782554903059976,
			 -0.257063726761817, 0.172793888341863, 50, 50, -0.0421349192099768,
			 "Total", 0.700805128406923, 0.109659569893718, -0.384233854380551,
			 -0.199321764714107, 0.19889390329386, 16, 84, -0.000213930710123079,
			 "Total", 0.998319754982018, 0.101587496287953, -0.00210587639168394,
			 -0.140129056403728, 0.172735720534463, 16, 84, 0.0163033320653679,
			 "Total", 0.838145011399768, 0.0798139096957976, 0.204266801707952,
			 -0.203517205015472, 0.27217685520522, 84, 84, 0.0343298250948741,
			 "Total", 0.77725898673866, 0.121352755451862, 0.282892835577121,
			 -0.176911191252841, 0.214879151174879, 50, 84, 0.0189839799610188,
			 "Total", 0.849357794853869, 0.0999483524998704, 0.189937897786193,
			 -0.120615444731728, 0.191617930204748, 16, 84, 0.0355012427365098,
			 "Total", 0.655814197975431, 0.0796528347967954, 0.445699676942798,
			 -0.186784174854015, 0.293839646386047, 84, 84, 0.053527735766016,
			 "Total", 0.662424842802336, 0.122610370657615, 0.436567767301597,
			 -0.170196013877661, 0.250068132811801, 84, 84, 0.0399360594670698,
			 "Total", 0.709524009598208, 0.10721221155196, 0.3724954358181,
			 -0.120832511819082, 0.233739156304203, 16, 84, 0.0564533222425608,
			 "Total", 0.532553063425733, 0.0904536182603612, 0.62411347747379,
			 -0.182816990828601, 0.331776621372735, 84, 84, 0.074479815272067,
			 "Total", 0.570475323795869, 0.131276292896294, 0.56735160346815,
			 -0.206901521535656, 0.171995657815636, 16, 84, -0.0174529318600102,
			 "Total", 0.856711792783892, 0.0966592198479117, -0.180561480709978,
			 -0.138459418341364, 0.136588080172325, 50, 84, -0.00093566908451926,
			 "Total", 0.989360533344622, 0.0701664675175739, -0.0133349891710725,
			 -0.204365285347542, 0.238546933237516, 84, 84, 0.017090823944987,
			 "Total", 0.879770805671411, 0.112989887079225, 0.151259766575423,
			 -0.201091263602676, 0.179687039492991, 50, 84, -0.0107021120548422,
			 "Total", 0.912272132320799, 0.0971391071721719, -0.11017305353521,
			 -0.132521426223911, 0.144151727665209, 50, 84, 0.0058151507206488,
			 "Total", 0.93433695917477, 0.0705811831420075, 0.0823895330423814,
			 -0.197792842660692, 0.245476130161003, 84, 84, 0.023841643750155,
			 "Total", 0.833014420299555, 0.113080897485399, 0.210837058073699,
			 -0.198011481981838, 0.19134258149271, 84, 84, -0.00333445024456395,
			 "Total", 0.97321965849795, 0.0993268413465054, -0.0335704850709145,
			 -0.130493686912116, 0.15685931197397, 50, 84, 0.013182812530927,
			 "Total", 0.857283337712009, 0.0733056834596683, 0.179833430489465,
			 -0.193444466825734, 0.255863077946601, 84, 84, 0.0312093055604333,
			 "Total", 0.785405413044393, 0.114621377820311, 0.2722817170228,
			 -0.229394163848564, 0.156859942659386, 16, 84, -0.0362671105945889,
			 "Total", 0.712828930732911, 0.0985360214663825, -0.368059416798781,
			 -0.155211950789971, 0.115712255151775, 84, 84, -0.019749847819098,
			 "Total", 0.775065679106102, 0.0691145878390527, -0.285755126907354,
			 -0.216967180062911, 0.213520470483727, 84, 84, -0.00172335478959173,
			 "Total", 0.987479711906687, 0.109820296174386, -0.0156924981048601,
			 -0.239763529752368, 0.15356211278198, 50, 84, -0.0431007084851937,
			 "Total", 0.667525525386628, 0.10034001788728, -0.429546549748596,
			 -0.161389556581822, 0.108222665162417, 84, 84, -0.0265834457097027,
			 "Total", 0.699126214071503, 0.0687798918426324, -0.386500254616935,
			 -0.219400448042021, 0.202286542681628, 84, 84, -0.00855695268019644,
			 "Total", 0.936599995593924, 0.107575188638634, -0.0795439244725932,
			 -0.254228173948945, 0.153110749839139, 84, 84, -0.0505587120549027,
			 "Total", 0.626584648931746, 0.103914900222943, -0.486539581392389,
			 -0.172894036575567, 0.104811138016743, 84, 84, -0.0340414492794118,
			 "Total", 0.630865010063289, 0.0708444585673035, -0.480509696422788,
			 -0.22508332919844, 0.193053416698629, 84, 84, -0.0160149562499055,
			 "Total", 0.880657136002231, 0.106669497295684, -0.150136230655635,
			 -0.0202410037155962, 0.0348504012079158, 16, 16, 0.00730469874615981,
			 "Total indirect", 0.60323612183143, 0.0140541880764305, 0.519752454317167,
			 -0.0240254044030977, 0.0491832377649295, 16, 16, 0.0125789166809159,
			 "Total indirect", 0.500608166769765, 0.0186760171986546, 0.673533149338828,
			 -0.0352543978369138, 0.0719245082787054, 16, 16, 0.0183350552208958,
			 "Total indirect", 0.502487741030129, 0.0273420600993265, 0.670580605641614,
			 -0.0447236346384332, 0.0248550298309785, 50, 16, -0.00993430240372733,
			 "Total indirect", 0.575698090168735, 0.0177499854635696, -0.559679467012336,
			 -0.0607603809801409, 0.0265460303102508, 16, 16, -0.017107175334945,
			 "Total indirect", 0.442435666144191, 0.0222724529580782, -0.768086719821325,
			 -0.0889285553466833, 0.0390576463652074, 16, 16, -0.0249354544907379,
			 "Total indirect", 0.445036152446038, 0.0326501412070399, -0.763716589543002,
			 -0.113639449969041, 0.0561424876924285, 84, 16, -0.028748481138306,
			 "Total indirect", 0.506853294900546, 0.0433125146688121, -0.663745371473591,
			 -0.134784642445383, 0.0357730989147896, 16, 16, -0.0495057717652965,
			 "Total indirect", 0.255207773072518, 0.0435104274123173, -1.13779097815256,
			 -0.198017908090214, 0.0536984754880605, 16, 16, -0.0721597163010767,
			 "Total indirect", 0.261128194966773, 0.0642145431150218, -1.12372856366545,
			 -0.0313505877875448, 0.0637156998319452, 16, 50, 0.0161825560222002,
			 "Total indirect", 0.504602559106742, 0.0242520496216667, 0.667265500221586,
			 -0.0193887157352401, 0.0751224375384903, 50, 50, 0.0278668609016251,
			 "Total indirect", 0.247762555292482, 0.0241104311148629, 1.15580102109607,
			 -0.0291503280327114, 0.110387917314066, 16, 50, 0.0406187946406775,
			 "Total indirect", 0.253841260805793, 0.03559714526579, 1.14106887890568,
			 -0.015045514225133, 0.0129326239697591, 50, 50, -0.00105644512768697,
			 "Total indirect", 0.882330798368375, 0.00713741130336579, -0.148015167234202,
			 -0.0255104081968648, 0.021871945968393, 50, 50, -0.00181923111423592,
			 "Total indirect", 0.880366643906552, 0.0120875573579422, -0.150504445221149,
			 -0.0371916320534951, 0.0318882019115827, 16, 50, -0.00265171507095621,
			 "Total indirect", 0.88039279617149, 0.0176227304455517, -0.150471294964711,
			 -0.0785801701279456, 0.0388389224034142, 84, 50, -0.0198706238622657,
			 "Total indirect", 0.507098463417757, 0.0299544005546905, -0.663362427366426,
			 -0.0932615464036052, 0.0248258913144304, 50, 50, -0.0342178275445874,
			 "Total indirect", 0.256012955657315, 0.0301248999087469, -1.13586526920384,
			 -0.137011593432467, 0.0372596396698774, 16, 50, -0.049875976881295,
			 "Total indirect", 0.261916330677679, 0.0444577641418348, -1.12187326205102,
			 -0.0513786666337711, 0.104556201480883, 16, 84, 0.0265887674235559,
			 "Total indirect", 0.503881621688647, 0.0397800340579338, 0.668394787818262,
			 -0.0314623929910987, 0.123035749180494, 84, 84, 0.0457866780946978,
			 "Total indirect", 0.245357376454842, 0.0394135156029026, 1.16169992436112,
			 -0.0473281693005111, 0.180805684502009, 16, 84, 0.0667387576007488,
			 "Total indirect", 0.251487449717831, 0.0581984810950637, 1.14674397587344,
			 -0.0233147482669857, 0.0420142808143232, 50, 84, 0.00934976627366878,
			 "Total indirect", 0.574788928266291, 0.0166658748825529, 0.561012628473337,
			 -0.0247999845827842, 0.0570011567404579, 84, 84, 0.0161005860788368,
			 "Total indirect", 0.440384857540377, 0.0208680215474568, 0.771543485434012,
			 -0.0364927162932693, 0.0834292120714994, 16, 84, 0.0234682478891151,
			 "Total indirect", 0.443013485324179, 0.0305928908160297, 0.767114426362691,
			 -0.0426374897502842, 0.0237086648284643, 84, 84, -0.00946441246090993,
			 "Total indirect", 0.576035050855226, 0.0169253504406404, -0.559185612971677,
			 -0.0579555799010765, 0.0253595591980472, 84, 84, -0.0162980103515146,
			 "Total indirect", 0.443193456393936, 0.0212542525669611, -0.766811738035391,
			 -0.0848224772101565, 0.0373104493677091, 16, 84, -0.0237560139212237,
			 "Total indirect", 0.445783591899742, 0.0311569313368089, -0.762463211297009,
			 16, 16, 50, 50, 16, 50, 84, 16, 50, 16, 50, 50, 50, 50, 50,
			 84, 50, 50, 16, 84, 50, 50, 84, 50, 84, 84, 50, 16, 16, 84,
			 50, 16, 84, 84, 16, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84,
			 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 16, 16, 50, 16, 16,
			 84, 16, 16, 16, 50, 16, 50, 50, 16, 84, 50, 16, 16, 84, 16,
			 50, 84, 16, 84, 84, 16, 16, 16, 50, 50, 16, 50, 84, 16, 50,
			 16, 50, 50, 50, 50, 50, 84, 50, 50, 16, 84, 50, 50, 84, 50,
			 84, 84, 50, 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 50, 84,
			 50, 50, 84, 84, 50, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50,
			 16, 84, 50, 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50,
			 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-65")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-65")
})


context('Model number 65 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(22995.7910522591, 23153.7227953462, 24948.1916009282, 15, 1, 2564,
			 0, 0, 24948.1916009282, 15))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 65))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678663455694198, 0.0881399975571723, 0.078003171563296, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.0051719450325793, 15.0819800040286,
			 -0.0939554758243198, -0.0542198702499051, -0.0740876730371125,
			 "contcor2", "<unicode>", 2.69562150378988e-13, "facGenderm",
			 0.0101368203415583, -7.30876848368046, -0.0997953581805871,
			 -0.0599923784600993, -0.0798938683203432, "contcor2", "<unicode>",
			 3.5527136788005e-15, "facExperimexperimental", 0.010154007939546,
			 -7.86821014874207, 0.960809912069224, 1.0720902098132, 1.01645006094121,
			 "contNormal", "<unicode>", 0, "contNormal", 0.0283883526997791,
			 35.8051793878522, 0.00607839570427823, 0.00678239413896368,
			 0.00643039492162095, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000179594737515203, 35.8050297608337, 0.103586140163688, 0.115583467340946,
			 0.109584803752317, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.0030605988864825,
			 35.8050198071729, 0.426153463873216, 0.475510422042999, 0.450831942958107,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.0125912921255452, 35.8050578497389, 0.236314971729689, 0.263684914203534,
			 0.249999942966612, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698225648270483, 35.8050357482378, 0.236315024754011, 0.263684980265646,
			 0.250000002509829, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698225980873269, 35.8050272201494,
			 0.975411380847127, 1.08838371744682, 1.03189754914698, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288200031966934, 35.8049075187253
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.495421715828635, 0.727954690685578, "", 0.611688203257107, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0593207264753672,
			 10.3115426867051, 0.214359739504705, 0.451349137343717, "",
			 0.332854438424211, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 3.67943062684617e-08, 0.0604575899629672, 5.50558562834044,
			 -0.00803085802109435, 0.00373631019081049, 16, -0.00214727391514193,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.474418246625348, 0.00300188378580493, -0.71530880885389, -0.00833468644536306,
			 0.0235970116873817, 16, 0.00763116262100934, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.348861558364303,
			 0.00814599104489113, 0.936799780279078, -0.00832846814460817,
			 0.00386057561949332, 16, -0.00223394626255743, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.472495546221989,
			 0.00310950707774406, -0.718424562705337, -0.00854735732126349,
			 0.0244257295177095, 16, 0.00793918609822303, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.345255766668898,
			 0.00841165631079462, 0.943831488696789, -0.0041711328305931,
			 0.00295228210594821, 50, -0.000609425362322442, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.737354057882968,
			 0.00181723107994073, -0.335359310683988, -0.00989808064238189,
			 0.0142297348504969, 50, 0.00216582710405752, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.724934770139366,
			 0.00615516807533096, 0.351871318142853, -0.00448117319990573,
			 0.00308897778042986, 50, -0.000696097709737938, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.718511435319737,
			 0.00193119645055929, -0.360448938033385, -0.0102458372198477,
			 0.0151935383823901, 50, 0.0024738505812712, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.703059920966767,
			 0.00648975588401122, 0.381193164347833, -0.00345569193598933,
			 0.00554660060083892, 84, 0.00104545433242479, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.648944415427499,
			 0.00229654539773108, 0.455229116505893, -0.0182988200446381,
			 0.0108679729903209, 84, -0.00371542352715863, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.617538765428926,
			 0.00744064515088618, -0.499341582862088, -0.0036181559528088,
			 0.00553571992282739, 84, 0.000958781985009298, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.681383899399486,
			 0.00233521532738377, 0.410575407657785, -0.0185148072546066,
			 0.0117000071547167, 84, -0.00340740004994494, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.658445743129301,
			 0.00770800245505886, -0.44206006287772))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.495421715828635, 0.727954690685578, 0.611688203257107, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0593207264753672, 10.3115426867051,
			 -0.794781743145051, 0.553690365644729, -0.120545688750161, "debCollin1",
			 "<unicode>", 0.72602417526502, "contNormal", 0.344004308096056,
			 -0.35041912532241, -0.507004112571052, 0.813106294415115, 0.153051090922032,
			 "facExperimexperimental", "<unicode>", 0.649491301797861, "contNormal",
			 0.336769047135312, 0.454468996553999, -0.461034853067465, 0.142410728283518,
			 -0.159312062391974, "contcor2", "<unicode>", 0.300726468358885,
			 "contNormal", 0.153943028063496, -1.03487676185155, -0.992922700355674,
			 0.958334047456704, -0.0172943264494852, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.972284672254249, "contNormal", 0.497778725324456,
			 -0.0347430003928203, -0.44516937141264, -0.11249815825315, -0.278833764832895,
			 "facGenderm:facExperimexperimental", "<unicode>", 0.00101783074943707,
			 "contNormal", 0.0848666648427109, -3.28555110949248, -0.167904034507761,
			 0.745566976214366, 0.288831470853302, "debCollin1:contcor2",
			 "<unicode>", 0.215180143846721, "contNormal", 0.233032601090497,
			 1.2394466246426, -0.00422885506552035, 0.0142520667434838, 0.0050116058389817,
			 "facGenderm", "<unicode>", 0.287784061273107, "debCollin1",
			 0.00471460750166311, 1.06299534737808, -0.0125866721647699,
			 0.0058942496441765, -0.0033462112602967, "facExperimexperimental",
			 "<unicode>", 0.477856735000733, "debCollin1", 0.00471460750164839,
			 -0.709753942216133, -0.0358902572691806, -0.00975428700168712,
			 -0.0228222721354339, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000619494515981645, "debCollin1", 0.00666746187012892, -3.42293253114511
			))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.493172963640797, 0.725908895043133, 16, 0.609540929341965, 0,
			 "Total", 0, 0.0593725020556826, 10.2663844075546, 0.212189953263241,
			 0.449224375754898, 16, 0.330707164509069, 0, "Total", 4.52506281334308e-08,
			 0.0604690760548035, 5.46902956164482, 0.501795198467374, 0.736843533288858,
			 16, 0.619319365878116, 0, "Total", 0, 0.0599624117268265, 10.3284599141805,
			 0.220485755899616, 0.460485446190826, 16, 0.340485601045221,
			 1, "Total", 2.67972302125941e-08, 0.0612255358221623, 5.56116980395576,
			 0.492974042577443, 0.725934471411655, 16, 0.609454256994549,
			 0, "Total", 0, 0.0594297728610765, 10.2550325813833, 0.211752375814602,
			 0.449488608508706, 16, 0.330620492161654, 0, "Total", 4.99591989999715e-08,
			 0.0606481125595514, 5.45145558877883, 0.502388660578844, 0.736866118131816,
			 16, 0.61962738935533, 0, "Total", 0, 0.0598167770945029, 10.3587558449764,
			 0.221924779059392, 0.459662469985476, 16, 0.340793624522434,
			 1, "Total", 1.9188652000679e-08, 0.0606484845643412, 5.6191614179723,
			 0.494850029032976, 0.727307526756592, 50, 0.611078777894784,
			 0, "Total", 0, 0.0593014717508106, 10.3046140315469, 0.213703589356443,
			 0.450786436767335, 50, 0.332245013061889, 1, "Total", 3.94404031656137e-08,
			 0.0604814295775257, 5.49333928418497, 0.496637565644507, 0.731070495077821,
			 50, 0.613854030361164, 1, "Total", 0, 0.0598054176715722, 10.2641876649405,
			 0.215889017090042, 0.454151513966496, 50, 0.335020265528269,
			 0, "Total", 3.5518172403215e-08, 0.0607823660934176, 5.51180033059867,
			 0.494654779754888, 0.727329431339849, 50, 0.610992105547369,
			 0, "Total", 0, 0.0593568691619512, 10.2935366061899, 0.213269807802927,
			 0.45104687362602, 50, 0.332158340714473, 0, "Total", 4.35362388362392e-08,
			 0.0606585293655005, 5.47587197033807, 0.49723453778531, 0.731089569891446,
			 50, 0.614162053838378, 1, "Total", 0, 0.0596579921750488, 10.2947154513062,
			 0.217339099876441, 0.453317478134524, 50, 0.335328289005483,
			 1, "Total", 2.54348226924606e-08, 0.0601996720652653, 5.57026770248743,
			 0.496520703289381, 0.728946611889682, 84, 0.612733657589531,
			 0, "Total", 0, 0.0592934131529066, 10.333924545875, 0.215201030030238,
			 0.452598755483034, 84, 0.333899892756636, 1, "Total", 3.52009963400235e-08,
			 0.0605617570846605, 5.51337855488358, 0.490300337282192, 0.725645222177704,
			 84, 0.607972779729948, 0, "Total", 0, 0.0600380636460368, 10.1264554985374,
			 0.210170236027248, 0.448107793766857, 84, 0.329139014897053,
			 1, "Total", 5.87921960004678e-08, 0.0606994719332676, 5.4224362159016,
			 0.496329535714912, 0.72896443476932, 84, 0.612646985242116,
			 1, "Total", 0, 0.0593467280239335, 10.3231804960679, 0.21477171024127,
			 0.452854730577171, 84, 0.333813220409221, 1, "Total", 3.88322212163672e-08,
			 0.0607365804203214, 5.49608190153445, 0.490899144366831, 0.725662462047492,
			 84, 0.608280803207162, 1, "Total", 0, 0.0598897019364754, 10.156684430528,
			 0.211624839899324, 0.447269236849209, 84, 0.329447038374266,
			 1, "Total", 4.2453730753067e-08, 0.0601144711863631, 5.48032831151313,
			 -0.00803085802109435, 0.00373631019081049, 16, -0.00214727391514193,
			 0, "Total indirect", 0.474418246625348, 0.00300188378580493,
			 -0.71530880885389, -0.00833468644536306, 0.0235970116873817,
			 16, 0.00763116262100934, 0, "Total indirect", 0.348861558364303,
			 0.00814599104489113, 0.936799780279078, -0.00832846814460817,
			 0.00386057561949332, 16, -0.00223394626255743, 0, "Total indirect",
			 0.472495546221989, 0.00310950707774406, -0.718424562705337,
			 -0.00854735732126349, 0.0244257295177095, 16, 0.00793918609822303,
			 1, "Total indirect", 0.345255766668898, 0.00841165631079462,
			 0.943831488696789, -0.0041711328305931, 0.00295228210594821,
			 50, -0.000609425362322442, 0, "Total indirect", 0.737354057882968,
			 0.00181723107994073, -0.335359310683988, -0.00989808064238189,
			 0.0142297348504969, 50, 0.00216582710405752, 0, "Total indirect",
			 0.724934770139366, 0.00615516807533096, 0.351871318142853, -0.00448117319990573,
			 0.00308897778042986, 50, -0.000696097709737938, 0, "Total indirect",
			 0.718511435319737, 0.00193119645055929, -0.360448938033385,
			 -0.0102458372198477, 0.0151935383823901, 50, 0.0024738505812712,
			 1, "Total indirect", 0.703059920966767, 0.00648975588401122,
			 0.381193164347833, -0.00345569193598933, 0.00554660060083892,
			 84, 0.00104545433242479, 0, "Total indirect", 0.648944415427499,
			 0.00229654539773108, 0.455229116505893, -0.0182988200446381,
			 0.0108679729903209, 84, -0.00371542352715863, 1, "Total indirect",
			 0.617538765428926, 0.00744064515088618, -0.499341582862088,
			 -0.0036181559528088, 0.00553571992282739, 84, 0.000958781985009298,
			 1, "Total indirect", 0.681383899399486, 0.00233521532738377,
			 0.410575407657785, -0.0185148072546066, 0.0117000071547167,
			 84, -0.00340740004994494, 0, "Total indirect", 0.658445743129301,
			 0.00770800245505886, -0.44206006287772, 0, 0, 1, 1, 0, 1, 0,
			 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1,
			 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1,
			 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-65")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-65")
})


context('Model number 66 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1403.06364229056, 1473.40323731224, 1154.52691555085, 22, 1, 100,
			 2.28675230684508e-230, 0, 1154.52691555085, 22))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 66))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848038172027, 0.0642089545333059, -0.24031954181936, "contcor1",
			 "<unicode>", 0.121932892675209, "contGamma", 0.155374536856161,
			 -1.54671123519961, -0.403934558301244, 0.194627998227913, -0.104653280036666,
			 "contcor2", "<unicode>", 0.493114158729449, "contGamma", 0.1526973355762,
			 -0.685364152830558, 0.424979376211947, 0.896763764986541, 0.660871570599244,
			 "contcor2", "<unicode>", 3.99660158301174e-08, "contcor1", 0.120355371959885,
			 5.49100185423808, 0.744514312344543, 1.31551495412497, 1.03001463323476,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145666105674494, 7.07106590421545, 0.00465468681173985, 0.00822457055251477,
			 0.00643962868212731, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910701362099944, 7.07106517034132, 0.32389180702558,
			 0.572298548837981, 0.44809517793178, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702312317476,
			 7.07106742743414, 0.318532840248742, 0.562829497550416, 0.440681168899579,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217210185125, 7.07106866911901, 1.68041089531135, 2.96919114386062,
			 2.32480101958599, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776512914269, 7.07106781740276, 0.732634704702719,
			 1.2945243432018, 1.01357952395226, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341827434381, 7.07106601118404,
			 0.721542091489572, 1.27492459022991, 0.998233340859739, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171598841955,
			 7.07106350745016))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.178874567817152, 0.175985608788068, "", 16, -0.00144447951454176,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.987269254319386,
			 0.0905272187153214, -0.0159563006026306, -0.14874393692075,
			 0.122082862108533, "", 50, -0.0133305374061088, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.847001840715609, 0.0690897386802845,
			 -0.192945257294956, -0.241085041983158, 0.1865593986602, "",
			 84, -0.0272628216614788, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.802664771058255, 0.109094974197629, -0.24989988642457,
			 -0.0196392961639237, 0.0330748790532665, 16, 16, 0.00671779144467139,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.6173934102171, 0.0134477407832473, 0.499547957753632, -0.024351687893088,
			 0.0474890895525301, 16, 16, 0.0115687008297211, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.527886326979869,
			 0.0183270657043418, 0.63123584628064, -0.0356981027124204, 0.0694238064900705,
			 50, 16, 0.0168628518888251, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.52947683436035, 0.0268173063463613,
			 0.628804834871609, -0.0434783887116253, 0.02437183982181, 16,
			 16, -0.0095532744449076, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.581000644960966, 0.0173090498265859,
			 -0.551923678111678, -0.059534389248988, 0.0266310236391431,
			 84, 16, -0.0164516828049225, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.454196412931435, 0.0219813765884968,
			 -0.748437330059298, -0.0871199824027819, 0.0391591448731928,
			 16, 16, -0.0239804187647946, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.456637718873548, 0.0322146550324517,
			 -0.744394709197962, -0.108340001367148, 0.0537178516386322,
			 16, 16, -0.0273110748642579, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.508860839531898, 0.0413420487019333,
			 -0.660612517322606, -0.129165065485269, 0.0351003249987715,
			 50, 16, -0.0470323702432489, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.261713027143865, 0.0419052063659703,
			 -1.12235147662802, -0.189731675552637, 0.0526203602777639, 50,
			 16, -0.0685556576374368, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.267492787097063, 0.0618256349968784,
			 -1.10885488909088, -0.0302741743644293, 0.0613297180104607,
			 50, 50, 0.0155277718230157, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.506391578327845, 0.0233687692981733,
			 0.664466820006197, -0.0191701669969152, 0.0726508825720107,
			 84, 50, 0.0267403577875478, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.253632252633724, 0.0234241675595059,
			 1.14157131601871, -0.0287854476359952, 0.10674038820584, 50,
			 50, 0.0389774702849222, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.259582602503783, 0.0345735526037329,
			 1.12737822264507, -0.0145239648445226, 0.013037376711396, 16,
			 50, -0.000743294066563336, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.915808133935269, 0.00703108367636317,
			 -0.105715434601086, -0.0248122724390176, 0.0222522207448261,
			 84, 50, -0.00128002584709574, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.915097314520352, 0.0120064688828678,
			 -0.106611349230432, -0.0361708306475357, 0.032439229910141,
			 50, 50, -0.00186580036869738, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.915106658612447, 0.0175028880884711,
			 -0.106599571411667, -0.0734968619424734, 0.0364946729706462,
			 84, 50, -0.0185010944859136, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.509670813004248, 0.0280595806302358,
			 -0.659350356290702, -0.0878059940421698, 0.0240845674713255,
			 84, 50, -0.0318607132854221, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.264338613795275, 0.0285440350935206,
			 -1.11619514133285, -0.128970167850657, 0.036088089367978, 84,
			 50, -0.0464410392413396, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.270063287900145, 0.0421074720047393,
			 -1.10291682284115, -0.0501710344686642, 0.101879876632181, 16,
			 84, 0.0258544210817585, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.505068299590456, 0.0387892104906528,
			 0.666536409344777, -0.0312164464738847, 0.120264183392764, 16,
			 84, 0.0445238684594395, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.249254152146401, 0.0386437279106933,
			 1.15216287006096, -0.0469175767501716, 0.176715971643431, 50,
			 84, 0.0648991974466298, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.25529753219854, 0.0570504229051135,
			 1.13757609745629, -0.0235955054969329, 0.0427622158812918, 16,
			 84, 0.00958335519217947, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.571316010477457, 0.0169283012090135,
			 0.566114406510961, -0.0247007661530618, 0.0577077358026536,
			 84, 84, 0.0165034848247959, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.432440778492365, 0.0210229633314038,
			 0.785021814700273, -0.0363632491613302, 0.0844751027473505,
			 16, 84, 0.0240559267930101, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.435178596431148, 0.0308266766282029,
			 0.780360694834087, -0.0383594945787989, 0.0220106041244572,
			 16, 84, -0.00817444522717084, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.595571292765503, 0.0154008183771354,
			 -0.530779925260782, -0.053600104726203, 0.0254456994991421,
			 50, 84, -0.0140772026135305, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.485116680790171, 0.0201651165146014,
			 -0.69809676543834, -0.0784012530618841, 0.0373626289026199,
			 50, 84, -0.0205193120796321, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.487172634367666, 0.0295321452020636,
			 -0.694812785838472))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.148007977467244, 0.122092117859383, -0.0129579298039303, "contGamma",
			 "<unicode>", 0.850832149076808, "contNormal", 0.0689043516761385,
			 -0.188056769837043, -2.36012781337828, 2.71484837005517, 0.177360278338444,
			 "debCollin1", "<unicode>", 0.89103581363456, "contNormal", 1.29466057117993,
			 0.136993650912532, -3.92591633389994, 0.389063554750851, -1.76842638957454,
			 "contcor1", "<unicode>", 0.108159573167992, "contNormal", 1.10078040277444,
			 -1.60652059676694, -1.07356788683604, 3.07543417453541, 1.00093314384968,
			 "contcor2", "<unicode>", 0.344317045790275, "contNormal", 1.05843834225992,
			 0.945669770156419, -0.183436914195339, 6.3637504591783, 3.09015677249148,
			 "debCollin1:contcor1", "<unicode>", 0.0642938425013915, "contNormal",
			 1.6702315514512, 1.85013674888763, -4.81086114817071, 1.39316456210659,
			 -1.70884829303206, "debCollin1:contcor2", "<unicode>", 0.280270361583733,
			 "contNormal", 1.58268870224501, -1.07971219520813, -0.148380697680573,
			 0.123457112250573, -0.012461792715, "contGamma:contcor2", "<unicode>",
			 0.85738787578261, "contNormal", 0.0693476543638985, -0.179700277238035,
			 -0.0197475156588486, 0.00116000678047473, -0.00929375443918691,
			 "contGamma", "<unicode>", 0.0814252552396264, "debCollin1",
			 0.00533364964974845, -1.74247561229021, -0.018547611112472,
			 0.0350787586186767, 0.00826557375310237, "contcor1", "<unicode>",
			 0.545718104536651, "debCollin1", 0.0136804477414245, 0.604188832802171,
			 -0.0145563079873152, 0.00654286081444775, -0.00400672358643374,
			 "contGamma:contcor1", "<unicode>", 0.45663891630678, "debCollin1",
			 0.00538253992629215, -0.744392729325063))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.171500028067271, 0.182046651927531, 16, 16, 0.00527331193012964,
			 "Total", 0.953376221471884, 0.0901921368921911, 0.058467535107112,
			 -0.143299193705906, 0.130073701783031, 16, 16, -0.00661274596143738,
			 "Total", 0.92445701653804, 0.0697392650184563, -0.0948209872829508,
			 -0.236751036049727, 0.195660975616112, 16, 50, -0.0205450302168074,
			 "Total", 0.852251795885517, 0.110311213643886, -0.186246071801297,
			 -0.166439581129396, 0.186688023759755, 16, 16, 0.0101242213151793,
			 "Total", 0.910518210160176, 0.0900852280130086, 0.11238492190659,
			 -0.139701157828175, 0.1361774846754, 16, 84, -0.0017618365763877,
			 "Total", 0.980028056424243, 0.070378497941715, -0.0250337337100714,
			 -0.233820680288256, 0.20243243862474, 16, 16, -0.0156941208317577,
			 "Total", 0.887855213871622, 0.111291105947381, -0.141018643836445,
			 -0.163233119560448, 0.194069864309014, 50, 16, 0.0154183723742833,
			 "Total", 0.865676215039567, 0.091150395284766, 0.16915310488906,
			 -0.138682832900389, 0.145747461865821, 16, 16, 0.00353231448271628,
			 "Total", 0.961173329558938, 0.0725600819733833, 0.0486812361101248,
			 -0.232462925034433, 0.211662985489126, 50, 50, -0.0103999697726537,
			 "Total", 0.926863431236917, 0.113299508059017, -0.0917918352058194,
			 -0.189953026316296, 0.167957518397398, 16, 16, -0.0109977539594494,
			 "Total", 0.904126512264088, 0.0913053881440799, -0.120450218579597,
			 -0.159639356544613, 0.113871732842581, 50, 84, -0.0228838118510164,
			 "Total", 0.74293583261472, 0.0697745192117341, -0.32796803345322,
			 -0.251003585244355, 0.177371393031582, 16, 16, -0.0368160961063864,
			 "Total", 0.736197714985633, 0.109281339263095, -0.336892797568593,
			 -0.197594859289398, 0.161802534650469, 84, 16, -0.0178961623194642,
			 "Total", 0.845242269005691, 0.0916846933858856, -0.195192476067322,
			 -0.167041054772535, 0.107476614350473, 16, 16, -0.0297822202110312,
			 "Total", 0.670639783853262, 0.0700313044750741, -0.425270105051827,
			 -0.257871702411353, 0.17044269347855, 84, 50, -0.0437145044664013,
			 "Total", 0.689101574957268, 0.109265884288791, -0.400074595569677,
			 -0.209662404732636, 0.158812608173963, 16, 16, -0.0254248982793363,
			 "Total", 0.786793823013107, 0.0940004550627161, -0.270476331868533,
			 -0.179969076817926, 0.105347164476119, 84, 84, -0.0373109561709033,
			 "Total", 0.608223415651043, 0.0727860928936917, -0.512611059167554,
			 -0.268521832873796, 0.166035352021249, 16, 16, -0.0512432404262733,
			 "Total", 0.643909059329503, 0.110858461768373, -0.462240226040123,
			 -0.223149373852509, 0.16563826509491, 16, 16, -0.0287555543787997,
			 "Total", 0.771872738465996, 0.0991823426384685, -0.289926146265945,
			 -0.194393261866012, 0.113110037325279, 50, 16, -0.0406416122703667,
			 "Total", 0.604400449469044, 0.0784461606480622, -0.518082872821522,
			 -0.277833865149489, 0.168686072098015, 16, 50, -0.0545738965257367,
			 "Total", 0.631870610029828, 0.113910240384414, -0.479095613718007,
			 -0.242854390369596, 0.145900690854015, 50, 16, -0.0484768497577906,
			 "Total", 0.624979153622299, 0.0991740369440615, -0.488805853341774,
			 -0.211715871080552, 0.0909900557818365, 16, 84, -0.0603629076493576,
			 "Total", 0.4344044428523, 0.0772223186880203, -0.781676964314229,
			 -0.293983017842081, 0.145392634032626, 50, 16, -0.0742951919047276,
			 "Total", 0.507438800001243, 0.112087685115759, -0.66283099546573,
			 -0.283347320546075, 0.143347046242118, 50, 16, -0.0700001371519785,
			 "Total", 0.520176932463971, 0.10885260396464, -0.643072692819708,
			 -0.254658581282025, 0.0908861911949341, 50, 16, -0.0818861950435456,
			 "Total", 0.352923743517692, 0.0881507964438562, -0.928933127628624,
			 -0.328793136048458, 0.137156177450627, 50, 50, -0.0958184792989156,
			 "Total", 0.420185444820385, 0.118866804996019, -0.806099560782548,
			 -0.167261467157544, 0.195428051774492, 50, 16, 0.0140832923084739,
			 "Total", 0.879020176792225, 0.0925245366223268, 0.152211433016521,
			 -0.139896173506887, 0.144290642340701, 50, 84, 0.00219723441690689,
			 "Total", 0.975821790704043, 0.0724979688630038, 0.0303075306986725,
			 -0.231052842169877, 0.207582742492951, 50, 16, -0.0117350498384631,
			 "Total", 0.916477451276327, 0.111898888990494, -0.104871906632246,
			 -0.154690857473615, 0.205282614019627, 84, 16, 0.025295878273006,
			 "Total", 0.782963432702582, 0.0918316546458676, 0.275459245186805,
			 -0.12809725218177, 0.154916892944648, 50, 16, 0.013409820381439,
			 "Total", 0.852652863226616, 0.0721988126717628, 0.185734638634627,
			 -0.22032753526624, 0.219282607518378, 84, 50, -0.000522463873930987,
			 "Total", 0.996282892343751, 0.112147505324641, -0.00465872042733878,
			 -0.147758295514565, 0.222824277055326, 50, 16, 0.0375329907703805,
			 "Total", 0.691356836626421, 0.0945381077134578, 0.397014406974824,
			 -0.123738278934285, 0.175032144691912, 84, 84, 0.0256469328788135,
			 "Total", 0.736499196584375, 0.0762183453325825, 0.336492910819591,
			 -0.21416356013773, 0.237592857384617, 50, 16, 0.0117146486234435,
			 "Total", 0.919035300807945, 0.115246101735987, 0.101648979418671,
			 -0.179100093270816, 0.174724546108606, 16, 16, -0.00218777358110509,
			 "Total", 0.98066296299461, 0.0902630462014472, -0.024237754797489,
			 -0.147660140219373, 0.119512477274029, 84, 16, -0.0140738314726721,
			 "Total", 0.836408374549731, 0.0681575323834584, -0.206489744867697,
			 -0.239825399269126, 0.183813167813042, 16, 50, -0.0280061157280421,
			 "Total", 0.795526753071204, 0.1080730488988, -0.259140609184323,
			 -0.179902990169639, 0.174453979446364, 84, 16, -0.0027245053616375,
			 "Total", 0.97595642226865, 0.0903988472265627, -0.0301387179729094,
			 -0.147716265528945, 0.118495139022536, 16, 84, -0.0146105632532045,
			 "Total", 0.829659240488908, 0.0679123204944895, -0.215138625021509,
			 -0.239442169404622, 0.182356474387473, 84, 16, -0.0285428475085745,
			 "Total", 0.790809910541257, 0.107603672087648, -0.265259046971233,
			 -0.181414281792875, 0.174793722026397, 50, 16, -0.00331027988323914,
			 "Total", 0.970940834073235, 0.0908710585064307, -0.0364283187369814,
			 -0.148624986344969, 0.118232310795357, 84, 16, -0.0151963377748062,
			 "Total", 0.823362351561008, 0.0680770920397676, -0.223222486735026,
			 -0.239556917035889, 0.181299672975537, 50, 50, -0.0291286220301762,
			 "Total", 0.786153531870651, 0.107363347829626, -0.271308809002493,
			 -0.205638305150878, 0.165747157149967, 84, 16, -0.0199455740004554,
			 "Total", 0.833259435845244, 0.0947429302860374, -0.210523085366242,
			 -0.17396764644271, 0.110304382658665, 50, 84, -0.0318316318920224,
			 "Total", 0.660706695286968, 0.0725197073373991, -0.438937677229242,
			 -0.260835987707961, 0.169308155413176, 84, 16, -0.0457639161473924,
			 "Total", 0.676642448107707, 0.109732665118864, -0.417049163052955,
			 -0.219234399372187, 0.152624013772259, 84, 16, -0.0333051927999639,
			 "Total", 0.725524488461374, 0.0948635832284721, -0.351085123147317,
			 -0.184730878140709, 0.0943483767576475, 84, 16, -0.0451912506915309,
			 "Total", 0.525589396572708, 0.0711949956988236, -0.634753190838069,
			 -0.270226370517093, 0.151979300623291, 84, 50, -0.0591235349469009,
			 "Total", 0.58305570123093, 0.107707507502865, -0.54892677695033,
			 -0.243415047266243, 0.14764400975448, 84, 16, -0.0478855187558814,
			 "Total", 0.631228416893414, 0.0997617966721193, -0.479998560102758,
			 -0.208900250833366, 0.0893570975384696, 84, 84, -0.0597715766474484,
			 "Total", 0.432122884553246, 0.0760874563829876, -0.785564132234715,
			 -0.288842119787178, 0.141434397981541, 84, 16, -0.0737038609028184,
			 "Total", 0.50192700746746, 0.10976643478214, -0.671460825425392,
			 -0.16753338529658, 0.216353268431014, 16, 16, 0.0244099415672167,
			 "Total", 0.803164454901739, 0.0979320683327967, 0.249253814228306,
			 -0.142378540494072, 0.167426307845372, 16, 50, 0.0125238836756497,
			 "Total", 0.874091678388451, 0.079033301321643, 0.158463375137033,
			 -0.228842435781368, 0.226025634621927, 16, 50, -0.00140840057972032,
			 "Total", 0.990316146110173, 0.116039905322556, -0.0121372089696677,
			 -0.14796081495467, 0.234119592844465, 16, 50, 0.0430793889448977,
			 "Total", 0.658510869968205, 0.0974712828431892, 0.441970062240828,
			 -0.123284707120765, 0.185671369227427, 16, 84, 0.0311933310533307,
			 "Total", 0.692274556074207, 0.0788167738757442, 0.395770208794735,
			 -0.210437151673231, 0.244959245269152, 16, 50, 0.0172610467979607,
			 "Total", 0.88188633180431, 0.116174684977503, 0.148578382642512,
			 -0.143746871126904, 0.27065630699108, 50, 16, 0.063454717932088,
			 "Total", 0.548351830749611, 0.10571703903407, 0.600231698805318,
			 -0.123170559867894, 0.226307879948936, 16, 50, 0.051568660040521,
			 "Total", 0.562980374807069, 0.0891543014497897, 0.578420325233143,
			 -0.204832815854282, 0.280105567424584, 50, 50, 0.037636375785151,
			 "Total", 0.760954119475818, 0.123711044464081, 0.304228098212189,
			 -0.172091993188366, 0.188369744543641, 16, 50, 0.00813887567763771,
			 "Total", 0.929472796298666, 0.0919562146486577, 0.0885081634638221,
			 -0.141145888959201, 0.133651524531342, 50, 84, -0.0037471822139293,
			 "Total", 0.95737115676048, 0.0701026691454819, -0.0534527751882441,
			 -0.231507045390454, 0.196148112451855, 16, 50, -0.0176794664692993,
			 "Total", 0.871265160038815, 0.109097708227192, -0.162051676030468,
			 -0.166623560140844, 0.196741570761352, 84, 16, 0.0150590053102542,
			 "Total", 0.870948139219111, 0.0926968897817445, 0.162454267297541,
			 -0.134926818402241, 0.141272713239615, 16, 50, 0.00317294741868717,
			 "Total", 0.964082067942977, 0.0704603589199809, 0.0450316669872567,
			 -0.224127396307236, 0.20260872263387, 84, 50, -0.0107593368366828,
			 "Total", 0.921270467343424, 0.108863255219776, -0.0988335027733793,
			 -0.164158831421376, 0.209381725978313, 16, 50, 0.0226114472784684,
			 "Total", 0.812436376275655, 0.0952927095462288, 0.237284125786129,
			 -0.132744194494022, 0.154194973267825, 84, 84, 0.0107253893869014,
			 "Total", 0.883509727972282, 0.0732001123554275, 0.146521488038483,
			 -0.219107044970508, 0.212693255233571, 16, 50, -0.00320689486846863,
			 "Total", 0.97677484679663, 0.110155161934113, -0.0291125246621376,
			 -0.190291724279967, 0.171053874796542, 16, 16, -0.0096189247417126,
			 "Total", 0.916893623105766, 0.0921816936246678, -0.104347450816835,
			 -0.156454685188508, 0.113444719921949, 50, 50, -0.0215049826332796,
			 "Total", 0.754788893458746, 0.068853154251657, -0.312331117826197,
			 -0.245405105972319, 0.17453057219502, 16, 50, -0.0354372668886496,
			 "Total", 0.740801296911868, 0.107128417021879, -0.330792406662859,
			 -0.198481160292181, 0.167437796036037, 50, 50, -0.0155216821280722,
			 "Total", 0.867939030790557, 0.0933483878312408, -0.16627691692044,
			 -0.161995579936943, 0.107180099897665, 16, 84, -0.0274077400196392,
			 "Total", 0.689796658452591, 0.0686685270642296, -0.399131031221963,
			 -0.248463112546852, 0.165783063996834, 50, 50, -0.0413400242750092,
			 "Total", 0.695655094403576, 0.105676986876087, -0.391192306831032,
			 -0.21027077057043, 0.166343187382083, 50, 16, -0.0219637915941738,
			 "Total", 0.819174602425517, 0.0960767547065141, -0.228606718256322,
			 -0.171999402530421, 0.10429970355894, 50, 50, -0.0338498494857408,
			 "Total", 0.631059091367886, 0.0704857610315223, -0.480236702993143,
			 -0.254380532121049, 0.158816264638827, 50, 50, -0.0477821337411108,
			 "Total", 0.65033201057006, 0.105409283032525, -0.453301003160863,
			 -0.0196392961639237, 0.0330748790532665, 50, 50, 0.00671779144467139,
			 "Total indirect", 0.6173934102171, 0.0134477407832473, 0.499547957753632,
			 -0.024351687893088, 0.0474890895525301, 50, 84, 0.0115687008297211,
			 "Total indirect", 0.527886326979869, 0.0183270657043418, 0.63123584628064,
			 -0.0356981027124204, 0.0694238064900705, 50, 50, 0.0168628518888251,
			 "Total indirect", 0.52947683436035, 0.0268173063463613, 0.628804834871609,
			 -0.0434783887116253, 0.02437183982181, 84, 16, -0.0095532744449076,
			 "Total indirect", 0.581000644960966, 0.0173090498265859, -0.551923678111678,
			 -0.059534389248988, 0.0266310236391431, 50, 50, -0.0164516828049225,
			 "Total indirect", 0.454196412931435, 0.0219813765884968, -0.748437330059298,
			 -0.0871199824027819, 0.0391591448731928, 84, 50, -0.0239804187647946,
			 "Total indirect", 0.456637718873548, 0.0322146550324517, -0.744394709197962,
			 -0.108340001367148, 0.0537178516386322, 50, 50, -0.0273110748642579,
			 "Total indirect", 0.508860839531898, 0.0413420487019333, -0.660612517322606,
			 -0.129165065485269, 0.0351003249987715, 84, 84, -0.0470323702432489,
			 "Total indirect", 0.261713027143865, 0.0419052063659703, -1.12235147662802,
			 -0.189731675552637, 0.0526203602777639, 50, 50, -0.0685556576374368,
			 "Total indirect", 0.267492787097063, 0.0618256349968784, -1.10885488909088,
			 -0.0302741743644293, 0.0613297180104607, 16, 16, 0.0155277718230157,
			 "Total indirect", 0.506391578327845, 0.0233687692981733, 0.664466820006197,
			 -0.0191701669969152, 0.0726508825720107, 84, 50, 0.0267403577875478,
			 "Total indirect", 0.253632252633724, 0.0234241675595059, 1.14157131601871,
			 -0.0287854476359952, 0.10674038820584, 16, 50, 0.0389774702849222,
			 "Total indirect", 0.259582602503783, 0.0345735526037329, 1.12737822264507,
			 -0.0145239648445226, 0.013037376711396, 84, 50, -0.000743294066563336,
			 "Total indirect", 0.915808133935269, 0.00703108367636317, -0.105715434601086,
			 -0.0248122724390176, 0.0222522207448261, 16, 84, -0.00128002584709574,
			 "Total indirect", 0.915097314520352, 0.0120064688828678, -0.106611349230432,
			 -0.0361708306475357, 0.032439229910141, 84, 50, -0.00186580036869738,
			 "Total indirect", 0.915106658612447, 0.0175028880884711, -0.106599571411667,
			 -0.0734968619424734, 0.0364946729706462, 50, 16, -0.0185010944859136,
			 "Total indirect", 0.509670813004248, 0.0280595806302358, -0.659350356290702,
			 -0.0878059940421698, 0.0240845674713255, 84, 50, -0.0318607132854221,
			 "Total indirect", 0.264338613795275, 0.0285440350935206, -1.11619514133285,
			 -0.128970167850657, 0.036088089367978, 50, 50, -0.0464410392413396,
			 "Total indirect", 0.270063287900145, 0.0421074720047393, -1.10291682284115,
			 -0.0501710344686642, 0.101879876632181, 84, 50, 0.0258544210817585,
			 "Total indirect", 0.505068299590456, 0.0387892104906528, 0.666536409344777,
			 -0.0312164464738847, 0.120264183392764, 50, 84, 0.0445238684594395,
			 "Total indirect", 0.249254152146401, 0.0386437279106933, 1.15216287006096,
			 -0.0469175767501716, 0.176715971643431, 84, 50, 0.0648991974466298,
			 "Total indirect", 0.25529753219854, 0.0570504229051135, 1.13757609745629,
			 -0.0235955054969329, 0.0427622158812918, 84, 16, 0.00958335519217947,
			 "Total indirect", 0.571316010477457, 0.0169283012090135, 0.566114406510961,
			 -0.0247007661530618, 0.0577077358026536, 84, 50, 0.0165034848247959,
			 "Total indirect", 0.432440778492365, 0.0210229633314038, 0.785021814700273,
			 -0.0363632491613302, 0.0844751027473505, 84, 50, 0.0240559267930101,
			 "Total indirect", 0.435178596431148, 0.0308266766282029, 0.780360694834087,
			 -0.0383594945787989, 0.0220106041244572, 84, 50, -0.00817444522717084,
			 "Total indirect", 0.595571292765503, 0.0154008183771354, -0.530779925260782,
			 -0.053600104726203, 0.0254456994991421, 84, 84, -0.0140772026135305,
			 "Total indirect", 0.485116680790171, 0.0201651165146014, -0.69809676543834,
			 -0.0784012530618841, 0.0373626289026199, 84, 50, -0.0205193120796321,
			 "Total indirect", 0.487172634367666, 0.0295321452020636, -0.694812785838472,
			 16, 16, 16, 84, 16, 50, 16, 84, 16, 84, 16, 84, 50, 16, 16,
			 84, 50, 50, 16, 84, 50, 84, 16, 84, 84, 16, 16, 84, 84, 50,
			 16, 84, 84, 84, 16, 84, 16, 16, 50, 84, 16, 50, 50, 84, 16,
			 84, 50, 84, 50, 16, 50, 84, 50, 50, 50, 84, 50, 84, 50, 84,
			 84, 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 16, 16, 84,
			 84, 16, 50, 84, 84, 16, 84, 84, 84, 50, 16, 84, 84, 50, 50,
			 84, 84, 50, 84, 84, 84, 84, 16, 84, 84, 84, 50, 84, 84, 84,
			 84, 84, 84, 16, 16, 16, 16, 50, 16, 16, 16, 84, 16, 16, 16,
			 16, 16, 50, 16, 50, 16, 50, 50, 84, 50, 50, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 16, 84, 50, 84,
			 16, 84, 84, 84, 16, 84, 16, 84, 50, 84, 50, 84, 50, 84, 50,
			 16, 84, 50, 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50,
			 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-66")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-66")
})


context('Model number 66 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(23006.5352862856, 23164.4670293727, 26480.143463901, 22, 1, 2564,
			 0, 0, 26480.143463901, 22))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 66))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678662522025197, 0.0881399162149208, 0.0780030842087202, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517194810014804, 15.0819541685825,
			 -0.0939549651629422, -0.0542194930210993, -0.0740872290920207,
			 "contcor2", "<unicode>", 2.69562150378988e-13, "facGenderm",
			 0.0101367863020115, -7.30874923123509, -0.0997946734837454,
			 -0.0599918570099636, -0.0798932652468545, "contcor2", "<unicode>",
			 3.5527136788005e-15, "facExperimexperimental", 0.0101539662942129,
			 -7.86818302640896, 0.964848409551791, 1.07659694434503, 1.02072267694841,
			 "contNormal", "<unicode>", 0, "contNormal", 0.0285078031215615,
			 35.8050275777442, 0.00607838327389062, 0.00678237865221866,
			 0.00643038096305464, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000179593957817866, 35.8051074834932, 0.103586090131704, 0.115583405007181,
			 0.109584747569442, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.00306059574821532,
			 35.8050381640053, 0.426154356378552, 0.47551153399576, 0.450832945187156,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.0125913481080598, 35.8049782531684, 0.236315141344854, 0.263685125523686,
			 0.25000013343427, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.0069822671219273, 35.8050084691207, 0.236315048582828, 0.263685009953448,
			 0.250000029268138, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698226130339928, 35.8050233878281,
			 0.975407763645017, 1.08837921084893, 1.03189348724698, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288197763058457, 35.8050484603404
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.344155311818459, 0.590211040178342, 16, 0.467183175998401, "",
			 "facGenderm", "contNormal", "", "<unicode>", "", 9.85878045867139e-14,
			 0.0627704718813048, 7.44272206335834, 0.391174530715408, 0.557614513008836,
			 50, 0.474394521862122, "", "facGenderm", "contNormal", "", "<unicode>",
			 "", 0, 0.0424599593682041, 11.1727502550879, 0.363240705833166,
			 0.601068604590673, 84, 0.48215465521192, "", "facGenderm", "contNormal",
			 "", "<unicode>", "", 1.99840144432528e-15, 0.0606714971890973,
			 7.94697143716709, -0.00833584071653404, 0.00378888004305299,
			 16, -0.00227348033674052, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.462328976061807, 0.00309309784649751,
			 -0.73501727057064, -0.00803907917380119, 0.0242003101510777,
			 16, 0.00808061548863824, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.325850060136777, 0.00822448513829312,
			 0.982507154279479, -0.00794529716337125, 0.00383207177856801,
			 16, -0.00205661269240162, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.493650668571636, 0.00300448606067194,
			 -0.684513973728227, -0.00914520643733895, 0.0237648150680225,
			 16, 0.00730980431534176, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.383932073826693, 0.00839556791985758,
			 0.870674192040336, -0.00403869449604168, 0.00300160562549699,
			 50, -0.000518544435272343, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.772797680055046, 0.00179602793139865,
			 -0.288717355786626, -0.0102360761831753, 0.0139221940065793,
			 50, 0.00184305891170199, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.764897869538268, 0.00616293727341724,
			 0.299055276718734, -0.00390605574878162, 0.00330270216691474,
			 50, -0.00030167679093344, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.869696745468983, 0.0018390026481502,
			 -0.164043695770035, -0.0115974957111135, 0.0137419911879246,
			 50, 0.00107224773840551, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.8682569832936, 0.0064642736037276,
			 0.165872889072518, -0.0034262682119752, 0.0061661543674798,
			 84, 0.0013699430777523, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.575598794212932, 0.00244709154227292,
			 0.559825022516265, -0.0195787418321619, 0.00984038335705942,
			 84, -0.00486917923755125, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.516474173650983, 0.00750501678124589,
			 -0.648789920059702, -0.00355935834019353, 0.00673297978437594,
			 84, 0.0015868107220912, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.545610377328046, 0.002625644707187,
			 0.604350892467565, -0.0209685036677347, 0.00968852284603926,
			 84, -0.00563999041084772, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.470816398365684, 0.0078208137383117,
			 -0.721151353243358))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.391220103280782, 0.557618626583203, 0.474419364931993, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0424493829006429, 11.1761192392931,
			 -0.778148619810251, 0.573606861092518, -0.102270879358866, "debCollin1",
			 "<unicode>", 0.766792356100411, "contNormal", 0.344841918414125,
			 -0.296573223548907, -0.67620436928291, 0.63025720255021, -0.0229735833663502,
			 "facExperimexperimental", "<unicode>", 0.94504509758203, "contNormal",
			 0.333287137452097, -0.0689303029873218, -0.491138288109813,
			 0.129879677229976, -0.180629305439919, "contcor2", "<unicode>",
			 0.254223657682321, "contNormal", 0.158425861454165, -1.14015037558863,
			 -0.934453647327609, 1.02100701940121, 0.0432766860368014, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.930868085973581, "contNormal", 0.498851173325951,
			 0.0867526997045356, -0.130921064169292, 0.790183512635998, 0.329631224233353,
			 "debCollin1:contcor2", "<unicode>", 0.160674817669729, "contNormal",
			 0.234979975160474, 1.40280559655451, -0.0729925474222227, 0.086567995438942,
			 0.00678772400835967, "facGenderm:contcor2", "<unicode>", 0.867563464447058,
			 "contNormal", 0.0407049680809846, 0.166754190664273, -0.0042292620759094,
			 0.0142516396745307, 0.00501118879931067, "facGenderm", "<unicode>",
			 0.287823654715524, "debCollin1", 0.00471460238458847, 1.06290804409969,
			 -0.0125863696206074, 0.00589453212973482, -0.00334591874543627,
			 "facExperimexperimental", "<unicode>", 0.47789473979073, "debCollin1",
			 0.00471460238456349, -0.709692668122226, -0.0358903935541518,
			 -0.00975445165398107, -0.0228224226040664, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.000619434620565684, "debCollin1", 0.006667454633434,
			 -3.42295881394126))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.341516878405209, 0.588302512918112, 16, 0.46490969566166, 0,
			 "Total", 1.52988732793347e-13, 0.0629566758520862, 7.384597254689,
			 0.388771499918509, 0.555470583132255, 16, 0.472121041525382,
			 0, "Total", 0, 0.0425260577563279, 11.1019235366375, 0.361185968562249,
			 0.59857638118811, 50, 0.479881174875179, 0, "Total", 2.22044604925031e-15,
			 0.0605598915333052, 7.92407586481997, 0.351948409550308, 0.59857917342377,
			 16, 0.475263791487039, 0, "Total", 4.21884749357559e-14, 0.0629171673099235,
			 7.55380147910885, 0.397390820565248, 0.567559454136274, 84,
			 0.482475137350761, 0, "Total", 0, 0.043411163397209, 11.1140798724086,
			 0.368926838602479, 0.611543702798637, 16, 0.490235270700558,
			 0, "Total", 2.44249065417534e-15, 0.0618931944948705, 7.9206651830063,
			 0.34166423883012, 0.588588887781879, 16, 0.465126563305999,
			 1, "Total", 1.53654866608122e-13, 0.0629921393707919, 7.38388262332409,
			 0.388703230006177, 0.555972588333265, 16, 0.472337909169721,
			 0, "Total", 0, 0.0426715387748161, 11.0691557588846, 0.361064692592228,
			 0.599131392446808, 50, 0.480098042519518, 1, "Total", 2.66453525910038e-15,
			 0.0607324169557248, 7.90513644252821, 0.351410716765036, 0.59757524386245,
			 16, 0.474492980313743, 0, "Total", 4.15223411209809e-14, 0.0627982271712973,
			 7.5558340049863, 0.397599307143976, 0.565809345210952, 84, 0.481704326177464,
			 1, "Total", 0, 0.0429115125057897, 11.2255266255756, 0.369324689274674,
			 0.609604229779849, 16, 0.489464459527261, 0, "Total", 1.33226762955019e-15,
			 0.0612969274947066, 7.98513856293254, 0.343555068124561, 0.589774195001696,
			 16, 0.466664631563129, 0, "Total", 1.0902390101819e-13, 0.0628121559424763,
			 7.42952736713101, 0.390644454246748, 0.557107500606952, 16,
			 0.47387597742685, 1, "Total", 0, 0.0424658431668242, 11.1589913701998,
			 0.362796416598655, 0.60047580495464, 50, 0.481636110776647,
			 0, "Total", 1.99840144432528e-15, 0.0606336111864223, 7.94338488756381,
			 0.345517815822867, 0.592534653997339, 16, 0.469026234910103,
			 1, "Total", 9.83657599817889e-14, 0.0630156574617975, 7.44301105156991,
			 0.391924516857685, 0.560550644689964, 84, 0.476237580773824,
			 0, "Total", 0, 0.043017659804563, 11.0707458968586, 0.364025947444005,
			 0.603969480803239, 16, 0.483997714123622, 1, "Total", 2.66453525910038e-15,
			 0.0612112098109653, 7.90701107882561, 0.343691408192259, 0.590071590222676,
			 16, 0.466881499207468, 1, "Total", 1.10134124042816e-13, 0.0628532421957321,
			 7.4281211739809, 0.390559764058992, 0.557625926083385, 16, 0.474092845071189,
			 1, "Total", 0, 0.0426197020308, 11.1237953922948, 0.362664325415091,
			 0.601041631426882, 50, 0.481852978420986, 1, "Total", 2.22044604925031e-15,
			 0.060811654676331, 7.92369457771936, 0.344964775936271, 0.591546071537342,
			 16, 0.468255423736807, 1, "Total", 9.76996261670138e-14, 0.0629045476207912,
			 7.44390416030969, 0.392119903539058, 0.558813635661998, 84,
			 0.475466769600528, 1, "Total", 0, 0.0425246926570589, 11.1809572248984,
			 0.364421399836814, 0.602032406063837, 16, 0.483226902950325,
			 1, "Total", 1.55431223447522e-15, 0.0606161664452174, 7.97191461104765,
			 0.345599245081812, 0.591506993070495, 16, 0.468553119076153,
			 0, "Total", 8.08242361927114e-14, 0.0627327210929313, 7.46903865977766,
			 0.392438853529532, 0.559090076350217, 50, 0.475764464939875,
			 0, "Total", 0, 0.0425138482480312, 11.1908115718955, 0.36437497607388,
			 0.602674220505464, 50, 0.483524598289672, 0, "Total", 1.77635683940025e-15,
			 0.0607917406419858, 7.9537876886474, 0.337820313173915, 0.586807680347784,
			 50, 0.46231399676085, 0, "Total", 3.37729844090973e-13, 0.0635183526681739,
			 7.27843178137858, 0.384901600491484, 0.554149084757658, 84,
			 0.469525342624571, 0, "Total", 0, 0.0431761720116229, 10.8746403571437,
			 0.357957163132431, 0.596613788816306, 50, 0.477285475974368,
			 0, "Total", 4.44089209850063e-15, 0.0608829110040716, 7.83939972815113,
			 0.345723782526387, 0.591816190914598, 16, 0.468769986720492,
			 1, "Total", 8.21565038222616e-14, 0.0627798292033315, 7.4668885320194,
			 0.392337289093489, 0.559625376074938, 50, 0.475981332584214,
			 0, "Total", 0, 0.0426763165805587, 11.1532899444524, 0.364231742943506,
			 0.603251188924516, 50, 0.483741465934011, 1, "Total", 2.22044604925031e-15,
			 0.0609754689030935, 7.93337836733665, 0.337249554635696, 0.585836816539411,
			 50, 0.461543185587553, 0, "Total", 3.38840067115598e-13, 0.0634162831216645,
			 7.27799175334953, 0.385069644760461, 0.552439418142088, 84,
			 0.468754531451275, 1, "Total", 0, 0.0426971553308679, 10.9785892717867,
			 0.358342145965113, 0.59468718363703, 50, 0.476514664801072,
			 0, "Total", 2.66453525910038e-15, 0.0602932093487882, 7.90328910913496,
			 -0.00833584071653404, 0.00378888004305299, 16, -0.00227348033674052,
			 0, "Total indirect", 0.462328976061807, 0.00309309784649751,
			 -0.73501727057064, -0.00803907917380119, 0.0242003101510777,
			 50, 0.00808061548863824, 1, "Total indirect", 0.325850060136777,
			 0.00822448513829312, 0.982507154279479, -0.00794529716337125,
			 0.00383207177856801, 50, -0.00205661269240162, 0, "Total indirect",
			 0.493650668571636, 0.00300448606067194, -0.684513973728227,
			 -0.00914520643733895, 0.0237648150680225, 50, 0.00730980431534176,
			 1, "Total indirect", 0.383932073826693, 0.00839556791985758,
			 0.870674192040336, -0.00403869449604168, 0.00300160562549699,
			 84, -0.000518544435272343, 0, "Total indirect", 0.772797680055046,
			 0.00179602793139865, -0.288717355786626, -0.0102360761831753,
			 0.0139221940065793, 50, 0.00184305891170199, 1, "Total indirect",
			 0.764897869538268, 0.00616293727341724, 0.299055276718734, -0.00390605574878162,
			 0.00330270216691474, 16, -0.00030167679093344, 1, "Total indirect",
			 0.869696745468983, 0.0018390026481502, -0.164043695770035, -0.0115974957111135,
			 0.0137419911879246, 50, 0.00107224773840551, 1, "Total indirect",
			 0.8682569832936, 0.0064642736037276, 0.165872889072518, -0.0034262682119752,
			 0.0061661543674798, 50, 0.0013699430777523, 1, "Total indirect",
			 0.575598794212932, 0.00244709154227292, 0.559825022516265, -0.0195787418321619,
			 0.00984038335705942, 50, -0.00486917923755125, 1, "Total indirect",
			 0.516474173650983, 0.00750501678124589, -0.648789920059702,
			 -0.00355935834019353, 0.00673297978437594, 84, 0.0015868107220912,
			 1, "Total indirect", 0.545610377328046, 0.002625644707187, 0.604350892467565,
			 -0.0209685036677347, 0.00968852284603926, 50, -0.00563999041084772,
			 1, "Total indirect", 0.470816398365684, 0.0078208137383117,
			 -0.721151353243358, 16, 0, 84, 0, 50, 0, 84, 0, 84, 0, 84, 0,
			 16, 1, 84, 0, 50, 1, 84, 0, 84, 1, 84, 0, 16, 0, 84, 1, 50,
			 0, 84, 1, 84, 0, 84, 1, 16, 1, 84, 1, 50, 1, 84, 1, 84, 1, 84,
			 1, 16, 0, 16, 0, 16, 1, 16, 0, 50, 0, 50, 1, 50, 1, 50, 1, 84,
			 0, 84, 0, 84, 1, 84, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-66")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-66")
})


context('Model number 67 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1404.67194741312, 1477.61671262079, 1154.1352206734, 21, 1, 100,
			 3.69176894119418e-231, 0, 1154.1352206734, 21))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 67))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544856218296629, 0.0641995783178009, -0.240328319989414, "contcor1",
			 "<unicode>", 0.121918531047449, "contGamma", 0.155374231725324,
			 -1.54677076964908, -0.403949049068933, 0.19460969512916, -0.104669676969887,
			 "contcor2", "<unicode>", 0.49304366293697, "contGamma", 0.152696363024895,
			 -0.685475900646186, 0.424982979578605, 0.896773947813972, 0.660878463696289,
			 "contcor2", "<unicode>", 3.99703847797639e-08, "contcor1", 0.120357050424598,
			 5.49098255037679, 0.741603682901688, 1.31037184820674, 1.02598776555421,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145096585904491, 7.07106758686632, 0.00465468242245698, 0.00822455524296112,
			 0.00643961883270905, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910698576265393, 7.07107598555467, 0.32388815554132,
			 0.572285812799685, 0.448086984170502, "debCollin1:contcor1",
			 "<unicode>", 1.53610457687137e-12, "debCollin1:contcor1", 0.063367913700888,
			 7.07119673034499, 0.318536812342335, 0.562843352191208, 0.440690082266772,
			 "debCollin1:contcor2", "<unicode>", 1.53899115673539e-12, "debCollin1:contcor2",
			 0.0623242421227969, 7.0709256503831, 1.68039916575604, 2.96915023265497,
			 2.3247746992055, "contGamma", "<unicode>", 1.53654866608122e-12,
			 "contGamma", 0.32876906847892, 7.07114787276457, 0.73263810172904,
			 1.29453618954538, 1.01358714563721, "contcor1", "<unicode>",
			 1.53810297831569e-12, "contcor1", 0.143343982912063, 7.07101285345902,
			 0.721543623445427, 1.27492993318266, 0.998236778314043, "contcor2",
			 "<unicode>", 1.53788093371077e-12, "contcor2", 0.141172571052905,
			 7.07103916057424))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.20948739058456, 0.166372958585366, 16, 16, -0.0215572159995969,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.822115559681658,
			 0.0958845040354478, -0.224824816235451, -0.198508312754799,
			 0.314043709651082, 50, 16, 0.0577676984481417, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.658634315056076, 0.130755469602714,
			 0.441799479774442, -0.344937479185743, 0.633619000448367, 84,
			 16, 0.144340760631312, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.563126319945568, 0.249636342135069, 0.578204116423137,
			 -0.366990545527585, 0.186092706851534, 16, 50, -0.0904489193380255,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.521491102856743,
			 0.141095259081741, -0.641048607349917, -0.146448971120195, 0.124200961339621,
			 50, 50, -0.0111240048902868, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.872004182277221, 0.0690446188283734, -0.161113278327137,
			 -0.233449084892533, 0.3843471994783, 84, 50, 0.0754490572928833,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.632133882396993,
			 0.157603988962025, 0.478725556312303, -0.669522144050601, 0.327121004195345,
			 16, 84, -0.171200569927628, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.500721945222121, 0.254250372993417, -0.67335425278633,
			 -0.385815301880422, 0.202063990920642, 50, 84, -0.0918756554798896,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.540128374140258,
			 0.149971963117226, -0.612618876023346, -0.229497364605522, 0.218892178012083,
			 84, 84, -0.00530259329671948, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.963026082406464, 0.114387189293897, -0.046356531089294,
			 -0.0204603750482093, 0.0355994842466277, 16, 16, 0.00756955459920919,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.596601991998937, 0.0143012473027642, 0.529293315398168, -0.0237406617288537,
			 0.049810973224662, 16, 16, 0.0130351557479041, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.487238634085231,
			 0.0187635169660467, 0.694707488553011, -0.0348556296284569,
			 0.0728559591118954, 50, 16, 0.0190001647417192, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.489270548517026,
			 0.0274779510210309, 0.691469488652084, -0.0473530127182455,
			 0.025801084673965, 16, 16, -0.0107759640221403, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.56365240769523,
			 0.0186621024593413, -0.577424973719743, -0.0631274836560624,
			 0.026013973865913, 84, 16, -0.0185567548950747, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.414489143786187,
			 0.0227405855987946, -0.816019218786444, -0.0924345896066185,
			 0.0383375911668701, 16, 16, -0.0270484992198742, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.417488947878834,
			 0.0333608632110087, -0.810785351949421, -0.120799472053987,
			 0.0592039401698316, 16, 16, -0.0307977659420775, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.502423218508478,
			 0.0459200816044739, -0.670681864360558, -0.141584254011217,
			 0.035513633743964, 50, 16, -0.0530353101336265, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.240436473350822,
			 0.0451788627628126, -1.17389652794184, -0.208092906954119, 0.0534833803546232,
			 50, 16, -0.0773047632997478, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.246671005332413, 0.0667298708986549,
			 -1.15847314341659, -0.0327768385193061, 0.0670648246595105,
			 50, 50, 0.0171439930701022, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.500884983593129, 0.0254702800577855,
			 0.673097941255726, -0.0192250700715005, 0.0782707158570843,
			 84, 50, 0.0295228228927919, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.235228262625586, 0.0248718309871046,
			 1.18699837209809, -0.0289897325587222, 0.115055217229872, 50,
			 50, 0.0430327423355749, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.241574740511419, 0.0367468358920884,
			 1.17105980122876, -0.0152548378260869, 0.0128517867235924, 16,
			 50, -0.00120152555124727, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.866919711425862, 0.00717018903698761,
			 -0.167572367346129, -0.0257553260434991, 0.0216171505431253,
			 84, 50, -0.00206908775018689, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.864058093254069, 0.0120850375211719,
			 -0.171210701378629, -0.0375510450505565, 0.0315192017985193,
			 50, 50, -0.00301592162601856, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.864096455069075, 0.0176202847077531,
			 -0.171161912309597, -0.083295903383429, 0.04084924844106, 84,
			 50, -0.0212233274711845, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.502772229844972, 0.0316702635364043,
			 -0.670134223758157, -0.0977210493155194, 0.0246257633380418,
			 84, 50, -0.0365476429887388, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.241611884974906, 0.0312114951138432,
			 -1.17096739055377, -0.143620363707582, 0.0370759922957978, 84,
			 50, -0.0532721857058921, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.247821206784935, 0.0460968562250862,
			 -1.15565767534709, -0.0540505087474685, 0.110783917849423, 16,
			 84, 0.028366704550977, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.499937125779797, 0.0420503713070965,
			 0.674588681840956, -0.0312544654512371, 0.128952264451299, 16,
			 84, 0.0488488995000309, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.231996503560438, 0.0408698147430836,
			 1.19523173293311, -0.0471679122191657, 0.18957313635337, 50,
			 84, 0.071202612067102, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.238412617278063, 0.0603942343940804,
			 1.17896373356595, -0.0240540209508287, 0.0440963928100838, 16,
			 84, 0.0100211859296275, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.564340595342731, 0.0173856290979003,
			 0.576406287813754, -0.0243380518058097, 0.0588520295199138,
			 84, 84, 0.0172569888570521, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.416131106897096, 0.0212223494875202,
			 0.813151666699298, -0.0358640152399331, 0.0861719114509503,
			 16, 84, 0.0251539481055086, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.419106451254029, 0.0311321860129796,
			 0.807972433899162, -0.0442766222251919, 0.0242753902445724,
			 16, 84, -0.0100006159903097, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.567421366547299, 0.0174880796306702,
			 -0.571853296731957, -0.0593864040770192, 0.0249432713140196,
			 50, 84, -0.0172215663814998, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.423411586058327, 0.0215130676012979,
			 -0.800516537235293, -0.0869440340269638, 0.0367394020782338,
			 50, 84, -0.025102315974365, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.426279944679923, 0.0315524767497762,
			 -0.795573551117284))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.144542526137713, 0.126020975102709, -0.00926077551750198, "contGamma",
			 "<unicode>", 0.89326794917256, "contNormal", 0.0690225696427566,
			 -0.134170251345805, -2.28223793356013, 2.81249396690104, 0.265128016670458,
			 "debCollin1", "<unicode>", 0.838360029997893, "contNormal",
			 1.2997003875193, 0.203991642394213, -4.64758380026664, 0.319581889598821,
			 -2.16400095533391, "contcor1", "<unicode>", 0.0876808468907078,
			 "contNormal", 1.2671573888719, -1.70776019959166, -0.962520760139711,
			 3.35439340193103, 1.19593632089566, "contcor2", "<unicode>",
			 0.277497906095173, "contNormal", 1.10127384893856, 1.08595725036815,
			 -0.00782262026121749, 6.97589184306992, 3.48403461140435, "debCollin1:contcor1",
			 "<unicode>", 0.0505154545867237, "contNormal", 1.78159254925544,
			 1.95557318246554, -0.173335206129874, 0.336196631485035, 0.0814307126775809,
			 "contGamma:contcor1", "<unicode>", 0.531011704221008, "contNormal",
			 0.129985000141337, 0.626462380959638, -4.98755976642118, 1.27340639092147,
			 -1.85707668774986, "debCollin1:contcor2", "<unicode>", 0.244952441027623,
			 "contNormal", 1.59721459341303, -1.16269704484827, -0.303235748529832,
			 0.158778412949147, -0.0722286677903424, "contGamma:contcor2",
			 "<unicode>", 0.539995856541435, "contNormal", 0.117862921238168,
			 -0.612819256739689, -0.0197475053956237, 0.0011600010546637,
			 -0.00929375217047999, "contGamma", "<unicode>", 0.0814250966273569,
			 "debCollin1", 0.00533364557083781, -1.74247651949249, -0.0185480472866889,
			 0.0350782814337614, 0.00826511707353624, "contcor1", "<unicode>",
			 0.545739988925145, "debCollin1", 0.0136804372793194, 0.604155912913,
			 -0.0145561431481604, 0.00654300951794366, -0.00400656681510836,
			 "contGamma:contcor1", "<unicode>", 0.456656187650671, "debCollin1",
			 0.00538253580997698, -0.744364172678953))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.200654247324304, 0.172678924523529, 16, 16, -0.0139876614003877,
			 "Total", 0.883236360683863, 0.0952398040965645, -0.146867809452921,
			 -0.19259005051088, 0.323264556605582, 16, 16, 0.0653372530473509,
			 "Total", 0.619547822436284, 0.1315979811837, 0.496491302219489,
			 -0.339704947978387, 0.643525578439429, 16, 16, 0.151910315230521,
			 "Total", 0.544758051482978, 0.250828722918741, 0.605633650974391,
			 -0.357885516744502, 0.192126787266869, 50, 16, -0.0828793647388163,
			 "Total", 0.554735006788386, 0.140311839490368, -0.590679767579456,
			 -0.140625217897843, 0.133516317315688, 16, 16, -0.00355445029107764,
			 "Total", 0.959465127672939, 0.0699353501839638, -0.0508248015020689,
			 -0.228969981090956, 0.395007204875141, 16, 16, 0.0830186118920925,
			 "Total", 0.601992972934551, 0.15918077854694, 0.521536661963312,
			 -0.66066184392022, 0.333399813263382, 84, 50, -0.163631015328419,
			 "Total", 0.518762901557502, 0.253591817253948, -0.645253530261027,
			 -0.378309851336517, 0.209697649575157, 16, 16, -0.0843061008806804,
			 "Total", 0.574100229211229, 0.150004669868886, -0.56202317537427,
			 -0.225206676943776, 0.229740599548756, 16, 50, 0.00226696130248971,
			 "Total", 0.98441619266183, 0.116060111328856, 0.0195326480091535,
			 -0.194269541866454, 0.177225421363068, 16, 16, -0.00852206025169278,
			 "Total", 0.928348573345924, 0.094770864709716, -0.0899227866897272,
			 -0.188309230353563, 0.329914938745654, 16, 50, 0.0708028541960459,
			 "Total", 0.592260075379718, 0.132202472389009, 0.53556376757998,
			 -0.335919390849081, 0.650671223607513, 16, 16, 0.157375916379216,
			 "Total", 0.531782730063264, 0.251685903985659, 0.625286970334991,
			 -0.351304934400037, 0.196477407219794, 50, 84, -0.0774137635901213,
			 "Total", 0.579597636396648, 0.139742961080068, -0.553972543531305,
			 -0.136404614520189, 0.140226916235424, 16, 16, 0.00191115085761732,
			 "Total", 0.978394796813871, 0.0705705648005901, 0.0270814164945062,
			 -0.225716125033434, 0.402684551115009, 16, 84, 0.0884842130407874,
			 "Total", 0.580976081251759, 0.160309240655744, 0.551959529462204,
			 -0.654261652658946, 0.337930824299498, 84, 16, -0.158165414179724,
			 "Total", 0.532052600928623, 0.253114976801801, -0.624875762699627,
			 -0.372889652694152, 0.215208653230181, 16, 84, -0.0788404997319854,
			 "Total", 0.599231611457312, 0.150027834838593, -0.525505815749494,
			 -0.222078381255452, 0.237543506157821, 16, 16, 0.00773256245118467,
			 "Total", 0.94741932296337, 0.11725263602768, 0.0659478772772258,
			 -0.189794806855002, 0.184680704339247, 16, 16, -0.00255705125787768,
			 "Total", 0.978645849287771, 0.0955312225500225, -0.0267666548131816,
			 -0.185409628653238, 0.338945355032959, 16, 16, 0.076767863189861,
			 "Total", 0.566039126913257, 0.133766484441103, 0.573894600808335,
			 -0.332719112042805, 0.659400962788867, 16, 16, 0.163340925373031,
			 "Total", 0.518687355410154, 0.253096506532107, 0.645370130196998,
			 -0.345816856726101, 0.202919347533489, 50, 16, -0.0714487545963062,
			 "Total", 0.609772516949123, 0.139986297857499, -0.510398201037064,
			 -0.135074347826574, 0.150826667529439, 16, 16, 0.00787615985143242,
			 "Total", 0.914004932467344, 0.0729352726915301, 0.107988351325477,
			 -0.223611754599364, 0.412510198668569, 16, 16, 0.0944492220346025,
			 "Total", 0.560554852919913, 0.162278990401248, 0.582017560012355,
			 -0.64821241629705, 0.343811605925232, 84, 50, -0.152200405185909,
			 "Total", 0.547565961151199, 0.253072002865165, -0.601411469711251,
			 -0.368550069228993, 0.222799087752653, 16, 16, -0.0728754907381703,
			 "Total", 0.629041667357654, 0.150857148816543, -0.483076150582656,
			 -0.220629033048257, 0.248024175938256, 16, 50, 0.0136975714449998,
			 "Total", 0.908786136771752, 0.119556586927921, 0.114569776513091,
			 -0.223466450640957, 0.158800090597482, 16, 16, -0.0323331800217372,
			 "Total", 0.740222629674379, 0.0975187667359474, -0.331558541027145,
			 -0.207946059293374, 0.301929528145377, 50, 50, 0.0469917344260014,
			 "Total", 0.717895476689115, 0.130072693034307, 0.361272864655822,
			 -0.352889041280752, 0.620018634499095, 16, 16, 0.133564796609172,
			 "Total", 0.590477670643641, 0.248195294264083, 0.538143952346884,
			 -0.382073627505167, 0.179623860784835, 50, 84, -0.101224883360166,
			 "Total", 0.479927084549841, 0.143292808623169, -0.706419842927127,
			 -0.159068845439619, 0.115268907614765, 50, 16, -0.0218999689124271,
			 "Total", 0.754339971797827, 0.0699854066754096, -0.312921935482901,
			 -0.241674376343673, 0.371020562885159, 16, 84, 0.064673093270743,
			 "Total", 0.679043653802836, 0.156302601492092, 0.413768501953023,
			 -0.684088054268767, 0.32013498636923, 84, 16, -0.181976533949769,
			 "Total", 0.477496339267067, 0.25618405454365, -0.710335131021055,
			 -0.399794365429095, 0.194491126425035, 50, 84, -0.10265161950203,
			 "Total", 0.498346514584054, 0.151606227599532, -0.677093686238169,
			 -0.239874998095205, 0.207717883457485, 16, 16, -0.0160785573188598,
			 "Total", 0.88801786684814, 0.114183955695933, -0.140812754479065,
			 -0.232704926176661, 0.152476984387318, 16, 16, -0.0401139708946716,
			 "Total", 0.683102795262702, 0.0982624970668454, -0.40823276521645,
			 -0.214130653662603, 0.292552540768737, 50, 16, 0.039210943553067,
			 "Total", 0.761620547946588, 0.129258292098221, 0.303353409027496,
			 -0.358292556880415, 0.609860568352889, 16, 16, 0.125784005736237,
			 "Total", 0.610553644805108, 0.246982376428846, 0.509283324401386,
			 -0.392364332374535, 0.174352983908335, 50, 16, -0.1090056742331,
			 "Total", 0.450860310301938, 0.144573400519873, -0.753981533540234,
			 -0.167015205712365, 0.107653686141642, 50, 16, -0.0296807597853615,
			 "Total", 0.671866324645102, 0.0700698824112484, -0.42358797765867,
			 -0.24707861291011, 0.360863217705727, 16, 16, 0.0568923023978086,
			 "Total", 0.713742852110113, 0.155090051503804, 0.366833989970099,
			 -0.694273279768894, 0.314758630123488, 84, 50, -0.189757324822703,
			 "Total", 0.461014761354815, 0.257410829446739, -0.73717692931006,
			 -0.409336272360289, 0.188471451610361, 50, 16, -0.110432410374964,
			 "Total", 0.468989433069738, 0.152504772711662, -0.724124290744372,
			 -0.246656677665151, 0.198937981281563, 16, 50, -0.0238593481917941,
			 "Total", 0.833751664707365, 0.113674195664182, -0.209892386327322,
			 -0.24680406306585, 0.149592632626908, 16, 16, -0.0486057152194711,
			 "Total", 0.630760196584905, 0.101123464211456, -0.480657141233148,
			 -0.223991165256622, 0.285429563713157, 50, 50, 0.0307191992282675,
			 "Total", 0.813137545626331, 0.129956655578374, 0.236380346135804,
			 -0.365815318875457, 0.600399841698332, 16, 16, 0.117292261411438,
			 "Total", 0.634178493740896, 0.246487988604681, 0.475853862394697,
			 -0.406320004670267, 0.171325167554468, 50, 84, -0.1174974185579,
			 "Total", 0.425251770352498, 0.14736117009831, -0.797343143241284,
			 -0.181319991013116, 0.104974982792793, 50, 16, -0.038172504110161,
			 "Total", 0.601214439116144, 0.0730357741428331, -0.522654884652946,
			 -0.255566843273508, 0.352367959419526, 16, 84, 0.0484005580730091,
			 "Total", 0.754976715431798, 0.15508825863341, 0.312083961090928,
			 -0.706932394766384, 0.31043425647138, 84, 16, -0.198249069147502,
			 "Total", 0.444952796851277, 0.259537078043939, -0.763856442561702,
			 -0.422354528164244, 0.184506218764716, 50, 84, -0.118924154699764,
			 "Total", 0.442384334012355, 0.154814259781251, -0.76817313125936,
			 -0.257589929334709, 0.192887744301521, 16, 16, -0.0323510925165937,
			 "Total", 0.778319289021226, 0.114919885566659, -0.281509961109634,
			 -0.263384362735429, 0.15867439885208, 16, 16, -0.0523549819416745,
			 "Total", 0.626787094263666, 0.107670029887451, -0.486253992837208,
			 -0.236620157822247, 0.290560022834376, 84, 16, 0.0269699325060642,
			 "Total", 0.84105905018769, 0.13448721119749, 0.20053901234118,
			 -0.3735787569536, 0.600664746332068, 16, 16, 0.113542994689234,
			 "Total", 0.647780918506548, 0.248536072848883, 0.456847142500202,
			 -0.418870882662873, 0.176377512102667, 50, 16, -0.121246685280103,
			 "Total", 0.424607261432593, 0.151851870611089, -0.798453682474749,
			 -0.200049665587954, 0.116206123923226, 84, 16, -0.0419217708323644,
			 "Total", 0.603333991340025, 0.0806789798194674, -0.519612059128304,
			 -0.265512713692044, 0.354815296393655, 16, 16, 0.0446512913508057,
			 "Total", 0.777823183294599, 0.158249849226508, 0.282156928231223,
			 -0.715628474334764, 0.311631802595352, 84, 50, -0.201998335869706,
			 "Total", 0.440821617850693, 0.262061008526946, -0.770806527095142,
			 -0.433283685888298, 0.187936843044364, 84, 16, -0.122673421421967,
			 "Total", 0.438886731051968, 0.158477536789648, -0.774074508646582,
			 -0.269410408983531, 0.197209690505937, 16, 50, -0.036100359238797,
			 "Total", 0.761685853686858, 0.119037927015524, -0.303267707560878,
			 -0.286911487097623, 0.137726434831177, 16, 16, -0.0745925261332235,
			 "Total", 0.491087389409876, 0.108327991044297, -0.688580351339861,
			 -0.252399865262336, 0.261864641891366, 84, 50, 0.00473238831451518,
			 "Total", 0.971224836900344, 0.131192335984272, 0.0360721400302113,
			 -0.38792208621015, 0.57053298720552, 16, 16, 0.0913054504976853,
			 "Total", 0.708832386020417, 0.244508338157191, 0.373424690486368,
			 -0.44549794419346, 0.158529485250156, 50, 84, -0.143484229471652,
			 "Total", 0.351769381629249, 0.15409146142687, -0.931162753231127,
			 -0.218197851097124, 0.0898792210492977, 84, 16, -0.0641593150239134,
			 "Total", 0.414297803087052, 0.078592533989526, -0.816353815903987,
			 -0.278683115038305, 0.323510609356818, 16, 84, 0.0224137471592567,
			 "Total", 0.884000056303411, 0.153623670930984, 0.145900348712056,
			 -0.742785166631175, 0.294313406508665, 84, 16, -0.224235880061255,
			 "Total", 0.396690992582656, 0.264570824086652, -0.847545759572541,
			 -0.45739696264026, 0.167575031413228, 84, 84, -0.144910965613516,
			 "Total", 0.363399955946586, 0.159434560783562, -0.908905603034448,
			 -0.284913524720674, 0.168237717859982, 16, 16, -0.058337903430346,
			 "Total", 0.613808398205724, 0.11560193099339, -0.504644714227843,
			 -0.33385747532119, 0.136133516722501, 16, 16, -0.0988619792993447,
			 "Total", 0.40962619328157, 0.11989786438703, -0.824551628210982,
			 -0.287855362215603, 0.248781232512391, 84, 16, -0.019537064851606,
			 "Total", 0.886518514448343, 0.136899606054222, -0.142710891687066,
			 -0.413464923089863, 0.547536917752991, 16, 16, 0.0670359973315641,
			 "Total", 0.784515058329826, 0.245158035663694, 0.273439934979424,
			 -0.489673898682606, 0.15416653340706, 50, 16, -0.167753682637773,
			 "Total", 0.307091641276164, 0.164248026282166, -1.02134367416742,
			 -0.26698515457573, 0.0901276181956609, 84, 16, -0.0884287681900346,
			 "Total", 0.331718568700504, 0.0911018711538199, -0.970658089346244,
			 -0.308707824566819, 0.30499641255309, 16, 16, -0.00185570600686449,
			 "Total", 0.990542898922208, 0.156560080175128, -0.0118529960178144,
			 -0.781405382844938, 0.284394716390186, 84, 50, -0.248505333227376,
			 "Total", 0.360725860317346, 0.271892776510696, -0.913982844327606,
			 -0.498529427466894, 0.160168589907619, 84, 16, -0.169180418779637,
			 "Total", 0.31403243321889, 0.168038296257033, -1.00679679899192,
			 -0.322407634045334, 0.1571929208524, 16, 50, -0.0826073565964672,
			 "Total", 0.499563815882697, 0.122349328528678, -0.675176215430597,
			 -0.195418500396633, 0.186592054537644, 16, 16, -0.00441322292949473,
			 "Total", 0.963879792874795, 0.0974534629073615, -0.0452854398174635,
			 -0.188435666058328, 0.338259049094816, 16, 50, 0.0749116915182439,
			 "Total", 0.577164939617268, 0.134363365681116, 0.557530627031416,
			 -0.334303582562489, 0.657273089965317, 50, 16, 0.161484753701414,
			 "Total", 0.523222483431842, 0.252957880948129, 0.638385936410211,
			 -0.349502187718837, 0.202892335182991, 50, 84, -0.0733049262679233,
			 "Total", 0.602931250515795, 0.140919559557993, -0.520189862201178,
			 -0.137617312081133, 0.149657288440764, 16, 16, 0.00601998817981537,
			 "Total", 0.934532106799988, 0.0732856835094629, 0.0821441227199313,
			 -0.224385389564891, 0.409571490290862, 50, 84, 0.0925930503629855,
			 "Total", 0.566964297194705, 0.161726665606186, 0.57252803683256,
			 -0.65058962238371, 0.342476468668658, 84, 16, -0.154056576857526,
			 "Total", 0.543116347587927, 0.253337841635241, -0.608107244709769,
			 -0.369910186548805, 0.220446861729231, 16, 84, -0.0747316624097874,
			 "Total", 0.619744269462461, 0.150604055210886, -0.496212816481888,
			 -0.219959338925626, 0.243642138472391, 50, 16, 0.0118413997733827,
			 "Total", 0.920246224586173, 0.11826785620931, 0.100123568253625,
			 -0.180207849532288, 0.196139063318678, 16, 16, 0.007965606893195,
			 "Total", 0.93387729139001, 0.0960086297043066, 0.0829676136169006,
			 -0.177454285937469, 0.352035328619337, 16, 16, 0.0872905213409337,
			 "Total", 0.518129823637958, 0.135076363324365, 0.646230911112988,
			 -0.324655573474575, 0.672382740522783, 50, 16, 0.173863583524104,
			 "Total", 0.494254815412952, 0.25435118243546, 0.683557205668664,
			 -0.333382225899705, 0.211530033009238, 50, 16, -0.0609260964452336,
			 "Total", 0.661180974932756, 0.139010783669277, -0.438283238444176,
			 -0.124397672942063, 0.161195308947074, 16, 16, 0.0183988180025051,
			 "Total", 0.800628058033976, 0.0728566912815383, 0.252534361345164,
			 -0.214733904028448, 0.424677664399798, 50, 16, 0.104971880185675,
			 "Total", 0.519878548179457, 0.163118193362695, 0.643532631288216,
			 -0.634978015729082, 0.351622521659409, 84, 50, -0.141677747034836,
			 "Total", 0.57349668484186, 0.251688435392352, -0.56290924457446,
			 -0.35517052239203, 0.230464857217834, 16, 16, -0.0623528325870977,
			 "Total", 0.676417817368389, 0.149399525764065, -0.417356295264059,
			 -0.208847816459673, 0.257288275651818, 50, 50, 0.0242202295960724,
			 "Total", 0.838605322301257, 0.118914453476776, 0.203677760675262,
			 -0.171331520270753, 0.214282572942709, 16, 16, 0.021475526335978,
			 "Total", 0.827189394488543, 0.0983727497686531, 0.21830767551464,
			 -0.170920765197716, 0.372521646765149, 16, 50, 0.100800440783717,
			 "Total", 0.4671720373038, 0.138635815823523, 0.727088019679065,
			 -0.317029029741414, 0.691776035675187, 50, 16, 0.187373502966887,
			 "Total", 0.466564711297919, 0.257352959894653, 0.728079844286958,
			 -0.321148517208013, 0.226316163203112, 50, 84, -0.0474161770024506,
			 "Total", 0.734227952392184, 0.139661923568356, -0.339506830430009,
			 -0.119963520403908, 0.183780995294484, 16, 16, 0.0319087374452881,
			 "Total", 0.680490942542904, 0.0774872696881906, 0.411793286480335,
			 -0.208694143324026, 0.445657742580943, 50, 84, 0.118481799628458,
			 "Total", 0.477846034219348, 0.16692956887637, 0.709771195277014,
			 -0.620905127563877, 0.36456947237977, 84, 16, -0.128167827592053,
			 "Total", 0.610181844510034, 0.251401201174344, -0.509813903009836,
			 -0.344079063426481, 0.246393237137852, 16, 84, -0.0488429131443147,
			 "Total", 0.745748696383362, 0.150633456844591, -0.324250098002505,
			 -0.202895833290005, 0.278356131367716, 50, 16, 0.0377301490388554,
			 "Total", 0.758598054282706, 0.122770614269899, 0.30732231212845,
			 -0.210704828185936, 0.165187345084248, 16, 16, -0.0227587415508442,
			 "Total", 0.812396377885168, 0.0958926225775508, -0.237335687971602,
			 -0.198329527561712, 0.311461873355501, 50, 16, 0.0565661728968945,
			 "Total", 0.663596508782777, 0.130051216486217, 0.434953047154998,
			 -0.344622024530864, 0.630900494690993, 50, 16, 0.143139235080065,
			 "Total", 0.565173415889512, 0.248862358420015, 0.575174309159614,
			 -0.368572389313821, 0.185271499535276, 50, 16, -0.0916504448892728,
			 "Total", 0.51655026710586, 0.141289302563146, -0.648672215281916,
			 -0.145786318711782, 0.121135257828714, 50, 16, -0.0123255304415341,
			 "Total", 0.856360559180113, 0.0680934901472525, -0.181008939545911,
			 -0.232575583409034, 0.381070646892306, 50, 16, 0.074247531741636,
			 "Total", 0.635294625380954, 0.156545282245415, 0.474287890868782,
			 -0.671175192377605, 0.326371001419854, 84, 50, -0.172402095478876,
			 "Total", 0.498110229485812, 0.254480745989716, -0.677466166677468,
			 -0.386571933815416, 0.200417571753142, 50, 16, -0.0930771810311369,
			 "Total", 0.534223780620026, 0.149744972407314, -0.621571325800257,
			 -0.228372043281877, 0.215363805585943, 50, 50, -0.00650411884796675,
			 "Total", 0.954181254167187, 0.113200000706123, -0.0574568799239852,
			 -0.21217070313132, 0.164918095631753, 16, 16, -0.0236263037497838,
			 "Total", 0.805991068224566, 0.0961978897922363, -0.245601060489069,
			 -0.198630501292494, 0.310027722688403, 50, 50, 0.0556986106979548,
			 "Total", 0.667751314455213, 0.129762135425224, 0.429236236868584,
			 -0.344618253016706, 0.629161598778955, 50, 16, 0.142271672881125,
			 "Total", 0.566840195595579, 0.248417792234121, 0.572711284492221,
			 -0.3701124772749, 0.185076463098476, 50, 84, -0.0925180070882124,
			 "Total", 0.513610506210944, 0.141632434257118, -0.653226131242342,
			 -0.146125137749765, 0.119738952468817, 50, 16, -0.0131930926404737,
			 "Total", 0.845768472002748, 0.0678237182712754, -0.194520338559221,
			 -0.232297712128658, 0.37905765121405, 50, 84, 0.0733799695426964,
			 "Total", 0.637996085744248, 0.155960866670256, 0.470502447885481,
			 -0.672589813250046, 0.326050497894416, 84, 16, -0.173269657677815,
			 "Total", 0.496422567235795, 0.254759862686664, -0.680129341610316,
			 -0.387494407715492, 0.199604921255339, 50, 84, -0.0939447432300765,
			 "Total", 0.530496966452977, 0.149772989096176, -0.627247568450078,
			 -0.228045390333254, 0.213302028239441, 50, 16, -0.00737168104690637,
			 "Total", 0.947797188082573, 0.112590696067374, -0.0654732700337442,
			 -0.214388070706297, 0.165241795455066, 16, 16, -0.0245731376256155,
			 "Total", 0.799701217853837, 0.0968461331830162, -0.253733802455263,
			 -0.199419995721798, 0.308923549366044, 50, 16, 0.0547517768221232,
			 "Total", 0.672878500830837, 0.129681858722301, 0.422200740809614,
			 -0.344853967652744, 0.627503645663331, 50, 16, 0.141324839005293,
			 "Total", 0.568859523493225, 0.2480549696285, 0.5697319397267,
			 -0.372213057977125, 0.185283376049037, 50, 16, -0.093464840964044,
			 "Total", 0.511065255757703, 0.142221091413828, -0.657179888263442,
			 -0.147376864700399, 0.119097011667788, 50, 16, -0.0141399265163054,
			 "Total", 0.835226250667773, 0.0679792788209627, -0.208003479318246,
			 -0.232375062224985, 0.377241333558714, 50, 16, 0.0724331356668647,
			 "Total", 0.641389951295339, 0.155517244345375, 0.46575629584848,
			 -0.674367869649236, 0.325934886541942, 84, 50, -0.174216491553647,
			 "Total", 0.494790486586017, 0.25518396360378, -0.682709403417488,
			 -0.388900868183128, 0.199117713971312, 50, 16, -0.0948915771059081,
			 "Total", 0.527008670396077, 0.150007496768475, -0.632578898722413,
			 -0.228216179850757, 0.211579150005281, 50, 50, -0.00831851492273803,
			 "Total", 0.940896176683212, 0.112194747792584, -0.0741435324416131,
			 -0.243325516942547, 0.157764430000984, 16, 16, -0.0427805434707815,
			 "Total", 0.675872287776449, 0.102320744183893, -0.418102348766107,
			 -0.221043201797466, 0.29413194375138, 84, 50, 0.0365443709769572,
			 "Total", 0.780963766242248, 0.131424645966069, 0.27806330166103,
			 -0.362118997238226, 0.608353863558481, 50, 16, 0.123117433160127,
			 "Total", 0.618980914801198, 0.247574156579323, 0.497295173539974,
			 -0.400260173733634, 0.176915680115214, 50, 84, -0.11167224680921,
			 "Total", 0.448193934917843, 0.14724144382283, -0.758429446967262,
			 -0.176894884746729, 0.112200220023786, 84, 16, -0.0323473323614714,
			 "Total", 0.660946132932394, 0.0737501063924799, -0.438607263687551,
			 -0.251366227465428, 0.359817687108825, 50, 84, 0.0542257298216987,
			 "Total", 0.728001216546064, 0.155917128935836, 0.347785584507614,
			 -0.699738025898383, 0.314890231100757, 84, 16, -0.192423897398813,
			 "Total", 0.457231687475129, 0.258838495248484, -0.743412981187697,
			 -0.415120798933666, 0.188922833031518, 84, 84, -0.113098982951074,
			 "Total", 0.462977150746132, 0.15409559479914, -0.733953381980165,
			 -0.251174959900261, 0.198123118364453, 50, 16, -0.026525920767904,
			 "Total", 0.816983104659473, 0.114618962850522, -0.231426983007142,
			 -0.260252918153642, 0.14404320017697, 16, 16, -0.0581048589883357,
			 "Total", 0.573185389779861, 0.10313866007734, -0.563366432574989,
			 -0.231653648814402, 0.274093759733208, 84, 16, 0.021220055459403,
			 "Total", 0.869359896869827, 0.129019566822881, 0.164471606764376,
			 -0.371495412955316, 0.587081648240462, 50, 16, 0.107793117642573,
			 "Total", 0.659357424838722, 0.244539458060687, 0.440800509240608,
			 -0.419067832348589, 0.16507470769506, 50, 16, -0.126996562326764,
			 "Total", 0.394092548026625, 0.149018692346209, -0.852219009087251,
			 -0.188614300514848, 0.0932710047567969, 84, 16, -0.0476716478790256,
			 "Total", 0.507377203737183, 0.0719108380294537, -0.662927163489597,
			 -0.259471892648136, 0.337274721256425, 50, 16, 0.0389014143041445,
			 "Total", 0.798308496240137, 0.152234076394164, 0.255536836597747,
			 -0.718634123590331, 0.303137697757597, 84, 50, -0.207748212916367,
			 "Total", 0.425447684191753, 0.260660866579063, -0.797005763246602,
			 -0.431412023184811, 0.174565426247554, 84, 16, -0.128423298468628,
			 "Total", 0.406120176325692, 0.154588924646636, -0.830740615876476,
			 -0.260302817571231, 0.176602345000314, 50, 50, -0.0418502362854582,
			 "Total", 0.707302222260124, 0.111457446671928, -0.375481742450491,
			 -0.289561624941142, 0.139902821530164, 16, 16, -0.0748294017054891,
			 "Total", 0.494604418175041, 0.109559269930179, -0.683003836673766,
			 -0.25213759053204, 0.261128616016539, 84, 50, 0.00449551274224958,
			 "Total", 0.972611427685949, 0.130937662782877, 0.0343332288564225,
			 -0.386422737301723, 0.568559887152562, 50, 16, 0.0910685749254197,
			 "Total", 0.70854552393995, 0.2436224930629, 0.37381020849297,
			 -0.447126161942236, 0.159683951854401, 50, 84, -0.143721105043918,
			 "Total", 0.353188266672084, 0.154801342928512, -0.928422856837155,
			 -0.216984468727044, 0.0881920875346861, 84, 16, -0.064396190596179,
			 "Total", 0.408149001613411, 0.0778525928713292, -0.827155374293181,
			 -0.275833195188007, 0.320186938361989, 50, 84, 0.0221768715869911,
			 "Total", 0.884036886044593, 0.152048746367619, 0.145853695717902,
			 -0.743621153439403, 0.294675642172363, 84, 16, -0.22447275563352,
			 "Total", 0.396737683765528, 0.264876498701435, -0.847461955794511,
			 -0.456567432791702, 0.166271750420139, 84, 84, -0.145147841185782,
			 "Total", 0.360975001185456, 0.158890466387321, -0.913508811988511,
			 -0.280535458646452, 0.163385900641228, 50, 16, -0.0585747790026116,
			 "Total", 0.604996445860722, 0.113247325662429, -0.517228805713372,
			 -0.194942931591192, 0.208561908693952, 16, 16, 0.00680948855138006,
			 "Total", 0.947256708013494, 0.102936799723857, 0.0661521299442719,
			 -0.187660939270666, 0.359929745268904, 16, 50, 0.0861344029991187,
			 "Total", 0.537503125514382, 0.139694068069336, 0.616593132332339,
			 -0.330220235132783, 0.675635165497361, 84, 16, 0.172707465182289,
			 "Total", 0.500909254741776, 0.256600480560919, 0.673059788527117,
			 -0.343782103645592, 0.219617674071495, 50, 50, -0.0620822147870485,
			 "Total", 0.665781267509127, 0.143727074109808, -0.431945165318103,
			 -0.141163770753761, 0.175649170075142, 16, 16, 0.0172426996606902,
			 "Total", 0.831058654894395, 0.0808211128693902, 0.213344001938639,
			 -0.222457752074804, 0.430089275762524, 84, 50, 0.10381576184386,
			 "Total", 0.532868182437002, 0.166469137439396, 0.623633686344143,
			 -0.641096519773384, 0.355428789020082, 84, 50, -0.142833865376651,
			 "Total", 0.574217730746647, 0.254220311356211, -0.561850721583429,
			 -0.363912020608368, 0.236894118750542, 16, 50, -0.0635089509289126,
			 "Total", 0.678609892151777, 0.153269688651932, -0.414360800804771,
			 -0.218516857127294, 0.264645079635809, 84, 50, 0.0230641112542575,
			 "Total", 0.851565909354554, 0.123257861005157, 0.187120813765319,
			 -0.170982281502534, 0.225565648503402, 16, 50, 0.027291683500434,
			 "Total", 0.787328088210951, 0.101162045102322, 0.269781848249799,
			 -0.16976821036606, 0.383001406262405, 16, 50, 0.106616597948173,
			 "Total", 0.449610632999892, 0.141015248491462, 0.756064319913797,
			 -0.314190286961493, 0.700569607224179, 84, 50, 0.193189660131343,
			 "Total", 0.455501541092264, 0.258872076780484, 0.746274617695295,
			 -0.317559013536502, 0.234358973860513, 50, 84, -0.0416000198379946,
			 "Total", 0.767643344875514, 0.140797992144364, -0.295458899693263,
			 -0.119460649709683, 0.194910438929171, 16, 50, 0.0377248946097441,
			 "Total", 0.638072196652324, 0.0801981799457982, 0.470395894710334,
			 -0.206069350167262, 0.45466526375309, 84, 84, 0.124297956792914,
			 "Total", 0.460866867782638, 0.16855784573904, 0.737420179095974,
			 -0.615243776878562, 0.370540436023367, 84, 50, -0.122351670427597,
			 "Total", 0.626594214620939, 0.251480185523221, -0.486526086232347,
			 -0.339227881503857, 0.253174369544139, 16, 84, -0.0430267559798587,
			 "Total", 0.775867700594237, 0.151125800198572, -0.284708209473985,
			 -0.199204456766588, 0.286297069173211, 84, 50, 0.0435463062033114,
			 "Total", 0.725144372089861, 0.12385470594597, 0.351591858143106,
			 -0.164362521701924, 0.263653313836934, 16, 16, 0.0496453960675051,
			 "Total", 0.649345966300171, 0.109189719534388, 0.454670973414032,
			 -0.164200036017894, 0.422140657048381, 16, 50, 0.128970310515244,
			 "Total", 0.388566789664998, 0.149579455972471, 0.862219411594731,
			 -0.30440758480244, 0.735494330199268, 84, 16, 0.215543372698414,
			 "Total", 0.41650799158808, 0.265285975457795, 0.812494412214811,
			 -0.30326183277984, 0.264769218237993, 50, 50, -0.0192463072709234,
			 "Total", 0.8943381677983, 0.144908543090177, -0.132816926183203,
			 -0.119621737896487, 0.239778952250118, 16, 16, 0.0600786071768152,
			 "Total", 0.512295146115078, 0.0916855342704028, 0.655268114592961,
			 -0.199876502451845, 0.493179841171816, 84, 50, 0.146651669359985,
			 "Total", 0.406842965909988, 0.176803336461894, 0.829462114769494,
			 -0.595112735408936, 0.395116819687883, 84, 50, -0.0999979578605262,
			 "Total", 0.692213883737845, 0.252614222227455, -0.39585244638557,
			 -0.325639578062544, 0.284293491236969, 16, 50, -0.0206730434127875,
			 "Total", 0.894302632010272, 0.155598029889985, -0.132861858388595,
			 -0.194007101354726, 0.325807138895491, 84, 50, 0.0659000187703826,
			 "Total", 0.619222086030792, 0.132608110238363, 0.496953155066665,
			 -0.201819689408547, 0.178747629268609, 16, 50, -0.0115360300699694,
			 "Total", 0.905415052597516, 0.0970852836274091, -0.11882367377369,
			 -0.191531368080649, 0.327109136836188, 50, 50, 0.0677888843777692,
			 "Total", 0.608403269789356, 0.132308682457384, 0.512354012742919,
			 -0.337272430047191, 0.64599632316907, 84, 50, 0.154361946560939,
			 "Total", 0.53830125386058, 0.250838474832231, 0.615383850759663,
			 -0.356867202317149, 0.196011735500353, 50, 84, -0.080427733408398,
			 "Total", 0.568518319641168, 0.141043137062349, -0.570235001032657,
			 -0.138710356419096, 0.136504718497777, 50, 50, -0.0011028189606593,
			 "Total", 0.987467656349773, 0.0702092173855576, -0.0157076093670595,
			 -0.225628800513133, 0.396569286958155, 84, 84, 0.0854702432225108,
			 "Total", 0.590250178661558, 0.158726918550317, 0.538473524233487,
			 -0.658329588839222, 0.335970820843221, 84, 50, -0.161179383998001,
			 "Total", 0.525145865505392, 0.25365272462284, -0.635433284770195,
			 -0.374965249953515, 0.211256310852991, 50, 84, -0.0818544695502621,
			 "Total", 0.584143860928199, 0.149549064531427, -0.547341902851294,
			 -0.220044113864681, 0.229481299130498, 84, 50, 0.00471859263290804,
			 "Total", 0.967178845708514, 0.114676957469877, 0.0411468244101918,
			 -0.195562412501357, 0.186961958216267, 16, 16, -0.00430022714254484,
			 "Total", 0.964851249119057, 0.0975845407708836, -0.044066684216317,
			 -0.185956085946527, 0.336005460556914, 50, 50, 0.0750246873051938,
			 "Total", 0.573138753873221, 0.13315590251163, 0.563434935215442,
			 -0.331457803439752, 0.65465330241648, 84, 16, 0.161597749488364,
			 "Total", 0.520630770453767, 0.251563578115351, 0.642373394030298,
			 -0.349069858411441, 0.202685997449494, 50, 50, -0.0731919304809734,
			 "Total", 0.603071090781537, 0.140756631298615, -0.519989216889519,
			 -0.132128737594376, 0.144394705527906, 50, 16, 0.00613298396676526,
			 "Total", 0.930719471114235, 0.0705429909180637, 0.0869396645499306,
			 -0.219541502495887, 0.404953594795757, 84, 50, 0.0927060461499354,
			 "Total", 0.56062613819642, 0.159312901210834, 0.581911731224131,
			 -0.649974838940209, 0.342087676799057, 84, 50, -0.153943581070576,
			 "Total", 0.543004482535281, 0.25308182282035, -0.608275929717216,
			 -0.366668714275094, 0.217431381029419, 50, 50, -0.0746186666228375,
			 "Total", 0.616533008989353, 0.149007864407668, -0.500769989016752,
			 -0.212618582145402, 0.236527373266067, 84, 50, 0.0119543955603326,
			 "Total", 0.916905753953697, 0.114580155287106, 0.104332164067837,
			 -0.192262179966507, 0.19945564417833, 16, 50, 0.00359673210591167,
			 "Total", 0.971288284266527, 0.0999298525979706, 0.0359925689111315,
			 -0.182457141663204, 0.348300434770505, 50, 50, 0.0829216465536503,
			 "Total", 0.540259505695901, 0.135399828930597, 0.612420615362477,
			 -0.326492275183032, 0.665481692656673, 84, 50, 0.16949470873682,
			 "Total", 0.502996293303828, 0.253059233655381, 0.669782747258456,
			 -0.343039757168518, 0.212449814703484, 50, 84, -0.0652949712325169,
			 "Total", 0.644965366080441, 0.141709127375205, -0.460767576809887,
			 -0.12979385864975, 0.157853745080193, 50, 50, 0.0140299432152218,
			 "Total", 0.848373955921029, 0.0733808391375737, 0.191193551070172,
			 -0.21507386528657, 0.416279876083354, 84, 84, 0.100603005398392,
			 "Total", 0.532220114992568, 0.161062587463332, 0.624620571312352,
			 -0.642238288565099, 0.35014504492086, 84, 50, -0.14604662182212,
			 "Total", 0.564016342031228, 0.253163665586142, -0.576886187375991,
			 -0.359958538337936, 0.226515123589174, 50, 84, -0.066721707374381,
			 "Total", 0.655625533326123, 0.149613377223546, -0.445960839950083,
			 -0.20755137985323, 0.247254089470808, 84, 50, 0.0198513548087891,
			 "Total", 0.864147443649637, 0.116023935366029, 0.171097064982003,
			 -0.225105349926992, 0.161989685947179, 16, 16, -0.0315578319899067,
			 "Total", 0.749293403289976, 0.0987505482058668, -0.319571208092107,
			 -0.207153981119922, 0.302688146035586, 84, 50, 0.047767082457832,
			 "Total", 0.713426692790317, 0.130064157090915, 0.367257848174441,
			 -0.351052400683236, 0.61973268996524, 84, 16, 0.134340144641002,
			 "Total", 0.587507608095438, 0.247653808515336, 0.542451357588078,
			 -0.382183849919577, 0.181284779262907, 50, 50, -0.100449535328335,
			 "Total", 0.484673628740727, 0.143744638581896, -0.698805439418919,
			 -0.156683696730237, 0.114434454969043, 84, 16, -0.0211246208805966,
			 "Total", 0.760040431084809, 0.0691640647067562, -0.305427695294679,
			 -0.238503612755345, 0.369400495360492, 84, 50, 0.0654484413025735,
			 "Total", 0.673003834864407, 0.15508042824024, 0.42202902097475,
			 -0.683306319076302, 0.320903947240426, 84, 50, -0.181201185917938,
			 "Total", 0.47936912982184, 0.256180795728343, -0.707317601238487,
			 -0.397426864078474, 0.193674321138075, 84, 50, -0.101876271470199,
			 "Total", 0.499294979758983, 0.150793889550798, -0.675599467416617,
			 -0.234662058909246, 0.204055640335188, 84, 50, -0.0153032092870292,
			 "Total", 0.891241320085607, 0.111919836972767, -0.13673366313742,
			 -0.235661105628754, 0.158103540866561, 16, 50, -0.0387787823810967,
			 "Total", 0.699464920460426, 0.100452010751544, -0.386042868539598,
			 -0.21290870708105, 0.294000971214334, 84, 50, 0.0405461320666419,
			 "Total", 0.753868253211786, 0.129316069655826, 0.313542873477018,
			 -0.35519403620126, 0.609432424700884, 84, 50, 0.127119194249812,
			 "Total", 0.605455642780711, 0.246082700628939, 0.516571030490646,
			 -0.39266547933547, 0.17732450789642, 50, 84, -0.107670485719525,
			 "Total", 0.459014791415317, 0.145408280899011, -0.740470109775279,
			 -0.163166877960101, 0.106475735416528, 84, 50, -0.0283455712717866,
			 "Total", 0.680285491140985, 0.068787644952544, -0.412073582273997,
			 -0.24169399087677, 0.358148972699537, 84, 84, 0.0582274909113835,
			 "Total", 0.703565236605134, 0.153023976029099, 0.380512207448532,
			 -0.692998575633468, 0.316154303015212, 84, 50, -0.188422136309128,
			 "Total", 0.464228269288818, 0.257441689390405, -0.731902190182531,
			 -0.405391957711243, 0.187197513988464, 84, 84, -0.109097221861389,
			 "Total", 0.47049821339254, 0.151173561446531, -0.72166866228111,
			 -0.237754838227659, 0.192706518871221, 84, 50, -0.0225241596782193,
			 "Total", 0.83748408818766, 0.109813588538949, -0.205112682117937,
			 -0.250551709450413, 0.15723264550249, 16, 16, -0.0466595319739619,
			 "Total", 0.653773416004513, 0.104028532710155, -0.448526291377817,
			 -0.221921044297396, 0.28725180924495, 84, 50, 0.0326653824737767,
			 "Total", 0.8014443027612, 0.129893420889015, 0.251478344709136,
			 -0.361138799963852, 0.599615689277746, 84, 16, 0.119238444656947,
			 "Total", 0.626613402414231, 0.245094934605918, 0.486499016589908,
			 -0.406458976530684, 0.175356505905903, 50, 50, -0.11555123531239,
			 "Total", 0.436265022718131, 0.148425044293128, -0.778515754283256,
			 -0.175321520752209, 0.102868879022905, 84, 16, -0.0362263208646518,
			 "Total", 0.609730497755113, 0.0709682427762562, -0.510458191544402,
			 -0.247453421215364, 0.348146903852401, 84, 50, 0.0503467413185183,
			 "Total", 0.740375776103408, 0.151941650399136, 0.331355761808972,
			 -0.704929385212901, 0.312323613408915, 84, 50, -0.196302885901993,
			 "Total", 0.44938406947973, 0.259508084496904, -0.756442275324704,
			 -0.41641014332697, 0.182454200418461, 84, 50, -0.116977971454255,
			 "Total", 0.443860000746981, 0.152774323525635, -0.765691306986057,
			 -0.244308279327564, 0.183498460785396, 84, 50, -0.0304049092710845,
			 "Total", 0.780555227792149, 0.10913637788435, -0.278595550452517,
			 -0.0204603750482093, 0.0355994842466277, 16, 50, 0.00756955459920919,
			 "Total indirect", 0.596601991998937, 0.0143012473027642, 0.529293315398168,
			 -0.0237406617288537, 0.049810973224662, 16, 50, 0.0130351557479041,
			 "Total indirect", 0.487238634085231, 0.0187635169660467, 0.694707488553011,
			 -0.0348556296284569, 0.0728559591118954, 16, 50, 0.0190001647417192,
			 "Total indirect", 0.489270548517026, 0.0274779510210309, 0.691469488652084,
			 -0.0473530127182455, 0.025801084673965, 50, 84, -0.0107759640221403,
			 "Total indirect", 0.56365240769523, 0.0186621024593413, -0.577424973719743,
			 -0.0631274836560624, 0.026013973865913, 16, 50, -0.0185567548950747,
			 "Total indirect", 0.414489143786187, 0.0227405855987946, -0.816019218786444,
			 -0.0924345896066185, 0.0383375911668701, 16, 84, -0.0270484992198742,
			 "Total indirect", 0.417488947878834, 0.0333608632110087, -0.810785351949421,
			 -0.120799472053987, 0.0592039401698316, 84, 50, -0.0307977659420775,
			 "Total indirect", 0.502423218508478, 0.0459200816044739, -0.670681864360558,
			 -0.141584254011217, 0.035513633743964, 16, 84, -0.0530353101336265,
			 "Total indirect", 0.240436473350822, 0.0451788627628126, -1.17389652794184,
			 -0.208092906954119, 0.0534833803546232, 16, 50, -0.0773047632997478,
			 "Total indirect", 0.246671005332413, 0.0667298708986549, -1.15847314341659,
			 -0.0327768385193061, 0.0670648246595105, 16, 16, 0.0171439930701022,
			 "Total indirect", 0.500884983593129, 0.0254702800577855, 0.673097941255726,
			 -0.0192250700715005, 0.0782707158570843, 16, 50, 0.0295228228927919,
			 "Total indirect", 0.235228262625586, 0.0248718309871046, 1.18699837209809,
			 -0.0289897325587222, 0.115055217229872, 16, 16, 0.0430327423355749,
			 "Total indirect", 0.241574740511419, 0.0367468358920884, 1.17105980122876,
			 -0.0152548378260869, 0.0128517867235924, 50, 50, -0.00120152555124727,
			 "Total indirect", 0.866919711425862, 0.00717018903698761, -0.167572367346129,
			 -0.0257553260434991, 0.0216171505431253, 16, 16, -0.00206908775018689,
			 "Total indirect", 0.864058093254069, 0.0120850375211719, -0.171210701378629,
			 -0.0375510450505565, 0.0315192017985193, 16, 50, -0.00301592162601856,
			 "Total indirect", 0.864096455069075, 0.0176202847077531, -0.171161912309597,
			 -0.083295903383429, 0.04084924844106, 84, 50, -0.0212233274711845,
			 "Total indirect", 0.502772229844972, 0.0316702635364043, -0.670134223758157,
			 -0.0977210493155194, 0.0246257633380418, 16, 50, -0.0365476429887388,
			 "Total indirect", 0.241611884974906, 0.0312114951138432, -1.17096739055377,
			 -0.143620363707582, 0.0370759922957978, 16, 50, -0.0532721857058921,
			 "Total indirect", 0.247821206784935, 0.0460968562250862, -1.15565767534709,
			 -0.0540505087474685, 0.110783917849423, 16, 50, 0.028366704550977,
			 "Total indirect", 0.499937125779797, 0.0420503713070965, 0.674588681840956,
			 -0.0312544654512371, 0.128952264451299, 16, 50, 0.0488488995000309,
			 "Total indirect", 0.231996503560438, 0.0408698147430836, 1.19523173293311,
			 -0.0471679122191657, 0.18957313635337, 16, 50, 0.071202612067102,
			 "Total indirect", 0.238412617278063, 0.0603942343940804, 1.17896373356595,
			 -0.0240540209508287, 0.0440963928100838, 50, 84, 0.0100211859296275,
			 "Total indirect", 0.564340595342731, 0.0173856290979003, 0.576406287813754,
			 -0.0243380518058097, 0.0588520295199138, 16, 50, 0.0172569888570521,
			 "Total indirect", 0.416131106897096, 0.0212223494875202, 0.813151666699298,
			 -0.0358640152399331, 0.0861719114509503, 16, 84, 0.0251539481055086,
			 "Total indirect", 0.419106451254029, 0.0311321860129796, 0.807972433899162,
			 -0.0442766222251919, 0.0242753902445724, 84, 50, -0.0100006159903097,
			 "Total indirect", 0.567421366547299, 0.0174880796306702, -0.571853296731957,
			 -0.0593864040770192, 0.0249432713140196, 16, 84, -0.0172215663814998,
			 "Total indirect", 0.423411586058327, 0.0215130676012979, -0.800516537235293,
			 -0.0869440340269638, 0.0367394020782338, 16, 50, -0.025102315974365,
			 "Total indirect", 0.426279944679923, 0.0315524767497762, -0.795573551117284,
			 16, 16, 50, 50, 16, 16, 50, 50, 50, 16, 16, 50, 84, 50, 50,
			 50, 16, 50, 16, 50, 50, 50, 16, 50, 50, 84, 50, 50, 16, 84,
			 84, 50, 50, 84, 16, 50, 16, 16, 50, 50, 16, 16, 50, 50, 50,
			 16, 16, 50, 84, 50, 50, 50, 16, 50, 16, 50, 84, 50, 16, 50,
			 50, 84, 84, 50, 16, 84, 84, 50, 84, 84, 16, 50, 16, 16, 84,
			 50, 16, 16, 50, 50, 84, 16, 16, 50, 84, 50, 84, 50, 16, 50,
			 16, 50, 84, 50, 16, 50, 50, 84, 84, 50, 16, 84, 84, 50, 84,
			 84, 16, 50, 16, 16, 16, 84, 50, 16, 50, 84, 16, 16, 50, 84,
			 84, 50, 16, 84, 50, 50, 16, 84, 16, 50, 50, 84, 50, 84, 16,
			 84, 50, 84, 84, 84, 16, 84, 50, 84, 16, 16, 16, 84, 50, 16,
			 50, 84, 16, 16, 50, 84, 84, 50, 16, 84, 50, 50, 16, 84, 50,
			 50, 50, 84, 50, 84, 50, 84, 50, 84, 84, 84, 50, 84, 50, 84,
			 16, 16, 50, 84, 50, 16, 50, 84, 50, 16, 50, 84, 84, 50, 50,
			 84, 50, 50, 16, 84, 50, 50, 50, 84, 50, 84, 50, 84, 50, 84,
			 84, 84, 50, 84, 50, 84, 16, 16, 84, 84, 50, 16, 50, 84, 84,
			 16, 50, 84, 84, 50, 84, 84, 50, 50, 16, 84, 84, 50, 50, 84,
			 50, 84, 84, 84, 50, 84, 84, 84, 84, 84, 50, 84, 16, 16, 84,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 84, 50, 84, 84, 50, 50,
			 16, 84, 16, 50, 84, 84, 50, 84, 16, 84, 84, 84, 84, 84, 16,
			 84, 84, 84, 16, 16, 16, 84, 84, 16, 50, 84, 16, 16, 84, 84,
			 84, 50, 16, 84, 84, 50, 16, 84, 16, 50, 84, 84, 50, 84, 16,
			 84, 84, 84, 84, 84, 16, 84, 84, 84, 16, 16, 50, 84, 84, 16,
			 50, 84, 50, 16, 84, 84, 84, 50, 50, 84, 84, 50, 16, 84, 50,
			 50, 84, 84, 50, 84, 50, 84, 84, 84, 84, 84, 50, 84, 84, 84,
			 16, 16, 50, 84, 84, 16, 50, 84, 50, 16, 84, 84, 84, 50, 50,
			 84, 84, 50, 16, 84, 84, 50, 84, 84, 50, 84, 84, 84, 84, 84,
			 84, 84, 84, 84, 84, 84, 16, 16, 84, 84, 84, 16, 50, 84, 84,
			 16, 84, 84, 84, 50, 84, 84, 84, 50, 16, 84, 84, 50, 84, 84,
			 50, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 16, 16, 16,
			 16, 16, 16, 50, 16, 16, 16, 16, 16, 84, 16, 16, 16, 16, 16,
			 16, 50, 16, 50, 16, 50, 50, 50, 16, 50, 16, 50, 84, 50, 16,
			 50, 16, 50, 16, 84, 16, 84, 16, 84, 50, 84, 16, 84, 16, 84,
			 84, 84, 16, 84, 16, 84, 16, 50, 16, 50, 50, 16, 84, 50, 16,
			 16, 50, 16, 50, 50, 16, 84, 50, 16, 16, 50, 16, 50, 50, 16,
			 84, 50, 16, 16, 84, 16, 50, 84, 16, 84, 84, 16, 16, 84, 16,
			 50, 84, 16, 84, 84, 16, 16, 84, 16, 50, 84, 16, 84, 84, 16,
			 16, 16, 50, 50, 16, 50, 84, 16, 50, 16, 16, 50, 50, 16, 50,
			 84, 16, 50, 16, 16, 50, 50, 16, 50, 84, 16, 50, 16, 50, 50,
			 50, 50, 50, 84, 50, 50, 16, 50, 50, 50, 50, 50, 84, 50, 50,
			 16, 50, 50, 50, 50, 50, 84, 50, 50, 16, 84, 50, 50, 84, 50,
			 84, 84, 50, 16, 84, 50, 50, 84, 50, 84, 84, 50, 16, 84, 50,
			 50, 84, 50, 84, 84, 50, 16, 16, 84, 50, 16, 84, 84, 16, 84,
			 16, 16, 84, 50, 16, 84, 84, 16, 84, 16, 16, 84, 50, 16, 84,
			 84, 16, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84, 16, 50, 84,
			 50, 50, 84, 84, 50, 84, 16, 50, 84, 50, 50, 84, 84, 50, 84,
			 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 84, 84, 50, 84, 84,
			 84, 84, 84, 16, 84, 84, 50, 84, 84, 84, 84, 84, 16, 16, 50,
			 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50,
			 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-67")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-67")
})


context('Model number 67 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(22997.6864931565, 23161.4675600617, 26469.2946707718, 21, 1, 2564,
			 0, 0, 26469.2946707718, 21))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 67))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0678665016842968, 0.0881401592474678, 0.0780033304658823, "facExperimexperimental",
			 "<unicode>", 0, "facGenderm", 0.00517194645490607, 15.0820065803057,
			 -0.0939556529283561, -0.0542201828979553, -0.0740879179131557,
			 "contcor2", "<unicode>", 2.69562150378988e-13, "facGenderm",
			 0.0101367857633684, -7.30881757222192, -0.0997951782392662,
			 -0.0599923328464047, -0.0798937555428355, "contcor2", "<unicode>",
			 3.5527136788005e-15, "facExperimexperimental", 0.0101539736716647,
			 -7.86822559583584, 0.960774568964023, 1.0720512724198, 1.01641292069191,
			 "contNormal", "<unicode>", 0, "contNormal", 0.0283874357726748,
			 35.8050275773865, 0.00607846432311821, 0.00678247962985989,
			 0.00643047197648905, "debCollin1", "<unicode>", 0, "debCollin1",
			 0.000179599041690273, 35.8046007148451, 0.103586140646051, 0.115583467941911,
			 0.109584804293981, "debCollin1:facExperimexperimental", "<unicode>",
			 0, "debCollin1:facExperimexperimental", 0.00306059891673864,
			 35.8050196301951, 0.426152176949215, 0.475508818693622, 0.450830497821419,
			 "debCollin1:contcor2", "<unicode>", 0, "debCollin1:contcor2",
			 0.0125912114033029, 35.8051726224814, 0.236314934908945, 0.263684868329715,
			 0.24999990161933, "facGenderm", "<unicode>", 0, "facGenderm",
			 0.00698225417320442, 35.805041669601, 0.236315040456159, 0.26368499982865,
			 0.250000020142405, "facExperimexperimental", "<unicode>", 0,
			 "facExperimexperimental", 0.00698226079366291, 35.8050246947671,
			 0.975408202297199, 1.08837975735589, 1.03189397982655, "contcor2",
			 "<unicode>", 0, "contcor2", 0.0288198038203253, 35.8050313687007
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.472927131268973, 0.784722443156585, 16, 0.628824787212779, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 2.66453525910038e-15,
			 0.0795410819655398, 7.90566046719367, 0.203503400032089, 0.488257101694874,
			 16, 0.345880250863482, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 1.92256584896633e-06, 0.0726425852487307, 4.76139787260015,
			 0.497013631494709, 0.7324158599072, 50, 0.614714745700954, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.060052692363052,
			 10.2362562195324, 0.213094573753949, 0.450445844949365, 50,
			 0.331770209351657, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 4.27047377460354e-08, 0.0605499062910371, 5.47928526523197,
			 0.461875970614568, 0.737185873534756, 84, 0.599530922074662,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0, 0.0702334086472499,
			 8.53626406039652, 0.162421076860451, 0.470751694590278, 84,
			 0.316586385725364, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 5.70027331412426e-05, 0.0786572151738244, 4.02488678280487,
			 -0.00789293055396792, 0.00373536190807631, 16, -0.00207878432294581,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.483450518976231, 0.00296645564759524, -0.700763662059459,
			 -0.00861503932403104, 0.0233906339238299, 16, 0.00738779729989945,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.36555645006616, 0.00816486259449604, 0.90482812348607, -0.00825454664869183,
			 0.00385577710369345, 16, -0.00219938477249919, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.47652207914348,
			 0.00308942507309062, -0.711907465132002, -0.00867060744869373,
			 0.0243034065845694, 16, 0.00781639956793782, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.352781213475824,
			 0.00841189284429661, 0.929208171409061, -0.00414670796467, 0.00296053919030995,
			 50, -0.000593084387180028, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.743585065270064, 0.00181310657008012,
			 -0.327109501982457, -0.00995828016482276, 0.0141738086213892,
			 50, 0.00210776422828322, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.732066827522768, 0.00615625822121294,
			 0.342377488491368, -0.004511322371605, 0.00308395269813818,
			 50, -0.000713684836733414, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.712624683980875, 0.00193760577481366,
			 -0.368333355531029, -0.0101921174203112, 0.0152648504129543,
			 50, 0.00253636649632159, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.696125383486097, 0.00649424378051505,
			 0.390556095835446, -0.00347092606487292, 0.00548228236758026,
			 84, 0.00100567815135367, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.659712703471902, 0.00228402371244445,
			 0.440309855748981, -0.0181726924909354, 0.0110245278168725,
			 84, -0.00357408233703146, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.631337487073463, 0.00744840735291869,
			 -0.479845175979928, -0.00366307872948272, 0.00543323413308328,
			 84, 0.000885077701800282, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.702897724754932, 0.002320530615439,
			 0.381411775355027, -0.0183208345070311, 0.0120298743690449,
			 84, -0.00314548006899309, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.684556987254762, 0.00774267004788827,
			 -0.406252629847114))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.497010557512237, 0.732321715768732, 0.614666136640485, "facGenderm",
			 "<unicode>", 0, "contNormal", 0.0600294597534953, 10.2394081033637,
			 -0.791830649356795, 0.557186755592424, -0.117321946882185, "debCollin1",
			 "<unicode>", 0.733171304332138, "contNormal", 0.344143416815334,
			 -0.340910042585938, -0.503018243135904, 0.818241172856848, 0.157611464860472,
			 "facExperimexperimental", "<unicode>", 0.640068127954142, "contNormal",
			 0.337062167063956, 0.46760354694618, -0.457708051344491, 0.163269055197175,
			 -0.147219498073658, "contcor2", "<unicode>", 0.352720450519337,
			 "contNormal", 0.158415438099846, -0.929325448576977, -1.00054929410701,
			 0.952420402903554, -0.0240644456017278, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.961476151916121, "contNormal", 0.498215710190427,
			 -0.0483012580886498, -0.45113413226499, -0.114754940433606,
			 -0.282944536349298, "facGenderm:facExperimexperimental", "<unicode>",
			 0.000976407777573129, "contNormal", 0.0858125951509059, -3.29723784546691,
			 -0.18152221780287, 0.739601479670135, 0.279039630933632, "debCollin1:contcor2",
			 "<unicode>", 0.235038646684747, "contNormal", 0.234984852971461,
			 1.18747922432057, -0.0937816592236299, 0.0672193310982828, -0.0132811640626735,
			 "facGenderm:contcor2", "<unicode>", 0.746422965943552, "contNormal",
			 0.0410724359202179, -0.323359541870656, -0.0042289547491187,
			 0.0142520777870937, 0.00501156151898748, "facGenderm", "<unicode>",
			 0.287791212650963, "debCollin1", 0.00471463574891896, 1.06297957803773,
			 -0.0125864699958574, 0.00589456254033932, -0.00334595372775905,
			 "facExperimexperimental", "<unicode>", 0.477893252656461, "debCollin1",
			 0.00471463574891497, -0.709695065738449, -0.0358902271595756,
			 -0.00975410030021179, -0.0228221637298937, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.000619578312568203, "debCollin1", 0.00666750181776865,
			 -3.42289576420863))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.470499076621386, 0.782992929158281, 16, 0.626746002889833, 0,
			 "Total", 3.77475828372553e-15, 0.079719284385276, 7.8619120545642,
			 0.201178794015493, 0.486424139065579, 16, 0.343801466540536,
			 0, "Total", 2.30541583623456e-06, 0.0727680067848352, 4.72462393476172,
			 0.494773457965108, 0.730498464790909, 16, 0.612635961378008,
			 0, "Total", 0, 0.0601350353080899, 10.1876711012023, 0.21101977662084,
			 0.448363073436581, 16, 0.329691425028711, 1, "Total", 5.1765686182037e-08,
			 0.0605478719731267, 5.44513645624143, 0.459936705451952, 0.73496757005148,
			 50, 0.597452137751716, 0, "Total", 0, 0.0701622240941509, 8.5152964499813,
			 0.160593381323567, 0.46842182148127, 16, 0.314507601402419,
			 0, "Total", 6.20223901504069e-05, 0.0785291062962929, 4.00498128955869,
			 0.48035094547996, 0.792074223545397, 50, 0.636212584512679,
			 0, "Total", 1.33226762955019e-15, 0.0795227056528257, 8.00038906234162,
			 0.210445037027812, 0.49609105929895, 16, 0.353268048163381,
			 0, "Total", 1.24770971088317e-06, 0.0728702222398672, 4.84790683086607,
			 0.503381567539237, 0.740823518462471, 84, 0.622102543000854,
			 0, "Total", 0, 0.0605730392997386, 10.2702877417534, 0.218893724016766,
			 0.459422289286346, 16, 0.339158006651556, 1, "Total", 3.25185693927921e-08,
			 0.0613604553876597, 5.52730589283997, 0.46741404767836, 0.746423391070763,
			 84, 0.606918719374561, 0, "Total", 0, 0.0711771608032579, 8.52687452723995,
			 0.167711315763164, 0.480237050287364, 16, 0.323974183025264,
			 0, "Total", 4.83375893811644e-05, 0.0797274176947544, 4.06352284311573,
			 0.470431401300298, 0.782819403580262, 16, 0.62662540244028,
			 0, "Total", 3.77475828372553e-15, 0.0796922812725235, 7.86306267601263,
			 0.200879705113437, 0.486482027068528, 16, 0.343680866090982,
			 0, "Total", 2.39273229607484e-06, 0.0728590739952075, 4.71706332849617,
			 0.494572799906319, 0.730457921950591, 16, 0.612515360928455,
			 0, "Total", 0, 0.0601758817776509, 10.1787517329898, 0.210535876097144,
			 0.44860577306117, 16, 0.329570824579157, 1, "Total", 5.74595560021152e-08,
			 0.060733232559856, 5.42653191157489, 0.459609058748391, 0.735054015855935,
			 50, 0.597331537302163, 0, "Total", 0, 0.0702678618791514, 8.50077861098819,
			 0.16006896909834, 0.468705032807391, 16, 0.314387000952865,
			 0, "Total", 6.52509560599146e-05, 0.0787351364983063, 3.99296952967914,
			 0.480508182570211, 0.792774190991223, 50, 0.636641186780717,
			 0, "Total", 1.33226762955019e-15, 0.0796611598182738, 7.99186439455625,
			 0.211417851347129, 0.49597544951571, 16, 0.353696650431419,
			 1, "Total", 1.10276264919662e-06, 0.0725925579278842, 4.87235414383377,
			 0.503983784666164, 0.74107850587162, 84, 0.622531145268892,
			 0, "Total", 0, 0.0604844586624113, 10.2924149283289, 0.22049637402949,
			 0.458676843809699, 16, 0.339586608919594, 1, "Total", 2.28577581307121e-08,
			 0.0607614404292494, 5.5888505361391, 0.468477150342048, 0.746217492943151,
			 84, 0.6073473216426, 1, "Total", 0, 0.0708534301629733, 8.57188311484161,
			 0.169478176485803, 0.479327394100801, 16, 0.324402785293302,
			 0, "Total", 4.05986066078778e-05, 0.0790446202223738, 4.10404635230924,
			 0.472296194110667, 0.784167211540531, 16, 0.628231702825599,
			 0, "Total", 2.88657986402541e-15, 0.07956039495875, 7.89628687931125,
			 0.202816579539971, 0.487757753412632, 16, 0.345287166476302,
			 1, "Total", 2.03309903112903e-06, 0.0726904106708697, 4.75010614590837,
			 0.496442587907928, 0.73180073471962, 16, 0.614121661313774,
			 0, "Total", 0, 0.0600414468500867, 10.2282955113845, 0.212460591757457,
			 0.449893658171496, 16, 0.331177124964477, 1, "Total", 4.56154249928176e-08,
			 0.060570772801664, 5.4676060688362, 0.461368172072753, 0.736507503302211,
			 50, 0.598937837687482, 1, "Total", 0, 0.0701898946612596, 8.53310637632369,
			 0.161855809360443, 0.470130793315926, 16, 0.315993301338184,
			 0, "Total", 5.86763518095612e-05, 0.0786430226236595, 4.01807167115572,
			 0.474559284169257, 0.787305818712868, 50, 0.630932551441062,
			 0, "Total", 2.66453525910038e-15, 0.0797837452653509, 7.90803376480584,
			 0.205275907418383, 0.490700122765146, 16, 0.347988015091765,
			 1, "Total", 1.76029195508853e-06, 0.0728136378010395, 4.77915986072044,
			 0.498237271455106, 0.735407748403369, 84, 0.616822509929237,
			 0, "Total", 0, 0.0605037844621213, 10.1947756725102, 0.214547041217358,
			 0.453208905942522, 16, 0.33387797357994, 1, "Total", 4.16249152923598e-08,
			 0.060884247518755, 5.48381539046025, 0.46299246548157, 0.74028490712432,
			 84, 0.601638686302945, 1, "Total", 0, 0.0707391676148127, 8.50502920219495,
			 0.163813906606051, 0.473574393301244, 16, 0.318694149953648,
			 0, "Total", 5.50737684670288e-05, 0.079021984367709, 4.03298085341269,
			 0.472232046620218, 0.783990158131873, 16, 0.628111102376046,
			 0, "Total", 2.88657986402541e-15, 0.0795315918993316, 7.89763020424749,
			 0.202521039907994, 0.487812092145503, 16, 0.345166566026748,
			 0, "Total", 2.1096803577425e-06, 0.0727796669958858, 4.74262359631654,
			 0.496246335147045, 0.731755786581396, 16, 0.614001060864221,
			 1, "Total", 0, 0.0600800456773746, 10.2197169449797, 0.211981307940137,
			 0.450131741089709, 16, 0.331056524514923, 1, "Total", 5.06107609155038e-08,
			 0.0607537778826736, 5.44915124709204, 0.461044478692866, 0.736589995782991,
			 50, 0.598817237237929, 0, "Total", 0, 0.0702935154073218, 8.5188119240876,
			 0.161335432349531, 0.470409969427731, 16, 0.315872700888631,
			 1, "Total", 6.17170741539219e-05, 0.0788469940050279, 4.00614766453225,
			 0.474715191570725, 0.788007115847477, 50, 0.631361153709101,
			 0, "Total", 2.88657986402541e-15, 0.0799228778559092, 7.89962987628355,
			 0.206246704611778, 0.490586530107828, 16, 0.348416617359803,
			 0, "Total", 1.56075725987748e-06, 0.0725370026538465, 4.80329493379373,
			 0.498836756097826, 0.735665468296726, 84, 0.617251112197276,
			 1, "Total", 0, 0.0604165979750074, 10.2165817488203, 0.216156027638466,
			 0.45245712405749, 16, 0.334306575847978, 1, "Total", 2.92761286324605e-08,
			 0.060281999639518, 5.54571145361978, 0.464056999624129, 0.740077577517838,
			 84, 0.602067288570984, 0, "Total", 0, 0.0704147066147452, 8.55030600162875,
			 0.165590557670315, 0.472654946773057, 16, 0.319122752221686,
			 1, "Total", 4.62397218428112e-05, 0.0783341917312836, 4.07386283267465,
			 0.474133758042199, 0.785527172686067, 16, 0.629830465364133,
			 0, "Total", 2.22044604925031e-15, 0.0794385552745099, 7.92852366445581,
			 0.20447311616389, 0.48929874186578, 50, 0.346885929014835, 0,
			 "Total", 1.8056987929338e-06, 0.0726609335550445, 4.77403622611112,
			 0.498110601642509, 0.733330246062107, 16, 0.615720423852308,
			 1, "Total", 0, 0.0600061139579555, 10.2609614794207, 0.213884001536456,
			 0.451667773469564, 50, 0.33277588750301, 1, "Total", 4.1137432571503e-08,
			 0.0606602401392872, 5.48589795785336, 0.462798928139319, 0.738274272312712,
			 50, 0.600536600226016, 0, "Total", 0, 0.0702756138241079, 8.54544795196086,
			 0.163116890540901, 0.472067237212535, 50, 0.317592063876718,
			 1, "Total", 5.58782317923168e-05, 0.0788153121967025, 4.02957312513196,
			 0.467735802725594, 0.782765607025901, 50, 0.625250704875748,
			 0, "Total", 7.32747196252603e-15, 0.0803662227431786, 7.78001856418987,
			 0.199061240034894, 0.485551097018006, 50, 0.34230616852645,
			 1, "Total", 2.81823989167762e-06, 0.0730854901526015, 4.68364059420987,
			 0.491917189082826, 0.730364137645019, 84, 0.611140663363923,
			 1, "Total", 0, 0.0608294209595259, 10.0467940303189, 0.20909252659016,
			 0.447299727439091, 50, 0.328196127014625, 1, "Total", 6.63509946985386e-08,
			 0.0607682597047393, 5.4007820630254, 0.457565131088032, 0.734348548387229,
			 84, 0.59595683973763, 1, "Total", 0, 0.0706093120798212, 8.44020175503089,
			 0.159027244261885, 0.466997362514781, 50, 0.313012303388333,
			 1, "Total", 6.77345550008646e-05, 0.0785652493316524, 3.98410628173526,
			 0.47407338542685, 0.785346344402309, 16, 0.629709864914579,
			 0, "Total", 2.22044604925031e-15, 0.0794078262230175, 7.93007307801166,
			 0.204181531536549, 0.489349125594015, 50, 0.346765328565282,
			 1, "Total", 1.87311035793059e-06, 0.0727481719834731, 4.76665349947295,
			 0.497919182163049, 0.73328046464246, 16, 0.615599823402754,
			 1, "Total", 0, 0.0600422467800201, 10.2527779424737, 0.213410058949261,
			 0.451900515157653, 50, 0.332655287053457, 1, "Total", 4.56015134542298e-08,
			 0.0608405200528109, 5.46766015091102, 0.462479643644625, 0.738352355908299,
			 50, 0.600415999776462, 1, "Total", 0, 0.0703769850976147, 8.5314254218715,
			 0.162601091687547, 0.472341835166783, 50, 0.317471463427165,
			 1, "Total", 5.87529466242742e-05, 0.0790169477404767, 4.01776419496572,
			 0.467891315760585, 0.783467298526987, 50, 0.625679307143786,
			 0, "Total", 7.7715611723761e-15, 0.0805055565448207, 7.77187729638817,
			 0.200027395227814, 0.485442146361163, 50, 0.342734770794488,
			 1, "Total", 2.51180036792142e-06, 0.0728112234165181, 4.70716950920969,
			 0.492512620061414, 0.730625911202508, 84, 0.611569265631961,
			 1, "Total", 0, 0.060744302706402, 10.0679279929821, 0.210700620864874,
			 0.446548837700453, 50, 0.328624729282664, 1, "Total", 4.7099911970605e-08,
			 0.0601664670105982, 5.46192498264485, 0.458628128521139, 0.734142755490199,
			 84, 0.596385442005669, 1, "Total", 0, 0.0702856351295953, 8.48516828376141,
			 0.160809354177328, 0.466072457135415, 50, 0.313440905656371,
			 1, "Total", 5.69897654154605e-05, 0.077874671515896, 4.02494032469069,
			 -0.00789293055396792, 0.00373536190807631, 16, -0.00207878432294581,
			 0, "Total indirect", 0.483450518976231, 0.00296645564759524,
			 -0.700763662059459, -0.00861503932403104, 0.0233906339238299,
			 50, 0.00738779729989945, 0, "Total indirect", 0.36555645006616,
			 0.00816486259449604, 0.90482812348607, -0.00825454664869183,
			 0.00385577710369345, 16, -0.00219938477249919, 0, "Total indirect",
			 0.47652207914348, 0.00308942507309062, -0.711907465132002, -0.00867060744869373,
			 0.0243034065845694, 50, 0.00781639956793782, 1, "Total indirect",
			 0.352781213475824, 0.00841189284429661, 0.929208171409061, -0.00414670796467,
			 0.00296053919030995, 50, -0.000593084387180028, 0, "Total indirect",
			 0.743585065270064, 0.00181310657008012, -0.327109501982457,
			 -0.00995828016482276, 0.0141738086213892, 50, 0.00210776422828322,
			 0, "Total indirect", 0.732066827522768, 0.00615625822121294,
			 0.342377488491368, -0.004511322371605, 0.00308395269813818,
			 50, -0.000713684836733414, 0, "Total indirect", 0.712624683980875,
			 0.00193760577481366, -0.368333355531029, -0.0101921174203112,
			 0.0152648504129543, 50, 0.00253636649632159, 0, "Total indirect",
			 0.696125383486097, 0.00649424378051505, 0.390556095835446, -0.00347092606487292,
			 0.00548228236758026, 84, 0.00100567815135367, 0, "Total indirect",
			 0.659712703471902, 0.00228402371244445, 0.440309855748981, -0.0181726924909354,
			 0.0110245278168725, 50, -0.00357408233703146, 1, "Total indirect",
			 0.631337487073463, 0.00744840735291869, -0.479845175979928,
			 -0.00366307872948272, 0.00543323413308328, 84, 0.000885077701800282,
			 0, "Total indirect", 0.702897724754932, 0.002320530615439, 0.381411775355027,
			 -0.0183208345070311, 0.0120298743690449, 50, -0.00314548006899309,
			 0, "Total indirect", 0.684556987254762, 0.00774267004788827,
			 -0.406252629847114, 16, 0, 50, 0, 16, 0, 50, 1, 50, 0, 50, 0,
			 50, 0, 50, 1, 84, 0, 50, 1, 84, 1, 50, 0, 16, 0, 84, 1, 16,
			 0, 84, 1, 50, 1, 84, 0, 50, 0, 84, 1, 84, 0, 84, 1, 84, 1, 84,
			 0, 16, 0, 84, 0, 16, 1, 84, 1, 50, 0, 84, 1, 50, 0, 84, 0, 84,
			 1, 84, 1, 84, 0, 84, 1, 16, 0, 84, 0, 16, 1, 84, 1, 50, 0, 84,
			 1, 50, 0, 84, 1, 84, 1, 84, 1, 84, 1, 84, 1, 16, 0, 84, 1, 16,
			 1, 84, 1, 50, 1, 84, 1, 50, 0, 84, 1, 84, 1, 84, 1, 84, 1, 84,
			 1, 16, 0, 16, 0, 16, 0, 16, 1, 50, 0, 50, 0, 50, 0, 50, 0, 84,
			 0, 84, 1, 84, 0, 84, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0,
			 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0,
			 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1,
			 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0,
			 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-67")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-67")
})


context('Model number 68 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1685.03952209869, 1765.79979786432, 834.975491928847, 25, 1, 100,
			 5.01944273950493e-160, 0, 834.975491928847, 25))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 68))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544843588863603, 0.0642187205174, -0.240312434173101, "contcor1",
			 "<unicode>", 0.121947186158462, "contGamma", 0.155375893175897,
			 -1.54665198867787, -0.403942370852575, 0.194624507496174, -0.104658931678201,
			 "contcor2", "<unicode>", 0.493093931158303, "contGamma", 0.152698438101457,
			 -0.685396216093988, 1.3770644439433, 3.45906900016091, 2.4180667220521,
			 "contGamma__contcor1__contcor2", "<unicode>", 5.29732354981327e-06,
			 "contGamma", 0.531133370980335, 4.55265448222351, 0.424978329220352,
			 0.896756937238798, 0.660867633229575, "contcor2", "<unicode>",
			 3.99581934207305e-08, "contcor1", 0.120353897250096, 5.49103642116621,
			 -0.374347985836535, 0.853226155293725, 0.239439084728595, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.44451909683559, "contcor1", 0.313162423088692,
			 0.764584340506213, -0.16490357042517, 1.06244203486759, 0.448769232221209,
			 "contGamma__contcor1__contcor2", "<unicode>", 0.151774773195023,
			 "contcor2", 0.31310412205885, 1.43329071897961, 0.761632527335585,
			 1.3457617279689, 1.05369712765224, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.149015289372879, 7.07106721791204,
			 0.00458998976028267, 0.00811025121466307, 0.00635012048747287,
			 "debCollin1", "<unicode>", 1.53743684450092e-12, "debCollin1",
			 0.000898042382959017, 7.07106992717811, 0.323891034718323, 0.572295855022577,
			 0.44809344487045, "debCollin1:contcor1", "<unicode>", 1.53721479989599e-12,
			 "debCollin1:contcor1", 0.0633697410420906, 7.07109477649315,
			 1.68042619427652, 2.96924450795865, 2.32483535111759, "contGamma",
			 "<unicode>", 1.53854706752554e-12, "contGamma", 0.328786223585782,
			 7.07096339306025, 0.73263272897687, 1.29451745130012, 1.0135750901385,
			 "contcor1", "<unicode>", 1.53721479989599e-12, "contcor1", 0.143340573284848,
			 7.07109694701938, 0.721538522744221, 1.27491214174388, 0.998225332244053,
			 "contcor2", "<unicode>", 1.53677071068614e-12, "contcor2", 0.141169333560363,
			 7.07112024310309, 6.95308754326008, 12.2855976349177, 9.61934258908889,
			 "contGamma__contcor1__contcor2", "<unicode>", 1.53632662147629e-12,
			 "contGamma__contcor1__contcor2", 1.36035920397512, 7.07117837772562
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.15421267726256, 0.117651910772562, "", "", -0.0182803832449989,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.79210437229231,
			 0.0693544856383982, -0.263578960707884, -0.0262434009139506,
			 0.0392910608254989, 16, 16, 0.00652382995577412, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.696372905134699,
			 0.0167182821358905, 0.390221309985485, -0.0321811327704064,
			 0.0645499213979659, 16, 16, 0.0161843943137798, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.511916663362343,
			 0.0246767427696056, 0.655856182677162, -0.0594512417755902,
			 0.112906586744566, 50, 16, 0.026727672484488, "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.54327601593004, 0.0439696417586479,
			 0.607866505513006, -0.0467664061972478, 0.0504006663975867,
			 16, 50, 0.00181713010016947, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.941561882814546, 0.0247879740039297,
			 0.0733069229409952, -0.0236000109020473, 0.0465553998183975,
			 84, 50, 0.0114776944581751, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.521317876073403, 0.0178971173128235,
			 0.641315260863334, -0.0388370597717154, 0.0828790050294821,
			 16, 50, 0.0220209726288834, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.47820244644819, 0.0310505870927421,
			 0.709196659087668, -0.0905175491324394, 0.0831178599963011,
			 16, 84, -0.00369984456806916, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.933433061820173, 0.0442955611680507,
			 -0.0835263053567041, -0.0540356737161021, 0.0659571132959751,
			 16, 84, 0.00596071978993649, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.845608260440327, 0.0306109673337278,
			 0.194724973077504, -0.0383451602777652, 0.0713531561990547,
			 50, 84, 0.0165039979606447, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.555358873199494, 0.0279847786342265,
			 0.589749098120778, -0.007900960522122, 0.00884516926253991,
			 16, 16, 0.000472104370208955, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.91200490431542, 0.00427205038377063,
			 0.110510019264394, -0.0190555417949394, 0.0213979459766909,
			 84, 16, 0.00117120209087573, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909642845062377, 0.0103199569203114,
			 0.113489048444632, -0.0315511997893044, 0.0354195565892152,
			 16, 16, 0.00193417839995542, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909863112738805, 0.0170846905623716,
			 0.113211204668545, -0.00403549619768659, 0.00429849356804844,
			 16, 50, 0.000131498685180927, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.95068151077014, 0.00212605686417518,
			 0.0618509727546458, -0.013523708533672, 0.0151849013453675,
			 16, 50, 0.000830596405847705, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909704555560096, 0.00732375954494301,
			 0.113411206464476, -0.0258678287576976, 0.0290549741875524,
			 50, 50, 0.00159357271492739, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909447213230766, 0.0140111765773438,
			 0.113735824120882, -0.00802741741695573, 0.00749193050159451,
			 16, 84, -0.000267743457680612, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.946082144851069, 0.00395909007536998,
			 -0.0676275236439502, -0.00809414135504031, 0.00895684988101264,
			 84, 84, 0.000431354262986166, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.921006514384803, 0.00434982259126928,
			 0.0991659438828509, -0.0195048241335793, 0.021893485277711,
			 16, 84, 0.00119433057206585, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.909960064700977, 0.0105609872777854,
			 0.113088913058164, -0.037581372778036, 0.0253162028741243, 16,
			 16, -0.00613258495195583, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.702314933764511, 0.0160455947528343,
			 -0.382197422184837, -0.0633262785882954, 0.0328987004024602,
			 50, 16, -0.0152137890929176, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.535411944809901, 0.0245476395866878,
			 -0.619765865438567, -0.110203555009547, 0.0599540165665337,
			 50, 16, -0.0251247692215064, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.562723801342002, 0.0434083414078681,
			 -0.578800488722482, -0.0474122337161671, 0.043995926184061,
			 50, 50, -0.00170815376605305, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.941605507441211, 0.0233188366269085,
			 -0.0732521005821512, -0.0456015658474625, 0.0240228500334329,
			 84, 50, -0.0107893579070148, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.5435508437499, 0.0177616569564757,
			 -0.607452217631144, -0.0817859094633699, 0.0403852333921627,
			 50, 50, -0.0207003380356036, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.506574041926789, 0.0311666805663785,
			 -0.664181672845019, -0.0782124285283706, 0.0851683459193916,
			 16, 84, 0.0034779586955105, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.933497519397936, 0.04167953486301,
			 0.0834452377393765, -0.0622987056285793, 0.0510922147376768,
			 50, 84, -0.00560324544545126, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.846407357833074, 0.0289267867319679,
			 -0.193704385397876, -0.069514588273468, 0.0384861371253878,
			 50, 84, -0.0155142255740401, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.57337033298291, 0.0275517117280603,
			 -0.563094798870136))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.15421267726256, 0.117651910772562, -0.0182803832449989, "contGamma",
			 "<unicode>", 0.79210437229231, "contNormal", 0.0693544856383982,
			 -0.263578960707884, -2.65749919902715, 2.350381565528, -0.153558816749574,
			 "debCollin1", "<unicode>", 0.904325946387913, "contNormal",
			 1.27754407837508, -0.120198448999808, -2.74314943539285, 0.527114600158058,
			 -1.1080174176174, "contcor1", "<unicode>", 0.184133882396021,
			 "contNormal", 0.834266359317399, -1.32813388103529, -0.533831116955686,
			 4.39043820801823, 1.92830354553127, "debCollin1:contcor1", "<unicode>",
			 0.124780955456875, "contNormal", 1.25621423756149, 1.53501169456129,
			 -0.020106873179165, 0.00866067781526425, -0.0057230976819504,
			 "contGamma", "<unicode>", 0.435484164287173, "debCollin1", 0.00733879582006202,
			 -0.779841519272849, -0.0350281256808969, 0.0413282192408694,
			 0.00315004677998628, "contcor1", "<unicode>", 0.871530393245337,
			 "debCollin1", 0.0194790173503328, 0.161714871101157, -0.0390766440814551,
			 0.0457715174569673, 0.00334743668775612, "contcor2", "<unicode>",
			 0.877097783986184, "debCollin1", 0.02164533690611, 0.154649322497319,
			 -0.016907686469098, 0.00681513950946107, -0.00504627347981844,
			 "contGamma:contcor1:contcor2", "<unicode>", 0.404371452322745,
			 "debCollin1", 0.0060518525252713, -0.833839466303291, -0.0236342259965732,
			 0.0138395305914694, -0.00489734770255186, "contGamma:contcor1",
			 "<unicode>", 0.608451433981708, "debCollin1", 0.00955980744636912,
			 -0.51228518252341, -0.0167950425335796, 0.0216688570790797,
			 0.00243690727275008, "contGamma:contcor2", "<unicode>", 0.803863786864758,
			 "debCollin1", 0.00981239959408889, 0.248349779213853, -0.0164775860401101,
			 0.0426895768691151, 0.0131059954145025, "contcor1:contcor2",
			 "<unicode>", 0.385232800677402, "debCollin1", 0.01509394136217,
			 0.868295105965505))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.150807326550764, 0.127294219972314, 16, 16, -0.0117565532892248,
			 "Total", 0.868383379616943, 0.0709455757138162, -0.165712282562185,
			 -0.14450580059974, 0.140313822737302, 16, 16, -0.00209598893121912,
			 "Total", 0.976986800806589, 0.0726594023113849, -0.0288467681338291,
			 -0.149726006693774, 0.166620585172752, 50, 16, 0.00844728923948911,
			 "Total", 0.916635742291512, 0.0807021441112764, 0.104672426396027,
			 -0.160608108239127, 0.127681601949468, 16, 50, -0.0164632531448294,
			 "Total", 0.822871013495058, 0.0735446448155649, -0.223853867077827,
			 -0.145826890952858, 0.13222151337921, 84, 50, -0.00680268878682378,
			 "Total", 0.923596543837033, 0.0709320187833243, -0.0959043448009554,
			 -0.14272319288412, 0.150204371651889, 16, 50, 0.00374058938388445,
			 "Total", 0.960077602771187, 0.0747277926652183, 0.0500562006513741,
			 -0.183651171637364, 0.139690716011228, 16, 84, -0.0219802278130681,
			 "Total", 0.789877268152807, 0.0824866911328656, -0.266469990627498,
			 -0.160237382503573, 0.135598055593448, 16, 84, -0.0123196634550624,
			 "Total", 0.870329429399202, 0.0754696107761502, -0.163240055545054,
			 -0.146480119058773, 0.142927348490065, 50, 84, -0.00177638528435418,
			 "Total", 0.980804312076867, 0.0738297922389513, -0.0240605483299327,
			 -0.152606011507224, 0.116989453757644, 16, 16, -0.0178082788747899,
			 "Total", 0.795686913501891, 0.0687756171519994, -0.258933029062208,
			 -0.151089697263563, 0.116871334955317, 84, 16, -0.0171091811541232,
			 "Total", 0.802366578242646, 0.0683586622847466, -0.250285488075457,
			 -0.150708470546727, 0.11801606085664, 16, 16, -0.0163462048450435,
			 "Total", 0.811536186161231, 0.0685534360638848, -0.238444719675473,
			 -0.153758136354367, 0.117460367234731, 16, 50, -0.018148884559818,
			 "Total", 0.793085310948308, 0.0691896651490628, -0.262306292720421,
			 -0.151687964783415, 0.116788391105113, 16, 50, -0.0174497868391512,
			 "Total", 0.798894457396842, 0.0684901248202098, -0.254778143344866,
			 -0.150695247882435, 0.117321626822292, 50, 50, -0.0166868105300715,
			 "Total", 0.807187538913364, 0.0683729080786204, -0.244055884106666,
			 -0.155485193457729, 0.11838894005237, 16, 84, -0.0185481267026795,
			 "Total", 0.790641920837416, 0.0698671342102162, -0.265477136172094,
			 -0.152777042413736, 0.11707898444971, 84, 84, -0.0178490289820127,
			 "Total", 0.795423105562086, 0.0688420881689756, -0.259274950204903,
			 -0.15106974609086, 0.116897640744994, 16, 84, -0.017086052672933,
			 "Total", 0.802632805187548, 0.0683602833902935, -0.249941220626348,
			 -0.16193940367817, 0.11311346728426, 16, 16, -0.0244129681969547,
			 "Total", 0.727898402582248, 0.0701678380653962, -0.347922479444242,
			 -0.172850826993253, 0.10586248231742, 50, 16, -0.0334941723379165,
			 "Total", 0.63758750836771, 0.0711016405171543, -0.471074536315875,
			 -0.196539079692819, 0.109728774759809, 50, 16, -0.0434051524665053,
			 "Total", 0.578523064614141, 0.078130990382586, -0.55554335423066,
			 -0.162860486896692, 0.122883412874588, 50, 50, -0.0199885370110519,
			 "Total", 0.7839238069751, 0.0728951914487185, -0.274209266946144,
			 -0.165877607565361, 0.107738125261333, 84, 50, -0.0290697411520137,
			 "Total", 0.677070000084436, 0.0698012144572401, -0.416464690164119,
			 -0.181606398677216, 0.103644956116011, 50, 50, -0.0389807212806025,
			 "Total", 0.592184153571018, 0.0727695399107469, -0.535673598162267,
			 -0.174378685461738, 0.144773836362762, 16, 84, -0.0148024245494884,
			 "Total", 0.855733513492652, 0.0814179557231497, -0.181807863118327,
			 -0.169439838582603, 0.121672581201702, 50, 84, -0.0238836286904502,
			 "Total", 0.747754833147845, 0.0742647370259256, -0.321601201955545,
			 -0.175196194841843, 0.107606977203765, 50, 84, -0.033794608819039,
			 "Total", 0.63947979229628, 0.0721449920193236, -0.468426260411634,
			 -0.0262434009139506, 0.0392910608254989, 50, 16, 0.00652382995577412,
			 "Total indirect", 0.696372905134699, 0.0167182821358905, 0.390221309985485,
			 -0.0321811327704064, 0.0645499213979659, 84, 16, 0.0161843943137798,
			 "Total indirect", 0.511916663362343, 0.0246767427696056, 0.655856182677162,
			 -0.0594512417755902, 0.112906586744566, 50, 16, 0.026727672484488,
			 "Total indirect", 0.54327601593004, 0.0439696417586479, 0.607866505513006,
			 -0.0467664061972478, 0.0504006663975867, 16, 50, 0.00181713010016947,
			 "Total indirect", 0.941561882814546, 0.0247879740039297, 0.0733069229409952,
			 -0.0236000109020473, 0.0465553998183975, 50, 50, 0.0114776944581751,
			 "Total indirect", 0.521317876073403, 0.0178971173128235, 0.641315260863334,
			 -0.0388370597717154, 0.0828790050294821, 50, 50, 0.0220209726288834,
			 "Total indirect", 0.47820244644819, 0.0310505870927421, 0.709196659087668,
			 -0.0905175491324394, 0.0831178599963011, 50, 84, -0.00369984456806916,
			 "Total indirect", 0.933433061820173, 0.0442955611680507, -0.0835263053567041,
			 -0.0540356737161021, 0.0659571132959751, 84, 84, 0.00596071978993649,
			 "Total indirect", 0.845608260440327, 0.0306109673337278, 0.194724973077504,
			 -0.0383451602777652, 0.0713531561990547, 50, 84, 0.0165039979606447,
			 "Total indirect", 0.555358873199494, 0.0279847786342265, 0.589749098120778,
			 -0.007900960522122, 0.00884516926253991, 16, 16, 0.000472104370208955,
			 "Total indirect", 0.91200490431542, 0.00427205038377063, 0.110510019264394,
			 -0.0190555417949394, 0.0213979459766909, 84, 16, 0.00117120209087573,
			 "Total indirect", 0.909642845062377, 0.0103199569203114, 0.113489048444632,
			 -0.0315511997893044, 0.0354195565892152, 50, 16, 0.00193417839995542,
			 "Total indirect", 0.909863112738805, 0.0170846905623716, 0.113211204668545,
			 -0.00403549619768659, 0.00429849356804844, 84, 50, 0.000131498685180927,
			 "Total indirect", 0.95068151077014, 0.00212605686417518, 0.0618509727546458,
			 -0.013523708533672, 0.0151849013453675, 84, 50, 0.000830596405847705,
			 "Total indirect", 0.909704555560096, 0.00732375954494301, 0.113411206464476,
			 -0.0258678287576976, 0.0290549741875524, 84, 50, 0.00159357271492739,
			 "Total indirect", 0.909447213230766, 0.0140111765773438, 0.113735824120882,
			 -0.00802741741695573, 0.00749193050159451, 16, 84, -0.000267743457680612,
			 "Total indirect", 0.946082144851069, 0.00395909007536998, -0.0676275236439502,
			 -0.00809414135504031, 0.00895684988101264, 84, 84, 0.000431354262986166,
			 "Total indirect", 0.921006514384803, 0.00434982259126928, 0.0991659438828509,
			 -0.0195048241335793, 0.021893485277711, 50, 84, 0.00119433057206585,
			 "Total indirect", 0.909960064700977, 0.0105609872777854, 0.113088913058164,
			 -0.037581372778036, 0.0253162028741243, 84, 16, -0.00613258495195583,
			 "Total indirect", 0.702314933764511, 0.0160455947528343, -0.382197422184837,
			 -0.0633262785882954, 0.0328987004024602, 84, 16, -0.0152137890929176,
			 "Total indirect", 0.535411944809901, 0.0245476395866878, -0.619765865438567,
			 -0.110203555009547, 0.0599540165665337, 84, 16, -0.0251247692215064,
			 "Total indirect", 0.562723801342002, 0.0434083414078681, -0.578800488722482,
			 -0.0474122337161671, 0.043995926184061, 16, 50, -0.00170815376605305,
			 "Total indirect", 0.941605507441211, 0.0233188366269085, -0.0732521005821512,
			 -0.0456015658474625, 0.0240228500334329, 84, 50, -0.0107893579070148,
			 "Total indirect", 0.5435508437499, 0.0177616569564757, -0.607452217631144,
			 -0.0817859094633699, 0.0403852333921627, 50, 50, -0.0207003380356036,
			 "Total indirect", 0.506574041926789, 0.0311666805663785, -0.664181672845019,
			 -0.0782124285283706, 0.0851683459193916, 84, 84, 0.0034779586955105,
			 "Total indirect", 0.933497519397936, 0.04167953486301, 0.0834452377393765,
			 -0.0622987056285793, 0.0510922147376768, 84, 84, -0.00560324544545126,
			 "Total indirect", 0.846407357833074, 0.0289267867319679, -0.193704385397876,
			 -0.069514588273468, 0.0384861371253878, 84, 84, -0.0155142255740401,
			 "Total indirect", 0.57337033298291, 0.0275517117280603, -0.563094798870136,
			 16, 16, 50, 16, 84, 16, 16, 16, 50, 16, 84, 16, 16, 16, 50,
			 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 50, 50, 50, 84, 50,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84, 16, 84, 50,
			 84, 84, 84, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-68")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-68")
})


context('Model number 70 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1611.08362736376, 1697.05424350137, 1454.07834720598, 27, 1, 100,
			 6.23388562103707e-290, 0, 1454.07834720598, 27))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 70))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544849560847229, 0.064207658635789, -0.24032095110572, "contcor1",
			 "<unicode>", 0.12193084348486, "contGamma", 0.155374594708674,
			 -1.54671972954343, -0.403935005855804, 0.194627194266044, -0.10465390579488,
			 "contcor2", "<unicode>", 0.493111315948985, "contGamma", 0.152697244654297,
			 -0.685368658955267, -0.0667368563424439, 0.346855308653217,
			 0.140059226155387, "debCollin1__contcor1__contcor2", "<unicode>",
			 0.184360541901404, "contGamma", 0.105510144129694, 1.32744796541292,
			 0.424979246374644, 0.896763373188803, 0.660871309781724, "contcor2",
			 "<unicode>", 3.99658162120176e-08, "contcor1", 0.120355305132016,
			 5.49100273608068, 0.00070906540453719, 0.276794386016043, 0.13875172571029,
			 "debCollin1__contcor1__contcor2", "<unicode>", 0.048834763822257,
			 "contcor1", 0.0704312229176739, 1.97003147130464, -0.0047894361852017,
			 0.268765632931216, 0.131988098373007, "debCollin1__contcor1__contcor2",
			 "<unicode>", 0.0585798531033876, "contcor2", 0.069785738736575,
			 1.89133339794871, 0.71035804685239, 1.25516254964079, 0.982760298246592,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.138983294357894, 7.07106780557307, 0.00465468300290018, 0.00822455726750867,
			 0.00643962013520443, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000910698944666127, 7.07107455534087, 0.323891879975708,
			 0.572298803336639, 0.448095341656173, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702775459993,
			 7.07106484315, 0.318532594267757, 0.562828639543738, 0.440680616905748,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623215648866401, 7.07107752681314, 1.68041083953907, 2.96919094927965,
			 2.32480089440936, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776477503239, 7.07106819826082, 0.732634771902915,
			 1.29452457620214, 1.01357967405253, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341869731112, 7.0710649718317,
			 0.721541824474406, 1.27492365814682, 0.998232741310615, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171429178654,
			 7.07106775867048, 0.340024396347901, 0.600804676697138, 0.470414536522519,
			 "debCollin1__contcor1__contcor2", "<unicode>", 1.53765888910584e-12,
			 "debCollin1__contcor1__contcor2", 0.0665268041673822, 7.07105267433186
			))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831896917727, 0.120439009855082, "", "", -0.0146964435313227,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.83120778377171,
			 0.0689479268253577, -0.213152798176922, -0.0260577965806517,
			 0.0512136458960996, 16, 16, 0.0125779246577239, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.523428372320269,
			 0.0197124648938089, 0.638069603445395, -0.0199063181903549,
			 0.0632268865440576, 16, 16, 0.0216602841768513, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.307096307215006,
			 0.0212078398863848, 1.02133382243974, -0.0296272817762414, 0.0927723322839678,
			 50, 16, 0.0315725252538632, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.31195381066715, 0.0312249651079514,
			 1.01113084177069, -0.0234837056045894, 0.0241048511343039, 16,
			 16, 0.000310572764857252, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.979590535307655, 0.0121401610219029,
			 0.0255822607539493, -0.040420906439029, 0.0414905732604577,
			 84, 16, 0.000534833410714341, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.979580528795757, 0.0208961696096443,
			 0.0255948061633026, -0.0589188172484107, 0.0604779880541598,
			 16, 16, 0.00077958540287457, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.979580658818656, 0.0304589283895922,
			 0.0255946431503793, -0.0644038157823526, 0.0382484504103462,
			 16, 16, -0.0130776826860032, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.617504258370863, 0.0261872837976633,
			 -0.499390573953688, -0.0924831253715218, 0.0474413031215263,
			 50, 16, -0.0225209111249977, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.528096437118971, 0.0356956631848223,
			 -0.630914489762822, -0.135199413308117, 0.0695454237825409,
			 50, 16, -0.032826994762788, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.529685003410559, 0.0522317855597498,
			 -0.628486933980766, -0.0370040894023158, 0.0774536785218768,
			 50, 50, 0.0202247945597805, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.488526126077555, 0.0291989467222411,
			 0.692654935541737, -0.0174622342032015, 0.0871199574770115,
			 84, 50, 0.034828861636905, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.191740291110271, 0.0266796207749591,
			 1.30544815200651, -0.0267059393527269, 0.128240628797816, 50,
			 50, 0.0507673447225446, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.199022431790181, 0.03952791208735,
			 1.28434167254666, -0.0184725474601006, 0.0343874327939282, 16,
			 50, 0.00795744266691382, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.55512452546598, 0.0134849366291885,
			 0.590098632698779, -0.0177818652748302, 0.0451886870163663,
			 84, 50, 0.013703410870768, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.393637266794322, 0.016064211584473,
			 0.853039739840898, -0.0262427969415754, 0.0661916066846873,
			 50, 50, 0.019974404871556, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.396957202686383, 0.0235806383064621,
			 0.847068031490993, -0.0365102161000196, 0.0256485905321263,
			 84, 50, -0.00543081278394664, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.731986704777765, 0.0158571298050491,
			 -0.342483970977988, -0.0579463142318949, 0.0392416469020068,
			 84, 50, -0.00935233366494405, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.706015993485146, 0.0247933028107935,
			 -0.377212093778511, -0.0845617913443705, 0.0572974407561573,
			 84, 50, -0.0136321752941066, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.706402994130743, 0.0361892446033436,
			 -0.376691346932594, -0.0548449634857731, 0.113221163111728,
			 16, 84, 0.0291880998129774, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.496013752667766, 0.0428747997216238,
			 0.680775187347558, -0.0297808388436847, 0.130309750207954, 16,
			 84, 0.0502644556821346, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.218412751499572, 0.0408401864305704,
			 1.23075970202991, -0.0451150554042667, 0.191648294159454, 50,
			 84, 0.0732666193775937, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.225120248898925, 0.0603999235269831,
			 1.21302503545162, -0.0335851294924535, 0.067426625332675, 16,
			 84, 0.0169207479201108, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.511413986734213, 0.0257687783096772,
			 0.656637568019914, -0.0226315975212291, 0.0809096073532243,
			 84, 84, 0.0291390049159976, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.269956494325335, 0.0264140580365694,
			 1.10316275051928, -0.0338759613001991, 0.118823320353409, 16,
			 84, 0.0424736795266051, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.275564469509623, 0.0389546141811994,
			 1.09033757410705, -0.0230643481095764, 0.030129333048077, 16,
			 84, 0.0035324924692503, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.794620760684697, 0.0135700659749971,
			 0.26031505489796, -0.0373326852379364, 0.0494992059985075, 50,
			 84, 0.00608326038028557, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.78360670778484, 0.0221513996995258,
			 0.274621940951921, -0.0544633600311034, 0.0721975587529883,
			 50, 84, 0.00886709936094249, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.783761259465263, 0.0323120526150421,
			 0.274420801011404))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831896917727, 0.120439009855082, -0.0146964435313227, "contGamma",
			 "<unicode>", 0.83120778377171, "contNormal", 0.0689479268253577,
			 -0.213152798176922, -4.39513848633302, 1.52254950501944, -1.43629449065679,
			 "debCollin1", "<unicode>", 0.341394278218924, "contNormal",
			 1.50964202353473, -0.951413956597339, -3.43497695515956, 0.849245470844334,
			 -1.29286574215761, "contcor1", "<unicode>", 0.236836396076239,
			 "contNormal", 1.09293396710279, -1.18293124843106, -1.18791427431701,
			 2.91802662942068, 0.865056177551836, "contcor2", "<unicode>",
			 0.408879983074837, "contNormal", 1.04745315121217, 0.825866222800268,
			 -0.133637761323952, 4.63689793464634, 2.2516300866612, "debCollin1:contcor1:contcor2",
			 "<unicode>", 0.0642912947725616, "contNormal", 1.21699575441173,
			 1.8501544302836, -0.924280937716875, 5.58380703574933, 2.32976304901623,
			 "debCollin1:contcor1", "<unicode>", 0.160540979200031, "contNormal",
			 1.66025703145598, 1.40325443884621, -4.58909598838325, 1.62263469987481,
			 -1.48323064425422, "debCollin1:contcor2", "<unicode>", 0.349275064042529,
			 "contNormal", 1.58465429397055, -0.935996355733716, -2.95950671284426,
			 0.224915107390732, -1.36729580272676, "contcor1:contcor2", "<unicode>",
			 0.0923556923492772, "contNormal", 0.812367432604198, -1.6831002177717,
			 -0.019747523142747, 0.00115998542195149, -0.00929376886039775,
			 "contGamma", "<unicode>", 0.0814245803438629, "debCollin1",
			 0.00533364611023831, -1.74247947244901, -0.0185476817553571,
			 0.0350786523882005, 0.0082654853164217, "contcor1", "<unicode>",
			 0.545722135386296, "debCollin1", 0.0136804386627906, 0.604182769292552,
			 -0.0145562699390624, 0.00654288486081935, -0.00400669253912154,
			 "contGamma:contcor1", "<unicode>", 0.456642106143923, "debCollin1",
			 0.00538253635431805, -0.74438745516456))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.140898686646936, 0.136661648899739, 16, 16, -0.00211851887359874,
			 "Total", 0.976131326105109, 0.070807509152218, -0.0299194096638037,
			 -0.131376380253235, 0.145304061544292, 16, 16, 0.00696384064552867,
			 "Total", 0.92140690531878, 0.0705830423364786, 0.0986616673779962,
			 -0.127228222460849, 0.160980385905931, 50, 16, 0.0168760817225405,
			 "Total", 0.818455650336723, 0.0735239551951293, 0.229531744827276,
			 -0.148908430183138, 0.120136688650207, 16, 16, -0.0143858707664654,
			 "Total", 0.833980691190731, 0.0686352200743325, -0.209598960284318,
			 -0.150834068222601, 0.122510847981384, 84, 16, -0.0141616101206083,
			 "Total", 0.839067911472654, 0.0697321273146075, -0.203085875420321,
			 -0.155300960931635, 0.127467244674739, 16, 16, -0.0139168581284481,
			 "Total", 0.847017635436739, 0.0721360718454047, -0.192925089659351,
			 -0.168862032342076, 0.113313779907424, 16, 16, -0.0277741262173259,
			 "Total", 0.699620789334046, 0.0719849483141699, -0.385832411744035,
			 -0.18367946872711, 0.109244759414469, 50, 16, -0.0372173546563204,
			 "Total", 0.618452560228731, 0.0747269415285504, -0.498044666288142,
			 -0.20956119716134, 0.114514320573118, 50, 16, -0.0475234382941107,
			 "Total", 0.565406014210614, 0.0826738451039724, -0.574830386010765,
			 -0.140657180465134, 0.15171388252205, 50, 50, 0.00552835102845783,
			 "Total", 0.940914371640597, 0.0745858253757134, 0.0741206656976671,
			 -0.123774415060683, 0.164039251271848, 84, 50, 0.0201324181055824,
			 "Total", 0.783933273643313, 0.0734232028248399, 0.274196947708897,
			 -0.118349608676597, 0.190491411059041, 50, 50, 0.0360709011912219,
			 "Total", 0.647077720574393, 0.0787874221597275, 0.457825630061796,
			 -0.142961407736164, 0.129483406007346, 16, 50, -0.00673900086440885,
			 "Total", 0.922757726275936, 0.069502505120635, -0.0969605462812026,
			 -0.137220395671018, 0.135234330349909, 84, 50, -0.000993032660554657,
			 "Total", 0.988600847590984, 0.0695050338092982, -0.0142872049135211,
			 -0.13395043019165, 0.144506352872117, 50, 50, 0.00527796134023331,
			 "Total", 0.940771993368827, 0.0710361989455414, 0.0742996024362109,
			 -0.156381441841645, 0.116126929211106, 84, 50, -0.0201272563152693,
			 "Total", 0.772181311282576, 0.0695187190178651, -0.289522830679561,
			 -0.163628138224208, 0.115530583831675, 84, 50, -0.0240487771962667,
			 "Total", 0.735595824615292, 0.0712152683054005, -0.337691309300916,
			 -0.175400314510577, 0.118743076859718, 84, 50, -0.0283286188254293,
			 "Total", 0.705784344417226, 0.0750379582712898, -0.377523848970023,
			 -0.14532357730881, 0.17430688987212, 16, 84, 0.0144916562816548,
			 "Total", 0.858939137393764, 0.0815398827994123, 0.177724762216107,
			 -0.122684462681012, 0.193820486982636, 16, 84, 0.035568012150812,
			 "Total", 0.659566741087623, 0.0807425422508269, 0.440511422594546,
			 -0.122599437456445, 0.239739789148987, 50, 84, 0.058570175846271,
			 "Total", 0.526318955432705, 0.0924351746928813, 0.633635150697472,
			 -0.141973934541926, 0.146422543319502, 16, 84, 0.00222430438878809,
			 "Total", 0.975881168774576, 0.0735718819672867, 0.0302330772206848,
			 -0.130155314749178, 0.159040437518528, 84, 84, 0.014442561384675,
			 "Total", 0.844795746465062, 0.0737757822462161, 0.195762904098732,
			 -0.12727890434482, 0.182833376335385, 16, 84, 0.0277772359952824,
			 "Total", 0.725502822963311, 0.0791117293803181, 0.351114003104993,
			 -0.147878816360015, 0.12555091423587, 16, 84, -0.0111639510620724,
			 "Total", 0.872843255822531, 0.0697537640366517, -0.160048009111112,
			 -0.148854924791818, 0.131628558489744, 50, 84, -0.00861318315103711,
			 "Total", 0.904186494850616, 0.0715532238076769, -0.120374494574667,
			 -0.152711759942801, 0.14105307160204, 50, 84, -0.00582934417038018,
			 "Total", 0.937998775731072, 0.0749413851126911, -0.0777853806893809,
			 -0.0260577965806517, 0.0512136458960996, 50, 16, 0.0125779246577239,
			 "Total indirect", 0.523428372320269, 0.0197124648938089, 0.638069603445395,
			 -0.0199063181903549, 0.0632268865440576, 84, 16, 0.0216602841768513,
			 "Total indirect", 0.307096307215006, 0.0212078398863848, 1.02133382243974,
			 -0.0296272817762414, 0.0927723322839678, 50, 16, 0.0315725252538632,
			 "Total indirect", 0.31195381066715, 0.0312249651079514, 1.01113084177069,
			 -0.0234837056045894, 0.0241048511343039, 16, 16, 0.000310572764857252,
			 "Total indirect", 0.979590535307655, 0.0121401610219029, 0.0255822607539493,
			 -0.040420906439029, 0.0414905732604577, 84, 16, 0.000534833410714341,
			 "Total indirect", 0.979580528795757, 0.0208961696096443, 0.0255948061633026,
			 -0.0589188172484107, 0.0604779880541598, 50, 16, 0.00077958540287457,
			 "Total indirect", 0.979580658818656, 0.0304589283895922, 0.0255946431503793,
			 -0.0644038157823526, 0.0382484504103462, 84, 16, -0.0130776826860032,
			 "Total indirect", 0.617504258370863, 0.0261872837976633, -0.499390573953688,
			 -0.0924831253715218, 0.0474413031215263, 84, 16, -0.0225209111249977,
			 "Total indirect", 0.528096437118971, 0.0356956631848223, -0.630914489762822,
			 -0.135199413308117, 0.0695454237825409, 84, 16, -0.032826994762788,
			 "Total indirect", 0.529685003410559, 0.0522317855597498, -0.628486933980766,
			 -0.0370040894023158, 0.0774536785218768, 16, 50, 0.0202247945597805,
			 "Total indirect", 0.488526126077555, 0.0291989467222411, 0.692654935541737,
			 -0.0174622342032015, 0.0871199574770115, 16, 50, 0.034828861636905,
			 "Total indirect", 0.191740291110271, 0.0266796207749591, 1.30544815200651,
			 -0.0267059393527269, 0.128240628797816, 50, 50, 0.0507673447225446,
			 "Total indirect", 0.199022431790181, 0.03952791208735, 1.28434167254666,
			 -0.0184725474601006, 0.0343874327939282, 16, 50, 0.00795744266691382,
			 "Total indirect", 0.55512452546598, 0.0134849366291885, 0.590098632698779,
			 -0.0177818652748302, 0.0451886870163663, 84, 50, 0.013703410870768,
			 "Total indirect", 0.393637266794322, 0.016064211584473, 0.853039739840898,
			 -0.0262427969415754, 0.0661916066846873, 16, 50, 0.019974404871556,
			 "Total indirect", 0.396957202686383, 0.0235806383064621, 0.847068031490993,
			 -0.0365102161000196, 0.0256485905321263, 16, 50, -0.00543081278394664,
			 "Total indirect", 0.731986704777765, 0.0158571298050491, -0.342483970977988,
			 -0.0579463142318949, 0.0392416469020068, 50, 50, -0.00935233366494405,
			 "Total indirect", 0.706015993485146, 0.0247933028107935, -0.377212093778511,
			 -0.0845617913443705, 0.0572974407561573, 50, 50, -0.0136321752941066,
			 "Total indirect", 0.706402994130743, 0.0361892446033436, -0.376691346932594,
			 -0.0548449634857731, 0.113221163111728, 50, 84, 0.0291880998129774,
			 "Total indirect", 0.496013752667766, 0.0428747997216238, 0.680775187347558,
			 -0.0297808388436847, 0.130309750207954, 84, 84, 0.0502644556821346,
			 "Total indirect", 0.218412751499572, 0.0408401864305704, 1.23075970202991,
			 -0.0451150554042667, 0.191648294159454, 50, 84, 0.0732666193775937,
			 "Total indirect", 0.225120248898925, 0.0603999235269831, 1.21302503545162,
			 -0.0335851294924535, 0.067426625332675, 16, 84, 0.0169207479201108,
			 "Total indirect", 0.511413986734213, 0.0257687783096772, 0.656637568019914,
			 -0.0226315975212291, 0.0809096073532243, 84, 84, 0.0291390049159976,
			 "Total indirect", 0.269956494325335, 0.0264140580365694, 1.10316275051928,
			 -0.0338759613001991, 0.118823320353409, 50, 84, 0.0424736795266051,
			 "Total indirect", 0.275564469509623, 0.0389546141811994, 1.09033757410705,
			 -0.0230643481095764, 0.030129333048077, 84, 84, 0.0035324924692503,
			 "Total indirect", 0.794620760684697, 0.0135700659749971, 0.26031505489796,
			 -0.0373326852379364, 0.0494992059985075, 84, 84, 0.00608326038028557,
			 "Total indirect", 0.78360670778484, 0.0221513996995258, 0.274621940951921,
			 -0.0544633600311034, 0.0721975587529883, 84, 84, 0.00886709936094249,
			 "Total indirect", 0.783761259465263, 0.0323120526150421, 0.274420801011404,
			 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50, 16, 84, 50,
			 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50, 50, 84, 50,
			 16, 84, 50, 84, 84, 84, 16, 16, 50, 16, 84, 16, 16, 50, 50,
			 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-70")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-70")
})


context('Model number 72 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "debCollin1",
        processIndependent = "contcor1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(2016.14038389805, 2128.16270189553, 1650.01212725349, 38, 1, 100,
			 2.51973479379036e-322, 0, 1650.01212725349, 38))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 72))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848480459938, 0.0642084460819418, -0.240320017188998, "contcor1",
			 "<unicode>", 0.121932114056666, "contGamma", 0.155374519977419,
			 -1.54671446273124, -0.403934431719148, 0.194627860106075, -0.104653285806536,
			 "contcor2", "<unicode>", 0.493113943680007, "contGamma", 0.152697268048445,
			 -0.68536449370747, -0.0667367034503515, 0.346854519051372, 0.14005890780051,
			 "debCollin1__contcor1__contcor2", "<unicode>", 0.184360539356736,
			 "contGamma", 0.105509903693149, 1.32744797311008, 1.37708867951227,
			 3.4591054958792, 2.41809708769574, "contGamma__contcor1__contcor2",
			 "<unicode>", 5.29655882042235e-06, "contGamma", 0.531136498626918,
			 4.55268484456811, 0.424979149264314, 0.896763038812107, 0.660871094038211,
			 "contcor2", "<unicode>", 3.99655968319479e-08, "contcor1", 0.120355244603769,
			 5.49100370502271, 0.000709721284091469, 0.276794321276646, 0.138752021280369,
			 "debCollin1__contcor1__contcor2", "<unicode>", 0.0488336936192368,
			 "contcor1", 0.0704310390829307, 1.97004080994733, -0.374372682113538,
			 0.853224536695747, 0.239425927291104, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.444552685265832, "contcor1", 0.313168310359888,
			 0.764527953086824, -0.00478878681714776, 0.268765709254006,
			 0.131988461218429, "debCollin1__contcor1__contcor2", "<unicode>",
			 0.0585786309307392, "contcor2", 0.0697855925488725, 1.89134255936846,
			 -0.164891659191429, 1.06248461779289, 0.44879647930073, "contGamma__contcor1__contcor2",
			 "<unicode>", 0.151760147124268, "contcor2", 0.31311194661374,
			 1.43334192180911, 1.03656628147242, 2.06894333985276, 1.55275481066259,
			 "contGamma__contcor1__contcor2", "<unicode>", 3.72873998344403e-09,
			 "debCollin1__contcor1__contcor2", 0.263366333902968, 5.89579840236782,
			 0.710358045014359, 1.2551625418823, 0.982760293448329, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.138983292847545,
			 7.07106784789127, 0.00458999025135805, 0.00811025292750515,
			 0.0063501215894316, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000898042694639923, 7.07106870011089, 0.323891806238985,
			 0.572298546020906, 0.448095176129945, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633702307137585,
			 7.07106745679968, 0.318532853753478, 0.562829544601085, 0.440681199177282,
			 "debCollin1:contcor2", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor2",
			 0.0623217295763056, 7.07106818397457, 1.68041101903292, 2.96919157529777,
			 2.32480129716534, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776591414584, 7.07106697335941, 0.732634557302684,
			 1.29452382801358, 1.01357919265813, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341733609139, 7.07106832837626,
			 0.721541841105094, 1.27492371549396, 0.998232778299525, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171439565693,
			 7.07106750041325, 0.340023891006351, 0.600802913408866, 0.470413402207608,
			 "debCollin1__contcor1__contcor2", "<unicode>", 1.53743684450092e-12,
			 "debCollin1__contcor1__contcor2", 0.0665264832567094, 7.07106973312264,
			 6.95315403152577, 12.2858295464423, 9.61949178898404, "contGamma__contcor1__contcor2",
			 "<unicode>", 1.53743684450092e-12, "contGamma__contcor1__contcor2",
			 1.36040140456151, 7.07106869834836))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831884031816, 0.120439021843412, "", "", -0.0146964310942021,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.831207923912687,
			 0.068947926596379, -0.213152618500552, -0.0299018028328567,
			 0.0448952595789498, 16, 16, 0.00749672837304656, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.694404506170637,
			 0.0190812338904684, 0.392884884493312, -0.0347203917768182,
			 0.0356388152900881, 50, 16, 0.000459211756634957, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.979589068065906,
			 0.0179491071320419, 0.0255841002706588, -0.159760333961889,
			 0.0958937978196942, 84, 16, -0.0319332680710974, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.624395250633776,
			 0.0652190891766763, -0.489630696690523, -0.0863016447997899,
			 0.0930177386872452, 16, 50, 0.00335804694372768, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.941482229004321,
			 0.0457455812712589, 0.0734070231573923, -0.0188169395877599,
			 0.0355054492603731, 50, 50, 0.00834425483630659, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.547090817695678,
			 0.0138580069013056, 0.602125175411801, -0.0713762777881052,
			 0.0495245620564564, 84, 50, -0.0109258578658244, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.723154923734176,
			 0.0308426177210939, -0.354245478273785, -0.241065238944778,
			 0.221335596662002, 16, 84, -0.0098648211413883, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.933352666293779,
			 0.117961564409892, -0.0836274187336995, -0.0831357219607278,
			 0.101565796786345, 50, 84, 0.00921503741280876, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.844945866620574,
			 0.047118600189589, 0.195571120019072, -0.0352230219007032, 0.0458757282027932,
			 84, 84, 0.00532635315104499, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.796830956984272, 0.0206888368212868,
			 0.257450585407716))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.149831884031816, 0.120439021843412, -0.0146964310942021, "contGamma",
			 "<unicode>", 0.831207923912687, "contNormal", 0.068947926596379,
			 -0.213152618500552, -4.3951384970828, 1.52254952510849, -1.43629448598715,
			 "debCollin1", "<unicode>", 0.341394282304443, "contNormal",
			 1.50964203140192, -0.951413948546033, -3.43497674115778, 0.849245233974006,
			 -1.29286575359189, "contcor1", "<unicode>", 0.23683634258712,
			 "contNormal", 1.09293385208228, -1.18293138338491, -1.18791405893846,
			 2.91802640320514, 0.865056172133341, "contcor2", "<unicode>",
			 0.408879935618514, "contNormal", 1.04745303855855, 0.8258663064492,
			 -0.133637815493317, 4.63689799377293, 2.25163008913981, "debCollin1:contcor1:contcor2",
			 "<unicode>", 0.0642913008102832, "contNormal", 1.21699578331429,
			 1.85015438838075, -0.924280615225439, 5.58380666379859, 2.32976302428657,
			 "debCollin1:contcor1", "<unicode>", 0.160540939005752, "contNormal",
			 1.66025685429911, 1.40325457368469, -4.58909565654505, 1.62263435219555,
			 -1.48323065217475, "debCollin1:contcor2", "<unicode>", 0.349275008750698,
			 "contNormal", 1.58465412062108, -0.935996463123083, -2.95950674929155,
			 0.22491514635846, -1.36729580146655, "contcor1:contcor2", "<unicode>",
			 0.0923557003645508, "contNormal", 0.812367451843077, -1.68310017636042,
			 -0.0201068352185738, 0.00866071827270779, -0.00572305847293302,
			 "contGamma", "<unicode>", 0.435487349297301, "debCollin1", 0.00733879645702585,
			 -0.779836108883223, -0.0350282979845607, 0.0413280535610877,
			 0.00314987778826349, "contcor1", "<unicode>", 0.871537236483424,
			 "debCollin1", 0.0194790190401297, 0.161706181495807, -0.0390764423396742,
			 0.0457717265626626, 0.0033476421114942, "contcor2", "<unicode>",
			 0.877090312311371, "debCollin1", 0.0216453387846941, 0.154658799513057,
			 -0.0169077196215288, 0.00681510841708154, -0.00504630560222361,
			 "contGamma:contcor1:contcor2", "<unicode>", 0.404368501701321,
			 "debCollin1", 0.00605185305080423, -0.833844701756762, -0.0236340752863291,
			 0.0138396845525214, -0.00489719536690382, "contGamma:contcor1",
			 "<unicode>", 0.608462615902609, "debCollin1", 0.00955980827567208,
			 -0.512269203072437, -0.0167951775474579, 0.0216687254031938,
			 0.00243677392786794, "contGamma:contcor2", "<unicode>", 0.80387431707379,
			 "debCollin1", 0.0098124004456332, 0.248336168236221, -0.0164773473453307,
			 0.0426898207017386, 0.0131062366782039, "contcor1:contcor2",
			 "<unicode>", 0.385224093895363, "debCollin1", 0.0150939426728686,
			 0.868311014706743))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146359978034764, 0.131960572592453, 16, 16, -0.0071997027211555,
			 "Total", 0.919231190338782, 0.0710014451343426, -0.101402199737384,
			 -0.149949014695587, 0.121474576020453, 50, 16, -0.0142372193375671,
			 "Total", 0.837091335274478, 0.0692419842550668, -0.20561541513775,
			 -0.226027442080145, 0.132768043749546, 84, 16, -0.0466296991652994,
			 "Total", 0.610443278982786, 0.0915311425770635, -0.509440807275405,
			 -0.173427253518714, 0.150750485217765, 16, 50, -0.0113383841504744,
			 "Total", 0.890949603959704, 0.0826999223693783, -0.137102718184324,
			 -0.142646385729825, 0.129942033214034, 50, 50, -0.00635217625789547,
			 "Total", 0.927217051063237, 0.0695391397734859, -0.0913467764856856,
			 -0.169091368068507, 0.117846790148454, 84, 50, -0.0256222889600265,
			 "Total", 0.726314709263649, 0.0731998548137344, -0.350031964205741,
			 -0.292220785738799, 0.243098281267619, 16, 84, -0.0245612522355904,
			 "Total", 0.857268561437013, 0.136563495867513, -0.179852251727786,
			 -0.169126562627927, 0.158163775265141, 50, 84, -0.00548139368139329,
			 "Total", 0.947656340293437, 0.0834939673572302, -0.0656501763527545,
			 -0.148964585780088, 0.130224429893774, 84, 84, -0.00937007794315706,
			 "Total", 0.895332541997302, 0.0712229964111765, -0.131559726707689,
			 -0.0299018028328567, 0.0448952595789498, 16, 16, 0.00749672837304656,
			 "Total indirect", 0.694404506170637, 0.0190812338904684, 0.392884884493312,
			 -0.0347203917768182, 0.0356388152900881, 50, 16, 0.000459211756634957,
			 "Total indirect", 0.979589068065906, 0.0179491071320419, 0.0255841002706588,
			 -0.159760333961889, 0.0958937978196942, 84, 16, -0.0319332680710974,
			 "Total indirect", 0.624395250633776, 0.0652190891766763, -0.489630696690523,
			 -0.0863016447997899, 0.0930177386872452, 16, 50, 0.00335804694372768,
			 "Total indirect", 0.941482229004321, 0.0457455812712589, 0.0734070231573923,
			 -0.0188169395877599, 0.0355054492603731, 50, 50, 0.00834425483630659,
			 "Total indirect", 0.547090817695678, 0.0138580069013056, 0.602125175411801,
			 -0.0713762777881052, 0.0495245620564564, 84, 50, -0.0109258578658244,
			 "Total indirect", 0.723154923734176, 0.0308426177210939, -0.354245478273785,
			 -0.241065238944778, 0.221335596662002, 16, 84, -0.0098648211413883,
			 "Total indirect", 0.933352666293779, 0.117961564409892, -0.0836274187336995,
			 -0.0831357219607278, 0.101565796786345, 50, 84, 0.00921503741280876,
			 "Total indirect", 0.844945866620574, 0.047118600189589, 0.195571120019072,
			 -0.0352230219007032, 0.0458757282027932, 84, 84, 0.00532635315104499,
			 "Total indirect", 0.796830956984272, 0.0206888368212868, 0.257450585407716
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-72")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-72")
})


context('Model number 75 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1404.48233882291, 1477.42710403058, 1153.94561208319, 21, 1, 100,
			 4.05257271899335e-231, 0, 1153.94561208319, 21))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 75))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54485451029573, 0.064204486308943, -0.240325011993393, "contcor1",
			 "<unicode>", 0.121925627237875, "contGamma", 0.155375048064366,
			 -1.54674135253581, -0.403940542688519, 0.194622133824209, -0.104659204432155,
			 "contcor2", "<unicode>", 0.493089769000148, "contGamma", 0.152697366184816,
			 -0.685402813729486, 0.424979307928446, 0.896764226956433, 0.66087176744244,
			 "contcor2", "<unicode>", 3.9967042342326e-08, "contcor1", 0.120355507231094,
			 5.49099731824905, 0.744754612162503, 1.31593934462094, 1.03034697839172,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145713068445101, 7.07106774558053, 0.00462621228045024, 0.00817425547528961,
			 0.00640023387786993, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905129691878496, 7.07106830689307, 0.323891604687874,
			 0.572297842954475, 0.448094723821175, "debCollin1:contcor1",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1", 0.0633701027738261,
			 7.07107459523092, 0.31853226150807, 0.562827478819589, 0.44067987016383,
			 "debCollin1:contcor2", "<unicode>", 1.53721479989599e-12, "debCollin1:contcor2",
			 0.0623213536673347, 7.07108950996372, 1.68041118992655, 2.96919217156381,
			 2.32480168074518, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.328776699929948, 7.07106580618553, 0.732635595102238,
			 1.29452744792281, 1.01358152151252, "contcor1", "<unicode>",
			 1.53765888910584e-12, "contcor1", 0.14334239232269, 7.07105208088589,
			 0.721541817209294, 1.27492363229542, 0.998232724752357, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171424437166,
			 7.07106787887274))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732746657169, 0.122660556421378, "", "", -0.0120360951178958,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.860972303761693,
			 0.0687240442180282, -0.175136595275317, -0.0189659004728368,
			 0.0308821218117228, 16, 16, 0.00595811066944302, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.63940460744426,
			 0.0127165658853312, 0.4685314198164, -0.0685093666433234, 0.0356529988318695,
			 50, 16, -0.016428183905727, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.536417420028117, 0.0265725202852737,
			 -0.61823958470478, -0.282915422339265, 0.137196340353004, 84,
			 16, -0.0728595409931304, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.496612752476675, 0.107173337368966,
			 -0.679828983418668, -0.0491999194946433, 0.0780831770476052,
			 16, 50, 0.0144416287764809, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.656494824872716, 0.0324707743474476,
			 0.444757757297407, -0.0255942701007291, 0.0225803003743238,
			 50, 50, -0.00150698486320264, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.902406269144694, 0.0122896570689686,
			 -0.122622206197094, -0.153640691377829, 0.0518158285425057,
			 84, 50, -0.0509124314176617, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.331367056458431, 0.0524133406381315,
			 -0.971363984775703, -0.160198093332501, 0.211644798106892, 16,
			 84, 0.0257233523871953, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.786258110298703, 0.0948596235370759,
			 0.271172828101529, -0.0386516240139857, 0.0732930018777946,
			 50, 84, 0.0173206889319044, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.544174258571551, 0.0285578272801912,
			 0.606512840138883, -0.0861981568340753, 0.0384995327104416,
			 84, 84, -0.0238493120618168, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.453427061879982, 0.0318112196265126,
			 -0.749713853848594))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.146732746657169, 0.122660556421378, -0.0120360951178958, "contGamma",
			 "<unicode>", 0.860972303761693, "contNormal", 0.0687240442180282,
			 -0.175136595275317, -2.33172281111413, 2.72584275902222, 0.197059973954047,
			 "debCollin1", "<unicode>", 0.878608252451845, "contNormal",
			 1.29021900658119, 0.152733739736338, -3.9278216634606, 0.322249054399508,
			 -1.80278630453055, "contcor1", "<unicode>", 0.0963630840628957,
			 "contNormal", 1.08422163656683, -1.66274702858637, -1.07379968923398,
			 3.00630207192074, 0.966251191343377, "contcor2", "<unicode>",
			 0.353242237671469, "contNormal", 1.04086141208156, 0.928318775321901,
			 -0.0857622437912315, 6.36779053000179, 3.14101414310528, "debCollin1:contcor1",
			 "<unicode>", 0.0564078310703018, "contNormal", 1.64634473508131,
			 1.90787146590543, -4.80094202990634, 1.40104537798702, -1.69994832595966,
			 "debCollin1:contcor2", "<unicode>", 0.282624682170956, "contNormal",
			 1.58216871759222, -1.07444187655706, -0.0199697973405792, 0.000908043559731947,
			 -0.00953087689042363, "contGamma", "<unicode>", 0.0735385309323213,
			 "debCollin1", 0.00532607768943534, -1.78947387668205, -0.0336990910153277,
			 0.0420655031390159, 0.00418320606184413, "contcor1", "<unicode>",
			 0.828651191582308, "debCollin1", 0.0193280577479906, 0.216431786182915,
			 -0.0310218554424562, 0.0494307664608037, 0.00920445550917377,
			 "contcor2", "<unicode>", 0.653812102061617, "debCollin1", 0.0205240051699572,
			 0.448472675433115, -0.0233914629276639, 0.0139843417655748,
			 -0.00470356058104455, "contGamma:contcor1", "<unicode>", 0.621798091345299,
			 "debCollin1", 0.00953481925893901, -0.493303591112637, -0.0182404665227807,
			 0.017560987918507, -0.000339739302136851, "contGamma:contcor2",
			 "<unicode>", 0.970326886286722, "debCollin1", 0.00913319191670995,
			 -0.0371983097733082))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.141762230368691, 0.129606261471785, 16, 16, -0.00607798444845278,
			 "Total", 0.930038251379144, 0.0692279281611794, -0.0877967116725168,
			 -0.168272215347231, 0.111343657299986, 50, 16, -0.0284642790236228,
			 "Total", 0.689863716245899, 0.0713318904971702, -0.399040020182165,
			 -0.328263797803406, 0.158472525581354, 84, 16, -0.0848956361110262,
			 "Total", 0.494160530662071, 0.124169711082467, -0.683706480195019,
			 -0.145660636035897, 0.150471703353067, 16, 50, 0.00240553365858515,
			 "Total", 0.974597856619477, 0.0755453522934141, 0.0318422455592263,
			 -0.146122988664182, 0.119036828701985, 50, 50, -0.0135430799810984,
			 "Total", 0.841315606437424, 0.0676440535279509, -0.20021094648774,
			 -0.223906365838894, 0.0980093127677789, 84, 50, -0.0629485265355575,
			 "Total", 0.443369018515753, 0.0821228556100782, -0.7665165326744,
			 -0.215565998207893, 0.242940512746492, 16, 84, 0.0136872572692995,
			 "Total", 0.906846571268489, 0.116968095988249, 0.11701701351687,
			 -0.137332961989027, 0.147902149617044, 50, 84, 0.00528459381400864,
			 "Total", 0.942104456472413, 0.0727653961644115, 0.0726250950667298,
			 -0.175715724600629, 0.103944910241203, 84, 84, -0.0358854071797126,
			 "Total", 0.614967007513832, 0.0713433096341972, -0.50299610942792,
			 -0.0189659004728368, 0.0308821218117228, 16, 16, 0.00595811066944302,
			 "Total indirect", 0.63940460744426, 0.0127165658853312, 0.4685314198164,
			 -0.0685093666433234, 0.0356529988318695, 50, 16, -0.016428183905727,
			 "Total indirect", 0.536417420028117, 0.0265725202852737, -0.61823958470478,
			 -0.282915422339265, 0.137196340353004, 84, 16, -0.0728595409931304,
			 "Total indirect", 0.496612752476675, 0.107173337368966, -0.679828983418668,
			 -0.0491999194946433, 0.0780831770476052, 16, 50, 0.0144416287764809,
			 "Total indirect", 0.656494824872716, 0.0324707743474476, 0.444757757297407,
			 -0.0255942701007291, 0.0225803003743238, 50, 50, -0.00150698486320264,
			 "Total indirect", 0.902406269144694, 0.0122896570689686, -0.122622206197094,
			 -0.153640691377829, 0.0518158285425057, 84, 50, -0.0509124314176617,
			 "Total indirect", 0.331367056458431, 0.0524133406381315, -0.971363984775703,
			 -0.160198093332501, 0.211644798106892, 16, 84, 0.0257233523871953,
			 "Total indirect", 0.786258110298703, 0.0948596235370759, 0.271172828101529,
			 -0.0386516240139857, 0.0732930018777946, 50, 84, 0.0173206889319044,
			 "Total indirect", 0.544174258571551, 0.0285578272801912, 0.606512840138883,
			 -0.0861981568340753, 0.0384995327104416, 84, 84, -0.0238493120618168,
			 "Total indirect", 0.453427061879982, 0.0318112196265126, -0.749713853848594
			))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-75")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-75")
})


context('Model number 75 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(958.801185942784, 1031.74595115045, 1017.25258719577, 21, 1, 100,
			 5.90243574561299e-202, 0, 1017.25258719577, 21))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 75))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962226894471635, 0.0896221764541582, 0.0399999537547209,
			 "facExperimexperimental", "<unicode>", 0.114128296354995, "facGenderm",
			 0.0253179257837649, 1.57990643058014, -0.163248035460827, 0.0342011067305704,
			 -0.0645234643651285, "contcor2", "<unicode>", 0.20020259375094,
			 "facGenderm", 0.0503706047021403, -1.28097458322526, -0.170526790288682,
			 0.0272978076034862, -0.0716144913425976, "contcor2", "<unicode>",
			 0.15588347873228, "facExperimexperimental", 0.0504663859776463,
			 -1.4190532956792, 0.758591156314587, 1.34038772930799, 1.04948944281129,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.148420220366941, 7.07106781149241, 0.00473841061738722, 0.00837255426928247,
			 0.00655548244333485, "debCollin1", "<unicode>", 1.53832502292062e-12,
			 "debCollin1", 0.000927094497797131, 7.07099703310863, 0.0796447104160653,
			 0.14072774256014, 0.110186226488102, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.015582692494834, 7.07106467798372, 0.318533103938857, 0.562830417211682,
			 0.44068176057527, "debCollin1:contcor2", "<unicode>", 1.53765888910584e-12,
			 "debCollin1:contcor2", 0.0623218883611664, 7.07105917621495,
			 0.180704672393151, 0.319294715505728, 0.24999969394944, "facGenderm",
			 "<unicode>", 1.53743684450092e-12, "facGenderm", 0.0353552524959023,
			 7.07107646815463, 0.180704716999923, 0.319294871088087, 0.249999794044005,
			 "facExperimexperimental", "<unicode>", 1.53743684450092e-12,
			 "facExperimexperimental", 0.0353552808065214, 7.07107363712103,
			 0.721541135964885, 1.27492125627199, 0.998231196118437, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141170992087634,
			 7.07107870644395))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0715438299773683, 0.892289575901905, "", 0.481916702939637,
			 "", "facGenderm", "contNormal", "", "<unicode>", "", 0.0213542773627917,
			 0.209377762142181, 2.30166135127753, -0.0560646009123797, 0.0459989291105628,
			 16, -0.00503283590090844, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.846728063327815, 0.0260370932394694,
			 -0.193294844959084, -0.0555870052177401, 0.0642899621835057,
			 16, 0.00435147848288283, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.886849702874587, 0.0305814209717168,
			 0.14229157261552, -0.0213441975950023, 0.0198257584998944, 50,
			 -0.000759219547553968, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.942372866006293, 0.0105027328103067,
			 -0.0722878093984184, -0.0615382536360259, 0.0595926752465729,
			 50, -0.000972789194726506, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.974886334191098, 0.0309013149828426,
			 -0.0314805112748966, -0.0179139933417252, 0.0185926575906855,
			 84, 0.00033933212448014, 0, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.970934684212808, 0.00931309228648346,
			 0.0364360315609274, -0.108167149001018, 0.0859182874036991,
			 84, -0.0111244307986596, 1, "facGenderm", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.822228819485638, 0.0495125007233905,
			 -0.224679235266424))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0715438299773683, 0.892289575901905, 0.481916702939637, "facGenderm",
			 "<unicode>", 0.0213542773627917, "contNormal", 0.209377762142181,
			 2.30166135127753, -3.61764354372958, 3.32517001574194, -0.146236763993823,
			 "debCollin1", "<unicode>", 0.934196953460481, "contNormal",
			 1.77115845348066, -0.0825656020252957, -3.432868686363, 3.20124666144837,
			 -0.115811012457319, "facExperimexperimental", "<unicode>", 0.94544354359626,
			 "contNormal", 1.69240746262187, -0.0684297458000479, -1.7756767102885,
			 1.36743845517149, -0.204119127558505, "contcor2", "<unicode>",
			 0.799057825326773, "contNormal", 0.801829827040823, -0.254566643288655,
			 -4.77223996808154, 5.15463710479232, 0.191198568355388, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.939816465003198, "contNormal", 2.53241313390853,
			 0.0755005436495631, -1.95652754962828, 2.77446184182128, 0.408967146096501,
			 "debCollin1:contcor2", "<unicode>", 0.734718592413582, "contNormal",
			 1.20690722604267, 0.338855495494433, -0.0402677547389432, 0.0518455391657029,
			 0.00578889221337984, "facGenderm", "<unicode>", 0.805411891500587,
			 "debCollin1", 0.0234987210559031, 0.246349245969947, -0.0489099049206544,
			 0.0420352461327504, -0.00343732939395202, "facExperimexperimental",
			 "<unicode>", 0.882219535413296, "debCollin1", 0.0232007199547462,
			 -0.148156152078756, -0.0174100673856477, 0.0258808691851166,
			 0.00423540089973446, "contcor2", "<unicode>", 0.701342352968945,
			 "debCollin1", 0.0110438092006378, 0.383509061301953, -0.0882816484471169,
			 0.0429311424707931, -0.0226752529881619, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498143430048936, "debCollin1", 0.0334732658234794,
			 -0.677413823549199, -0.0370220073109698, 0.0287651339615636,
			 -0.00412843667470309, "facGenderm:contcor2", "<unicode>", 0.805687673040202,
			 "debCollin1", 0.0167827423849249, -0.245992971828696))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0643801629082967, 0.889387571169159, 16, 0.476883867038728,
			 0, "Total", 0.023460021522739, 0.210464940878612, 2.26585893616256,
			 0.074214215630278, 0.898322147214761, 16, 0.486268181422519,
			 1, "Total", 0.0207243338302552, 0.210235478326373, 2.31296917767433,
			 0.0706762712923699, 0.891638695491795, 50, 0.481157483392083,
			 0, "Total", 0.0215943232209748, 0.209433038228017, 2.29742875079829,
			 0.0702171574950789, 0.891670669994741, 50, 0.48094391374491,
			 1, "Total", 0.0217310532112136, 0.209558318157676, 2.29503614064624,
			 0.0715087399126839, 0.893003330215549, 84, 0.482256035064117,
			 0, "Total", 0.0213813214137546, 0.209568797381664, 2.30118243311689,
			 0.0551226369149233, 0.886461907367031, 84, 0.470792272140977,
			 1, "Total", 0.0264270471639729, 0.212080241527295, 2.2198780459253,
			 -0.0560646009123797, 0.0459989291105628, 16, -0.00503283590090844,
			 0, "Total indirect", 0.846728063327815, 0.0260370932394694,
			 -0.193294844959084, -0.0555870052177401, 0.0642899621835057,
			 16, 0.00435147848288283, 1, "Total indirect", 0.886849702874587,
			 0.0305814209717168, 0.14229157261552, -0.0213441975950023, 0.0198257584998944,
			 50, -0.000759219547553968, 0, "Total indirect", 0.942372866006293,
			 0.0105027328103067, -0.0722878093984184, -0.0615382536360259,
			 0.0595926752465729, 50, -0.000972789194726506, 1, "Total indirect",
			 0.974886334191098, 0.0309013149828426, -0.0314805112748966,
			 -0.0179139933417252, 0.0185926575906855, 84, 0.00033933212448014,
			 0, "Total indirect", 0.970934684212808, 0.00931309228648346,
			 0.0364360315609274, -0.108167149001018, 0.0859182874036991,
			 84, -0.0111244307986596, 1, "Total indirect", 0.822228819485638,
			 0.0495125007233905, -0.224679235266424))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-75")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-75")
})


context('Model number 76 - continuous')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor1"), list(processDependent = "debCollin1",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1408.05835697871, 1486.21346255835, 1153.52163023898, 19, 1, 100,
			 8.20820338326019e-233, 0, 1153.52163023898, 19))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 76))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.54484358678171, 0.064214416479369, -0.240314585151171, "contcor1",
			 "<unicode>", 0.121941207996376, "contGamma", 0.155374794655731,
			 -1.54667676751331, -0.403937398902793, 0.194625970031864, -0.104655714435465,
			 "contcor2", "<unicode>", 0.493104687883831, "contGamma", 0.152697542826309,
			 -0.685379165233253, 0.42497989339144, 0.89676291919544, 0.66087140629344,
			 "contcor2", "<unicode>", 3.99627346769904e-08, "contcor1", 0.120355024256916,
			 5.49101635244333, 0.741603579426158, 1.31037148881429, 1.02598753412023,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.145096520618364, 7.07106917345591, 0.00462620952624863, 0.00817424586880462,
			 0.00640022769752663, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000905127943814899, 7.07107513502588, 0.323892409681785,
			 0.572300651098928, 0.448096530390356, "debCollin1:contcor1",
			 "<unicode>", 1.53765888910584e-12, "debCollin1:contcor1", 0.0633706137910074,
			 7.07104608246581, 0.318533181768373, 0.562830688480616, 0.440681935124495,
			 "debCollin1:contcor2", "<unicode>", 1.53765888910584e-12, "debCollin1:contcor2",
			 0.0623219377088638, 7.07105637798258, 1.68041492368261, 2.96920519491084,
			 2.32481005929672, "contGamma", "<unicode>", 1.53765888910584e-12,
			 "contGamma", 0.328779069767108, 7.07104032182923, 0.732634172756238,
			 1.29452248800829, 1.01357833038226, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341489865159, 7.07107433678647,
			 0.721540870781675, 1.27492033216017, 0.998230601470923, "contcor2",
			 "<unicode>", 1.53721479989599e-12, "contcor2", 0.141170823990513,
			 7.07108291397383))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209486691465841, 0.166373613542849, 16, 16, -0.0215565389614957,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.822121032378677,
			 0.0958844927696192, -0.224817781674972, -0.198506829068452,
			 0.314045127088994, 50, 16, 0.057769149010271, "contGamma", "contNormal",
			 "", "<unicode>", "", 0.658626245289122, 0.130755452702292, 0.44181063058075,
			 -0.344935115192718, 0.633621225985929, 84, 16, 0.144343055396605,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.563120059276554,
			 0.249636306814149, 0.578213390667034, -0.36698877696322, 0.186094400763109,
			 16, 50, -0.0904471881000558, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.521499018341799, 0.141095240037312, -0.641036423880336,
			 -0.14644645083599, 0.124203450579412, 50, 50, -0.0111215001282891,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.872032739772927,
			 0.0690446109087346, -0.161077019363464, -0.233445691335353,
			 0.384350503851444, 84, 50, 0.0754524062580453, "contGamma",
			 "contNormal", "", "<unicode>", "", 0.632118714475447, 0.157603966210577,
			 0.478746874664513, -0.669519109658324, 0.327123903647119, 16,
			 84, -0.171197603005602, "contGamma", "contNormal", "", "<unicode>",
			 "", 0.500729309398055, 0.254250338569187, -0.673342674660846,
			 -0.385811525111948, 0.202067695044277, 50, 84, -0.0918719150338355,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.540144819401555,
			 0.149971944585039, -0.612594010753399, -0.229492751937834, 0.218896734642832,
			 84, 84, -0.00529800864750113, "contGamma", "contNormal", "",
			 "<unicode>", "", 0.963058022768147, 0.114387174998496, -0.0463164567843447,
			 -0.0198745443032804, 0.0329042142267351, 16, 16, 0.00651483496172734,
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.628483163261511, 0.0134642164208954, 0.483862911741142, -0.0737514469059392,
			 0.0369339068124297, 50, 16, -0.0184087700467548, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.514434965533923,
			 0.0282365784757886, -0.651947616901933, -0.312137114310586,
			 0.149929622910544, 84, 16, -0.0811037457000213, "contGamma",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.491426988372926,
			 0.117876333663744, -0.68804095936152, -0.0534538487083768, 0.085020232922026,
			 16, 50, 0.0157831921068246, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.655025955644552, 0.0353256699415573,
			 0.446791020041129, -0.0264406011342638, 0.0221913180583279,
			 50, 50, -0.00212464153796795, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.864023545920259, 0.0124063298040663,
			 -0.171254639488269, -0.17032653669673, 0.0560009478381213, 84,
			 50, -0.0571627944293044, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.322152896953753, 0.0577376641407939,
			 -0.990043419316589, -0.174677265725413, 0.230895046540302, 16,
			 84, 0.0281088904074446, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.785870090749845, 0.103464225737008,
			 0.271677386142082, -0.0394867253696005, 0.0763359606910987,
			 50, 84, 0.0184246176607491, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.532912163044575, 0.0295471465226641,
			 0.62356673415541, -0.0950846833000991, 0.0398075559042164, 84,
			 84, -0.0276385636979413, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.421877429069772, 0.0344119178383706,
			 -0.803168362419001))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.144540041754843, 0.126023428368361, -0.00925830669324104, "contGamma",
			 "<unicode>", 0.893296220343538, "contNormal", 0.069022561704545,
			 -0.134134498410415, -2.2822370389843, 2.81249422126523, 0.265128591140465,
			 "debCollin1", "<unicode>", 0.838359664561531, "contNormal",
			 1.29970022419701, 0.203992110030041, -4.64758131883345, 0.319583137490261,
			 -2.16399909067159, "contcor1", "<unicode>", 0.0876810413222748,
			 "contNormal", 1.26715707418709, -1.70775915216339, -0.96251966752522,
			 3.35439359845285, 1.19593696546382, "contcor2", "<unicode>",
			 0.277497547400644, "contNormal", 1.10127362033929, 1.08595806108147,
			 -0.00781860144556568, 6.97589416059489, 3.48403777957466, "debCollin1:contcor1",
			 "<unicode>", 0.050515188762833, "contNormal", 1.78159211524474,
			 1.95557543713986, -0.173334374654821, 0.336197388126739, 0.0814315067359586,
			 "contGamma:contcor1", "<unicode>", 0.531007638194944, "contNormal",
			 0.129984981050846, 0.626468581813348, -4.98755810387928, 1.27340678736325,
			 -1.85707565825802, "debCollin1:contcor2", "<unicode>", 0.244952607203864,
			 "contNormal", 1.59721427042237, -1.16269663541569, -0.303234613244417,
			 0.158779488189772, -0.0722275625273224, "contGamma:contcor2",
			 "<unicode>", 0.540002005144584, "contNormal", 0.117862905920338,
			 -0.612809958852875, -0.0199698666003479, 0.000907964219748786,
			 -0.00953095119029954, "contGamma", "<unicode>", 0.0735361471857094,
			 "debCollin1", 0.0053260751179048, -1.78948869088592, -0.0336990432521721,
			 0.0420655143198797, 0.0041832355338538, "contcor1", "<unicode>",
			 0.828649921656983, "debCollin1", 0.0193280484156018, 0.216433415516336,
			 -0.031021667958522, 0.0494309151000133, 0.00920462357074564,
			 "contcor2", "<unicode>", 0.653806037400475, "debCollin1", 0.0205239952604066,
			 0.448481080508849, -0.0233914354811711, 0.0139843511656685,
			 -0.00470354215775129, "contGamma:contcor1", "<unicode>", 0.621799288136496,
			 "debCollin1", 0.0095348146551812, -0.493301897084638, -0.0182405450247509,
			 0.0175608921306716, -0.000339826447039642, "contGamma:contcor2",
			 "<unicode>", 0.970319264165621, "debCollin1", 0.00913318750696943,
			 -0.0372078692986785))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.201938891203118, 0.171855483203581, 16, 16, -0.0150417039997684,
			 "Total", 0.874661528681364, 0.0953574599725153, -0.157740191528841,
			 -0.193453017288842, 0.322020985232839, 16, 16, 0.0642839839719983,
			 "Total", 0.624949104315505, 0.131500886390687, 0.488848294003216,
			 -0.340452886411379, 0.642168667128045, 50, 16, 0.150857890358333,
			 "Total", 0.547300220419674, 0.250673369840012, 0.601810597011622,
			 -0.359189625732144, 0.191324919455487, 16, 16, -0.0839323531383284,
			 "Total", 0.550081058331654, 0.140439964593743, -0.597638666323532,
			 -0.141509282173584, 0.132295951840461, 84, 16, -0.00460666516656175,
			 "Total", 0.947416643026313, 0.069849557485185, -0.0659512433924698,
			 -0.229624936525833, 0.393559418965378, 16, 16, 0.0819672412197726,
			 "Total", 0.606142971283011, 0.158978522158266, 0.515586886247266,
			 -0.661913893039066, 0.332548356951316, 16, 50, -0.164682768043875,
			 "Total", 0.51624830294666, 0.253694011174331, -0.649139359977677,
			 -0.379386212232043, 0.208672052087827, 16, 16, -0.0853570800721081,
			 "Total", 0.569369465408941, 0.150017619955877, -0.568980364421283,
			 -0.225847229363831, 0.228280881992284, 50, 50, 0.00121682631422621,
			 "Total", 0.991619684493232, 0.115851136790834, 0.0105033610194361,
			 -0.235334774834174, 0.155404156817673, 16, 16, -0.0399653090082505,
			 "Total", 0.688467567799057, 0.0996801305365676, -0.400935560508614,
			 -0.21615083221536, 0.294871590142393, 84, 50, 0.0393603789635162,
			 "Total", 0.762710124202354, 0.13036525833858, 0.301923836650489,
			 -0.359310534036231, 0.611179104735932, 16, 16, 0.125934285349851,
			 "Total", 0.61098762614559, 0.247578436753752, 0.508664191442116,
			 -0.394081785919507, 0.176369869625886, 16, 84, -0.108855958146811,
			 "Total", 0.454449925880829, 0.145526055592103, -0.748016963037356,
			 -0.170769361374287, 0.111708821024199, 16, 16, -0.0295302701750439,
			 "Total", 0.68196052805433, 0.0720620849736624, -0.40978928358563,
			 -0.248757733510091, 0.362845005932672, 50, 84, 0.0570436362112905,
			 "Total", 0.714657494034342, 0.15602397397784, 0.36560814826696,
			 -0.69515443640713, 0.315941690302416, 16, 16, -0.189606373052357,
			 "Total", 0.462286687923854, 0.257937425045803, -0.735086709571859,
			 -0.410966785329814, 0.190405415168633, 84, 84, -0.11028068508059,
			 "Total", 0.472237511257074, 0.153414094657349, -0.718843241404269,
			 -0.248952697319071, 0.201539139930559, 16, 16, -0.0237067786942559,
			 "Total", 0.836569757831572, 0.114923498799736, -0.206283126965765,
			 -0.405366958234661, 0.200046388911627, 16, 16, -0.102660284661517,
			 "Total", 0.506239573210313, 0.154445018357917, -0.66470440907073,
			 -0.351565336547668, 0.304896143168167, 50, 16, -0.0233345966897503,
			 "Total", 0.889183173170316, 0.167467740451845, -0.139337860693595,
			 -0.452408877390516, 0.578887496783684, 50, 16, 0.063239309696584,
			 "Total", 0.810042809666698, 0.26309064409064, 0.240370804196278,
			 -0.546247405909617, 0.203145538309463, 50, 16, -0.171550933800077,
			 "Total", 0.36953250778847, 0.19117518233248, -0.897349392881582,
			 -0.352954016328368, 0.168503524671747, 84, 16, -0.0922252458283104,
			 "Total", 0.488133567100132, 0.133027327316549, -0.69328045363832,
			 -0.365549334938976, 0.354246656055024, 50, 16, -0.00565133944197604,
			 "Total", 0.97544773504043, 0.183624800422778, -0.0307765586618169,
			 -0.819015541284806, 0.314412843873559, 16, 50, -0.252301348705623,
			 "Total", 0.382893886717326, 0.289145207284089, -0.872576623612281,
			 -0.553745407553333, 0.20779408608562, 50, 16, -0.172975660733857,
			 "Total", 0.373267096411096, 0.19427384881709, -0.890370277765558,
			 -0.391836316279569, 0.219032807584524, 50, 50, -0.0864017543475224,
			 "Total", 0.579279575983646, 0.155836823707617, -0.554437342162662,
			 -0.202978833448658, 0.191432139739316, 50, 16, -0.00577334685467111,
			 "Total", 0.954242893986264, 0.100616893039627, -0.0573794984148174,
			 -0.19395399854719, 0.341058680781381, 84, 50, 0.0735523411170956,
			 "Total", 0.589953862924068, 0.136485334309376, 0.538902890111051,
			 -0.337665343248328, 0.657917838255188, 50, 16, 0.16012624750343,
			 "Total", 0.528388420496646, 0.253979968345477, 0.630468018980212,
			 -0.355376492863421, 0.206048500876959, 16, 84, -0.0746639959932312,
			 "Total", 0.602149567125975, 0.143223293430091, -0.521311821597481,
			 -0.14682131337219, 0.156144697329261, 50, 16, 0.00466169197853552,
			 "Total", 0.95190448772219, 0.0772886678253295, 0.060315336124965,
			 -0.229035174748163, 0.411506371477903, 50, 84, 0.0912355983648699,
			 "Total", 0.576615425871164, 0.163406458301932, 0.558335327213876,
			 -0.654599471475437, 0.343770649677882, 50, 16, -0.155414410898778,
			 "Total", 0.54172412309003, 0.25469093540196, -0.610207860964891,
			 -0.375374369393846, 0.223196923539824, 84, 84, -0.0760887229270109,
			 "Total", 0.618279391936019, 0.152699564291774, -0.498290373518177,
			 -0.226064518537465, 0.247034885456112, 50, 16, 0.0104851834593235,
			 "Total", 0.93076977403856, 0.120690841190278, 0.0868763806426107,
			 -0.212282230939167, 0.16491986994024, 16, 16, -0.0236811804994637,
			 "Total", 0.805606701322508, 0.0962267939244623, -0.246097573593206,
			 -0.198661919509852, 0.309950934454458, 84, 16, 0.055644507472303,
			 "Total", 0.668026896213171, 0.129750561228722, 0.428857547476914,
			 -0.344622740536898, 0.629059568254173, 50, 16, 0.142218413858637,
			 "Total", 0.566946548006561, 0.248392908357335, 0.572554243996545,
			 -0.370221785106466, 0.185078125830418, 84, 16, -0.0925718296380237,
			 "Total", 0.513449759173655, 0.14166074359453, -0.653475530969881,
			 -0.146170396572113, 0.119678113239599, 84, 16, -0.013246141666257,
			 "Total", 0.845147180838633, 0.0678197436046509, -0.195313944910707,
			 -0.232287760881576, 0.378943290321731, 84, 16, 0.0733277647200773,
			 "Total", 0.638166885558629, 0.155929153807065, 0.470263340303942,
			 -0.672684298807471, 0.32603980972033, 16, 50, -0.17332224454357,
			 "Total", 0.496328024056508, 0.254781239962981, -0.680278675811269,
			 -0.387561539968101, 0.199568426824494, 84, 16, -0.0939965565718034,
			 "Total", 0.530291717933458, 0.149780805010654, -0.627560764979983,
			 -0.22803540493082, 0.213190104559881, 50, 50, -0.00742265018546908,
			 "Total", 0.94742226719082, 0.112559596240296, -0.0659441792028371,
			 -0.304429733855459, 0.146991067073859, 84, 16, -0.0787193333908001,
			 "Total", 0.494251771479505, 0.115160483684922, -0.683562024680059,
			 -0.263819460253202, 0.265032169415135, 84, 50, 0.000606354580966584,
			 "Total", 0.996414006466473, 0.134913609086659, 0.00449439152263062,
			 -0.393665642817902, 0.568026164752503, 84, 16, 0.0871802609673009,
			 "Total", 0.722324940884024, 0.245334050818308, 0.355353285353226,
			 -0.459442445579739, 0.164222480521018, 16, 84, -0.14760998252936,
			 "Total", 0.353524484193995, 0.159101118954263, -0.927774634770443,
			 -0.234697241403809, 0.0981286522886218, 84, 16, -0.0682842945575935,
			 "Total", 0.421262511990741, 0.0849061248874262, -0.804232847137106,
			 -0.285642093743557, 0.322221317401038, 50, 84, 0.0182896118287409,
			 "Total", 0.906111874733023, 0.155070046169048, 0.117944195417358,
			 -0.752869374756803, 0.29614857988699, 84, 16, -0.228360397434907,
			 "Total", 0.393477481337038, 0.26761153850742, -0.853327919672549,
			 -0.468099012738191, 0.170029593811911, 84, 84, -0.14903470946314,
			 "Total", 0.359930364636227, 0.16279090115522, -0.915497785229633,
			 -0.293200566732323, 0.168278960578712, 84, 16, -0.0624608030768055,
			 "Total", 0.595724815601209, 0.117726532464659, -0.53055842017224,
			 -0.267393704021586, 0.280498406913484, 16, 16, 0.00655235144594889,
			 "Total", 0.962609503170222, 0.139770963970964, 0.0468792033752451,
			 -0.244683349455307, 0.416439428290739, 16, 50, 0.0858780394177156,
			 "Total", 0.610620513248156, 0.16865686894272, 0.509187914824162,
			 -0.3634626675748, 0.7083665591829, 50, 16, 0.17245194580405,
			 "Total", 0.528238827057976, 0.273430847508463, 0.630696746089384,
			 -0.399562262589034, 0.274885667203811, 16, 50, -0.0623382976926112,
			 "Total", 0.71711771930242, 0.172056204887642, -0.362313569181187,
			 -0.226779609540513, 0.260754390098824, 84, 16, 0.0169873902791555,
			 "Total", 0.891359620111666, 0.124373203662145, 0.136584005066728,
			 -0.271599245447047, 0.478721838778027, 16, 50, 0.10356129666549,
			 "Total", 0.588480835633833, 0.191411957092965, 0.541038805716783,
			 -0.674744154613921, 0.388566729417606, 16, 50, -0.143088712598158,
			 "Total", 0.597845792737768, 0.271257760963668, -0.527500898369956,
			 -0.41674805999298, 0.289222010740198, 16, 50, -0.0637630246263909,
			 "Total", 0.723303790079562, 0.180097715137059, -0.3540468271786,
			 -0.281621563099682, 0.327243326619569, 50, 50, 0.0228108817599435,
			 "Total", 0.883243671278293, 0.155325530091854, 0.146858547635112,
			 -0.198511591576145, 0.192247748974651, 16, 50, -0.00313192130074665,
			 "Total", 0.974936127245178, 0.0996853369840099, -0.0314180740668914,
			 -0.187969283857135, 0.340356817199175, 84, 50, 0.0761937666710201,
			 "Total", 0.571855142113741, 0.134779543201732, 0.565321449093921,
			 -0.332066930298664, 0.657602276413372, 16, 50, 0.162767673057354,
			 "Total", 0.519123046357541, 0.252471273584214, 0.644697793719735,
			 -0.350572951910543, 0.206527811031929, 16, 84, -0.0720225704393067,
			 "Total", 0.61231452711068, 0.14212015305812, -0.50677239567743,
			 -0.136492480169164, 0.151098715234084, 16, 50, 0.00730311753245999,
			 "Total", 0.920707136445579, 0.0733664489938926, 0.099543014996786,
			 -0.220997208863573, 0.408751256701162, 50, 84, 0.0938770239187943,
			 "Total", 0.55898736282855, 0.16065307080439, 0.584346277657515,
			 -0.650165549138685, 0.344619578448979, 16, 50, -0.152772985344853,
			 "Total", 0.547175173646514, 0.253776379421867, -0.601998443247114,
			 -0.367938044061592, 0.221043449315419, 84, 84, -0.0734472973730864,
			 "Total", 0.62496651467033, 0.150253141900265, -0.488823704078277,
			 -0.21480102110306, 0.241054239129556, 16, 50, 0.0131266090132479,
			 "Total", 0.910128440517027, 0.116291744090286, 0.112876534064678,
			 -0.255452440531425, 0.157062235212551, 16, 16, -0.049195102659437,
			 "Total", 0.640158408363407, 0.105235269371743, -0.467477329160962,
			 -0.224948259121003, 0.285209429745662, 50, 50, 0.0301305853123297,
			 "Total", 0.816913870674797, 0.130144659006677, 0.231516110936093,
			 -0.363116742161709, 0.596525725559037, 50, 16, 0.116704491698664,
			 "Total", 0.63356712680255, 0.244811250433754, 0.476712126145708,
			 -0.410983529123689, 0.174812025527695, 50, 50, -0.118085751797997,
			 "Total", 0.429418956451193, 0.149440387494889, -0.790186333008779,
			 -0.179437683250621, 0.10191755559816, 84, 16, -0.0387600638262304,
			 "Total", 0.589185195289304, 0.0717756145184493, -0.540017164412678,
			 -0.24941138068064, 0.345039065800848, 50, 50, 0.047813842560104,
			 "Total", 0.752538236224918, 0.151648308634862, 0.31529426863065,
			 -0.708823821924363, 0.311151488517276, 16, 50, -0.198836166703543,
			 "Total", 0.444772415630471, 0.260202564559113, -0.76415913517398,
			 -0.420055103686822, 0.181034146223269, 50, 50, -0.119510478731777,
			 "Total", 0.435760282356348, 0.153341912058437, -0.779372561144485,
			 -0.246565475929044, 0.180692331238159, 50, 50, -0.0329365723454424,
			 "Total", 0.762514444752428, 0.108996341396413, -0.302180531231357,
			 -0.0198745443032804, 0.0329042142267351, 50, 50, 0.00651483496172734,
			 "Total indirect", 0.628483163261511, 0.0134642164208954, 0.483862911741142,
			 -0.0737514469059392, 0.0369339068124297, 84, 50, -0.0184087700467548,
			 "Total indirect", 0.514434965533923, 0.0282365784757886, -0.651947616901933,
			 -0.312137114310586, 0.149929622910544, 50, 50, -0.0811037457000213,
			 "Total indirect", 0.491426988372926, 0.117876333663744, -0.68804095936152,
			 -0.0534538487083768, 0.085020232922026, 16, 84, 0.0157831921068246,
			 "Total indirect", 0.655025955644552, 0.0353256699415573, 0.446791020041129,
			 -0.0264406011342638, 0.0221913180583279, 50, 50, -0.00212464153796795,
			 "Total indirect", 0.864023545920259, 0.0124063298040663, -0.171254639488269,
			 -0.17032653669673, 0.0560009478381213, 50, 84, -0.0571627944293044,
			 "Total indirect", 0.322152896953753, 0.0577376641407939, -0.990043419316589,
			 -0.174677265725413, 0.230895046540302, 50, 50, 0.0281088904074446,
			 "Total indirect", 0.785870090749845, 0.103464225737008, 0.271677386142082,
			 -0.0394867253696005, 0.0763359606910987, 84, 84, 0.0184246176607491,
			 "Total indirect", 0.532912163044575, 0.0295471465226641, 0.62356673415541,
			 -0.0950846833000991, 0.0398075559042164, 50, 50, -0.0276385636979413,
			 "Total indirect", 0.421877429069772, 0.0344119178383706, -0.803168362419001,
			 16, 16, 84, 50, 50, 16, 84, 50, 84, 16, 84, 50, 16, 50, 84,
			 50, 50, 50, 84, 50, 84, 50, 84, 50, 16, 84, 84, 50, 50, 84,
			 84, 50, 84, 84, 84, 50, 16, 16, 16, 84, 50, 16, 16, 84, 84,
			 16, 16, 84, 16, 50, 16, 84, 50, 50, 16, 84, 84, 50, 16, 84,
			 16, 84, 16, 84, 50, 84, 16, 84, 84, 84, 16, 84, 16, 16, 50,
			 84, 50, 16, 50, 84, 84, 16, 50, 84, 16, 50, 50, 84, 50, 50,
			 50, 84, 84, 50, 50, 84, 16, 84, 50, 84, 50, 84, 50, 84, 84,
			 84, 50, 84, 16, 16, 84, 84, 50, 16, 84, 84, 84, 16, 84, 84,
			 16, 50, 84, 84, 50, 50, 84, 84, 84, 50, 84, 84, 16, 84, 84,
			 84, 50, 84, 84, 84, 84, 84, 84, 84, 16, 16, 50, 16, 84, 16,
			 16, 50, 50, 50, 84, 50, 16, 84, 50, 84, 84, 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-76")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-76")
})


context('Model number 76 - factors')

options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "debCollin1"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "facExperim"), list(processDependent = "debCollin1",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "debCollin1", processType = "moderators",
        processVariable = "contcor2"), list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "moderators",
        processVariable = "contcor2")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model fit table results match", {
	table <- results[["results"]][["modelFitTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(962.391580948687, 1040.54668652833, 1016.84298220168, 19, 1, 100,
			 1.34570375562213e-203, 0, 1016.84298220168, 19))
})

test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 76))
})

test_that("Residual covariances table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0096223775002459, 0.0896224744931614, 0.0400000484964577, "facExperimexperimental",
			 "<unicode>", 0.114128921788274, "facGenderm", 0.025318029508766,
			 1.57990369995455, -0.163257882036936, 0.0341942754042673, -0.0645318033163342,
			 "contcor2", "<unicode>", 0.200151319377884, "facGenderm", 0.0503713739126536,
			 -1.28112057114494, -0.170524660194817, 0.0272998096993194, -0.0716124252477486,
			 "contcor2", "<unicode>", 0.15589514623218, "facExperimexperimental",
			 0.0504663533244872, -1.41901327380041, 0.755490283887591, 1.33490866286512,
			 1.04519947337636, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.147813527071903, 7.071067811459, 0.00473839291662248,
			 0.00837249252899138, 0.00655544272280693, "debCollin1", "<unicode>",
			 1.53765888910584e-12, "debCollin1", 0.000927083263017643, 7.07103987776573,
			 0.0796448132213731, 0.140728101140446, 0.11018645718091, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53765888910584e-12, "debCollin1:facExperimexperimental",
			 0.0155827577447571, 7.07104987356828, 0.318532304518855, 0.562827628893254,
			 0.440679966706055, "debCollin1:contcor2", "<unicode>", 1.53721479989599e-12,
			 "debCollin1:contcor2", 0.0623213809797958, 7.07108796014839,
			 0.180705495038502, 0.31929758490468, 0.250001539971591, "facGenderm",
			 "<unicode>", 1.53788093371077e-12, "facGenderm", 0.0353557746365175,
			 7.07102425393828, 0.180704348944245, 0.319293587341091, 0.249998968142668,
			 "facExperimexperimental", "<unicode>", 1.53721479989599e-12,
			 "facExperimexperimental", 0.035355047207505, 7.0710969971382,
			 0.721542839228028, 1.27492719739265, 0.99823501831034, "contcor2",
			 "<unicode>", 1.53765888910584e-12, "contcor2", 0.141172073193602,
			 7.07105163031338))
})

test_that("Mediation effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.175783430118581, 1.32274378006339, 16, 0.573480174972405, 0,
			 "facGenderm", "contNormal", "", "<unicode>", "", 0.133578077732285,
			 0.382284374101301, 1.50014024591138, -0.36271605290989, 1.00606619809274,
			 16, 0.321675072591423, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.356938046289779, 0.349185562030579, 0.921215272249007,
			 0.0235481261539662, 1.18422554836949, 50, 0.603886837261728,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0.0414008984771714,
			 0.296096619981489, 2.03949250518118, -0.236088085389875, 0.940251555151366,
			 50, 0.352081734880746, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.240697421671454, 0.300092157259026, 1.17324537267678,
			 -0.0534551055951045, 1.33251133084086, 84, 0.639528112622876,
			 0, "facGenderm", "contNormal", "", "<unicode>", "", 0.0704856635452917,
			 0.353569363357768, 1.80877694421661, -0.392737323130656, 1.16818334361444,
			 84, 0.387723010241894, 1, "facGenderm", "contNormal", "", "<unicode>",
			 "", 0.330212575118154, 0.398201364682576, 0.973685789728431,
			 -0.0569405775470041, 0.0465260956601665, 16, -0.00520724094341882,
			 0, "facGenderm", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.843607641984977, 0.026395044506762, -0.197281006367874, -0.0557475946409533,
			 0.0658041113706975, 16, 0.00502825836487211, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.87118254057282,
			 0.0310086580596468, 0.162156593658455, -0.0219058613887893,
			 0.0200624927561355, 50, -0.000921684316326902, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.931397136020766,
			 0.0107064095248601, -0.0860871531381986, -0.0604797233781838,
			 0.0606542743612505, 50, 8.7275491533329e-05, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.997746571286119,
			 0.03090209786887, 0.00282425781911875, -0.0157856404476159,
			 0.016376917606226, 84, 0.000295638579305036, 0, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.971256827238902,
			 0.00820488496409526, 0.0360320200220669, -0.105833817012267,
			 0.0868131728105404, 84, -0.00951032210086318, 1, "facGenderm",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.846556898089072,
			 0.0491455433218116, -0.193513418675389))
})

test_that("Path coefficients table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.020710761439925, 1.18515651928514, 0.602933640362535, "facGenderm",
			 "<unicode>", 0.0423887125030125, "contNormal", 0.297057947755729,
			 2.02968358503011, -3.64059357414836, 3.29137566076219, -0.174608956693085,
			 "debCollin1", "<unicode>", 0.921345637478216, "contNormal",
			 1.76839199331953, -0.0987388301647524, -3.31785501992305, 3.38683687195893,
			 0.0344909260179405, "facExperimexperimental", "<unicode>", 0.983911530000476,
			 "contNormal", 1.7104120138859, 0.0201652734767574, -1.83177666710652,
			 1.39297612675554, -0.219400270175491, "contcor2", "<unicode>",
			 0.789702139288306, "contNormal", 0.822656135341901, -0.266697421619917,
			 -4.80316188098362, 5.11832344416202, 0.157580781589203, "debCollin1:facExperimexperimental",
			 "<unicode>", 0.950356292761363, "contNormal", 2.53103766278489,
			 0.0622593586441608, -1.08435620492761, 0.580746000165641, -0.251805102380983,
			 "facGenderm:facExperimexperimental", "<unicode>", 0.553320926173643,
			 "contNormal", 0.424778776096745, -0.592791157540397, -1.98257275899915,
			 2.77839543560714, 0.397911338304, "debCollin1:contcor2", "<unicode>",
			 0.743199731147249, "contNormal", 1.2145550204392, 0.327619030515479,
			 -0.387148701000537, 0.450907690913145, 0.0318794949563041, "facGenderm:contcor2",
			 "<unicode>", 0.881464259834135, "contNormal", 0.213793824408041,
			 0.149113263886705, -0.0402685023590234, 0.0518445124847463,
			 0.00578800506286144, "facGenderm", "<unicode>", 0.805440536370428,
			 "debCollin1", 0.0234986498655959, 0.246312239042108, -0.0489088959805552,
			 0.0420359795506234, -0.00343645821496589, "facExperimexperimental",
			 "<unicode>", 0.882248814633102, "debCollin1", 0.0232006496671725,
			 -0.148119051158652, -0.0174097214899744, 0.0258810839282911,
			 0.00423568121915836, "contcor2", "<unicode>", 0.701322675304462,
			 "debCollin1", 0.0110437757427529, 0.383535605740445, -0.0882814211137053,
			 0.0429309722879479, -0.0226752244128787, "facGenderm:facExperimexperimental",
			 "<unicode>", 0.498142669785322, "debCollin1", 0.0334731644144076,
			 -0.677415022139909, -0.0370229348140808, 0.0287640071529506,
			 -0.00412946383056509, "facGenderm:contcor2", "<unicode>", 0.805639718727808,
			 "debCollin1", 0.0167826915407503, -0.246054920364726))
})

test_that("Total effects table results match", {
	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.184490882675235, 1.32103675073321, 16, 0.568272934028986, 0,
			 "Total", 0.138978202887079, 0.384070229168457, 1.47960682935343,
			 -0.37082698988724, 1.00376265318325, 16, 0.316467831648004,
			 0, "Total", 0.366805246232909, 0.35066706682191, 0.90247377524256,
			 0.0161242655455335, 1.18123492709109, 16, 0.598679596318309,
			 1, "Total", 0.0439871886200827, 0.297227569163463, 2.01421287400517,
			 -0.242402161376438, 0.936151149251092, 16, 0.346874493937327,
			 0, "Total", 0.248614109903283, 0.300656879392634, 1.15372212549421,
			 -0.0582557604356757, 1.32689750379459, 50, 0.634320871679457,
			 0, "Total", 0.0726373660818378, 0.353361917656696, 1.79510252798583,
			 -0.396766289911941, 1.16179782850889, 16, 0.382515769298475,
			 0, "Total", 0.336018799342548, 0.397600193349109, 0.962061326168949,
			 -0.171604937079847, 1.3286218037544, 50, 0.578508433337277,
			 1, "Total", 0.130640971621907, 0.382717935805924, 1.51157910098741,
			 -0.356853988352349, 1.01026065026494, 16, 0.326703330956295,
			 0, "Total", 0.348883825643865, 0.348760142890613, 0.936756500466178,
			 0.0263288086690273, 1.19150138258417, 84, 0.6089150956266, 0,
			 "Total", 0.0405070589528869, 0.297243363425522, 2.04854059182106,
			 -0.231229005265307, 0.945448991756543, 16, 0.357109993245618,
			 0, "Total", 0.234180485885068, 0.300178474273848, 1.1896588991249,
			 -0.0514391539745015, 1.34055189595, 84, 0.644556370987748, 1,
			 "Total", 0.0695072637302172, 0.355106282795079, 1.81510832732774,
			 -0.38884174540666, 1.17434428262019, 16, 0.392751268606766,
			 0, "Total", 0.324681124233455, 0.398779273587949, 0.984883855856028,
			 -0.176823938082083, 1.32194091939424, 16, 0.572558490656078,
			 0, "Total", 0.134265345076536, 0.382344999525091, 1.49749177148191,
			 -0.364183760369144, 1.00569053691934, 16, 0.320753388275096,
			 1, "Total", 0.358700820753617, 0.349464150385893, 0.917843469554477,
			 0.0227614060653444, 1.18316889982546, 16, 0.602965152945401,
			 1, "Total", 0.0416647335677214, 0.296027759416311, 2.03685341582253,
			 -0.237360735900254, 0.939680837029091, 16, 0.351160050564419,
			 1, "Total", 0.242211825469661, 0.300271224934157, 1.16947619819855,
			 -0.0539805928339343, 1.33119344944703, 50, 0.638606428306549,
			 0, "Total", 0.0707305754319618, 0.353367218277235, 1.80720337166514,
			 -0.393672237642652, 1.16727488949379, 16, 0.386801325925567,
			 1, "Total", 0.331371675985012, 0.398208114906445, 0.971354704854375,
			 -0.179609328199452, 1.32674422912733, 50, 0.573567450463939,
			 1, "Total", 0.135548918275684, 0.384280927917224, 1.49257329415913,
			 -0.36172881441242, 1.00525351057833, 16, 0.321762348082956,
			 1, "Total", 0.356174763260528, 0.348726388794216, 0.922678519384514,
			 0.0203012470287784, 1.18764697847774, 84, 0.603974112753262,
			 0, "Total", 0.042546446978392, 0.297797750534408, 2.0281352416847,
			 -0.233249112502725, 0.937587133247283, 16, 0.352169010372279,
			 1, "Total", 0.238377355902107, 0.298688204218398, 1.17905228729681,
			 -0.0544771150113553, 1.33370789124017, 84, 0.63961538811441,
			 1, "Total", 0.0708976235934418, 0.354135335445283, 1.80613263940513,
			 -0.389072357058996, 1.16469292852585, 16, 0.387810285733427,
			 1, "Total", 0.327881482349456, 0.396375978803883, 0.97838997939203,
			 -0.175369755649102, 1.32292138275252, 16, 0.57377581355171,
			 0, "Total", 0.133316748703973, 0.382224150601734, 1.50115007816334,
			 -0.362577464255112, 1.00651888659657, 50, 0.321970711170728,
			 0, "Total", 0.356606622697788, 0.349265691015482, 0.921850383398969,
			 0.0238167413004547, 1.18454821038161, 16, 0.604182475841033,
			 1, "Total", 0.0413109052301719, 0.296110407700565, 2.04039594735218,
			 -0.236152117364671, 0.940906864284772, 50, 0.352377373460051,
			 0, "Total", 0.240590179059559, 0.300275666015788, 1.17351291943025,
			 -0.0533581781234362, 1.3330056805278, 50, 0.639823751202181,
			 0, "Total", 0.0704363473902987, 0.353670748438925, 1.80909434559209,
			 -0.392869074385187, 1.16890637202758, 50, 0.388018648821199,
			 0, "Total", 0.330108722497656, 0.398419424727153, 0.973894907576164,
			 -0.198573539970841, 1.32651324571393, 50, 0.563969852871542,
			 1, "Total", 0.147178256838976, 0.389059900517167, 1.44957075278607,
			 -0.375958824996089, 1.00028832597721, 50, 0.31216475049056,
			 0, "Total", 0.3739329415179, 0.351089908240396, 0.88913051376235,
			 0.00382355183431438, 1.18492947848742, 84, 0.594376515160865,
			 0, "Total", 0.0485350159333611, 0.301308068915938, 1.9726538266942,
			 -0.243047820837551, 0.928190646397316, 50, 0.342571412779882,
			 0, "Total", 0.251577608243382, 0.298790813625517, 1.14652592100518,
			 -0.0647278560121686, 1.32476343705619, 84, 0.630017790522013,
			 1, "Total", 0.0755092508360407, 0.354468578001559, 1.77735864226375,
			 -0.394192950779598, 1.15061832706166, 50, 0.37821268814103,
			 0, "Total", 0.337202602311936, 0.39409175118179, 0.959707192568376,
			 -0.0569405775470041, 0.0465260956601665, 16, -0.00520724094341882,
			 0, "Total indirect", 0.843607641984977, 0.026395044506762, -0.197281006367874,
			 -0.0557475946409533, 0.0658041113706975, 50, 0.00502825836487211,
			 1, "Total indirect", 0.87118254057282, 0.0310086580596468, 0.162156593658455,
			 -0.0219058613887893, 0.0200624927561355, 16, -0.000921684316326902,
			 1, "Total indirect", 0.931397136020766, 0.0107064095248601,
			 -0.0860871531381986, -0.0604797233781838, 0.0606542743612505,
			 50, 8.7275491533329e-05, 1, "Total indirect", 0.997746571286119,
			 0.03090209786887, 0.00282425781911875, -0.0157856404476159,
			 0.016376917606226, 50, 0.000295638579305036, 0, "Total indirect",
			 0.971256827238902, 0.00820488496409526, 0.0360320200220669,
			 -0.105833817012267, 0.0868131728105404, 50, -0.00951032210086318,
			 1, "Total indirect", 0.846556898089072, 0.0491455433218116,
			 -0.193513418675389, 50, 1, 50, 1, 84, 0, 50, 1, 84, 1, 50, 1,
			 16, 0, 84, 0, 16, 1, 84, 0, 50, 0, 84, 0, 50, 1, 84, 0, 84,
			 0, 84, 0, 84, 1, 84, 0, 16, 0, 84, 1, 16, 1, 84, 1, 50, 0, 84,
			 1, 50, 1, 84, 1, 84, 0, 84, 1, 84, 1, 84, 1, 16, 0, 16, 1, 50,
			 0, 50, 1, 84, 0, 84, 1))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-76")
})

test_that("Statistical path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-76")
})


context('Model number 82 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded3"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded4"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded3",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded4")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 82))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")
})


context('Model number 82 - factors')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "facGender", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "facGender",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded3"),
        list(processDependent = "contNormal", processIndependent = "facGender",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded4"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded3",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded4")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 82))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")
})


context('Model number 83 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded1",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 83))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-83")
})


context('Model number 84 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded1",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "JaspProcess_Mediator_Encoded2",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 84))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-84")
})


context('Model number 85 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded1",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "JaspProcess_Mediator_Encoded2",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "contNormal",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 85))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-85")
})


context('Model number 86 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded1",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "contNormal",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1")), residualCovariances = TRUE,
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE,
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 86))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-86")
})


context('Model number 87 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded2",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 87))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-87")
})


context('Model number 88 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded2",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 88))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-88")
})


context('Model number 89 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded2",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 89))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-89")
})


context('Model number 90 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded2",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 90))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-90")
})


context('Model number 91 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded2",
            processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 91))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-91")
})


context('Model number 92 - continuous')




options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$pathPlotsLegend <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "",
    modelNumberMediators = list(), modelNumberModeratorW = "",
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE,
    processRelationships = list(list(processDependent = "contNormal",
        processIndependent = "contGamma", processType = "mediators",
        processVariable = "JaspProcess_Mediator_Encoded1"), list(
        processDependent = "contNormal", processIndependent = "contGamma",
        processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "mediators", processVariable = "JaspProcess_Mediator_Encoded2"),
        list(processDependent = "JaspProcess_Mediator_Encoded1",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "JaspProcess_Mediator_Encoded2",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "contNormal",
            processIndependent = "contGamma", processType = "moderators",
            processVariable = "contcor1"), list(processDependent = "JaspProcess_Mediator_Encoded2",
            processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded1",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "JaspProcess_Mediator_Encoded2",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug", options)


test_that("Model numbers table results match", {
	table <- results[["results"]][["modelNumberTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("Model 1", 92))
})

test_that("Conceptual path plot matches", {
	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")
})
