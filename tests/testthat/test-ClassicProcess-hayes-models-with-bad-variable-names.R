### This code was automatically generated by 'generate-tests-for-bad-var-names.R'

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(961.745418061986, 987.797119921867, 2, "Model 1", 100, -470.872709030993,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544850082631131, 0.0642075341001774, -0.240321274265477, "Y",
			 "<unicode>", 0.121930585104781, "W", 0.155374696049386, -1.54672080059349,
			 1.68041145454125, 2.96919309445352, 2.32480227449739, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776867860332, 7.07106400041802,
			 0.776405337504771, 1.37186438136396, 1.07413485943436, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.151905608612222, 7.07106781143526,
			 0.732634775738868, 1.29452458982638, 1.01357968278263, "Y",
			 "<unicode>", 1.53743684450092e-12, "Y", 0.143341872228171, 7.07106490955563
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16569395359711, 0.204085014407693, 0.0191955304052916,
			 "W", "M", "<unicode>", 0.838754651525841, 0.0943331027818806,
			 0.203486685365115, 50, -0.161247760244973, 0.1088200297932,
			 -0.0262138652258869, "W", "M", "<unicode>", 0.703586197486989,
			 0.068896110379689, -0.380483964645048, 84, -0.278343730144802,
			 0.126798831800759, -0.0757724491720214, "W", "M", "<unicode>",
			 0.463478577712245, 0.103354593538778, -0.733130928946979))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161055937745397, 0.108967563443863, -0.0260441871507668, "W",
			 "<unicode>", 0.70536882046419, "M", 0.0688848119963353, -0.378083156446044,
			 -0.0878908629922849, 0.604701009289819, 0.258405073148767, "Y",
			 "<unicode>", 0.143598843509078, "M", 0.176684846697485, 1.46251972355728,
			 -0.18286417583744, 0.0896344642329923, -0.0466148558022241,
			 "W:Y", "<unicode>", 0.50250042972327, "M", 0.0695162365788013,
			 -0.670560693391148))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16569395359711, 0.204085014407693, 0.0191955304052916,
			 "Total", "W", "M", "<unicode>", 0.838754651525841, 0.0943331027818806,
			 0.203486685365115, 50, -0.161247760244973, 0.1088200297932,
			 -0.0262138652258869, "Total", "W", "M", "<unicode>", 0.703586197486989,
			 0.068896110379689, -0.380483964645048, 84, -0.278343730144802,
			 0.126798831800759, -0.0757724491720214, "Total", "W", "M", "<unicode>",
			 0.463478577712245, 0.103354593538778, -0.733130928946979))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(596.346471143819, 622.3981730037, 2, "Model 1", 100, -288.17323557191,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962242574014883, 0.0896221577540205, 0.0399998660069358,
			 "medexperimental", "<unicode>", 0.114129593712154, "sm", 0.0253179610128038,
			 1.57990076636531, 0.180704780462425, 0.319295092441708, 0.249999936452067,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553210856081,
			 7.07106960920326, 0.758630464114515, 1.34045718397417, 1.04954382404434,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.148427911035364,
			 7.07106781145954, 0.180704780436992, 0.319295092352504, 0.249999936394748,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553210693398, 7.07106961083572))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "s",
			 "M", 0, "<unicode>", 0.036378010371507, "m", 0.293546322878014,
			 2.09267685884226, -0.258993824622392, 0.891686616803016, 0.316346396090312,
			 "s", "M", 1, "<unicode>", 0.281180548821822, "m", 0.293546322917622,
			 1.07767112510923))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "sm",
			 "<unicode>", 0.036378010371507, "M", 0.293546322878014, 2.09267685884226,
			 -0.427566567127894, 0.72311387432658, 0.147773653599343, "medexperimental",
			 "<unicode>", 0.61467724160965, "M", 0.293546322925037, 0.503408293883075,
			 -1.11160514390099, 0.515702742311497, -0.297951200794745, "sm:medexperimental",
			 "<unicode>", 0.472931529552078, "M", 0.415137191052612, -0.717717437070063
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "Total",
			 "s", "M", 0, "<unicode>", 0.036378010371507, "m", 0.293546322878014,
			 2.09267685884226, -0.258993824622392, 0.891686616803016, 0.316346396090312,
			 "Total", "s", "M", 1, "<unicode>", 0.281180548821822, "m", 0.293546322917622,
			 1.07767112510923))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1199.86016487143, 1241.54288784724, 6, "Model 1", 100, -583.930082435716,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403938892429879, 0.194627164487928, -0.104655863970976, "Z",
			 "<unicode>", 0.493106011784507, "W", 0.152698228548897, -0.685377066685898,
			 -0.544853906416774, 0.0642071273354463, -0.240323389540664,
			 "Y", "<unicode>", 0.121929394261216, "W", 0.155375567754412,
			 -1.54672573696092, 1.6804147319274, 2.96920452585506, 2.32480962889123,
			 "W", "<unicode>", 1.53765888910584e-12, "W", 0.328778948004521,
			 7.07104163147106, 0.770361877035362, 1.36118593001358, 1.06577390352447,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150723191252126,
			 7.07106779434939, 0.424979599250991, 0.896765893922282, 0.660872746586637,
			 "Z", "<unicode>", 3.99688246943697e-08, "Y", 0.120355858166957,
			 5.49098944290589, 0.732635748188917, 1.29452798168317, 1.01358186493604,
			 "Y", "<unicode>", 1.53765888910584e-12, "Y", 0.143342489435109,
			 7.07104968617761, 0.721542954515916, 1.27492759928265, 0.998235276899282,
			 "Z", "<unicode>", 1.53765888910584e-12, "Z", 0.141172146307728,
			 7.07104979988987))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17515664262081, 0.19898054114065, 0.01191194925992,
			 "W", "M", "<unicode>", 0.900678369373086, 0.0954449129454946,
			 0.124804443655604, 50, 16, -0.250367117827483, 0.256906430759303,
			 0.00326965646591023, "W", "M", "<unicode>", 0.979842723600564,
			 0.12940889541545, 0.0252660874309561, 84, 16, -0.477660609823986,
			 0.465335994400638, -0.00616230771167361, "W", "M", "<unicode>",
			 0.97956362297046, 0.240564778654828, -0.025616001420206, 16,
			 50, -0.285600027728774, 0.255933757762182, -0.0148331349832961,
			 "W", "M", "<unicode>", 0.914494958080953, 0.138148912368417,
			 -0.107370624415333, 50, 50, -0.158318473742292, 0.11136761818768,
			 -0.0234754277773059, "W", "M", "<unicode>", 0.732938811960452,
			 0.0687987366240455, -0.341218878852218, 84, 50, -0.322690905724989,
			 0.25687612181521, -0.0329073919548897, "W", "M", "<unicode>",
			 0.823869686646883, 0.147851448320416, -0.222570643228158, 16,
			 84, -0.537941056636039, 0.445576098927959, -0.04618247885404,
			 "W", "M", "<unicode>", 0.853961741174023, 0.250901843942505,
			 -0.184065920474554, 50, 84, -0.350939244232729, 0.241289700936629,
			 -0.0548247716480498, "W", "M", "<unicode>", 0.716693119624935,
			 0.15108158870285, -0.362881884674116, 84, 84, -0.277371899322844,
			 0.148858427671577, -0.0642567358256336, "W", "M", "<unicode>",
			 0.554552407181609, 0.108734224290975, -0.590952262221336))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.157311735263844, 0.112102291166833, -0.0226047220485055, "W",
			 "<unicode>", 0.742235177229438, "M", 0.0687293308845928, -0.328894836564936,
			 -0.219434320875926, 0.758255109178322, 0.269410394151198, "Y",
			 "<unicode>", 0.280067146370022, "M", 0.249415151953336, 1.08016851438762,
			 -0.250026106779323, 0.232282676073244, -0.0088717153530394,
			 "W:Y", "<unicode>", 0.942518990072331, "M", 0.123040215702165,
			 -0.0721041921327132, -0.585977065352088, 0.452208104537436,
			 -0.0668844804073256, "Z", "<unicode>", 0.800624398022235, "M",
			 0.264848022228622, -0.252539097118836, -0.259037001544805, 0.202955885496963,
			 -0.0280405580239212, "W:Z", "<unicode>", 0.811943781098948,
			 "M", 0.117857493986091, -0.237919177436697))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17515664262081, 0.19898054114065, 0.01191194925992,
			 "Total", "W", "M", "<unicode>", 0.900678369373086, 0.0954449129454946,
			 0.124804443655604, 50, 16, -0.250367117827483, 0.256906430759303,
			 0.00326965646591023, "Total", "W", "M", "<unicode>", 0.979842723600564,
			 0.12940889541545, 0.0252660874309561, 84, 16, -0.477660609823986,
			 0.465335994400638, -0.00616230771167361, "Total", "W", "M",
			 "<unicode>", 0.97956362297046, 0.240564778654828, -0.025616001420206,
			 16, 50, -0.285600027728774, 0.255933757762182, -0.0148331349832961,
			 "Total", "W", "M", "<unicode>", 0.914494958080953, 0.138148912368417,
			 -0.107370624415333, 50, 50, -0.158318473742292, 0.11136761818768,
			 -0.0234754277773059, "Total", "W", "M", "<unicode>", 0.732938811960452,
			 0.0687987366240455, -0.341218878852218, 84, 50, -0.322690905724989,
			 0.25687612181521, -0.0329073919548897, "Total", "W", "M", "<unicode>",
			 0.823869686646883, 0.147851448320416, -0.222570643228158, 16,
			 84, -0.537941056636039, 0.445576098927959, -0.04618247885404,
			 "Total", "W", "M", "<unicode>", 0.853961741174023, 0.250901843942505,
			 -0.184065920474554, 50, 84, -0.350939244232729, 0.241289700936629,
			 -0.0548247716480498, "Total", "W", "M", "<unicode>", 0.716693119624935,
			 0.15108158870285, -0.362881884674116, 84, 84, -0.277371899322844,
			 0.148858427671577, -0.0642567358256336, "Total", "W", "M", "<unicode>",
			 0.554552407181609, 0.108734224290975, -0.590952262221336))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(888.390142595547, 930.072865571357, 6, "Model 1", 100, -428.195071297774,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250713701616, 0.0341991764117861, -0.0645257686449151, "Z",
			 "<unicode>", 0.200188229808427, "sm", 0.0503707955020761, -1.28101547735643,
			 -0.00962232683594784, 0.0896223175830575, 0.0399999953735549,
			 "medexperimental", "<unicode>", 0.114128645513458, "sm", 0.0253179765551394,
			 1.57990490616183, 0.180704804599385, 0.319295176626548, 0.249999990612966,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553364042261,
			 7.07106807738034, 0.756348936485436, 1.3364258535154, 1.04638739500042,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147981524560027,
			 7.07106781141427, -0.170527239521493, 0.0272978261643685, -0.0716147066785622,
			 "Z", "<unicode>", 0.155883213071517, "medexperimental", 0.0504665053149651,
			 -1.41905420697569, 0.180704807996422, 0.319295188478254, 0.249999998237338,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553385610694, 7.07106786166146, 0.721541791202579, 1.27492354169259,
			 0.998232666447587, "Z", "<unicode>", 1.53743684450092e-12, "Z",
			 0.141171407958263, 7.07106829126978))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.161065462194807, 1.33098043663047, 0.584957487217831, "s",
			 "M", 0, "<unicode>", 0.124339818093537, "m", 0.380630947964948,
			 1.53681010528786, 16, -0.358875044039608, 1.00789206259699,
			 0.32450850927869, "s", "M", 1, "<unicode>", 0.352008831946516,
			 "m", 0.348671485143983, 0.930699879701047, 50, 0.0267424851522365,
			 1.18684632306517, 0.606794404108703, "s", "M", 0, "<unicode>",
			 0.0403326883420316, "m", 0.295950294766558, 2.05032539192885,
			 50, -0.238349615477602, 0.931040467816727, 0.346345426169562,
			 "s", "M", 1, "<unicode>", 0.245646338215588, "m", 0.298319278445504,
			 1.16098908516511, 84, -0.0593588649715731, 1.32414010993462,
			 0.632390622481523, "s", "M", 0, "<unicode>", 0.0731682258865887,
			 "m", 0.352939897319302, 1.79177992424417, 84, -0.399560650480822,
			 1.14344393956559, 0.371941644542382, "s", "M", 1, "<unicode>",
			 0.344710124067758, "m", 0.393630852969093, 0.944899622925609
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0242260928370315, 1.18799361532788, 0.606109854082454, "sm",
			 "<unicode>", 0.0411947062807585, "M", 0.296884925353347, 2.04156493752949,
			 -0.427734844509414, 0.721274257656449, 0.146769706573517, "medexperimental",
			 "<unicode>", 0.616571355555424, "M", 0.293119953026969, 0.500715509326018,
			 -1.08932599531723, 0.568428039438946, -0.260448977939141, "sm:medexperimental",
			 "<unicode>", 0.53798818427836, "M", 0.42290420840187, -0.615858089763074,
			 -0.226807989822628, 0.320133541185831, 0.0466627756816015, "Z",
			 "<unicode>", 0.738053637805202, "M", 0.139528464635744, 0.334431944072633,
			 -0.39268563820285, 0.438474937617554, 0.022894649707352, "sm:Z",
			 "<unicode>", 0.914014745958629, "M", 0.212034655324407, 0.10797598002234
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.161065462194807, 1.33098043663047, 0.584957487217831, "Total",
			 "s", "M", 0, "<unicode>", 0.124339818093537, "m", 0.380630947964948,
			 1.53681010528786, 16, -0.358875044039608, 1.00789206259699,
			 0.32450850927869, "Total", "s", "M", 1, "<unicode>", 0.352008831946516,
			 "m", 0.348671485143983, 0.930699879701047, 50, 0.0267424851522365,
			 1.18684632306517, 0.606794404108703, "Total", "s", "M", 0, "<unicode>",
			 0.0403326883420316, "m", 0.295950294766558, 2.05032539192885,
			 50, -0.238349615477602, 0.931040467816727, 0.346345426169562,
			 "Total", "s", "M", 1, "<unicode>", 0.245646338215588, "m", 0.298319278445504,
			 1.16098908516511, 84, -0.0593588649715731, 1.32414010993462,
			 0.632390622481523, "Total", "s", "M", 0, "<unicode>", 0.0731682258865887,
			 "m", 0.352939897319302, 1.79177992424417, 84, -0.399560650480822,
			 1.14344393956559, 0.371941644542382, "Total", "s", "M", 1, "<unicode>",
			 0.344710124067758, "m", 0.393630852969093, 0.944899622925609
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "Y", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1202.63140796962, 1249.52447131741, 12, "Model 1", 100, -583.315703984811,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403934719485908, 0.194627523139163, -0.104653598173373, "Z",
			 "<unicode>", 0.493112617592176, "W", 0.152697255497156, -0.685366595703628,
			 -0.54484893124694, 0.0642081196599298, -0.240320405793505, "Y",
			 "<unicode>", 0.121931586882155, "W", 0.155374551703765, -1.54671664798556,
			 1.68041109906878, 2.96919185457515, 2.32480147682197, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776642242437, 7.07106642663404,
			 0.76095392253491, 1.34456260813113, 1.05275826533302, "M", "<unicode>",
			 1.53743684450092e-12, "M", 0.14888250248465, 7.0710677733373,
			 0.424979147181667, 0.896762978356815, 0.660871062769241, "Z",
			 "<unicode>", 3.99655020189016e-08, "Y", 0.120355229712515, 5.49100412460533,
			 0.732634580828943, 1.29452390997947, 1.01357924540421, "Y",
			 "<unicode>", 1.53743684450092e-12, "Y", 0.143341748517483, 7.07106796091987,
			 0.721541757181454, 1.27492342302875, 0.998232590105103, "Z",
			 "<unicode>", 1.53743684450092e-12, "Z", 0.141171386365337, 7.07106883204916
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220182733576812, 0.191149893780464, -0.0145164198981741,
			 "W", "M", "<unicode>", 0.889972550313695, 0.104933720874928,
			 -0.138338941735197, 50, 16, -0.253451043483989, 0.257888208611024,
			 0.00221858256351789, "W", "M", "<unicode>", 0.986430505331174,
			 0.130446083736332, 0.0170076594097088, 84, 16, -0.48040495075626,
			 0.521370372329285, 0.0204827107865124, "W", "M", "<unicode>",
			 0.936119180000883, 0.255559625326644, 0.080148461480691, 16,
			 50, -0.338190016263921, 0.282578208006221, -0.0278059041288497,
			 "W", "M", "<unicode>", 0.860620553730323, 0.158362150826924,
			 -0.1755842793474, 50, 50, -0.212793523976785, 0.161540545055392,
			 -0.0256264894606964, "W", "M", "<unicode>", 0.788426950806225,
			 0.0954951397027894, -0.268353861154128, 84, 50, -0.330684915806524,
			 0.284189045112793, -0.0232479353468655, "W", "M", "<unicode>",
			 0.882177345274006, 0.1568584845868, -0.148209613321879, 16,
			 84, -0.687596860251758, 0.600830421316987, -0.0433832194673854,
			 "W", "M", "<unicode>", 0.894992460157817, 0.328686468662612,
			 -0.131989672845088, 50, 84, -0.434125868485485, 0.31759549278684,
			 -0.0582651878493224, "W", "M", "<unicode>", 0.761257573720771,
			 0.19176917718943, -0.303829784865625, 84, 84, -0.289302187361277,
			 0.140288257583636, -0.0745069648888202, "W", "M", "<unicode>",
			 0.496592262580247, 0.109591412988572, -0.679861340017484))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209965686053068, 0.160438800652554, -0.0247634427002567, "W",
			 "<unicode>", 0.793269540287346, "M", 0.0944926768112387, -0.262067321362107,
			 -0.264231158096318, 0.71891588648238, 0.227342364193031, "Y",
			 "<unicode>", 0.364701994714644, "M", 0.250807426139877, 0.90644191717928,
			 -0.238546135055623, 0.243957487573035, 0.00270567625870588,
			 "W:Y", "<unicode>", 0.982462873758645, "M", 0.123089920640018,
			 0.0219812982625828, -0.62830373750896, 0.464182018987634, -0.0820608592606628,
			 "Z", "<unicode>", 0.768420900113276, "M", 0.278700467231536,
			 -0.294441053780111, -0.276763043740878, 0.218489436717651, -0.0291368035116134,
			 "W:Z", "<unicode>", 0.817611528456655, "M", 0.126342240052628,
			 -0.230618069613745, -0.168390618628367, 0.137059128603864, -0.0156657450122515,
			 "W:Y:Z", "<unicode>", 0.840664801536042, "M", 0.077922285726059,
			 -0.201043191511675, -0.234142199130234, 0.527680821946979, 0.146769311408372,
			 "Y:Z", "<unicode>", 0.450131836781496, "M", 0.194346178574294,
			 0.755195252538838))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220182733576812, 0.191149893780464, -0.0145164198981741,
			 "Total", "W", "M", "<unicode>", 0.889972550313695, 0.104933720874928,
			 -0.138338941735197, 50, 16, -0.253451043483989, 0.257888208611024,
			 0.00221858256351789, "Total", "W", "M", "<unicode>", 0.986430505331174,
			 0.130446083736332, 0.0170076594097088, 84, 16, -0.48040495075626,
			 0.521370372329285, 0.0204827107865124, "Total", "W", "M", "<unicode>",
			 0.936119180000883, 0.255559625326644, 0.080148461480691, 16,
			 50, -0.338190016263921, 0.282578208006221, -0.0278059041288497,
			 "Total", "W", "M", "<unicode>", 0.860620553730323, 0.158362150826924,
			 -0.1755842793474, 50, 50, -0.212793523976785, 0.161540545055392,
			 -0.0256264894606964, "Total", "W", "M", "<unicode>", 0.788426950806225,
			 0.0954951397027894, -0.268353861154128, 84, 50, -0.330684915806524,
			 0.284189045112793, -0.0232479353468655, "Total", "W", "M", "<unicode>",
			 0.882177345274006, 0.1568584845868, -0.148209613321879, 16,
			 84, -0.687596860251758, 0.600830421316987, -0.0433832194673854,
			 "Total", "W", "M", "<unicode>", 0.894992460157817, 0.328686468662612,
			 -0.131989672845088, 50, 84, -0.434125868485485, 0.31759549278684,
			 -0.0582651878493224, "Total", "W", "M", "<unicode>", 0.761257573720771,
			 0.19176917718943, -0.303829784865625, 84, 84, -0.289302187361277,
			 0.140288257583636, -0.0745069648888202, "Total", "W", "M", "<unicode>",
			 0.496592262580247, 0.109591412988572, -0.679861340017484))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "med", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(887.37892431538, 934.271987663166, 12, "Model 1", 100, -425.68946215769,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250713701575, 0.034199176411745, -0.0645257686449151, "Z",
			 "<unicode>", 0.200188229808239, "sm", 0.0503707955020551, -1.28101547735696,
			 -0.00962232683601574, 0.0896223175831254, 0.0399999953735549,
			 "medexperimental", "<unicode>", 0.114128645513953, "sm", 0.025317976555174,
			 1.57990490615966, 0.180704804599391, 0.319295176626542, 0.249999990612966,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553364042231,
			 7.07106807738094, 0.719380656934087, 1.27110499138571, 0.995242824159901,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.140748589975009,
			 7.07106781202291, -0.170527239521602, 0.0272978261644779, -0.0716147066785622,
			 "Z", "<unicode>", 0.155883213071974, "medexperimental", 0.0504665053150208,
			 -1.41905420697412, 0.180704807996413, 0.319295188478263, 0.249999998237338,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553385610739, 7.07106786166056, 0.721541791202229, 1.27492354169294,
			 0.998232666447587, "Z", "<unicode>", 1.53743684450092e-12, "Z",
			 0.141171407958442, 7.07106829126084))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.879096135662962, 0.89332247553067, 0.00711316993385364,
			 "s", "M", 0, "<unicode>", 0.987448457027282, "m", 0.452155913367349,
			 0.0157316751225912, 16, -0.22623610084653, 1.45144461316699,
			 0.61260425616023, "s", "M", 1, "<unicode>", 0.152327153056169,
			 "m", 0.42798763835633, 1.43135969653916, 50, -0.0706048608473389,
			 1.07522417216051, 0.502309655656585, "s", "M", 0, "<unicode>",
			 0.0857196942797964, "m", 0.292308695987784, 1.71842186890525,
			 50, -0.295309938962812, 0.864575094355603, 0.284632577696395,
			 "s", "M", 1, "<unicode>", 0.336080006918855, "m", 0.295894476242278,
			 0.96193947690777, 84, 0.299944752023776, 1.86556713852616, 1.08275594527497,
			 "s", "M", 0, "<unicode>", 0.00670905736716132, "m", 0.399400805028005,
			 2.71095083345926, 84, -1.01442802676004, 0.814826886236355,
			 -0.0998005702618417, "s", "M", 1, "<unicode>", 0.830653424053209,
			 "m", 0.466655236378149, -0.213863603109705))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0900823230834538, 1.0636545072775, 0.486786092097024, "sm",
			 "<unicode>", 0.0981476435559117, "M", 0.294326028299878, 1.653900930573,
			 -0.45671062992195, 0.690161425497172, 0.116725397787611, "medexperimental",
			 "<unicode>", 0.689923271371556, "M", 0.292574778022837, 0.39895919455675,
			 -1.0101170732093, 0.626372747670924, -0.191872162769187, "sm:medexperimental",
			 "<unicode>", 0.645805844040443, "M", 0.417479564366653, -0.459596538719856,
			 -0.308134865845155, 0.319885281038118, 0.00587520759648157,
			 "Z", "<unicode>", 0.970746996836771, "M", 0.160212165079822,
			 0.0366714200107987, -0.075954181167165, 1.11431963665622, 0.519182727744529,
			 "sm:Z", "<unicode>", 0.0872983994322345, "M", 0.303646859639288,
			 1.70982413044312, -1.7325379163599, 0.00645663268079, -0.863040641839553,
			 "sm:medexperimental:Z", "<unicode>", 0.0517256684177121, "M",
			 0.443629210219589, -1.94540986472095, -0.448506068173794, 0.741301251482179,
			 0.146397591654192, "medexperimental:Z", "<unicode>", 0.629578553594368,
			 "M", 0.303527852817965, 0.482320124150159))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.879096135662962, 0.89332247553067, 0.00711316993385364,
			 "Total", "s", "M", 0, "<unicode>", 0.987448457027282, "m", 0.452155913367349,
			 0.0157316751225912, 16, -0.22623610084653, 1.45144461316699,
			 0.61260425616023, "Total", "s", "M", 1, "<unicode>", 0.152327153056169,
			 "m", 0.42798763835633, 1.43135969653916, 50, -0.0706048608473389,
			 1.07522417216051, 0.502309655656585, "Total", "s", "M", 0, "<unicode>",
			 0.0857196942797964, "m", 0.292308695987784, 1.71842186890525,
			 50, -0.295309938962812, 0.864575094355603, 0.284632577696395,
			 "Total", "s", "M", 1, "<unicode>", 0.336080006918855, "m", 0.295894476242278,
			 0.96193947690777, 84, 0.299944752023776, 1.86556713852616, 1.08275594527497,
			 "Total", "s", "M", 0, "<unicode>", 0.00670905736716132, "m",
			 0.399400805028005, 2.71095083345926, 84, -1.01442802676004,
			 0.814826886236355, -0.0998005702618417, "Total", "s", "M", 1,
			 "<unicode>", 0.830653424053209, "m", 0.466655236378149, -0.213863603109705
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(459.709342975141, 483.155874649034, 0, "Model 1", 100, -220.854671487571,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089500486, 2.96919114281872, 2.32480101891179, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512726659, 7.07106781938708,
			 0.79850843700121, 1.41091930982898, 1.1047138734151, "M", "<unicode>",
			 1.53743684450092e-12, "M", 0.156230134241852, 7.07106781144378,
			 0.00468047959390449, 0.00827014307736615, 0.00647531133563532,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000915747307546586,
			 7.07106783964627))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, "W",
			 "M", "", "<unicode>", "", 0.536343446165773, 0.0699572528327317,
			 -0.618351825661737, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.843493105517029, 0.0120012348671278, 0.197427379485498))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, "W",
			 "<unicode>", 0.536343446165773, "M", 0.0699572528327317, -0.618351825661737,
			 -2.81958314086857, 2.30044871074282, -0.259567215062877, "jasp",
			 "<unicode>", 0.842476880392771, "M", 1.30615457528749, -0.198726261021399,
			 -0.0194720937763586, 0.00121576390948324, -0.00912816493343769,
			 "W", "<unicode>", 0.0837015035455533, "jasp", 0.00527761169312933,
			 -1.72960146827801))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023198584645, 0.0942455532706607, -0.0408888226569923, "Total",
			 "W", "M", "<unicode>", 0.553151760947466, 0.0689473770914036,
			 -0.593043918157843, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, "Total indirect", "W", "M", "<unicode>",
			 0.843493105517029, 0.0120012348671278, 0.197427379485498))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(234.766135212086, 258.212666885979, 0, "Model 1", 100, -108.383067606043,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704810207797, 0.319295196191503, 0.25000000319965, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553399646345,
			 7.07106772130382, 0.762533966062566, 1.34735445145525, 1.05494420875891,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.149191640766277,
			 7.07106781144378, 0.0048066281871781, 0.00849304083605079, 0.00664983451161445,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000940428670616055,
			 7.07106739659296))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991965639, 0.868598726146002, 0.465400612671283, "s",
			 "M", "", "<unicode>", "", 0.0236768306591097, "m", 0.205717103301435,
			 2.26233310309321, -0.0219205602251843, 0.0213787048213383, -0.000270927701922977,
			 "s", "jasp", "M", "<unicode>", "<unicode>", 0.980431952510507,
			 "m", 0.0110459338508416, -0.0245273695806476))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991965639, 0.868598726146002, 0.465400612671283, "sm",
			 "<unicode>", 0.0236768306591097, "M", 0.205717103301435, 2.26233310309321,
			 -2.43771284938872, 2.49956339312939, 0.0309252718703352, "jasp",
			 "<unicode>", 0.980411525583682, "M", 1.25953238974357, 0.0245529786468067,
			 -0.0407263692122695, 0.0232049257107259, -0.0087607217507718,
			 "sm", "<unicode>", 0.591156408942288, "jasp", 0.0163093034941655,
			 -0.537160998561702))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0625107998260226, 0.867748570112698, 0.46512968496936, "Total",
			 "s", "M", "<unicode>", 0.0235575795563017, "m", 0.205421573212132,
			 2.26426892607348, -0.0219205602251843, 0.0213787048213383, -0.000270927701922977,
			 "Total indirect", "s", "M", "<unicode>", 0.980431952510507,
			 "m", 0.0110459338508416, -0.0245273695806476))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(994.47021560483, 1056.99430006854, 6, "Model 1", 100, -473.235107802415,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403936335154203, 0.194627260090051, -0.104654537532076, "Z",
			 "<unicode>", 0.493109713711227, "W", 0.15269760055941, -0.685371198687292,
			 -0.544846693697774, 0.0642098763845074, -0.240318408656634,
			 "Y", "<unicode>", 0.121934393179746, "W", 0.155374429042177,
			 -1.54670501534972, 1.68041034701259, 2.96918923146479, 2.32479978923869,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776164923927,
			 7.07107155951102, 0.770087764351801, 1.36070158389967, 1.06539467412574,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150669559289497,
			 7.07106783314263, 0.00462621316576298, 0.00817425856321058,
			 0.00640023586448678, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000905130253778673, 7.07106611205131, 0.424979799965003,
			 0.896765348125679, 0.660872574045341, "Z", "<unicode>", 3.99671826745163e-08,
			 "Y", 0.120355667727076, 5.49099669775393, 0.732634727383019,
			 1.29452442114643, 1.01357957426473, "Y", "<unicode>", 1.53743684450092e-12,
			 "Y", 0.143341841532683, 7.07106566670988, 0.721543052421166,
			 1.274927940758, 0.998235496589583, "Z", "<unicode>", 1.53765888910584e-12,
			 "Z", 0.1411722084441, 7.07104824378274))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17662603987508, 0.198183782734888, 0.0107788714299038,
			 "W", "M", "", "<unicode>", "", 0.910244429525087, 0.0956165076415742,
			 0.112730235560467, 50, 16, -0.25364284712116, 0.255685959288872,
			 0.00102155608385586, "W", "M", "", "<unicode>", "", 0.993726965890373,
			 0.129933205514885, 0.00786216333082642, 84, 16, -0.482413938292148,
			 0.463159311305014, -0.00962731349356722, "W", "M", "", "<unicode>",
			 "", 0.968164417379325, 0.241222098226223, -0.0399105785264272,
			 16, 50, -0.287055904057026, 0.254966162045428, -0.0160448710057994,
			 "W", "M", "", "<unicode>", "", 0.907623036583779, 0.138273476037788,
			 -0.116037229015741, 50, 50, -0.162770699722108, 0.111166327018414,
			 -0.0258021863518474, "W", "M", "", "<unicode>", "", 0.711964612252681,
			 0.0698831786964716, -0.369218842547443, 84, 50, -0.328512602408522,
			 0.255610490549981, -0.0364510559292705, "W", "M", "", "<unicode>",
			 "", 0.806754226053921, 0.149013731263939, -0.244615416445796,
			 16, 84, -0.539344034334301, 0.444371205631329, -0.0474864143514864,
			 "W", "M", "", "<unicode>", "", 0.8499166278163, 0.250952376606165,
			 -0.189224804298266, 50, 84, -0.354370228989922, 0.239882769594853,
			 -0.0572437296975343, "W", "M", "", "<unicode>", "", 0.705726058269976,
			 0.15159793834789, -0.37760229671574, 84, 84, -0.284292547035944,
			 0.148507348486029, -0.0678925992749574, "W", "M", "", "<unicode>",
			 "", 0.538612456898277, 0.110410165425447, -0.614912576331577,
			 16, 16, -0.0111496082978387, 0.0134144431296098, 0.00113241741588554,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.856594411292176,
			 0.00626645479743676, 0.180711016434483, 50, 16, -0.0215878488296315,
			 0.0260832588797613, 0.00224770502506489, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.853365816217869, 0.0121612203299184, 0.184825614871494,
			 84, 16, -0.0336129662687324, 0.040542765670904, 0.00346489970108582,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.854674664856362,
			 0.0189176261718499, 0.183157213786247, 16, 50, -0.0123697654317444,
			 0.0147924475400767, 0.00121134105416614, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.86122478695253, 0.00692926328903828, 0.174815273087172,
			 50, 50, -0.0219771855611938, 0.0266304428878848, 0.0023266286633455,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.851167232353355,
			 0.0124001330719568, 0.187629330253498, 84, 50, -0.0336750306948286,
			 0.0407626773735615, 0.00354382333936643, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.851958930580048, 0.0189895601795608, 0.186619558634159,
			 16, 84, -0.0151131483694201, 0.0177208517140655, 0.0013038516723227,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.876299487185875,
			 0.00837617434362977, 0.155661954829569, 50, 84, -0.0233255079589225,
			 0.0281637865219266, 0.00241913928150205, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.853879051833782, 0.0131352654658427, 0.18417132777353,
			 84, 84, -0.034353275420357, 0.041625943335403, 0.00363633395752298,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.851185420591928,
			 0.0193828099279054, 0.187606129918643))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161747319500839, 0.111897622706291, -0.0249248483972736, "W",
			 "<unicode>", 0.721057975671585, "M", 0.0698086659667235, -0.357045189907436,
			 -2.77216347423196, 2.2853309199467, -0.243416277142631, "jasp",
			 "<unicode>", 0.850355060471791, "M", 1.29020084911548, -0.188665413845844,
			 -0.218443524920422, 0.759300830141341, 0.27042865261046, "Y",
			 "<unicode>", 0.278280479935642, "M", 0.249429163692314, 1.08419019094355,
			 -0.251420994229452, 0.231388318544134, -0.0100163378426592,
			 "W:Y", "<unicode>", 0.93518537786013, "M", 0.123167904252814,
			 -0.0813226294903879, -0.584165711491852, 0.45487817184451, -0.0646437698236712,
			 "Z", "<unicode>", 0.807326070685034, "M", 0.265067085806731,
			 -0.243877015612587, -0.259079968576959, 0.202833916080203, -0.0281230262483783,
			 "W:Z", "<unicode>", 0.811369455047622, "M", 0.117837339946213,
			 -0.238659717380034, -0.0199698669730401, 0.000907977167533359,
			 -0.00953094490275338, "W", "<unicode>", 0.0735365208536713,
			 "jasp", 0.00532607851604806, -1.78948636863606, -0.0336994081748133,
			 0.0420651977380579, 0.0041828947816223, "Y", "<unicode>", 0.828663770322511,
			 "jasp", 0.0193280607476701, 0.21641564749979, -0.0233913482400559,
			 0.0139844622541412, -0.00470344299295736, "W:Y", "<unicode>",
			 0.621806858075437, "jasp", 0.00953482073880252, -0.493291182058245,
			 -0.0310212766175894, 0.0494313577717845, 0.00920504057709755,
			 "Z", "<unicode>", 0.653791583572263, "jasp", 0.0205240083552489,
			 0.448501112344531, -0.0182406683499735, 0.0175607916478939,
			 -0.000339938351039806, "W:Z", "<unicode>", 0.970309513819926,
			 "jasp", 0.00913319333423084, -0.0372200980095024))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175157302511728, 0.198979880203307, 0.0119112888457894,
			 "Total", "W", "M", "<unicode>", 0.900683847090116, 0.0954449126785446,
			 0.124797524682182, 50, 16, -0.250367512509345, 0.256906034727186,
			 0.00326926110892075, "Total", "W", "M", "<unicode>", 0.979845160385428,
			 0.129408895070991, 0.0252630323991817, 84, 16, -0.477660714675628,
			 0.465335887090665, -0.00616241379248139, "Total", "W", "M",
			 "<unicode>", 0.979563271192916, 0.240564778027691, -0.0256164424526522,
			 16, 50, -0.285600421980659, 0.255933362077392, -0.0148335299516333,
			 "Total", "W", "M", "<unicode>", 0.91449268981178, 0.138148912002874,
			 -0.107373483703764, 50, 50, -0.15831860327848, 0.111367487901476,
			 -0.0234755576885019, "Total", "W", "M", "<unicode>", 0.732937389822532,
			 0.0687987364327114, -0.34122076807998, 84, 50, -0.322690745592927,
			 0.256876280413119, -0.032907232589904, "Total", "W", "M", "<unicode>",
			 0.823870525166097, 0.147851447929043, -0.222569565944981, 16,
			 84, -0.537941139180713, 0.445576013822386, -0.0461825626791637,
			 "Total", "W", "M", "<unicode>", 0.853961478706265, 0.250901843289203,
			 -0.184066255049116, 50, 84, -0.350939062216749, 0.241289881384685,
			 -0.0548245904160323, "Total", "W", "M", "<unicode>", 0.716694015032825,
			 0.151081588302862, -0.362880686070956, 84, 84, -0.277371428220891,
			 0.148858897586022, -0.0642562653174344, "Total", "W", "M", "<unicode>",
			 0.554555305480186, 0.108734223988033, -0.590947936727871, 16,
			 16, -0.0111496082978387, 0.0134144431296098, 0.00113241741588554,
			 "Total indirect", "W", "M", "<unicode>", 0.856594411292176,
			 0.00626645479743676, 0.180711016434483, 50, 16, -0.0215878488296315,
			 0.0260832588797613, 0.00224770502506489, "Total indirect", "W",
			 "M", "<unicode>", 0.853365816217869, 0.0121612203299184, 0.184825614871494,
			 84, 16, -0.0336129662687324, 0.040542765670904, 0.00346489970108582,
			 "Total indirect", "W", "M", "<unicode>", 0.854674664856362,
			 0.0189176261718499, 0.183157213786247, 16, 50, -0.0123697654317444,
			 0.0147924475400767, 0.00121134105416614, "Total indirect", "W",
			 "M", "<unicode>", 0.86122478695253, 0.00692926328903828, 0.174815273087172,
			 50, 50, -0.0219771855611938, 0.0266304428878848, 0.0023266286633455,
			 "Total indirect", "W", "M", "<unicode>", 0.851167232353355,
			 0.0124001330719568, 0.187629330253498, 84, 50, -0.0336750306948286,
			 0.0407626773735615, 0.00354382333936643, "Total indirect", "W",
			 "M", "<unicode>", 0.851958930580048, 0.0189895601795608, 0.186619558634159,
			 16, 84, -0.0151131483694201, 0.0177208517140655, 0.0013038516723227,
			 "Total indirect", "W", "M", "<unicode>", 0.876299487185875,
			 0.00837617434362977, 0.155661954829569, 50, 84, -0.0233255079589225,
			 0.0281637865219266, 0.00241913928150205, "Total indirect", "W",
			 "M", "<unicode>", 0.853879051833782, 0.0131352654658427, 0.18417132777353,
			 84, 84, -0.034353275420357, 0.041625943335403, 0.00363633395752298,
			 "Total indirect", "W", "M", "<unicode>", 0.851185420591928,
			 0.0193828099279054, 0.187606129918643))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(685.429979661898, 747.954064125612, 6, "Model 1", 100, -318.714989830949,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250983216219, 0.0341989507437262, -0.0645260162362465, "Z",
			 "<unicode>", 0.200186603263831, "sm", 0.0503708066876242, -1.28102010826243,
			 -0.00962228283197884, 0.0896223766216305, 0.0400000468948258,
			 "medexperimental", "<unicode>", 0.114128234236348, "sm", 0.025317980390568,
			 1.57990670178919, 0.180704794824098, 0.319295142534337, 0.249999968679218,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553302008153,
			 7.07106869768261, 0.756337499871344, 1.33640564566332, 1.04637157276733,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.1479792869582,
			 7.07106781142219, 0.00473838184223441, 0.00837245390196784,
			 0.00655541787210112, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000927076234154943, 7.07106668318014, -0.170527327947284,
			 0.027297813645229, -0.0716147571510274, "Z", "<unicode>", 0.155883080249962,
			 "medexperimental", 0.0504665246792626, -1.41905466259409, 0.180704827733195,
			 0.319295257318888, 0.250000042526042, "medexperimental", "<unicode>",
			 1.53743684450092e-12, "medexperimental", 0.0353553510877946,
			 7.07106660899054, 0.72154187370912, 1.27492382947063, 0.998232851589875,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171460324403,
			 7.07106697979889))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.160966936946416, 1.33182551374, 0.585429288396791, "s",
			 "M", "", 0, "<unicode>", "", 0.124224648262154, "m", 0.38082139836787,
			 1.53728044407649, 16, -0.360278235774999, 1.00801085617087,
			 0.323866310197934, "s", "M", "", 1, "<unicode>", "", 0.353498436781024,
			 "m", 0.349059753836998, 0.927824839838657, 50, 0.0268555789958278,
			 1.1872899033158, 0.607072741155816, "s", "M", "", 0, "<unicode>",
			 "", 0.0402979555502774, "m", 0.29603460407266, 2.05068168654639,
			 50, -0.240696017921072, 0.931715543834989, 0.345509762956959,
			 "s", "M", "", 1, "<unicode>", "", 0.248007296018375, "m", 0.299090077930996,
			 1.15520302561382, 84, -0.0593069506334035, 1.3241913303755,
			 0.632442189871049, "s", "M", "", 0, "<unicode>", "", 0.0731446713444379,
			 "m", 0.352939720301435, 1.79192693112268, 84, -0.402473478138683,
			 1.14423190148307, 0.370879211672192, "s", "M", "", 1, "<unicode>",
			 "", 0.347245173974047, "m", 0.394574949290386, 0.939946168248114,
			 16, -0.0244283894400712, 0.0234847846908252, -0.000471802374623043,
			 "s", "jasp", "M", 0, "<unicode>", "<unicode>", 0.969209588462472,
			 "m", 0.0122229731027788, -0.0385996410738876, 16, -0.0318354200595275,
			 0.0331198142882155, 0.000642197114343996, "s", "jasp", "M",
			 1, "<unicode>", "<unicode>", 0.969085399557278, "m", 0.0165705173309565,
			 0.0387554052488309, 50, -0.0144874741583837, 0.0139308030436161,
			 -0.000278335557383788, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.9693745547348, "m", 0.00724969372553768, -0.0383927332548308,
			 50, -0.0413457006255193, 0.0430170284886858, 0.000835663931583251,
			 "s", "jasp", "M", 1, "<unicode>", "<unicode>", 0.969026515603792,
			 "m", 0.0215214998284784, 0.0388292608899616, 84, -0.00379187968753868,
			 0.0036887541833257, -5.15627521064903e-05, "s", "jasp", "M",
			 0, "<unicode>", "<unicode>", 0.978444256949649, "m", 0.00190836003362069,
			 -0.027019404723469, 84, -0.0525716275339396, 0.0546965010076607,
			 0.00106243673686055, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969029984171162, "m", 0.027364821340524, 0.0388249104074072
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.024338351088441, 1.18845016071051, 0.606394255899478, "sm",
			 "<unicode>", 0.0411595853401998, "M", 0.296972755317047, 2.0419188125594,
			 -2.52535807336346, 2.42710102157745, -0.0491285258930035, "jasp",
			 "<unicode>", 0.968981446199107, "M", 1.26340563755387, -0.038885789672526,
			 -0.427962420454414, 0.721164092553237, 0.146600836049411, "medexperimental",
			 "<unicode>", 0.617012908287648, "M", 0.293149905322704, 0.5000882940352,
			 -1.09233336631245, 0.569207409914738, -0.261562978198857, "sm:medexperimental",
			 "<unicode>", 0.5371801926359, "M", 0.423870231630074, -0.617082679274188,
			 -0.226798874973649, 0.3205405753407, 0.0468708501835257, "Z",
			 "<unicode>", 0.737112947251242, "M", 0.139629976528062, 0.335678994933483,
			 -0.39301106549621, 0.438394694682674, 0.0226918145932323, "sm:Z",
			 "<unicode>", 0.914798653137248, "M", 0.212097203503969, 0.106987806620504,
			 -0.0402675142633745, 0.0518453259851349, 0.00578890586088022,
			 "sm", "<unicode>", 0.805410502839226, "jasp", 0.0234986053251702,
			 0.246351040020214, -0.0489096353246045, 0.0420350678256656,
			 -0.00343728374946945, "medexperimental", "<unicode>", 0.88222051218656,
			 "jasp", 0.0232006056916429, -0.148154914365343, -0.0882812792419863,
			 0.0429308654561868, -0.0226752068928998, "sm:medexperimental",
			 "<unicode>", 0.498142187346072, "jasp", 0.0334731009684764,
			 -0.677415782728178, -0.0174100260197651, 0.0258806973434847,
			 0.0042353356618598, "Z", "<unicode>", 0.701345331890019, "jasp",
			 0.0110437548099663, 0.383505042871621, -0.0370221286796712,
			 0.0287646885916909, -0.00412872004399018, "sm:Z", "<unicode>",
			 0.805673664736493, "jasp", 0.0167826597300461, -0.24601106799529
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16106546336287, 1.33098043540721, 0.584957486022167, "Total",
			 "s", "M", 0, "<unicode>", 0.124339818849076, "m", 0.380630947950866,
			 1.53681010220345, 16, -0.358875046046061, 1.00789206067062,
			 0.324508507312278, "Total", "s", "M", 1, "<unicode>", 0.352008834892863,
			 "m", 0.348671485164412, 0.930699874006787, 50, 0.0267424866714,
			 1.18684632452546, 0.606794405598432, "Total", "s", "M", 0, "<unicode>",
			 0.0403326878410031, "m", 0.29595029475154, 2.05032539706661,
			 50, -0.238349614773835, 0.931040468550919, 0.346345426888542,
			 "Total", "s", "M", 1, "<unicode>", 0.245646337247743, "m", 0.298319278453266,
			 1.16098908754501, 84, -0.059358860306221, 1.32414011454411,
			 0.632390627118943, "Total", "s", "M", 0, "<unicode>", 0.0731682237694238,
			 "m", 0.35293989730505, 1.79177993745592, 84, -0.399560646589365,
			 1.14344394340747, 0.371941648409053, "Total", "s", "M", 1, "<unicode>",
			 0.34471011903679, "m", 0.393630852956447, 0.944899632779055,
			 16, -0.0244283894400712, 0.0234847846908252, -0.000471802374623043,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.969209588462472,
			 "m", 0.0122229731027788, -0.0385996410738876, 16, -0.0318354200595275,
			 0.0331198142882155, 0.000642197114343996, "Total indirect",
			 "s", "M", 1, "<unicode>", 0.969085399557278, "m", 0.0165705173309565,
			 0.0387554052488309, 50, -0.0144874741583837, 0.0139308030436161,
			 -0.000278335557383788, "Total indirect", "s", "M", 0, "<unicode>",
			 0.9693745547348, "m", 0.00724969372553768, -0.0383927332548308,
			 50, -0.0413457006255193, 0.0430170284886858, 0.000835663931583251,
			 "Total indirect", "s", "M", 1, "<unicode>", 0.969026515603792,
			 "m", 0.0215214998284784, 0.0388292608899616, 84, -0.00379187968753868,
			 0.0036887541833257, -5.15627521064903e-05, "Total indirect",
			 "s", "M", 0, "<unicode>", 0.978444256949649, "m", 0.00190836003362069,
			 -0.027019404723469, 84, -0.0525716275339396, 0.0546965010076607,
			 0.00106243673686055, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969029984171162, "m", 0.027364821340524, 0.0388249104074072
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1198.9121699047, 1264.04142455441, 14, "Model 1", 100, -574.456084952352,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403935110967608, 0.194627435288523, -0.104653837839543, "Z",
			 "<unicode>", 0.493111846740592, "W", 0.152697332955482, -0.685367817590199,
			 -0.544848845167012, 0.0642083332770456, -0.240320255944983,
			 "Y", "<unicode>", 0.121931897677982, "W", 0.155374584239359,
			 -1.54671535966759, 1.68041132168163, 2.9691926310392, 2.32480197636042,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776783533606,
			 7.07106490724212, 0.769964636041352, 1.36048403507066, 1.065224335556,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150645471979905,
			 7.07106772978942, 0.00465468645666783, 0.00822456931404296,
			 0.00643962788535539, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000910701136738712, 7.0710660452409, 0.424979293021199,
			 0.896763331600413, 0.660871312310806, "Z", "<unicode>", 3.99655790683795e-08,
			 "Y", 0.120355282622688, 5.49100378404352, 0.732634594484303,
			 1.29452395759921, 1.01357927604175, "Y", "<unicode>", 1.53743684450092e-12,
			 "Y", 0.143341757182023, 7.0710677472347, 0.721541878706891,
			 1.27492384690129, 0.998232862804092, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.141171463496117, 7.07106690036933, 0.318532873476458,
			 0.562829613376113, 0.440681243426286, "jasp:Z", "<unicode>",
			 1.53743684450092e-12, "jasp:Z", 0.0623217420898129, 7.07106747419243
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.179641321269042, 0.198135324313693, 0.0092470015223257,
			 "W", "M", "", "<unicode>", "", 0.923560471104347, 0.0963733641440836,
			 0.0959497637594233, 50, 16, -0.253470947204717, 0.255842584775245,
			 0.00118581878526412, "W", "M", "", "<unicode>", "", 0.992718091292669,
			 0.129929308905001, 0.00912664582962682, 84, 16, -0.481391693495552,
			 0.466167818250865, -0.00761193762234363, "W", "M", "", "<unicode>",
			 "", 0.974879105233945, 0.241728807064988, -0.0314895759209087,
			 16, 50, -0.289015084908431, 0.25438820883259, -0.0173134380379206,
			 "W", "M", "", "<unicode>", "", 0.900608023510926, 0.138625836501925,
			 -0.124893298931907, 50, 50, -0.162492536165, 0.111743294615036,
			 -0.0253746207749821, "W", "M", "", "<unicode>", "", 0.716825322351051,
			 0.0699594056174433, -0.362704922247872, 84, 50, -0.32833888812935,
			 0.25999413376417, -0.0341723771825899, "W", "M", "", "<unicode>",
			 "", 0.819892914485673, 0.150087712461611, -0.227682710477252,
			 16, 84, -0.540489508278865, 0.443596808281121, -0.0484463499988718,
			 "W", "M", "", "<unicode>", "", 0.846976839791801, 0.25104704074216,
			 -0.192977180115933, 50, 84, -0.353829537671399, 0.240814472199532,
			 -0.0565075327359334, "W", "M", "", "<unicode>", "", 0.709519905501389,
			 0.151697687957893, -0.372500949069299, 84, 84, -0.285373829556801,
			 0.154763251269719, -0.0653052891435412, "W", "M", "", "<unicode>",
			 "", 0.560823432940642, 0.112281930764612, -0.581618865108823,
			 16, 16, -0.0178571768616958, 0.0222266488051953, 0.00218473597174976,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.830818092866484,
			 0.0102256536301348, 0.213652452036061, 50, 16, -0.0213709617449345,
			 0.0261026480780367, 0.00236584316655113, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.845119531793056, 0.0121108372902352, 0.195349265278188,
			 84, 16, -0.0477632245327319, 0.0498882844506729, 0.0010625299589705,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.965978871798838,
			 0.0249115569861659, 0.0426520895326033, 16, 50, -0.0178571768616958,
			 0.0222266488051953, 0.00218473597174976, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.830818092866484, 0.0102256536301348, 0.213652452036061,
			 50, 50, -0.0213709617449345, 0.0261026480780367, 0.00236584316655113,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.845119531793056,
			 0.0121108372902352, 0.195349265278188, 84, 50, -0.0477632245327319,
			 0.0498882844506729, 0.0010625299589705, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.965978871798838, 0.0249115569861659, 0.0426520895326033,
			 16, 84, -0.0178571768616958, 0.0222266488051953, 0.00218473597174976,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.830818092866484,
			 0.0102256536301348, 0.213652452036061, 50, 84, -0.0213709617449345,
			 0.0261026480780367, 0.00236584316655113, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.845119531793056, 0.0121108372902352, 0.195349265278188,
			 84, 84, -0.0477632245327319, 0.0498882844506729, 0.0010625299589705,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.965978871798838,
			 0.0249115569861659, 0.0426520895326033))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161473166051625, 0.112449416583086, -0.0245118747342695, "W",
			 "<unicode>", 0.725758278623228, "M", 0.0698794939078924, -0.350773501115769,
			 -2.79872512084433, 2.28099170728299, -0.258866706780672, "jasp",
			 "<unicode>", 0.841666036529772, "M", 1.29586994153859, -0.199762876260035,
			 -0.22557070012982, 0.758946806930505, 0.266688053400342, "Y",
			 "<unicode>", 0.288309300537962, "M", 0.251157040340045, 1.06183785666239,
			 -0.251164553453605, 0.234614195728716, -0.00827517886244439,
			 "W:Y", "<unicode>", 0.946760450638972, "M", 0.123925427460423,
			 -0.066775471604382, -1.87023506485268, 1.53191987459685, -0.169157595127918,
			 "Z", "<unicode>", 0.845469947728008, "M", 0.867912616324916,
			 -0.194901643260122, -2.28051658268173, 2.59510112074986, 0.157292269034065,
			 "jasp:Z", "<unicode>", 0.899367201388141, "M", 1.24380288155544,
			 0.126460769119109, -0.258825137706534, 0.203131198599286, -0.0278469695536237,
			 "W:Z", "<unicode>", 0.81320352747752, "M", 0.11784816964742,
			 -0.236295308081039, -0.0197475213221638, 0.00115999982372788,
			 -0.00929376074921794, "W", "<unicode>", 0.08142502955033, "jasp",
			 0.00533364931978534, -1.74247690314818, -0.0185475943218726,
			 0.0350787720914214, 0.00826558888477438, "Y", "<unicode>", 0.54571734439758,
			 "jasp", 0.0136804468950175, 0.604189976263479, -0.0145563097507707,
			 0.00654285774561049, -0.00400672600258012, "W:Y", "<unicode>",
			 0.456638616964961, "jasp", 0.00538253959328048, -0.744393224265751
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175969759387681, 0.198833234375832, 0.0114317374940755,
			 "Total", "W", "M", "<unicode>", 0.904831408434972, 0.0956147655568957,
			 0.119560377808729, 50, 16, -0.250066780503028, 0.257170104406659,
			 0.00355166195181524, "Total", "W", "M", "<unicode>", 0.978103010125718,
			 0.129399542264732, 0.0274472528237316, 84, 16, -0.477943597599363,
			 0.464844782272616, -0.00654940766337314, "Total", "W", "M",
			 "<unicode>", 0.978275375467397, 0.240511659221438, -0.0272311441556483,
			 16, 50, -0.285960581476038, 0.255703177343696, -0.0151287020661708,
			 "Total", "W", "M", "<unicode>", 0.912818747223434, 0.138182069439109,
			 -0.109483829034977, 50, 50, -0.158092610229789, 0.112075055012927,
			 -0.023008777608431, "Total", "W", "M", "<unicode>", 0.738500360466881,
			 0.0689215892163746, -0.333839916781323, 84, 50, -0.322832692828799,
			 0.25661299838156, -0.0331098472236194, "Total", "W", "M", "<unicode>",
			 0.822767534049388, 0.147820494606266, -0.223986851835468, 16,
			 84, -0.537929460849635, 0.445406232795391, -0.0462616140271221,
			 "Total", "W", "M", "<unicode>", 0.853687629885909, 0.250855551786015,
			 -0.184415348585086, 50, 84, -0.350479847043212, 0.242196467904448,
			 -0.0541416895693823, "Total", "W", "M", "<unicode>", 0.720275884583597,
			 0.151195715743405, -0.358090103963437, 84, 84, -0.277402830079623,
			 0.148917311710482, -0.0642427591845707, "Total", "W", "M", "<unicode>",
			 0.554721949752536, 0.108757136649669, -0.59069925122717, 16,
			 16, -0.0178571768616958, 0.0222266488051953, 0.00218473597174976,
			 "Total indirect", "W", "M", "<unicode>", 0.830818092866484,
			 0.0102256536301348, 0.213652452036061, 50, 16, -0.0213709617449345,
			 0.0261026480780367, 0.00236584316655113, "Total indirect", "W",
			 "M", "<unicode>", 0.845119531793056, 0.0121108372902352, 0.195349265278188,
			 84, 16, -0.0477632245327319, 0.0498882844506729, 0.0010625299589705,
			 "Total indirect", "W", "M", "<unicode>", 0.965978871798838,
			 0.0249115569861659, 0.0426520895326033, 16, 50, -0.0178571768616958,
			 0.0222266488051953, 0.00218473597174976, "Total indirect", "W",
			 "M", "<unicode>", 0.830818092866484, 0.0102256536301348, 0.213652452036061,
			 50, 50, -0.0213709617449345, 0.0261026480780367, 0.00236584316655113,
			 "Total indirect", "W", "M", "<unicode>", 0.845119531793056,
			 0.0121108372902352, 0.195349265278188, 84, 50, -0.0477632245327319,
			 0.0498882844506729, 0.0010625299589705, "Total indirect", "W",
			 "M", "<unicode>", 0.965978871798838, 0.0249115569861659, 0.0426520895326033,
			 16, 84, -0.0178571768616958, 0.0222266488051953, 0.00218473597174976,
			 "Total indirect", "W", "M", "<unicode>", 0.830818092866484,
			 0.0102256536301348, 0.213652452036061, 50, 84, -0.0213709617449345,
			 0.0261026480780367, 0.00236584316655113, "Total indirect", "W",
			 "M", "<unicode>", 0.845119531793056, 0.0121108372902352, 0.195349265278188,
			 84, 84, -0.0477632245327319, 0.0498882844506729, 0.0010625299589705,
			 "Total indirect", "W", "M", "<unicode>", 0.965978871798838,
			 0.0249115569861659, 0.0426520895326033))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(889.31316978486, 954.442424434562, 14, "Model 1", 100, -419.65658489243,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250851571598, 0.0341991876423515, -0.0645258319646234, "Z",
			 "<unicode>", 0.200188128041839, "sm", 0.0503708335386289, -1.28101576709345,
			 -0.00962231710968488, 0.0896223937350757, 0.0400000383126954,
			 "medexperimental", "<unicode>", 0.114128499259206, "sm", 0.0253179935007965,
			 1.57990554470428, 0.180704838409114, 0.31929529455749, 0.250000066483302,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553578641136,
			 7.07106593134097, 0.755519568408052, 1.33496040696807, 1.04523998768806,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147819256662515,
			 7.07106781137754, 0.00474535451465546, 0.00838477483302746,
			 0.00656506467384146, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000928440610919201, 7.07106582438453, -0.170527471236785,
			 0.0272977583366349, -0.0716148564500749, "Z", "<unicode>", 0.15588269063201,
			 "medexperimental", 0.0504665471237838, -1.41905599910409, 0.180704844538884,
			 0.319295315936558, 0.250000080237721, "medexperimental", "<unicode>",
			 1.53743684450092e-12, "medexperimental", 0.0353553617543123,
			 7.0710655423354, 0.721541983165883, 1.27492421122344, 0.998233097194663,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171529788958,
			 7.07106524018659, 0.318532863881254, 0.562829579908031, 0.440681221894642,
			 "jasp:Z", "<unicode>", 1.53743684450092e-12, "jasp:Z", 0.0623217359996812,
			 7.0710678196913))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.175482581189691, 1.32297873647059, 0.57374807764045, "s",
			 "M", "", 0, "<unicode>", "", 0.133379607759841, "m", 0.382267564475663,
			 1.50090703726703, 16, -0.363072059027039, 1.00492534399304,
			 0.320926642483002, "s", "M", "", 1, "<unicode>", "", 0.357782243233094,
			 "m", 0.348985342029413, 0.919599203269558, 50, 0.023315006552205,
			 1.18386387725888, 0.60358944190554, "s", "M", "", 0, "<unicode>",
			 "", 0.0414785878761681, "m", 0.296063825626627, 2.03871391794667,
			 50, -0.235957380312315, 0.937493393808498, 0.350768006748092,
			 "s", "M", "", 1, "<unicode>", "", 0.241299367144379, "m", 0.299355187997546,
			 1.17174520707143, 84, -0.0537692188032339, 1.33090542123115,
			 0.63856810121396, "s", "M", "", 0, "<unicode>", "", 0.0706459384136116,
			 "m", 0.353239817403923, 1.80774666317917, 84, -0.392244909653621,
			 1.16373824176664, 0.385746666056511, "s", "M", "", 1, "<unicode>",
			 "", 0.331151744777551, "m", 0.396941771301325, 0.971796605814218,
			 16, -0.0299389522670278, 0.0252558970563767, -0.00234152760532555,
			 "s", "jasp", "M", 0, "<unicode>", "<unicode>", 0.867924913570812,
			 "m", 0.0140805774388648, -0.166294856549173, 16, -0.042893140008774,
			 0.0459615788817701, 0.00153421943649805, "s", "jasp", "M", 1,
			 "<unicode>", "<unicode>", 0.946037303736653, "m", 0.0226674366446064,
			 0.0676838524158004, 50, -0.022121535078026, 0.0257353551433592,
			 0.00180691003266662, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.882340502058913, "m", 0.0122086146987583, 0.14800287151747,
			 50, -0.0299389522670278, 0.0252558970563767, -0.00234152760532555,
			 "s", "jasp", "M", 1, "<unicode>", "<unicode>", 0.867924913570812,
			 "m", 0.0140805774388648, -0.166294856549173, 84, -0.042893140008774,
			 0.0459615788817701, 0.00153421943649805, "s", "jasp", "M", 0,
			 "<unicode>", "<unicode>", 0.946037303736653, "m", 0.0226674366446064,
			 0.0676838524158004, 84, -0.022121535078026, 0.0257353551433592,
			 0.00180691003266662, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.882340502058913, "m", 0.0122086146987583, 0.14800287151747
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0204863774153177, 1.18482155485136, 0.602653966133338, "sm",
			 "<unicode>", 0.0424649336521727, "M", 0.297029737949312, 2.02893478038277,
			 -2.59010002717834, 2.3939269826115, -0.0980865222834208, "jasp",
			 "<unicode>", 0.93850830041375, "M", 1.27145882503536, -0.0771448672596163,
			 -0.436456167327803, 0.715250740991392, 0.139397286831794, "medexperimental",
			 "<unicode>", 0.635179056966076, "M", 0.293808181528771, 0.474449983341066,
			 -1.08477365667398, 0.579130786359085, -0.252821435157448, "sm:medexperimental",
			 "<unicode>", 0.551434312978737, "M", 0.424473218936096, -0.59561221740001,
			 -1.83221551610126, 1.39245951672595, -0.219877999687653, "Z",
			 "<unicode>", 0.78925005625142, "M", 0.822636297978697, -0.267284582783323,
			 -1.98043777044073, 2.77951807973169, 0.399540154645482, "jasp:Z",
			 "<unicode>", 0.742132956488514, "M", 1.2142967645626, 0.329030074282871,
			 -0.387333899895966, 0.449907530143586, 0.0312868151238099, "sm:Z",
			 "<unicode>", 0.883539708238736, "M", 0.213585922150511, 0.146483507942825,
			 -0.0404918119126747, 0.0505150096787808, 0.00501159888305305,
			 "sm", "<unicode>", 0.829093672872922, "jasp", 0.0232164525239509,
			 0.215864110930941, -0.0488496056517389, 0.0421572159401147,
			 -0.00334619485581213, "medexperimental", "<unicode>", 0.885397558558652,
			 "jasp", 0.0232164525240524, -0.144130325352051, -0.0871738500132525,
			 0.0415292313497937, -0.0228223093317294, "sm:medexperimental",
			 "<unicode>", 0.486991189613435, "jasp", 0.0328330220295474,
			 -0.695102306184027))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.179097005242781, 1.32191010531303, 0.571406550035125, "Total",
			 "s", "M", 0, "<unicode>", 0.135634551985038, "m", 0.382917013372584,
			 1.49224644003775, 16, -0.36079489445684, 1.00571661829584, 0.3224608619195,
			 "Total", "s", "M", 1, "<unicode>", 0.354965830449459, "m", 0.348606281424442,
			 0.925000148023413, 50, 0.0253656274526687, 1.18542707642375,
			 0.605396351938207, "Total", "s", "M", 0, "<unicode>", 0.0407882392213244,
			 "m", 0.295939481062278, 2.04567619624502, 50, -0.239170904977403,
			 0.936023863262935, 0.348426479142766, "Total", "s", "M", 1,
			 "<unicode>", 0.245155844619367, "m", 0.299800092631835, 1.16219603564515,
			 84, -0.0540304841616978, 1.33423512546261, 0.640102320650458,
			 "Total", "s", "M", 0, "<unicode>", 0.0706995156833239, "m",
			 0.354155897908016, 1.80740268461295, 84, -0.393047063804042,
			 1.1681542159824, 0.387553576089178, "Total", "s", "M", 1, "<unicode>",
			 0.330510881752331, "m", 0.398272950957517, 0.973085355551845,
			 16, -0.0299389522670278, 0.0252558970563767, -0.00234152760532555,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.867924913570812,
			 "m", 0.0140805774388648, -0.166294856549173, 16, -0.042893140008774,
			 0.0459615788817701, 0.00153421943649805, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.946037303736653, "m", 0.0226674366446064,
			 0.0676838524158004, 50, -0.022121535078026, 0.0257353551433592,
			 0.00180691003266662, "Total indirect", "s", "M", 0, "<unicode>",
			 0.882340502058913, "m", 0.0122086146987583, 0.14800287151747,
			 50, -0.0299389522670278, 0.0252558970563767, -0.00234152760532555,
			 "Total indirect", "s", "M", 1, "<unicode>", 0.867924913570812,
			 "m", 0.0140805774388648, -0.166294856549173, 84, -0.042893140008774,
			 0.0459615788817701, 0.00153421943649805, "Total indirect", "s",
			 "M", 0, "<unicode>", 0.946037303736653, "m", 0.0226674366446064,
			 0.0676838524158004, 84, -0.022121535078026, 0.0257353551433592,
			 0.00180691003266662, "Total indirect", "s", "M", 1, "<unicode>",
			 0.882340502058913, "m", 0.0122086146987583, 0.14800287151747
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "mod"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "mod", processType = "mediators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1919.79936103679, 1990.13895605847, 0, "Model 1", 100, -932.899680518397,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089480192, 2.96919114210622, 2.32480101845407, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512596666, 7.07106782079068,
			 0.719243095446917, 1.27101851286767, 0.995130804157296, "M",
			 "<unicode>", 1.55364610066044e-12, "M", 0.140761621584144, 7.06961736415084,
			 -0.017063829424213, 0.0136234316300662, -0.00172019889707342,
			 "Y", "<unicode>", 0.826077786806031, "jasp", 0.00782852677302654,
			 -0.219734689162772, -0.762343306344135, 0.0887543315059579,
			 -0.336794487419088, "mod", "<unicode>", 0.120857287748549, "jasp",
			 0.217120733993952, -1.55118528398338, 0.00468047960484189, 0.00827014311556882,
			 0.00647531136020536, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000915747314502139, 7.07106781276859, 0.413197536866249,
			 0.872209472692487, 0.642703504779368, "Y", "<unicode>", 4.05039308759569e-08,
			 "Z", 0.117097033273791, 5.4886403763674, -6.53655165917213,
			 3.73651368195567, -1.40001898860823, "mod", "<unicode>", 0.593196294728594,
			 "Z", 2.62072809045483, -0.534209937195452, 0.71669479817852,
			 1.2663592308511, 0.991527014514812, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.140223095171204, 7.07106781022211, 507.563085651454,
			 899.790692619836, 703.676889135645, "mod", "<unicode>", 2.02793337678031e-12,
			 "mod", 100.059901626312, 7.03255627577598, 0.700714207950775,
			 1.23822336162219, 0.969468784786483, "Y", "<unicode>", 1.54809498553732e-12,
			 "Y", 0.137122201711669, 7.0701080691879))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, "W",
			 "M", "", "", "<unicode>", "", "", 0.813347598335086, 0.0673697800718175,
			 -0.236109634089419, -0.0261961165104945, 0.0194967930965771,
			 -0.00334966170695873, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.773834706557657, 0.0116565686837849, -0.287362584807512,
			 -0.0163077605876651, 0.0285137534820108, 0.00610299644717284,
			 "W", "Z", "M", "", "<unicode>", "<unicode>", "", 0.593517238385026,
			 0.0114342698190432, 0.533746058450414, -0.0332675922356836,
			 0.038704162906655, 0.0027182853354857, "W", "mod", "M", "",
			 "<unicode>", "<unicode>", "", 0.882302602912406, 0.0183604789960537,
			 0.148050894318713, -0.0775466819567461, 0.0159133084692364,
			 -0.0308166867437548, "W", "Y", "M", "", "<unicode>", "<unicode>",
			 "", 0.196176067287806, 0.0238422723996928, -1.29252305431054,
			 -0.00296122904246256, 0.00450914197709736, 0.000773956467317395,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.684655756514328, 0.00190574191119971, 0.406118196157092, -0.00589119861695775,
			 0.00506907909285442, -0.000411059762051665, "W", "mod", "Y",
			 "M", "<unicode>", "<unicode>", "<unicode>", 0.883120221676967,
			 0.00279604058958875, -0.147014948059866))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, "W",
			 "<unicode>", 0.813347598335086, "M", 0.0673697800718175, -0.236109634089419,
			 -2.10110820470282, 2.83502607382475, 0.366958934560965, "jasp",
			 "<unicode>", 0.77073564479617, "M", 1.25924106704592, 0.291412775650513,
			 -0.413433882620032, 0.107899969914886, -0.152766956352573, "Z",
			 "<unicode>", 0.250696109315949, "M", 0.132995773556844, -1.14866023383276,
			 0.0028905648879694, 0.0180163398795304, 0.0104534523837499,
			 "mod", "<unicode>", 0.00674721413960322, "M", 0.00385868697355441,
			 2.70906980934003, 0.0387464898678602, 0.565434272654561, 0.302090381261211,
			 "Y", "<unicode>", 0.024554599581468, "M", 0.134361597187792,
			 2.24833871868158, -0.0194720938734558, 0.00121576385131691,
			 -0.00912816501106944, "W", "<unicode>", 0.0837015014975608,
			 "jasp", 0.00527761170306084, -1.72960147973285, -0.169849433838636,
			 0.0899500027982267, -0.0399497155202047, "W", "<unicode>", 0.546659912050572,
			 "Z", 0.0662765843367857, -0.602772697476375, -1.87031193110395,
			 2.98033913143301, 0.555013600164534, "jasp", "<unicode>", 0.653778056597516,
			 "Z", 1.23743372347611, 0.448519859799382, -3.17623798796469,
			 3.69631216742168, 0.260037089728493, "W", "<unicode>", 0.882091377958021,
			 "mod", 1.75323378633387, 0.148318548133987, -0.228615253195251,
			 0.0245922941384487, -0.102011479528401, "W", "<unicode>", 0.11427905810986,
			 "Y", 0.0645949490222699, -1.57924854918968, -0.012530212645152,
			 0.0020646455096896, -0.0052327835677312, "mod", "<unicode>",
			 0.159891757636204, "Y", 0.00372324651625335, -1.40543569835845
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023199935095, 0.0942455517666334, -0.0408888240842308, "Total",
			 "W", "M", "<unicode>", 0.553151746868814, 0.0689473770522249,
			 -0.593043939195237, -0.0779893376489408, 0.0280249977233621,
			 -0.0249821699627893, "Total indirect", "W", "M", "<unicode>",
			 0.355628457145996, 0.0270449702669362, -0.923727026364354))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "mod"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "mod", processType = "mediators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1694.56540701386, 1764.90500203554, 0, "Model 1", 100, -820.282703506932,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704808730328, 0.319295191038147, 0.249999999884237, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553390268909,
			 7.0710678150785, 0.679351239017548, 1.20070868331726, 0.940029961167402,
			 "M", "<unicode>", 1.57407420431355e-12, "M", 0.133001791974778,
			 7.06779921691328, -0.0155310360409273, 0.015901321346984, 0.000185142653028361,
			 "Y", "<unicode>", 0.981579174401771, "jasp", 0.0080186058610887,
			 0.0230891324795984, -0.781706195292346, 0.0840275744384795,
			 -0.348839310426933, "mod", "<unicode>", 0.114221818813752, "jasp",
			 0.220854509715388, -1.57949824468822, 0.00480662801191764, 0.0084930402246428,
			 0.00664983411828022, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000940428559351885, 7.07106781493651, 0.415818962568938,
			 0.877332208264479, 0.646575585416708, "Y", "<unicode>", 3.97900377091531e-08,
			 "Z", 0.11773513425142, 5.49178110279271, -6.63530159455768,
			 3.59524109747847, -1.5200302485396, "mod", "<unicode>", 0.560287998937135,
			 "Z", 2.60988027655951, -0.582413784337798, 0.707778596528062,
			 1.25060480683957, 0.979191701683816, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.138478618636172, 7.07106780330087, 507.892714690368,
			 901.011119528301, 704.451917109335, "mod", "<unicode>", 2.15072404330385e-12,
			 "mod", 100.287150156534, 7.02434874268325, 0.716666293529629,
			 1.26647572327931, 0.99157100840447, "Y", "<unicode>", 1.55475632368507e-12,
			 "Y", 0.140260084901179, 7.06951667042756))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0910081224725078, 0.860751929259853, 0.475880025866181, "s",
			 "M", "", "", "<unicode>", "", "", 0.0153749805220957, "m", 0.196366824303657,
			 2.42342375069574, -0.0327065874144014, 0.0226541864902512, -0.0050262004620751,
			 "s", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.721922972814061,
			 "m", 0.0141229059159585, -0.355889962871992, -0.04952974707603,
			 0.106054836558549, 0.0282625447412593, "s", "Z", "M", "", "<unicode>",
			 "<unicode>", "", 0.476421330290286, "m", 0.0396906741301907,
			 0.712070161583914, -0.126072868172848, 0.100247146419103, -0.0129128608768725,
			 "s", "mod", "M", "", "<unicode>", "<unicode>", "", 0.823026170644271,
			 "m", 0.0577357585080989, -0.223654477061406, -0.138320655423621,
			 0.0912558701983019, -0.0235323926126597, "s", "Y", "M", "",
			 "<unicode>", "<unicode>", "", 0.687826618468944, "m", 0.0585665163831564,
			 -0.401806254937635, -0.00284859619040834, 0.00402188839589021,
			 0.000586646102740937, "s", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.73784489268874, "m", 0.00175270684576147, 0.334708627492162,
			 -0.0147815474651881, 0.0185253899009152, 0.00187192121786353,
			 "s", "mod", "Y", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.825631019351605, "m", 0.00849682382656624, 0.220308347692318
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0910081224725078, 0.860751929259853, 0.475880025866181, "sm",
			 "<unicode>", 0.0153749805220957, "M", 0.196366824303657, 2.42342375069574,
			 -1.79290884127227, 2.94034877890532, 0.573719968816522, "jasp",
			 "<unicode>", 0.634690061553928, "M", 1.20748586645289, 0.475135970329726,
			 -0.367051095396393, 0.14350331678753, -0.111773889304432, "Z",
			 "<unicode>", 0.390795230450944, "M", 0.130245865794247, -0.858176101197744,
			 0.00343201054080372, 0.0181440175053956, 0.0107880140230996,
			 "mod", "<unicode>", 0.00404792007154309, "M", 0.00375313196585199,
			 2.8744030642287, 0.0358514443861678, 0.542472331293712, 0.28916188783994,
			 "Y", "<unicode>", 0.0252627608038503, "M", 0.129242397029666,
			 2.23736091627553, -0.0407263673121724, 0.0232049257195319, -0.00876072079632024,
			 "sm", "<unicode>", 0.591156438387134, "jasp", 0.0163093030116845,
			 -0.537160955930723, -0.641306843553368, 0.135597595765052, -0.252854623894158,
			 "sm", "<unicode>", 0.202027488900194, "Z", 0.198193549842381,
			 -1.27579643280646, -1.77925887403205, 2.97744968035564, 0.599095403161793,
			 "jasp", "<unicode>", 0.621514529069439, "Z", 1.21346835755861,
			 0.493705006339943, -11.6494093208209, 9.25548197715544, -1.19696367183275,
			 "sm", "<unicode>", 0.822410573160282, "mod", 5.33297842788732,
			 -0.22444562415133, -0.471868158437157, 0.309105404407237, -0.0813813770149599,
			 "sm", "<unicode>", 0.682924078848467, "Y", 0.199231610632801,
			 -0.408476229030502, -0.0127958409040199, 0.00197912205577032,
			 -0.00540835942412481, "mod", "<unicode>", 0.151319742569027,
			 "Y", 0.00376919246382415, -1.43488544987634))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0625107978025213, 0.867748570150353, 0.465129683976437, "Total",
			 "s", "M", "<unicode>", 0.0235575802096637, "m", 0.205421573737947,
			 2.26426891544407, -0.156837434248426, 0.135336750468939, -0.0107503418897435,
			 "Total indirect", "s", "M", "<unicode>", 0.885318086689426,
			 "m", 0.0745356004043945, -0.144230969247143))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "Z", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "Z", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "Z", processType = "moderators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1490.43159736364, 1568.58670294328, 12, "Model 1", 100, -715.215798681819,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544845414224517, 0.0642127813981578, -0.24031631641318, "Y",
			 "<unicode>", 0.121938637675985, "W", 0.155374843728469, -1.54668742150534,
			 1.68041250288709, 2.96919675107937, 2.32480462698323, "W", "<unicode>",
			 1.53765888910584e-12, "W", 0.328777533250112, 7.07105684503896,
			 0.738695301427582, 1.30523287726226, 1.02196408934492, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.144527547522161, 7.07106781278647,
			 0.00465468244585314, 0.00822455532456515, 0.00643961888520914,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000910698591114611,
			 7.07107592790678, 0.377829117086005, 0.66760266765775, 0.522715892371877,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.0739231824812704,
			 7.07106857181529, 0.732635215491899, 1.29452612309587, 1.01358066929388,
			 "Y", "<unicode>", 1.53765888910584e-12, "Y", 0.143342151191576,
			 7.07105803051077, 0.323891627245581, 0.572297921749174, 0.448094774497378,
			 "jasp:Y", "<unicode>", 1.53743684450092e-12, "jasp:Y", 0.063370117120261,
			 7.0710737940882, 0.784506325641507, 1.38618000243142, 1.08534316403646,
			 "Z:Y", "<unicode>", 1.53765888910584e-12, "Z:Y", 0.153491003287773,
			 7.07105394315263))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.246046572007919, 0.136940953810542, -0.0545528090986887,
			 "W", "M", "", "", "<unicode>", "", "", 0.57660184827691, 0.0977026947534286,
			 -0.558355214627019, 50, -0.167682190637647, 0.106696898641721,
			 -0.0304926459979633, "W", "M", "", "", "<unicode>", "", "",
			 0.663101992273681, 0.0699959518245323, -0.435634421750604, 84,
			 -0.22366490872751, 0.215196836844783, -0.0042340359413634, "W",
			 "M", "", "", "<unicode>", "", "", 0.969832352299801, 0.111956584160214,
			 -0.0378185523711973, 16, -0.0261685059400495, 0.0522783697417529,
			 0.0130549319008517, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.51417891948777, 0.0200123258132755, 0.652344561179967,
			 50, -0.022627694238274, 0.023749622929404, 0.000560964345565005,
			 "W", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.962183173029298,
			 0.0118311656575061, 0.0474141231560825, 84, -0.100777088206936,
			 0.0326691783800381, -0.034053954913449, "W", "jasp", "M", "",
			 "<unicode>", "<unicode>", "", 0.317155377976575, 0.0340430404945145,
			 -1.00032060646687, 16, -0.0235748154916105, 0.0866024426612249,
			 0.0315138135848072, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.262198346331823, 0.0281069598783191, 1.12121032375031,
			 50, -0.0277462072739296, 0.0130459660261054, -0.0073501206239121,
			 "W", "Z", "M", "", "<unicode>", "<unicode>", "", 0.479995018014117,
			 0.0104063578774402, -0.706310575753531, 84, -0.0686530199485837,
			 0.0611295030193147, -0.00376175846463447, "W", "Z", "M", "",
			 "<unicode>", "<unicode>", "", 0.909539447930077, 0.0331083948459274,
			 -0.113619475729347, 16, -0.00562958045857296, 0.0039497869280092,
			 -0.000839896765281883, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.73107927190771, 0.00244376107472969, -0.343690213403856,
			 50, -0.00253990067433596, 0.00523214599640664, 0.00134612266103534,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.497179915180347, 0.00198270139962967, 0.678933631300594, 84,
			 -0.00960619029952168, 0.010783786153223, 0.000588797926850668,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.909875878855725, 0.00520162018628358, 0.113195101865242))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167725029154556, 0.106559929341094, -0.0305825499067307, "W",
			 "<unicode>", 0.662061466449758, "M", 0.0699719384282505, -0.437068782053111,
			 -2.55829550052727, 2.42017035676155, -0.0690625718828604, "jasp",
			 "<unicode>", 0.956633799813336, "M", 1.27004013761434, -0.0543782592671348,
			 -0.450844999534775, 0.102063560950179, -0.174390719292298, "Z",
			 "<unicode>", 0.21632139734344, "M", 0.141050694004131, -1.23636909781663,
			 -3.31235331374332, 0.50465006406657, -1.40385162483838, "Y",
			 "<unicode>", 0.149385287627976, "M", 0.973743244242734, -1.44170615112214,
			 -0.12541646010085, 0.174814212170831, 0.0246988760349903, "W:Y",
			 "<unicode>", 0.747090530516903, "M", 0.0765908645872737, 0.32247809406625,
			 -0.267220784961802, 5.10203772053223, 2.41740846778522, "jasp:Y",
			 "<unicode>", 0.0775848713245899, "M", 1.36973397160511, 1.76487443394019,
			 -0.0582255096744967, 0.349435769152973, 0.145605129739238, "Z:Y",
			 "<unicode>", 0.161487000406626, "M", 0.103997135162444, 1.40008789195781,
			 -0.0197477399995842, 0.00115976653632148, -0.00929398673163137,
			 "W", "<unicode>", 0.0814174092690125, "jasp", 0.00533364559267962,
			 -1.74252048999793, -0.0185474623059735, 0.0350788666330777,
			 0.0082657021635521, "Y", "<unicode>", 0.545711559213373, "jasp",
			 0.013680437335086, 0.604198678820976, -0.0145563464256446, 0.00654280632658964,
			 -0.00400677004952746, "W:Y", "<unicode>", 0.456633353081375,
			 "jasp", 0.00538253583194937, -0.744401927757598, -0.0543801026811009,
			 0.137869996309279, 0.0417449468140892, "W", "<unicode>", 0.394675884766629,
			 "Z", 0.0490442937999944, 0.851168272181217, -0.945916771267379,
			 2.59955068280099, 0.826816955766806, "jasp", "<unicode>", 0.360641909699776,
			 "Z", 0.904472603077038, 0.91414262074269, -1.86915930688467,
			 0.793983921499387, -0.537587692692644, "Y", "<unicode>", 0.428777755913428,
			 "Z", 0.679385756419658, -0.791284903477686, 0.0432011541485479,
			 0.248538805397686, 0.145869979773117, "W:Y", "<unicode>", 0.00535804414792973,
			 "Z", 0.052383016440306, 2.7846807932366, -0.508958994547159,
			 3.22713344329519, 1.35908722437401, "jasp:Y", "<unicode>", 0.153879451921323,
			 "Z", 0.9531023190508, 1.42596151242978))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.201040494137924, 0.179392573381301, -0.0108239603783117,
			 "Total", "W", "M", "<unicode>", 0.911197234216696, 0.0970510352537172,
			 -0.111528541143482, 50, -0.171681457617047, 0.0998100983864967,
			 -0.0359356796152751, "Total", "W", "M", "<unicode>", 0.603860513538175,
			 0.0692593226572106, -0.518856931263011, 84, -0.245856362666216,
			 0.162934459881024, -0.0414609513925962, "Total", "W", "M", "<unicode>",
			 0.690945418402339, 0.10428528936545, -0.39757238671797, 16,
			 -0.0231392766865853, 0.110596974127339, 0.0437288487203771,
			 "Total indirect", "W", "M", "<unicode>", 0.199936924897333,
			 0.0341170174219576, 1.28173128909661, 50, -0.0361512079721022,
			 0.0252651407374787, -0.00544303361731176, "Total indirect",
			 "W", "M", "<unicode>", 0.728287651279385, 0.0156677237934026,
			 -0.34740423619184, 84, -0.125316096440252, 0.0508622655377862,
			 -0.0372269154512328, "Total indirect", "W", "M", "<unicode>",
			 0.407506118790109, 0.0449442855500689, -0.828290293095463))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "Z", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "Z", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "Z", processType = "moderators", 
        processVariable = "med")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(959.510460980064, 1037.66556655971, 12, "Model 1", 100, -449.755230490032,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962196668040587, 0.0896229057349935, 0.0400004695272938,
			 "medexperimental", "<unicode>", 0.11412518736331, "sm", 0.0253180347185536,
			 1.5799200045326, 0.18070490373996, 0.319295522426352, 0.250000213083156,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553993286551,
			 7.07106178491198, 0.748461126016925, 1.32248853790023, 1.03547483195858,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.146438255093246,
			 7.07106781147609, 0.00474535809181169, 0.00838478730997079,
			 0.00656507270089124, "jasp", "<unicode>", 1.53765888910584e-12,
			 "jasp", 0.000928442881314772, 7.07105717865424, 0.682814779075062,
			 1.20649515039531, 0.944654964735185, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.133594386287444, 7.07106781195615, 0.180704903732434,
			 0.319295522401599, 0.250000213067017, "medexperimental", "<unicode>",
			 1.53743684450092e-12, "medexperimental", 0.0353553993242606,
			 7.07106178533439, 0.0796447318984438, 0.14072781748991, 0.110186274694177,
			 "jasp:medexperimental", "<unicode>", 1.53743684450092e-12, "jasp:medexperimental",
			 0.0155827061296233, 7.0710615844002, 0.319034105111151, 0.563714768007903,
			 0.441374436559527, "Z:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "Z:medexperimental", 0.0624196834295839, 7.07107778041593))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0345966305070722, 1.17847272956909, 0.606534680038083, "s",
			 "M", "", "", 0, "<unicode>", "", "", 0.0376612569422228, "m",
			 0.291810489397961, 2.07852254142555, -0.30763449691844, 0.879612205903842,
			 0.285988854492701, "s", "M", "", "", 1, "<unicode>", "", "",
			 0.345042766133323, "m", 0.302874622234677, 0.944248324216176,
			 -0.0184751271373697, 0.0173927839609914, -0.000541171588189157,
			 "s", "jasp", "M", "", 0, "<unicode>", "<unicode>", "", 0.952837814722433,
			 "m", 0.00915014545708048, -0.0591434956665517, -0.0660864196580941,
			 0.0606448326030803, -0.00272079352750691, "s", "jasp", "M",
			 "", 1, "<unicode>", "<unicode>", "", 0.932931651994774, "m",
			 0.0323299951582821, -0.0841569420034359, -0.0749810317426891,
			 0.0919666897035537, 0.00849282898043228, "s", "Z", "M", "",
			 0, "<unicode>", "<unicode>", "", 0.841940948352035, "m", 0.0425894870423909,
			 0.199411393989767, -0.12055702016095, 0.18434573841041, 0.0318943591247299,
			 "s", "Z", "M", "", 1, "<unicode>", "<unicode>", "", 0.681773566026288,
			 "m", 0.0777827452382785, 0.410044143171152, -0.00321825621320514,
			 0.0028407240465813, -0.000188766083311919, "s", "jasp", "Z",
			 "M", 0, "<unicode>", "<unicode>", "<unicode>", 0.902800482324132,
			 "m", 0.00154568663189194, -0.122124419929069, -0.00627221932251877,
			 0.00864020901780174, 0.00118399484764149, "s", "jasp", "Z",
			 "M", 1, "<unicode>", "<unicode>", "<unicode>", 0.755626825796107,
			 "m", 0.00380426080732805, 0.311228621697226))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0345966305070722, 1.17847272956909, 0.606534680038083, "sm",
			 "<unicode>", 0.0376612569422228, "M", 0.291810489397961, 2.07852254142555,
			 -3.54941876399751, 3.3334590658205, -0.107979849088507, "jasp",
			 "<unicode>", 0.950963763073855, "M", 1.75586844557075, -0.0614965485375003,
			 -0.121894548047822, 0.422376825388235, 0.150241138670206, "Z",
			 "<unicode>", 0.279225738099293, "M", 0.13884728947297, 1.08206029257384,
			 -3.31646428942003, 3.35029190110037, 0.0169138058401676, "medexperimental",
			 "<unicode>", 0.992065167611423, "M", 1.70073436121963, 0.00994500153924003,
			 -1.14486482675211, 0.503773175661347, -0.320545825545382, "sm:medexperimental",
			 "<unicode>", 0.445967916283779, "M", 0.420578647214363, -0.762154302574482,
			 -4.67371879642321, 5.19520577427491, 0.260743488925848, "jasp:medexperimental",
			 "<unicode>", 0.91751291393337, "M", 2.51762906067227, 0.103567079439503,
			 -0.6319348032448, 0.196704100553248, -0.217615351345776, "Z:medexperimental",
			 "<unicode>", 0.303271561238132, "M", 0.211391359824529, -1.02944297972449,
			 -0.0404916554644197, 0.0505152217641943, 0.00501178314988734,
			 "sm", "<unicode>", 0.829087588855613, "jasp", 0.0232164667173644,
			 0.215871915864737, -0.0488497749485977, 0.0421571022799943,
			 -0.00334633633430171, "medexperimental", "<unicode>", 0.885392816162945,
			 "jasp", 0.0232164667173587, -0.144136331123964, -0.0871738417030068,
			 0.0415293183429794, -0.0228222616800137, "sm:medexperimental",
			 "<unicode>", 0.486992365379827, "jasp", 0.0328330421020948,
			 -0.695100429897649, -0.489555034284806, 0.602611006245653, 0.0565279859804235,
			 "sm", "<unicode>", 0.83922382650975, "Z", 0.278618905537379,
			 0.202886397358415, -3.53710183349557, 3.03571511863317, -0.2506933574312,
			 "jasp", "<unicode>", 0.881151454365549, "Z", 1.67676982943929,
			 -0.149509701945813, -3.98113048506751, 2.37831974275646, -0.801405371155527,
			 "medexperimental", "<unicode>", 0.621319181980972, "Z", 1.62233854243917,
			 -0.493981589040362, -1.30434387560009, 0.244505511440842, -0.529919182079625,
			 "sm:medexperimental", "<unicode>", 0.17987056845759, "Z", 0.395121900008893,
			 -1.34115365933323, -3.4660603834228, 5.94082616433903, 1.23738289045811,
			 "jasp:medexperimental", "<unicode>", 0.606114420871309, "Z",
			 2.3997600522158, 0.515627755914842))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0369344462075991, 1.19166069648643, 0.614297571347015, "Total",
			 "s", "M", 0, "<unicode>", 0.0370380253756422, "m", 0.294578435978203,
			 2.08534466994206, -0.256320128223737, 0.889012958098868, 0.316346414937566,
			 "Total", "s", "M", 1, "<unicode>", 0.278940430461163, "m", 0.29218217665142,
			 1.08270264313546, -0.077695001361949, 0.0932207839798114, 0.0077628913089312,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.858690972379156,
			 "m", 0.0436017668411059, 0.178040750899404, -0.134497758660536,
			 0.195212879550265, 0.0303575604448645, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.718158601973748, "m", 0.0841114022531834,
			 0.3609208696044))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

