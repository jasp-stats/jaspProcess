### This code was automatically generated by 'generate-tests-for-bad-var-names.R'

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(961.745418061986, 987.797119921867, 2, "Model 1", 100, -470.872709030993,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544850082631131, 0.0642075341001774, -0.240321274265477, "Y",
			 "<unicode>", 0.121930585104781, "W", 0.155374696049386, -1.54672080059349,
			 1.68041145454125, 2.96919309445352, 2.32480227449739, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776867860332, 7.07106400041802,
			 0.776405337504771, 1.37186438136396, 1.07413485943436, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.151905608612222, 7.07106781143526,
			 0.732634775738868, 1.29452458982638, 1.01357968278263, "Y",
			 "<unicode>", 1.53743684450092e-12, "Y", 0.143341872228171, 7.07106490955563
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16569395359711, 0.204085014407693, 0.0191955304052916,
			 "W", "M", "<unicode>", 0.838754651525841, 0.0943331027818806,
			 0.203486685365115, 50, -0.161247760244973, 0.1088200297932,
			 -0.0262138652258869, "W", "M", "<unicode>", 0.703586197486989,
			 0.068896110379689, -0.380483964645048, 84, -0.278343730144802,
			 0.126798831800759, -0.0757724491720214, "W", "M", "<unicode>",
			 0.463478577712245, 0.103354593538778, -0.733130928946979))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161055937745397, 0.108967563443863, -0.0260441871507668, "W",
			 "<unicode>", 0.70536882046419, "M", 0.0688848119963353, -0.378083156446044,
			 -0.0878908629922849, 0.604701009289819, 0.258405073148767, "Y",
			 "<unicode>", 0.143598843509078, "M", 0.176684846697485, 1.46251972355728,
			 -0.18286417583744, 0.0896344642329923, -0.0466148558022241,
			 "W:Y", "<unicode>", 0.50250042972327, "M", 0.0695162365788013,
			 -0.670560693391148))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16569395359711, 0.204085014407693, 0.0191955304052916,
			 "Total", "W", "M", "<unicode>", 0.838754651525841, 0.0943331027818806,
			 0.203486685365115, 50, -0.161247760244973, 0.1088200297932,
			 -0.0262138652258869, "Total", "W", "M", "<unicode>", 0.703586197486989,
			 0.068896110379689, -0.380483964645048, 84, -0.278343730144802,
			 0.126798831800759, -0.0757724491720214, "Total", "W", "M", "<unicode>",
			 0.463478577712245, 0.103354593538778, -0.733130928946979))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(596.346471143819, 622.3981730037, 2, "Model 1", 100, -288.17323557191,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962242574014883, 0.0896221577540205, 0.0399998660069358,
			 "medexperimental", "<unicode>", 0.114129593712154, "sm", 0.0253179610128038,
			 1.57990076636531, 0.180704780462425, 0.319295092441708, 0.249999936452067,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553210856081,
			 7.07106960920326, 0.758630464114515, 1.34045718397417, 1.04954382404434,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.148427911035364,
			 7.07106781145954, 0.180704780436992, 0.319295092352504, 0.249999936394748,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553210693398, 7.07106961083572))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "s",
			 "M", 0, "<unicode>", 0.036378010371507, "m", 0.293546322878014,
			 2.09267685884226, -0.258993824622392, 0.891686616803016, 0.316346396090312,
			 "s", "M", 1, "<unicode>", 0.281180548821822, "m", 0.293546322917622,
			 1.07767112510923))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "sm",
			 "<unicode>", 0.036378010371507, "M", 0.293546322878014, 2.09267685884226,
			 -0.427566567127894, 0.72311387432658, 0.147773653599343, "medexperimental",
			 "<unicode>", 0.61467724160965, "M", 0.293546322925037, 0.503408293883075,
			 -1.11160514390099, 0.515702742311497, -0.297951200794745, "sm:medexperimental",
			 "<unicode>", 0.472931529552078, "M", 0.415137191052612, -0.717717437070063
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0389573762499846, 1.18963781752013, 0.614297596885057, "Total",
			 "s", "M", 0, "<unicode>", 0.036378010371507, "m", 0.293546322878014,
			 2.09267685884226, -0.258993824622392, 0.891686616803016, 0.316346396090312,
			 "Total", "s", "M", 1, "<unicode>", 0.281180548821822, "m", 0.293546322917622,
			 1.07767112510923))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1199.86016487143, 1241.54288784724, 6, "Model 1", 100, -583.930082435716,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403938892429879, 0.194627164487928, -0.104655863970976, "Z",
			 "<unicode>", 0.493106011784507, "W", 0.152698228548897, -0.685377066685898,
			 -0.544853906416774, 0.0642071273354463, -0.240323389540664,
			 "Y", "<unicode>", 0.121929394261216, "W", 0.155375567754412,
			 -1.54672573696092, 1.6804147319274, 2.96920452585506, 2.32480962889123,
			 "W", "<unicode>", 1.53765888910584e-12, "W", 0.328778948004521,
			 7.07104163147106, 0.770361877035362, 1.36118593001358, 1.06577390352447,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150723191252126,
			 7.07106779434939, 0.424979599250991, 0.896765893922282, 0.660872746586637,
			 "Z", "<unicode>", 3.99688246943697e-08, "Y", 0.120355858166957,
			 5.49098944290589, 0.732635748188917, 1.29452798168317, 1.01358186493604,
			 "Y", "<unicode>", 1.53765888910584e-12, "Y", 0.143342489435109,
			 7.07104968617761, 0.721542954515916, 1.27492759928265, 0.998235276899282,
			 "Z", "<unicode>", 1.53765888910584e-12, "Z", 0.141172146307728,
			 7.07104979988987))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17515664262081, 0.19898054114065, 0.01191194925992,
			 "W", "M", "<unicode>", 0.900678369373086, 0.0954449129454946,
			 0.124804443655604, 50, 16, -0.250367117827483, 0.256906430759303,
			 0.00326965646591023, "W", "M", "<unicode>", 0.979842723600564,
			 0.12940889541545, 0.0252660874309561, 84, 16, -0.477660609823986,
			 0.465335994400638, -0.00616230771167361, "W", "M", "<unicode>",
			 0.97956362297046, 0.240564778654828, -0.025616001420206, 16,
			 50, -0.285600027728774, 0.255933757762182, -0.0148331349832961,
			 "W", "M", "<unicode>", 0.914494958080953, 0.138148912368417,
			 -0.107370624415333, 50, 50, -0.158318473742292, 0.11136761818768,
			 -0.0234754277773059, "W", "M", "<unicode>", 0.732938811960452,
			 0.0687987366240455, -0.341218878852218, 84, 50, -0.322690905724989,
			 0.25687612181521, -0.0329073919548897, "W", "M", "<unicode>",
			 0.823869686646883, 0.147851448320416, -0.222570643228158, 16,
			 84, -0.537941056636039, 0.445576098927959, -0.04618247885404,
			 "W", "M", "<unicode>", 0.853961741174023, 0.250901843942505,
			 -0.184065920474554, 50, 84, -0.350939244232729, 0.241289700936629,
			 -0.0548247716480498, "W", "M", "<unicode>", 0.716693119624935,
			 0.15108158870285, -0.362881884674116, 84, 84, -0.277371899322844,
			 0.148858427671577, -0.0642567358256336, "W", "M", "<unicode>",
			 0.554552407181609, 0.108734224290975, -0.590952262221336))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.157311735263844, 0.112102291166833, -0.0226047220485055, "W",
			 "<unicode>", 0.742235177229438, "M", 0.0687293308845928, -0.328894836564936,
			 -0.219434320875926, 0.758255109178322, 0.269410394151198, "Y",
			 "<unicode>", 0.280067146370022, "M", 0.249415151953336, 1.08016851438762,
			 -0.250026106779323, 0.232282676073244, -0.0088717153530394,
			 "W:Y", "<unicode>", 0.942518990072331, "M", 0.123040215702165,
			 -0.0721041921327132, -0.585977065352088, 0.452208104537436,
			 -0.0668844804073256, "Z", "<unicode>", 0.800624398022235, "M",
			 0.264848022228622, -0.252539097118836, -0.259037001544805, 0.202955885496963,
			 -0.0280405580239212, "W:Z", "<unicode>", 0.811943781098948,
			 "M", 0.117857493986091, -0.237919177436697))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17515664262081, 0.19898054114065, 0.01191194925992,
			 "Total", "W", "M", "<unicode>", 0.900678369373086, 0.0954449129454946,
			 0.124804443655604, 50, 16, -0.250367117827483, 0.256906430759303,
			 0.00326965646591023, "Total", "W", "M", "<unicode>", 0.979842723600564,
			 0.12940889541545, 0.0252660874309561, 84, 16, -0.477660609823986,
			 0.465335994400638, -0.00616230771167361, "Total", "W", "M",
			 "<unicode>", 0.97956362297046, 0.240564778654828, -0.025616001420206,
			 16, 50, -0.285600027728774, 0.255933757762182, -0.0148331349832961,
			 "Total", "W", "M", "<unicode>", 0.914494958080953, 0.138148912368417,
			 -0.107370624415333, 50, 50, -0.158318473742292, 0.11136761818768,
			 -0.0234754277773059, "Total", "W", "M", "<unicode>", 0.732938811960452,
			 0.0687987366240455, -0.341218878852218, 84, 50, -0.322690905724989,
			 0.25687612181521, -0.0329073919548897, "Total", "W", "M", "<unicode>",
			 0.823869686646883, 0.147851448320416, -0.222570643228158, 16,
			 84, -0.537941056636039, 0.445576098927959, -0.04618247885404,
			 "Total", "W", "M", "<unicode>", 0.853961741174023, 0.250901843942505,
			 -0.184065920474554, 50, 84, -0.350939244232729, 0.241289700936629,
			 -0.0548247716480498, "Total", "W", "M", "<unicode>", 0.716693119624935,
			 0.15108158870285, -0.362881884674116, 84, 84, -0.277371899322844,
			 0.148858427671577, -0.0642567358256336, "Total", "W", "M", "<unicode>",
			 0.554552407181609, 0.108734224290975, -0.590952262221336))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(888.390142595547, 930.072865571357, 6, "Model 1", 100, -428.195071297774,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250713701616, 0.0341991764117861, -0.0645257686449151, "Z",
			 "<unicode>", 0.200188229808427, "sm", 0.0503707955020761, -1.28101547735643,
			 -0.00962232683594784, 0.0896223175830575, 0.0399999953735549,
			 "medexperimental", "<unicode>", 0.114128645513458, "sm", 0.0253179765551394,
			 1.57990490616183, 0.180704804599385, 0.319295176626548, 0.249999990612966,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553364042261,
			 7.07106807738034, 0.756348936485436, 1.3364258535154, 1.04638739500042,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147981524560027,
			 7.07106781141427, -0.170527239521493, 0.0272978261643685, -0.0716147066785622,
			 "Z", "<unicode>", 0.155883213071517, "medexperimental", 0.0504665053149651,
			 -1.41905420697569, 0.180704807996422, 0.319295188478254, 0.249999998237338,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553385610694, 7.07106786166146, 0.721541791202579, 1.27492354169259,
			 0.998232666447587, "Z", "<unicode>", 1.53743684450092e-12, "Z",
			 0.141171407958263, 7.07106829126978))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.161065462194807, 1.33098043663047, 0.584957487217831, "s",
			 "M", 0, "<unicode>", 0.124339818093537, "m", 0.380630947964948,
			 1.53681010528786, 16, -0.358875044039608, 1.00789206259699,
			 0.32450850927869, "s", "M", 1, "<unicode>", 0.352008831946516,
			 "m", 0.348671485143983, 0.930699879701047, 50, 0.0267424851522365,
			 1.18684632306517, 0.606794404108703, "s", "M", 0, "<unicode>",
			 0.0403326883420316, "m", 0.295950294766558, 2.05032539192885,
			 50, -0.238349615477602, 0.931040467816727, 0.346345426169562,
			 "s", "M", 1, "<unicode>", 0.245646338215588, "m", 0.298319278445504,
			 1.16098908516511, 84, -0.0593588649715731, 1.32414010993462,
			 0.632390622481523, "s", "M", 0, "<unicode>", 0.0731682258865887,
			 "m", 0.352939897319302, 1.79177992424417, 84, -0.399560650480822,
			 1.14344393956559, 0.371941644542382, "s", "M", 1, "<unicode>",
			 0.344710124067758, "m", 0.393630852969093, 0.944899622925609
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0242260928370315, 1.18799361532788, 0.606109854082454, "sm",
			 "<unicode>", 0.0411947062807585, "M", 0.296884925353347, 2.04156493752949,
			 -0.427734844509414, 0.721274257656449, 0.146769706573517, "medexperimental",
			 "<unicode>", 0.616571355555424, "M", 0.293119953026969, 0.500715509326018,
			 -1.08932599531723, 0.568428039438946, -0.260448977939141, "sm:medexperimental",
			 "<unicode>", 0.53798818427836, "M", 0.42290420840187, -0.615858089763074,
			 -0.226807989822628, 0.320133541185831, 0.0466627756816015, "Z",
			 "<unicode>", 0.738053637805202, "M", 0.139528464635744, 0.334431944072633,
			 -0.39268563820285, 0.438474937617554, 0.022894649707352, "sm:Z",
			 "<unicode>", 0.914014745958629, "M", 0.212034655324407, 0.10797598002234
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.161065462194807, 1.33098043663047, 0.584957487217831, "Total",
			 "s", "M", 0, "<unicode>", 0.124339818093537, "m", 0.380630947964948,
			 1.53681010528786, 16, -0.358875044039608, 1.00789206259699,
			 0.32450850927869, "Total", "s", "M", 1, "<unicode>", 0.352008831946516,
			 "m", 0.348671485143983, 0.930699879701047, 50, 0.0267424851522365,
			 1.18684632306517, 0.606794404108703, "Total", "s", "M", 0, "<unicode>",
			 0.0403326883420316, "m", 0.295950294766558, 2.05032539192885,
			 50, -0.238349615477602, 0.931040467816727, 0.346345426169562,
			 "Total", "s", "M", 1, "<unicode>", 0.245646338215588, "m", 0.298319278445504,
			 1.16098908516511, 84, -0.0593588649715731, 1.32414010993462,
			 0.632390622481523, "Total", "s", "M", 0, "<unicode>", 0.0731682258865887,
			 "m", 0.352939897319302, 1.79177992424417, 84, -0.399560650480822,
			 1.14344393956559, 0.371941644542382, "Total", "s", "M", 1, "<unicode>",
			 0.344710124067758, "m", 0.393630852969093, 0.944899622925609
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "Y", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1202.63140796962, 1249.52447131741, 12, "Model 1", 100, -583.315703984811,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403934719485908, 0.194627523139163, -0.104653598173373, "Z",
			 "<unicode>", 0.493112617592176, "W", 0.152697255497156, -0.685366595703628,
			 -0.54484893124694, 0.0642081196599298, -0.240320405793505, "Y",
			 "<unicode>", 0.121931586882155, "W", 0.155374551703765, -1.54671664798556,
			 1.68041109906878, 2.96919185457515, 2.32480147682197, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776642242437, 7.07106642663404,
			 0.76095392253491, 1.34456260813113, 1.05275826533302, "M", "<unicode>",
			 1.53743684450092e-12, "M", 0.14888250248465, 7.0710677733373,
			 0.424979147181667, 0.896762978356815, 0.660871062769241, "Z",
			 "<unicode>", 3.99655020189016e-08, "Y", 0.120355229712515, 5.49100412460533,
			 0.732634580828943, 1.29452390997947, 1.01357924540421, "Y",
			 "<unicode>", 1.53743684450092e-12, "Y", 0.143341748517483, 7.07106796091987,
			 0.721541757181454, 1.27492342302875, 0.998232590105103, "Z",
			 "<unicode>", 1.53743684450092e-12, "Z", 0.141171386365337, 7.07106883204916
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220182733576812, 0.191149893780464, -0.0145164198981741,
			 "W", "M", "<unicode>", 0.889972550313695, 0.104933720874928,
			 -0.138338941735197, 50, 16, -0.253451043483989, 0.257888208611024,
			 0.00221858256351789, "W", "M", "<unicode>", 0.986430505331174,
			 0.130446083736332, 0.0170076594097088, 84, 16, -0.48040495075626,
			 0.521370372329285, 0.0204827107865124, "W", "M", "<unicode>",
			 0.936119180000883, 0.255559625326644, 0.080148461480691, 16,
			 50, -0.338190016263921, 0.282578208006221, -0.0278059041288497,
			 "W", "M", "<unicode>", 0.860620553730323, 0.158362150826924,
			 -0.1755842793474, 50, 50, -0.212793523976785, 0.161540545055392,
			 -0.0256264894606964, "W", "M", "<unicode>", 0.788426950806225,
			 0.0954951397027894, -0.268353861154128, 84, 50, -0.330684915806524,
			 0.284189045112793, -0.0232479353468655, "W", "M", "<unicode>",
			 0.882177345274006, 0.1568584845868, -0.148209613321879, 16,
			 84, -0.687596860251758, 0.600830421316987, -0.0433832194673854,
			 "W", "M", "<unicode>", 0.894992460157817, 0.328686468662612,
			 -0.131989672845088, 50, 84, -0.434125868485485, 0.31759549278684,
			 -0.0582651878493224, "W", "M", "<unicode>", 0.761257573720771,
			 0.19176917718943, -0.303829784865625, 84, 84, -0.289302187361277,
			 0.140288257583636, -0.0745069648888202, "W", "M", "<unicode>",
			 0.496592262580247, 0.109591412988572, -0.679861340017484))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209965686053068, 0.160438800652554, -0.0247634427002567, "W",
			 "<unicode>", 0.793269540287346, "M", 0.0944926768112387, -0.262067321362107,
			 -0.264231158096318, 0.71891588648238, 0.227342364193031, "Y",
			 "<unicode>", 0.364701994714644, "M", 0.250807426139877, 0.90644191717928,
			 -0.238546135055623, 0.243957487573035, 0.00270567625870588,
			 "W:Y", "<unicode>", 0.982462873758645, "M", 0.123089920640018,
			 0.0219812982625828, -0.62830373750896, 0.464182018987634, -0.0820608592606628,
			 "Z", "<unicode>", 0.768420900113276, "M", 0.278700467231536,
			 -0.294441053780111, -0.276763043740878, 0.218489436717651, -0.0291368035116134,
			 "W:Z", "<unicode>", 0.817611528456655, "M", 0.126342240052628,
			 -0.230618069613745, -0.168390618628367, 0.137059128603864, -0.0156657450122515,
			 "W:Y:Z", "<unicode>", 0.840664801536042, "M", 0.077922285726059,
			 -0.201043191511675, -0.234142199130234, 0.527680821946979, 0.146769311408372,
			 "Y:Z", "<unicode>", 0.450131836781496, "M", 0.194346178574294,
			 0.755195252538838))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220182733576812, 0.191149893780464, -0.0145164198981741,
			 "Total", "W", "M", "<unicode>", 0.889972550313695, 0.104933720874928,
			 -0.138338941735197, 50, 16, -0.253451043483989, 0.257888208611024,
			 0.00221858256351789, "Total", "W", "M", "<unicode>", 0.986430505331174,
			 0.130446083736332, 0.0170076594097088, 84, 16, -0.48040495075626,
			 0.521370372329285, 0.0204827107865124, "Total", "W", "M", "<unicode>",
			 0.936119180000883, 0.255559625326644, 0.080148461480691, 16,
			 50, -0.338190016263921, 0.282578208006221, -0.0278059041288497,
			 "Total", "W", "M", "<unicode>", 0.860620553730323, 0.158362150826924,
			 -0.1755842793474, 50, 50, -0.212793523976785, 0.161540545055392,
			 -0.0256264894606964, "Total", "W", "M", "<unicode>", 0.788426950806225,
			 0.0954951397027894, -0.268353861154128, 84, 50, -0.330684915806524,
			 0.284189045112793, -0.0232479353468655, "Total", "W", "M", "<unicode>",
			 0.882177345274006, 0.1568584845868, -0.148209613321879, 16,
			 84, -0.687596860251758, 0.600830421316987, -0.0433832194673854,
			 "Total", "W", "M", "<unicode>", 0.894992460157817, 0.328686468662612,
			 -0.131989672845088, 50, 84, -0.434125868485485, 0.31759549278684,
			 -0.0582651878493224, "Total", "W", "M", "<unicode>", 0.761257573720771,
			 0.19176917718943, -0.303829784865625, 84, 84, -0.289302187361277,
			 0.140288257583636, -0.0745069648888202, "Total", "W", "M", "<unicode>",
			 0.496592262580247, 0.109591412988572, -0.679861340017484))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "med", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(887.37892431538, 934.271987663166, 12, "Model 1", 100, -425.68946215769,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250713701575, 0.034199176411745, -0.0645257686449151, "Z",
			 "<unicode>", 0.200188229808239, "sm", 0.0503707955020551, -1.28101547735696,
			 -0.00962232683601574, 0.0896223175831254, 0.0399999953735549,
			 "medexperimental", "<unicode>", 0.114128645513953, "sm", 0.025317976555174,
			 1.57990490615966, 0.180704804599391, 0.319295176626542, 0.249999990612966,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553364042231,
			 7.07106807738094, 0.719380656934087, 1.27110499138571, 0.995242824159901,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.140748589975009,
			 7.07106781202291, -0.170527239521602, 0.0272978261644779, -0.0716147066785622,
			 "Z", "<unicode>", 0.155883213071974, "medexperimental", 0.0504665053150208,
			 -1.41905420697412, 0.180704807996413, 0.319295188478263, 0.249999998237338,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553385610739, 7.07106786166056, 0.721541791202229, 1.27492354169294,
			 0.998232666447587, "Z", "<unicode>", 1.53743684450092e-12, "Z",
			 0.141171407958442, 7.07106829126084))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.879096135662962, 0.89332247553067, 0.00711316993385364,
			 "s", "M", 0, "<unicode>", 0.987448457027282, "m", 0.452155913367349,
			 0.0157316751225912, 16, -0.22623610084653, 1.45144461316699,
			 0.61260425616023, "s", "M", 1, "<unicode>", 0.152327153056169,
			 "m", 0.42798763835633, 1.43135969653916, 50, -0.0706048608473389,
			 1.07522417216051, 0.502309655656585, "s", "M", 0, "<unicode>",
			 0.0857196942797964, "m", 0.292308695987784, 1.71842186890525,
			 50, -0.295309938962812, 0.864575094355603, 0.284632577696395,
			 "s", "M", 1, "<unicode>", 0.336080006918855, "m", 0.295894476242278,
			 0.96193947690777, 84, 0.299944752023776, 1.86556713852616, 1.08275594527497,
			 "s", "M", 0, "<unicode>", 0.00670905736716132, "m", 0.399400805028005,
			 2.71095083345926, 84, -1.01442802676004, 0.814826886236355,
			 -0.0998005702618417, "s", "M", 1, "<unicode>", 0.830653424053209,
			 "m", 0.466655236378149, -0.213863603109705))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0900823230834538, 1.0636545072775, 0.486786092097024, "sm",
			 "<unicode>", 0.0981476435559117, "M", 0.294326028299878, 1.653900930573,
			 -0.45671062992195, 0.690161425497172, 0.116725397787611, "medexperimental",
			 "<unicode>", 0.689923271371556, "M", 0.292574778022837, 0.39895919455675,
			 -1.0101170732093, 0.626372747670924, -0.191872162769187, "sm:medexperimental",
			 "<unicode>", 0.645805844040443, "M", 0.417479564366653, -0.459596538719856,
			 -0.308134865845155, 0.319885281038118, 0.00587520759648157,
			 "Z", "<unicode>", 0.970746996836771, "M", 0.160212165079822,
			 0.0366714200107987, -0.075954181167165, 1.11431963665622, 0.519182727744529,
			 "sm:Z", "<unicode>", 0.0872983994322345, "M", 0.303646859639288,
			 1.70982413044312, -1.7325379163599, 0.00645663268079, -0.863040641839553,
			 "sm:medexperimental:Z", "<unicode>", 0.0517256684177121, "M",
			 0.443629210219589, -1.94540986472095, -0.448506068173794, 0.741301251482179,
			 0.146397591654192, "medexperimental:Z", "<unicode>", 0.629578553594368,
			 "M", 0.303527852817965, 0.482320124150159))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.879096135662962, 0.89332247553067, 0.00711316993385364,
			 "Total", "s", "M", 0, "<unicode>", 0.987448457027282, "m", 0.452155913367349,
			 0.0157316751225912, 16, -0.22623610084653, 1.45144461316699,
			 0.61260425616023, "Total", "s", "M", 1, "<unicode>", 0.152327153056169,
			 "m", 0.42798763835633, 1.43135969653916, 50, -0.0706048608473389,
			 1.07522417216051, 0.502309655656585, "Total", "s", "M", 0, "<unicode>",
			 0.0857196942797964, "m", 0.292308695987784, 1.71842186890525,
			 50, -0.295309938962812, 0.864575094355603, 0.284632577696395,
			 "Total", "s", "M", 1, "<unicode>", 0.336080006918855, "m", 0.295894476242278,
			 0.96193947690777, 84, 0.299944752023776, 1.86556713852616, 1.08275594527497,
			 "Total", "s", "M", 0, "<unicode>", 0.00670905736716132, "m",
			 0.399400805028005, 2.71095083345926, 84, -1.01442802676004,
			 0.814826886236355, -0.0998005702618417, "Total", "s", "M", 1,
			 "<unicode>", 0.830653424053209, "m", 0.466655236378149, -0.213863603109705
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(459.709342975141, 483.155874649034, 0, "Model 1", 100, -220.854671487571,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089500486, 2.96919114281872, 2.32480101891179, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512726659, 7.07106781938708,
			 0.79850843700121, 1.41091930982898, 1.1047138734151, "M", "<unicode>",
			 1.53743684450092e-12, "M", 0.156230134241852, 7.07106781144378,
			 0.00468047959390449, 0.00827014307736615, 0.00647531133563532,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000915747307546586,
			 7.07106783964627))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, "W",
			 "M", "", "<unicode>", "", 0.536343446165773, 0.0699572528327317,
			 -0.618351825661737, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.843493105517029, 0.0120012348671278, 0.197427379485498))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, "W",
			 "<unicode>", 0.536343446165773, "M", 0.0699572528327317, -0.618351825661737,
			 -2.81958314086857, 2.30044871074282, -0.259567215062877, "jasp",
			 "<unicode>", 0.842476880392771, "M", 1.30615457528749, -0.198726261021399,
			 -0.0194720937763586, 0.00121576390948324, -0.00912816493343769,
			 "W", "<unicode>", 0.0837015035455533, "jasp", 0.00527761169312933,
			 -1.72960146827801))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023198584645, 0.0942455532706607, -0.0408888226569923, "Total",
			 "W", "M", "<unicode>", 0.553151760947466, 0.0689473770914036,
			 -0.593043918157843, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, "Total indirect", "W", "M", "<unicode>",
			 0.843493105517029, 0.0120012348671278, 0.197427379485498))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(234.766135212086, 258.212666885979, 0, "Model 1", 100, -108.383067606043,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704810207797, 0.319295196191503, 0.25000000319965, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553399646345,
			 7.07106772130382, 0.762533966062566, 1.34735445145525, 1.05494420875891,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.149191640766277,
			 7.07106781144378, 0.0048066281871781, 0.00849304083605079, 0.00664983451161445,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000940428670616055,
			 7.07106739659296))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991965639, 0.868598726146002, 0.465400612671283, "s",
			 "M", "", "<unicode>", "", 0.0236768306591097, "m", 0.205717103301435,
			 2.26233310309321, -0.0219205602251843, 0.0213787048213383, -0.000270927701922977,
			 "s", "jasp", "M", "<unicode>", "<unicode>", 0.980431952510507,
			 "m", 0.0110459338508416, -0.0245273695806476))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0622024991965639, 0.868598726146002, 0.465400612671283, "sm",
			 "<unicode>", 0.0236768306591097, "M", 0.205717103301435, 2.26233310309321,
			 -2.43771284938872, 2.49956339312939, 0.0309252718703352, "jasp",
			 "<unicode>", 0.980411525583682, "M", 1.25953238974357, 0.0245529786468067,
			 -0.0407263692122695, 0.0232049257107259, -0.0087607217507718,
			 "sm", "<unicode>", 0.591156408942288, "jasp", 0.0163093034941655,
			 -0.537160998561702))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0625107998260226, 0.867748570112698, 0.46512968496936, "Total",
			 "s", "M", "<unicode>", 0.0235575795563017, "m", 0.205421573212132,
			 2.26426892607348, -0.0219205602251843, 0.0213787048213383, -0.000270927701922977,
			 "Total indirect", "s", "M", "<unicode>", 0.980431952510507,
			 "m", 0.0110459338508416, -0.0245273695806476))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(994.47021560483, 1056.99430006854, 6, "Model 1", 100, -473.235107802415,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403936335154203, 0.194627260090051, -0.104654537532076, "Z",
			 "<unicode>", 0.493109713711227, "W", 0.15269760055941, -0.685371198687292,
			 -0.544846693697774, 0.0642098763845074, -0.240318408656634,
			 "Y", "<unicode>", 0.121934393179746, "W", 0.155374429042177,
			 -1.54670501534972, 1.68041034701259, 2.96918923146479, 2.32479978923869,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776164923927,
			 7.07107155951102, 0.770087764351801, 1.36070158389967, 1.06539467412574,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150669559289497,
			 7.07106783314263, 0.00462621316576298, 0.00817425856321058,
			 0.00640023586448678, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000905130253778673, 7.07106611205131, 0.424979799965003,
			 0.896765348125679, 0.660872574045341, "Z", "<unicode>", 3.99671826745163e-08,
			 "Y", 0.120355667727076, 5.49099669775393, 0.732634727383019,
			 1.29452442114643, 1.01357957426473, "Y", "<unicode>", 1.53743684450092e-12,
			 "Y", 0.143341841532683, 7.07106566670988, 0.721543052421166,
			 1.274927940758, 0.998235496589583, "Z", "<unicode>", 1.53765888910584e-12,
			 "Z", 0.1411722084441, 7.07104824378274))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17662603987508, 0.198183782734888, 0.0107788714299038,
			 "W", "M", "", "<unicode>", "", 0.910244429525087, 0.0956165076415742,
			 0.112730235560467, 50, 16, -0.25364284712116, 0.255685959288872,
			 0.00102155608385586, "W", "M", "", "<unicode>", "", 0.993726965890373,
			 0.129933205514885, 0.00786216333082642, 84, 16, -0.482413938292148,
			 0.463159311305014, -0.00962731349356722, "W", "M", "", "<unicode>",
			 "", 0.968164417379325, 0.241222098226223, -0.0399105785264272,
			 16, 50, -0.287055904057026, 0.254966162045428, -0.0160448710057994,
			 "W", "M", "", "<unicode>", "", 0.907623036583779, 0.138273476037788,
			 -0.116037229015741, 50, 50, -0.162770699722108, 0.111166327018414,
			 -0.0258021863518474, "W", "M", "", "<unicode>", "", 0.711964612252681,
			 0.0698831786964716, -0.369218842547443, 84, 50, -0.328512602408522,
			 0.255610490549981, -0.0364510559292705, "W", "M", "", "<unicode>",
			 "", 0.806754226053921, 0.149013731263939, -0.244615416445796,
			 16, 84, -0.539344034334301, 0.444371205631329, -0.0474864143514864,
			 "W", "M", "", "<unicode>", "", 0.8499166278163, 0.250952376606165,
			 -0.189224804298266, 50, 84, -0.354370228989922, 0.239882769594853,
			 -0.0572437296975343, "W", "M", "", "<unicode>", "", 0.705726058269976,
			 0.15159793834789, -0.37760229671574, 84, 84, -0.284292547035944,
			 0.148507348486029, -0.0678925992749574, "W", "M", "", "<unicode>",
			 "", 0.538612456898277, 0.110410165425447, -0.614912576331577,
			 16, 16, -0.0111496082978387, 0.0134144431296098, 0.00113241741588554,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.856594411292176,
			 0.00626645479743676, 0.180711016434483, 50, 16, -0.0215878488296315,
			 0.0260832588797613, 0.00224770502506489, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.853365816217869, 0.0121612203299184, 0.184825614871494,
			 84, 16, -0.0336129662687324, 0.040542765670904, 0.00346489970108582,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.854674664856362,
			 0.0189176261718499, 0.183157213786247, 16, 50, -0.0123697654317444,
			 0.0147924475400767, 0.00121134105416614, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.86122478695253, 0.00692926328903828, 0.174815273087172,
			 50, 50, -0.0219771855611938, 0.0266304428878848, 0.0023266286633455,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.851167232353355,
			 0.0124001330719568, 0.187629330253498, 84, 50, -0.0336750306948286,
			 0.0407626773735615, 0.00354382333936643, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.851958930580048, 0.0189895601795608, 0.186619558634159,
			 16, 84, -0.0151131483694201, 0.0177208517140655, 0.0013038516723227,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.876299487185875,
			 0.00837617434362977, 0.155661954829569, 50, 84, -0.0233255079589225,
			 0.0281637865219266, 0.00241913928150205, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.853879051833782, 0.0131352654658427, 0.18417132777353,
			 84, 84, -0.034353275420357, 0.041625943335403, 0.00363633395752298,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.851185420591928,
			 0.0193828099279054, 0.187606129918643))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161747319500839, 0.111897622706291, -0.0249248483972736, "W",
			 "<unicode>", 0.721057975671585, "M", 0.0698086659667235, -0.357045189907436,
			 -2.77216347423196, 2.2853309199467, -0.243416277142631, "jasp",
			 "<unicode>", 0.850355060471791, "M", 1.29020084911548, -0.188665413845844,
			 -0.218443524920422, 0.759300830141341, 0.27042865261046, "Y",
			 "<unicode>", 0.278280479935642, "M", 0.249429163692314, 1.08419019094355,
			 -0.251420994229452, 0.231388318544134, -0.0100163378426592,
			 "W:Y", "<unicode>", 0.93518537786013, "M", 0.123167904252814,
			 -0.0813226294903879, -0.584165711491852, 0.45487817184451, -0.0646437698236712,
			 "Z", "<unicode>", 0.807326070685034, "M", 0.265067085806731,
			 -0.243877015612587, -0.259079968576959, 0.202833916080203, -0.0281230262483783,
			 "W:Z", "<unicode>", 0.811369455047622, "M", 0.117837339946213,
			 -0.238659717380034, -0.0199698669730401, 0.000907977167533359,
			 -0.00953094490275338, "W", "<unicode>", 0.0735365208536713,
			 "jasp", 0.00532607851604806, -1.78948636863606, -0.0336994081748133,
			 0.0420651977380579, 0.0041828947816223, "Y", "<unicode>", 0.828663770322511,
			 "jasp", 0.0193280607476701, 0.21641564749979, -0.0233913482400559,
			 0.0139844622541412, -0.00470344299295736, "W:Y", "<unicode>",
			 0.621806858075437, "jasp", 0.00953482073880252, -0.493291182058245,
			 -0.0310212766175894, 0.0494313577717845, 0.00920504057709755,
			 "Z", "<unicode>", 0.653791583572263, "jasp", 0.0205240083552489,
			 0.448501112344531, -0.0182406683499735, 0.0175607916478939,
			 -0.000339938351039806, "W:Z", "<unicode>", 0.970309513819926,
			 "jasp", 0.00913319333423084, -0.0372200980095024))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175157302511728, 0.198979880203307, 0.0119112888457894,
			 "Total", "W", "M", "<unicode>", 0.900683847090116, 0.0954449126785446,
			 0.124797524682182, 50, 16, -0.250367512509345, 0.256906034727186,
			 0.00326926110892075, "Total", "W", "M", "<unicode>", 0.979845160385428,
			 0.129408895070991, 0.0252630323991817, 84, 16, -0.477660714675628,
			 0.465335887090665, -0.00616241379248139, "Total", "W", "M",
			 "<unicode>", 0.979563271192916, 0.240564778027691, -0.0256164424526522,
			 16, 50, -0.285600421980659, 0.255933362077392, -0.0148335299516333,
			 "Total", "W", "M", "<unicode>", 0.91449268981178, 0.138148912002874,
			 -0.107373483703764, 50, 50, -0.15831860327848, 0.111367487901476,
			 -0.0234755576885019, "Total", "W", "M", "<unicode>", 0.732937389822532,
			 0.0687987364327114, -0.34122076807998, 84, 50, -0.322690745592927,
			 0.256876280413119, -0.032907232589904, "Total", "W", "M", "<unicode>",
			 0.823870525166097, 0.147851447929043, -0.222569565944981, 16,
			 84, -0.537941139180713, 0.445576013822386, -0.0461825626791637,
			 "Total", "W", "M", "<unicode>", 0.853961478706265, 0.250901843289203,
			 -0.184066255049116, 50, 84, -0.350939062216749, 0.241289881384685,
			 -0.0548245904160323, "Total", "W", "M", "<unicode>", 0.716694015032825,
			 0.151081588302862, -0.362880686070956, 84, 84, -0.277371428220891,
			 0.148858897586022, -0.0642562653174344, "Total", "W", "M", "<unicode>",
			 0.554555305480186, 0.108734223988033, -0.590947936727871, 16,
			 16, -0.0111496082978387, 0.0134144431296098, 0.00113241741588554,
			 "Total indirect", "W", "M", "<unicode>", 0.856594411292176,
			 0.00626645479743676, 0.180711016434483, 50, 16, -0.0215878488296315,
			 0.0260832588797613, 0.00224770502506489, "Total indirect", "W",
			 "M", "<unicode>", 0.853365816217869, 0.0121612203299184, 0.184825614871494,
			 84, 16, -0.0336129662687324, 0.040542765670904, 0.00346489970108582,
			 "Total indirect", "W", "M", "<unicode>", 0.854674664856362,
			 0.0189176261718499, 0.183157213786247, 16, 50, -0.0123697654317444,
			 0.0147924475400767, 0.00121134105416614, "Total indirect", "W",
			 "M", "<unicode>", 0.86122478695253, 0.00692926328903828, 0.174815273087172,
			 50, 50, -0.0219771855611938, 0.0266304428878848, 0.0023266286633455,
			 "Total indirect", "W", "M", "<unicode>", 0.851167232353355,
			 0.0124001330719568, 0.187629330253498, 84, 50, -0.0336750306948286,
			 0.0407626773735615, 0.00354382333936643, "Total indirect", "W",
			 "M", "<unicode>", 0.851958930580048, 0.0189895601795608, 0.186619558634159,
			 16, 84, -0.0151131483694201, 0.0177208517140655, 0.0013038516723227,
			 "Total indirect", "W", "M", "<unicode>", 0.876299487185875,
			 0.00837617434362977, 0.155661954829569, 50, 84, -0.0233255079589225,
			 0.0281637865219266, 0.00241913928150205, "Total indirect", "W",
			 "M", "<unicode>", 0.853879051833782, 0.0131352654658427, 0.18417132777353,
			 84, 84, -0.034353275420357, 0.041625943335403, 0.00363633395752298,
			 "Total indirect", "W", "M", "<unicode>", 0.851185420591928,
			 0.0193828099279054, 0.187606129918643))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(685.429979661898, 747.954064125612, 6, "Model 1", 100, -318.714989830949,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250983216219, 0.0341989507437262, -0.0645260162362465, "Z",
			 "<unicode>", 0.200186603263831, "sm", 0.0503708066876242, -1.28102010826243,
			 -0.00962228283197884, 0.0896223766216305, 0.0400000468948258,
			 "medexperimental", "<unicode>", 0.114128234236348, "sm", 0.025317980390568,
			 1.57990670178919, 0.180704794824098, 0.319295142534337, 0.249999968679218,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553302008153,
			 7.07106869768261, 0.756337499871344, 1.33640564566332, 1.04637157276733,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.1479792869582,
			 7.07106781142219, 0.00473838184223441, 0.00837245390196784,
			 0.00655541787210112, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000927076234154943, 7.07106668318014, -0.170527327947284,
			 0.027297813645229, -0.0716147571510274, "Z", "<unicode>", 0.155883080249962,
			 "medexperimental", 0.0504665246792626, -1.41905466259409, 0.180704827733195,
			 0.319295257318888, 0.250000042526042, "medexperimental", "<unicode>",
			 1.53743684450092e-12, "medexperimental", 0.0353553510877946,
			 7.07106660899054, 0.72154187370912, 1.27492382947063, 0.998232851589875,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171460324403,
			 7.07106697979889))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.160966936946416, 1.33182551374, 0.585429288396791, "s",
			 "M", "", 0, "<unicode>", "", 0.124224648262154, "m", 0.38082139836787,
			 1.53728044407649, 16, -0.360278235774999, 1.00801085617087,
			 0.323866310197934, "s", "M", "", 1, "<unicode>", "", 0.353498436781024,
			 "m", 0.349059753836998, 0.927824839838657, 50, 0.0268555789958278,
			 1.1872899033158, 0.607072741155816, "s", "M", "", 0, "<unicode>",
			 "", 0.0402979555502774, "m", 0.29603460407266, 2.05068168654639,
			 50, -0.240696017921072, 0.931715543834989, 0.345509762956959,
			 "s", "M", "", 1, "<unicode>", "", 0.248007296018375, "m", 0.299090077930996,
			 1.15520302561382, 84, -0.0593069506334035, 1.3241913303755,
			 0.632442189871049, "s", "M", "", 0, "<unicode>", "", 0.0731446713444379,
			 "m", 0.352939720301435, 1.79192693112268, 84, -0.402473478138683,
			 1.14423190148307, 0.370879211672192, "s", "M", "", 1, "<unicode>",
			 "", 0.347245173974047, "m", 0.394574949290386, 0.939946168248114,
			 16, -0.0244283894400712, 0.0234847846908252, -0.000471802374623043,
			 "s", "jasp", "M", 0, "<unicode>", "<unicode>", 0.969209588462472,
			 "m", 0.0122229731027788, -0.0385996410738876, 16, -0.0318354200595275,
			 0.0331198142882155, 0.000642197114343996, "s", "jasp", "M",
			 1, "<unicode>", "<unicode>", 0.969085399557278, "m", 0.0165705173309565,
			 0.0387554052488309, 50, -0.0144874741583837, 0.0139308030436161,
			 -0.000278335557383788, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.9693745547348, "m", 0.00724969372553768, -0.0383927332548308,
			 50, -0.0413457006255193, 0.0430170284886858, 0.000835663931583251,
			 "s", "jasp", "M", 1, "<unicode>", "<unicode>", 0.969026515603792,
			 "m", 0.0215214998284784, 0.0388292608899616, 84, -0.00379187968753868,
			 0.0036887541833257, -5.15627521064903e-05, "s", "jasp", "M",
			 0, "<unicode>", "<unicode>", 0.978444256949649, "m", 0.00190836003362069,
			 -0.027019404723469, 84, -0.0525716275339396, 0.0546965010076607,
			 0.00106243673686055, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969029984171162, "m", 0.027364821340524, 0.0388249104074072
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.024338351088441, 1.18845016071051, 0.606394255899478, "sm",
			 "<unicode>", 0.0411595853401998, "M", 0.296972755317047, 2.0419188125594,
			 -2.52535807336346, 2.42710102157745, -0.0491285258930035, "jasp",
			 "<unicode>", 0.968981446199107, "M", 1.26340563755387, -0.038885789672526,
			 -0.427962420454414, 0.721164092553237, 0.146600836049411, "medexperimental",
			 "<unicode>", 0.617012908287648, "M", 0.293149905322704, 0.5000882940352,
			 -1.09233336631245, 0.569207409914738, -0.261562978198857, "sm:medexperimental",
			 "<unicode>", 0.5371801926359, "M", 0.423870231630074, -0.617082679274188,
			 -0.226798874973649, 0.3205405753407, 0.0468708501835257, "Z",
			 "<unicode>", 0.737112947251242, "M", 0.139629976528062, 0.335678994933483,
			 -0.39301106549621, 0.438394694682674, 0.0226918145932323, "sm:Z",
			 "<unicode>", 0.914798653137248, "M", 0.212097203503969, 0.106987806620504,
			 -0.0402675142633745, 0.0518453259851349, 0.00578890586088022,
			 "sm", "<unicode>", 0.805410502839226, "jasp", 0.0234986053251702,
			 0.246351040020214, -0.0489096353246045, 0.0420350678256656,
			 -0.00343728374946945, "medexperimental", "<unicode>", 0.88222051218656,
			 "jasp", 0.0232006056916429, -0.148154914365343, -0.0882812792419863,
			 0.0429308654561868, -0.0226752068928998, "sm:medexperimental",
			 "<unicode>", 0.498142187346072, "jasp", 0.0334731009684764,
			 -0.677415782728178, -0.0174100260197651, 0.0258806973434847,
			 0.0042353356618598, "Z", "<unicode>", 0.701345331890019, "jasp",
			 0.0110437548099663, 0.383505042871621, -0.0370221286796712,
			 0.0287646885916909, -0.00412872004399018, "sm:Z", "<unicode>",
			 0.805673664736493, "jasp", 0.0167826597300461, -0.24601106799529
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.16106546336287, 1.33098043540721, 0.584957486022167, "Total",
			 "s", "M", 0, "<unicode>", 0.124339818849076, "m", 0.380630947950866,
			 1.53681010220345, 16, -0.358875046046061, 1.00789206067062,
			 0.324508507312278, "Total", "s", "M", 1, "<unicode>", 0.352008834892863,
			 "m", 0.348671485164412, 0.930699874006787, 50, 0.0267424866714,
			 1.18684632452546, 0.606794405598432, "Total", "s", "M", 0, "<unicode>",
			 0.0403326878410031, "m", 0.29595029475154, 2.05032539706661,
			 50, -0.238349614773835, 0.931040468550919, 0.346345426888542,
			 "Total", "s", "M", 1, "<unicode>", 0.245646337247743, "m", 0.298319278453266,
			 1.16098908754501, 84, -0.059358860306221, 1.32414011454411,
			 0.632390627118943, "Total", "s", "M", 0, "<unicode>", 0.0731682237694238,
			 "m", 0.35293989730505, 1.79177993745592, 84, -0.399560646589365,
			 1.14344394340747, 0.371941648409053, "Total", "s", "M", 1, "<unicode>",
			 0.34471011903679, "m", 0.393630852956447, 0.944899632779055,
			 16, -0.0244283894400712, 0.0234847846908252, -0.000471802374623043,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.969209588462472,
			 "m", 0.0122229731027788, -0.0385996410738876, 16, -0.0318354200595275,
			 0.0331198142882155, 0.000642197114343996, "Total indirect",
			 "s", "M", 1, "<unicode>", 0.969085399557278, "m", 0.0165705173309565,
			 0.0387554052488309, 50, -0.0144874741583837, 0.0139308030436161,
			 -0.000278335557383788, "Total indirect", "s", "M", 0, "<unicode>",
			 0.9693745547348, "m", 0.00724969372553768, -0.0383927332548308,
			 50, -0.0413457006255193, 0.0430170284886858, 0.000835663931583251,
			 "Total indirect", "s", "M", 1, "<unicode>", 0.969026515603792,
			 "m", 0.0215214998284784, 0.0388292608899616, 84, -0.00379187968753868,
			 0.0036887541833257, -5.15627521064903e-05, "Total indirect",
			 "s", "M", 0, "<unicode>", 0.978444256949649, "m", 0.00190836003362069,
			 -0.027019404723469, 84, -0.0525716275339396, 0.0546965010076607,
			 0.00106243673686055, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969029984171162, "m", 0.027364821340524, 0.0388249104074072
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(993.067814933798, 1052.98672921152, 12, "Model 1", 100, -473.533907466899,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403934294121032, 0.194627698096129, -0.104653298012451, "Z",
			 "<unicode>", 0.493113676826481, "W", 0.152697191616413, -0.685364916699636,
			 -0.544848520102322, 0.064208280191367, -0.240320119955477, "Y",
			 "<unicode>", 0.121931877151799, "W", 0.155374487770656, -1.54671544475312,
			 1.68041079880807, 2.96919080728206, 2.32480080304506, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776451669448, 7.07106847598202,
			 0.769964633305562, 1.36048402552725, 1.06522432941641, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.150645470243237, 7.07106777055068,
			 0.00465468594499418, 0.00822456752935371, 0.00643962673717395,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000910700811983867,
			 7.07106730600788, 0.424979055650715, 0.896762762349977, 0.660870909000346,
			 "Z", "<unicode>", 3.99654631610957e-08, "Y", 0.120355197957879,
			 5.49100429573166, 0.732634547660127, 1.29452379428455, 1.01357917097234,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341727464519,
			 7.0710684802039, 0.721541711175052, 1.27492326256062, 0.998232486867837,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.14117135716538,
			 7.07106956334225))


	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.179638968435534, 0.198137676035385, 0.0092493537999258,
			 "W", "M", "", "<unicode>", "", 0.923541085604784, 0.0963733638604518,
			 0.0959741720058545, 50, 16, -0.253468625790696, 0.255844904767958,
			 0.00118813948863128, "W", "M", "", "<unicode>", "", 0.992703840629896,
			 0.129929308542416, 0.00914450713207181, 84, 16, -0.481389405926762,
			 0.466170103170285, -0.00760965137823876, "W", "M", "", "<unicode>",
			 "", 0.974886647727583, 0.241728806389116, -0.0314801181204251,
			 16, 50, -0.289012428124915, 0.254390864080486, -0.0173107820222148,
			 "W", "M", "", "<unicode>", "", 0.900623191636149, 0.138625836110178,
			 -0.124874139683864, 50, 50, -0.162489911333858, 0.111745918666839,
			 -0.0253719963335093, "W", "M", "", "<unicode>", "", 0.716853347962077,
			 0.0699594054186287, -0.362667409502502, 84, 50, -0.328336297304783,
			 0.259996722904024, -0.0341697872003794, "W", "M", "", "<unicode>",
			 "", 0.819906330371806, 0.150087712031829, -0.227665454671819,
			 16, 84, -0.540486494886591, 0.443599818975621, -0.0484433379554851,
			 "W", "M", "", "<unicode>", "", 0.846986235746787, 0.25104704005394,
			 -0.192965182720643, 50, 84, -0.353826556403179, 0.24081745186962,
			 -0.0565045522667796, "W", "M", "", "<unicode>", "", 0.709534530455147,
			 0.151697687550199, -0.372481302643995, 84, 84, -0.285370882927835,
			 0.154766196660536, -0.0653023431336497, "W", "M", "", "<unicode>",
			 "", 0.560841108938639, 0.112281930448752, -0.581592629131498,
			 16, 16, -0.0178571986128888, 0.0222266710606334, 0.00218473622387233,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.830818256567571,
			 0.0102256648565225, 0.213652242130621, 50, 16, -0.0213709538754851,
			 0.0261026264422218, 0.00236583628336835, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.845119881658276, 0.0121108297632437, 0.195348818340148,
			 84, 16, -0.0477631655344829, 0.0498882032327905, 0.0010625188491538,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.965979178487907,
			 0.0249115212160874, 0.0426517048050703, 16, 50, -0.0178571986128888,
			 0.0222266710606334, 0.00218473622387233, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.830818256567571, 0.0102256648565225, 0.213652242130621,
			 50, 50, -0.0213709538754851, 0.0261026264422218, 0.00236583628336835,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.845119881658276,
			 0.0121108297632437, 0.195348818340148, 84, 50, -0.0477631655344829,
			 0.0498882032327905, 0.0010625188491538, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.965979178487907, 0.0249115212160874, 0.0426517048050703,
			 16, 84, -0.0178571986128888, 0.0222266710606334, 0.00218473622387233,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.830818256567571,
			 0.0102256648565225, 0.213652242130621, 50, 84, -0.0213709538754851,
			 0.0261026264422218, 0.00236583628336835, "W", "jasp", "M", "<unicode>",
			 "<unicode>", 0.845119881658276, 0.0121108297632437, 0.195348818340148,
			 84, 84, -0.0477631655344829, 0.0498882032327905, 0.0010625188491538,
			 "W", "jasp", "M", "<unicode>", "<unicode>", 0.965979178487907,
			 0.0249115212160874, 0.0426517048050703))


	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161470550623882, 0.11245203123091, -0.024509259696486, "W",
			 "<unicode>", 0.725786355015267, "M", 0.0698794937089302, -0.350736080009033,
			 -2.79872452832282, 2.28099228440671, -0.258866121958059, "jasp",
			 "<unicode>", 0.84166638902595, "M", 1.29586993761051, -0.199762425568256,
			 -0.225570643808616, 0.758946860434, 0.266688108312692, "Y",
			 "<unicode>", 0.288309199885071, "M", 0.251157039621229, 1.0618380783389,
			 -0.251164585174639, 0.234614162624914, -0.00827521127486247,
			 "W:Y", "<unicode>", 0.946760242267473, "M", 0.12392542710767,
			 -0.0667757333422198, -1.87023489935322, 1.53192002938999, -0.169157434981615,
			 "Z", "<unicode>", 0.845470091702745, "M", 0.867912613593662,
			 -0.194901459354536, -2.28051646778693, 2.59510121864007, 0.157292375426567,
			 "jasp:Z", "<unicode>", 0.899367133333083, "M", 1.24380287721745,
			 0.126460855098238, -0.258824818632382, 0.203131516426174, -0.027846651103104,
			 "W:Z", "<unicode>", 0.813205623675289, "M", 0.117848169329235,
			 -0.236292606508874, -0.0197475148905916, 0.00116000439140291,
			 -0.00929375524959436, "W", "<unicode>", 0.0814251826682524,
			 "jasp", 0.00533364884429265, -1.74247602737088, -0.0185476356768126,
			 0.0350787259553042, 0.00826554513924577, "Y", "<unicode>", 0.54571943430391,
			 "jasp", 0.013680445675307, 0.604186832462993, -0.0145562957965629,
			 0.00654286981869156, -0.00400671298893568, "W:Y", "<unicode>",
			 0.456640039091319, "jasp", 0.00538253911339239, -0.744390872881258
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175967405291482, 0.198835585339078, 0.0114340900237981,
			 "Total", "W", "M", "<unicode>", 0.904811916131242, 0.0956147647576583,
			 0.119584983059662, 50, 16, -0.250064465889431, 0.25717241743343,
			 0.00355397577199963, "Total", "W", "M", "<unicode>", 0.978088748293639,
			 0.129399541859922, 0.0274651341180704, 84, 16, -0.477941320962256,
			 0.464847055904086, -0.00654713252908495, "Total", "W", "M",
			 "<unicode>", 0.97828292023752, 0.24051165845468, -0.0272216846831924,
			 16, 50, -0.285957923958285, 0.2557058323616, -0.0151260457983425,
			 "Total", "W", "M", "<unicode>", 0.912833992889179, 0.138182068801381,
			 -0.109464606584261, 50, 50, -0.158089992169776, 0.112077672069494,
			 -0.023006160050141, "Total", "W", "M", "<unicode>", 0.738529019982977,
			 0.0689215889603884, -0.333801939235084, 84, 50, -0.322830113631586,
			 0.256615576929135, -0.0331072683512256, "Total", "W", "M", "<unicode>",
			 0.82278110891567, 0.147820494440539, -0.223969406113324, 16,
			 84, -0.537926447079823, 0.445409243616598, -0.0462586017316128,
			 "Total", "W", "M", "<unicode>", 0.853697048986519, 0.250855551033807,
			 -0.18440334105016, 50, 84, -0.350476872630484, 0.242199440663661,
			 -0.0541387159834113, "Total", "W", "M", "<unicode>", 0.72029060147463,
			 0.151195715321582, -0.358070437831271, 84, 84, -0.277399896550879,
			 0.148920247981888, -0.0642398242844959, "Total", "W", "M", "<unicode>",
			 0.554740036979814, 0.108757137349341, -0.590672261611209, 16,
			 16, -0.0178571986128888, 0.0222266710606334, 0.00218473622387233,
			 "Total indirect", "W", "M", "<unicode>", 0.830818256567571,
			 0.0102256648565225, 0.213652242130621, 50, 16, -0.0213709538754851,
			 0.0261026264422218, 0.00236583628336835, "Total indirect", "W",
			 "M", "<unicode>", 0.845119881658276, 0.0121108297632437, 0.195348818340148,
			 84, 16, -0.0477631655344829, 0.0498882032327905, 0.0010625188491538,
			 "Total indirect", "W", "M", "<unicode>", 0.965979178487907,
			 0.0249115212160874, 0.0426517048050703, 16, 50, -0.0178571986128888,
			 0.0222266710606334, 0.00218473622387233, "Total indirect", "W",
			 "M", "<unicode>", 0.830818256567571, 0.0102256648565225, 0.213652242130621,
			 50, 50, -0.0213709538754851, 0.0261026264422218, 0.00236583628336835,
			 "Total indirect", "W", "M", "<unicode>", 0.845119881658276,
			 0.0121108297632437, 0.195348818340148, 84, 50, -0.0477631655344829,
			 0.0498882032327905, 0.0010625188491538, "Total indirect", "W",
			 "M", "<unicode>", 0.965979178487907, 0.0249115212160874, 0.0426517048050703,
			 16, 84, -0.0178571986128888, 0.0222266710606334, 0.00218473622387233,
			 "Total indirect", "W", "M", "<unicode>", 0.830818256567571,
			 0.0102256648565225, 0.213652242130621, 50, 84, -0.0213709538754851,
			 0.0261026264422218, 0.00236583628336835, "Total indirect", "W",
			 "M", "<unicode>", 0.845119881658276, 0.0121108297632437, 0.195348818340148,
			 84, 84, -0.0477631655344829, 0.0498882032327905, 0.0010625188491538,
			 "Total indirect", "W", "M", "<unicode>", 0.965979178487907,
			 0.0249115212160874, 0.0426517048050703))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "Z")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(683.468814808014, 743.38772908574, 12, "Model 1", 100, -318.734407404007,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.163250654063005, 0.0341992419550993, -0.0645257060539527, "Z",
			 "<unicode>", 0.200188679713803, "sm", 0.0503707970084052, -1.28101419644374,
			 -0.00962235312507845, 0.0896223756900236, 0.0400000112824726,
			 "medexperimental", "<unicode>", 0.114128809316977, "sm", 0.0253179980851515,
			 1.57990419100046, 0.180704826756538, 0.31929525391269, 0.250000040334614,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553504680023,
			 7.07106667096602, 0.755519568407858, 1.33496040696827, 1.04523998768806,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147819256662614,
			 7.07106781137279, 0.00474535349054337, 0.00838477126098208,
			 0.00656506237576272, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000928439960924275, 7.07106829958839, -0.170527298691206,
			 0.0272978681279, -0.0716147152816529, "Z", "<unicode>", 0.155883374860555,
			 "medexperimental", 0.0504665311147362, -1.41905365199039, 0.180704880736032,
			 0.319295442190382, 0.250000161463207, "medexperimental", "<unicode>",
			 1.53743684450092e-12, "medexperimental", 0.0353553847283764,
			 7.07106324493071, 0.721541730641438, 1.27492333050725, 0.998232530574345,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171369533016,
			 7.07106925346419))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.175482580965452, 1.32297873624635, 0.57374807764045, "s",
			 "M", "", 0, "<unicode>", "", 0.133379607643638, "m", 0.382267564361253,
			 1.50090703771624, 16, -0.363072059052361, 1.00492534401836,
			 0.320926642483002, "s", "M", "", 1, "<unicode>", "", 0.357782243250891,
			 "m", 0.348985342042332, 0.919599203235514, 50, 0.023315006680749,
			 1.18386387713033, 0.60358944190554, "s", "M", "", 0, "<unicode>",
			 "", 0.0414785878310684, "m", 0.296063825561042, 2.03871391839829,
			 50, -0.235957380361609, 0.937493393857793, 0.350768006748092,
			 "s", "M", "", 1, "<unicode>", "", 0.241299367183916, "m", 0.299355188022696,
			 1.17174520697299, 84, -0.0537692187614062, 1.33090542118933,
			 0.63856810121396, "s", "M", "", 0, "<unicode>", "", 0.0706459383966056,
			 "m", 0.353239817382582, 1.80774666328838, 84, -0.392244909626186,
			 1.16373824173921, 0.385746666056511, "s", "M", "", 1, "<unicode>",
			 "", 0.331151744760499, "m", 0.396941771287328, 0.971796605848486,
			 16, -0.0299389244370698, 0.0252558778430029, -0.00234152329703343,
			 "s", "jasp", "M", 0, "<unicode>", "<unicode>", 0.867925042814984,
			 "m", 0.0140805654377943, -0.166294692310327, 16, -0.0428931931971457,
			 0.0459616359108829, 0.00153422135686861, "s", "jasp", "M", 1,
			 "<unicode>", "<unicode>", 0.946037303129492, "m", 0.0226674647618283,
			 0.0676838531785087, 50, -0.0221215131102254, 0.0257353265263129,
			 0.00180690670804374, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.882340593509484, "m", 0.0122086017942235, 0.148002755638953,
			 50, -0.0299389244370698, 0.0252558778430029, -0.00234152329703343,
			 "s", "jasp", "M", 1, "<unicode>", "<unicode>", 0.867925042814984,
			 "m", 0.0140805654377943, -0.166294692310327, 84, -0.0428931931971457,
			 0.0459616359108829, 0.00153422135686861, "s", "jasp", "M", 0,
			 "<unicode>", "<unicode>", 0.946037303129492, "m", 0.0226674647618283,
			 0.0676838531785087, 84, -0.0221215131102254, 0.0257353265263129,
			 0.00180690670804374, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.882340593509484, "m", 0.0122086017942235, 0.148002755638953
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0204863775471656, 1.18482155471951, 0.602653966133338, "sm",
			 "<unicode>", 0.0424649336053637, "M", 0.297029737882041, 2.02893478084228,
			 -2.59010002663173, 2.39392698206488, -0.0980865222834208, "jasp",
			 "<unicode>", 0.938508300400288, "M", 1.27145882475647, -0.0771448672765379,
			 -0.436456167400391, 0.71525074106398, 0.139397286831794, "medexperimental",
			 "<unicode>", 0.635179057008715, "M", 0.293808181565806, 0.47444998328126,
			 -1.08477365658279, 0.579130786267889, -0.252821435157448, "sm:medexperimental",
			 "<unicode>", 0.55143431293511, "M", 0.424473218889567, -0.5956122174653,
			 -1.83221551376808, 1.39245951439277, -0.219877999687654, "Z",
			 "<unicode>", 0.789250055953641, "M", 0.822636296788278, -0.267284583170105,
			 -1.98043776725246, 2.77951807654343, 0.399540154645482, "jasp:Z",
			 "<unicode>", 0.742132956155356, "M", 1.2142967629359, 0.329030074723646,
			 -0.387333899830101, 0.449907530077721, 0.03128681512381, "sm:Z",
			 "<unicode>", 0.883539708220543, "M", 0.213585922116905, 0.146483507965873,
			 -0.0404918131698006, 0.0505149924937307, 0.0050115896619651,
			 "sm", "<unicode>", 0.829093953027793, "jasp", 0.0232164484606302,
			 0.215863751532178, -0.0488496033595185, 0.0421572023045134,
			 -0.00334620052750253, "medexperimental", "<unicode>", 0.885397345733618,
			 "jasp", 0.0232164484607579, -0.144130594873652, -0.0871738518232516,
			 0.0415292070149127, -0.0228223224041695, "sm:medexperimental",
			 "<unicode>", 0.486990863882062, "jasp", 0.0328330162832985,
			 -0.695102825986132))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.179096998434454, 1.32191010712129, 0.571406554343417, "Total",
			 "s", "M", 0, "<unicode>", 0.135634547733906, "m", 0.382917012097032,
			 1.49224645625988, 16, -0.360794893413043, 1.00571662109278,
			 0.32246086383987, "Total", "s", "M", 1, "<unicode>", 0.354965828201298,
			 "m", 0.348606281871681, 0.925000152345405, 50, 0.0253656239429223,
			 1.18542707328425, 0.605396348613584, "Total", "s", "M", 0, "<unicode>",
			 0.0407882403916258, "m", 0.295939481156731, 2.04567618435799,
			 50, -0.239170899195374, 0.936023866097491, 0.348426483451058,
			 "Total", "s", "M", 1, "<unicode>", 0.245155837599654, "m", 0.299800091879915,
			 1.16219605293057, 84, -0.0540304861801204, 1.33423513132178,
			 0.640102322570829, "Total", "s", "M", 0, "<unicode>", 0.0706995164364208,
			 "m", 0.354155899917641, 1.8074026797794, 84, -0.393047062213603,
			 1.16815420774271, 0.387553572764555, "Total", "s", "M", 1, "<unicode>",
			 0.330510882855865, "m", 0.398272948449786, 0.97308535333129,
			 16, -0.0299389244370698, 0.0252558778430029, -0.00234152329703343,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.867925042814984,
			 "m", 0.0140805654377943, -0.166294692310327, 16, -0.0428931931971457,
			 0.0459616359108829, 0.00153422135686861, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.946037303129492, "m", 0.0226674647618283,
			 0.0676838531785087, 50, -0.0221215131102254, 0.0257353265263129,
			 0.00180690670804374, "Total indirect", "s", "M", 0, "<unicode>",
			 0.882340593509484, "m", 0.0122086017942235, 0.148002755638953,
			 50, -0.0299389244370698, 0.0252558778430029, -0.00234152329703343,
			 "Total indirect", "s", "M", 1, "<unicode>", 0.867925042814984,
			 "m", 0.0140805654377943, -0.166294692310327, 84, -0.0428931931971457,
			 0.0459616359108829, 0.00153422135686861, "Total indirect", "s",
			 "M", 0, "<unicode>", 0.946037303129492, "m", 0.0226674647618283,
			 0.0676838531785087, 84, -0.0221215131102254, 0.0257353265263129,
			 0.00180690670804374, "Total indirect", "s", "M", 1, "<unicode>",
			 0.882340593509484, "m", 0.0122086017942235, 0.148002755638953
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "mod"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "mod", processType = "mediators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1919.79936103679, 1990.13895605847, 0, "Model 1", 100, -932.899680518397,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089480192, 2.96919114210622, 2.32480101845407, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512596666, 7.07106782079068,
			 0.719243095446917, 1.27101851286767, 0.995130804157296, "M",
			 "<unicode>", 1.55364610066044e-12, "M", 0.140761621584144, 7.06961736415084,
			 -0.017063829424213, 0.0136234316300662, -0.00172019889707342,
			 "Y", "<unicode>", 0.826077786806031, "jasp", 0.00782852677302654,
			 -0.219734689162772, -0.762343306344135, 0.0887543315059579,
			 -0.336794487419088, "mod", "<unicode>", 0.120857287748549, "jasp",
			 0.217120733993952, -1.55118528398338, 0.00468047960484189, 0.00827014311556882,
			 0.00647531136020536, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000915747314502139, 7.07106781276859, 0.413197536866249,
			 0.872209472692487, 0.642703504779368, "Y", "<unicode>", 4.05039308759569e-08,
			 "Z", 0.117097033273791, 5.4886403763674, -6.53655165917213,
			 3.73651368195567, -1.40001898860823, "mod", "<unicode>", 0.593196294728594,
			 "Z", 2.62072809045483, -0.534209937195452, 0.71669479817852,
			 1.2663592308511, 0.991527014514812, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.140223095171204, 7.07106781022211, 507.563085651454,
			 899.790692619836, 703.676889135645, "mod", "<unicode>", 2.02793337678031e-12,
			 "mod", 100.059901626312, 7.03255627577598, 0.700714207950775,
			 1.23822336162219, 0.969468784786483, "Y", "<unicode>", 1.54809498553732e-12,
			 "Y", 0.137122201711669, 7.0701080691879))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, "W",
			 "M", "", "", "<unicode>", "", "", 0.813347598335086, 0.0673697800718175,
			 -0.236109634089419, -0.0261961165104945, 0.0194967930965771,
			 -0.00334966170695873, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.773834706557657, 0.0116565686837849, -0.287362584807512,
			 -0.0163077605876651, 0.0285137534820108, 0.00610299644717284,
			 "W", "Z", "M", "", "<unicode>", "<unicode>", "", 0.593517238385026,
			 0.0114342698190432, 0.533746058450414, -0.0332675922356836,
			 0.038704162906655, 0.0027182853354857, "W", "mod", "M", "",
			 "<unicode>", "<unicode>", "", 0.882302602912406, 0.0183604789960537,
			 0.148050894318713, -0.0775466819567461, 0.0159133084692364,
			 -0.0308166867437548, "W", "Y", "M", "", "<unicode>", "<unicode>",
			 "", 0.196176067287806, 0.0238422723996928, -1.29252305431054,
			 -0.00296122904246256, 0.00450914197709736, 0.000773956467317395,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.684655756514328, 0.00190574191119971, 0.406118196157092, -0.00589119861695775,
			 0.00506907909285442, -0.000411059762051665, "W", "mod", "Y",
			 "M", "<unicode>", "<unicode>", "<unicode>", 0.883120221676967,
			 0.00279604058958875, -0.147014948059866))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, "W",
			 "<unicode>", 0.813347598335086, "M", 0.0673697800718175, -0.236109634089419,
			 -2.10110820470282, 2.83502607382475, 0.366958934560965, "jasp",
			 "<unicode>", 0.77073564479617, "M", 1.25924106704592, 0.291412775650513,
			 -0.413433882620032, 0.107899969914886, -0.152766956352573, "Z",
			 "<unicode>", 0.250696109315949, "M", 0.132995773556844, -1.14866023383276,
			 0.0028905648879694, 0.0180163398795304, 0.0104534523837499,
			 "mod", "<unicode>", 0.00674721413960322, "M", 0.00385868697355441,
			 2.70906980934003, 0.0387464898678602, 0.565434272654561, 0.302090381261211,
			 "Y", "<unicode>", 0.024554599581468, "M", 0.134361597187792,
			 2.24833871868158, -0.0194720938734558, 0.00121576385131691,
			 -0.00912816501106944, "W", "<unicode>", 0.0837015014975608,
			 "jasp", 0.00527761170306084, -1.72960147973285, -0.169849433838636,
			 0.0899500027982267, -0.0399497155202047, "W", "<unicode>", 0.546659912050572,
			 "Z", 0.0662765843367857, -0.602772697476375, -1.87031193110395,
			 2.98033913143301, 0.555013600164534, "jasp", "<unicode>", 0.653778056597516,
			 "Z", 1.23743372347611, 0.448519859799382, -3.17623798796469,
			 3.69631216742168, 0.260037089728493, "W", "<unicode>", 0.882091377958021,
			 "mod", 1.75323378633387, 0.148318548133987, -0.228615253195251,
			 0.0245922941384487, -0.102011479528401, "W", "<unicode>", 0.11427905810986,
			 "Y", 0.0645949490222699, -1.57924854918968, -0.012530212645152,
			 0.0020646455096896, -0.0052327835677312, "mod", "<unicode>",
			 0.159891757636204, "Y", 0.00372324651625335, -1.40543569835845
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023199935095, 0.0942455517666334, -0.0408888240842308, "Total",
			 "W", "M", "<unicode>", 0.553151746868814, 0.0689473770522249,
			 -0.593043939195237, -0.0779893376489408, 0.0280249977233621,
			 -0.0249821699627893, "Total indirect", "W", "M", "<unicode>",
			 0.355628457145996, 0.0270449702669362, -0.923727026364354))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "mod"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "mod", processType = "mediators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1694.56540701386, 1764.90500203554, 0, "Model 1", 100, -820.282703506932,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704808730328, 0.319295191038147, 0.249999999884237, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553390268909,
			 7.0710678150785, 0.679351239017548, 1.20070868331726, 0.940029961167402,
			 "M", "<unicode>", 1.57407420431355e-12, "M", 0.133001791974778,
			 7.06779921691328, -0.0155310360409273, 0.015901321346984, 0.000185142653028361,
			 "Y", "<unicode>", 0.981579174401771, "jasp", 0.0080186058610887,
			 0.0230891324795984, -0.781706195292346, 0.0840275744384795,
			 -0.348839310426933, "mod", "<unicode>", 0.114221818813752, "jasp",
			 0.220854509715388, -1.57949824468822, 0.00480662801191764, 0.0084930402246428,
			 0.00664983411828022, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000940428559351885, 7.07106781493651, 0.415818962568938,
			 0.877332208264479, 0.646575585416708, "Y", "<unicode>", 3.97900377091531e-08,
			 "Z", 0.11773513425142, 5.49178110279271, -6.63530159455768,
			 3.59524109747847, -1.5200302485396, "mod", "<unicode>", 0.560287998937135,
			 "Z", 2.60988027655951, -0.582413784337798, 0.707778596528062,
			 1.25060480683957, 0.979191701683816, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.138478618636172, 7.07106780330087, 507.892714690368,
			 901.011119528301, 704.451917109335, "mod", "<unicode>", 2.15072404330385e-12,
			 "mod", 100.287150156534, 7.02434874268325, 0.716666293529629,
			 1.26647572327931, 0.99157100840447, "Y", "<unicode>", 1.55475632368507e-12,
			 "Y", 0.140260084901179, 7.06951667042756))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0910081224725078, 0.860751929259853, 0.475880025866181, "s",
			 "M", "", "", "<unicode>", "", "", 0.0153749805220957, "m", 0.196366824303657,
			 2.42342375069574, -0.0327065874144014, 0.0226541864902512, -0.0050262004620751,
			 "s", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.721922972814061,
			 "m", 0.0141229059159585, -0.355889962871992, -0.04952974707603,
			 0.106054836558549, 0.0282625447412593, "s", "Z", "M", "", "<unicode>",
			 "<unicode>", "", 0.476421330290286, "m", 0.0396906741301907,
			 0.712070161583914, -0.126072868172848, 0.100247146419103, -0.0129128608768725,
			 "s", "mod", "M", "", "<unicode>", "<unicode>", "", 0.823026170644271,
			 "m", 0.0577357585080989, -0.223654477061406, -0.138320655423621,
			 0.0912558701983019, -0.0235323926126597, "s", "Y", "M", "",
			 "<unicode>", "<unicode>", "", 0.687826618468944, "m", 0.0585665163831564,
			 -0.401806254937635, -0.00284859619040834, 0.00402188839589021,
			 0.000586646102740937, "s", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.73784489268874, "m", 0.00175270684576147, 0.334708627492162,
			 -0.0147815474651881, 0.0185253899009152, 0.00187192121786353,
			 "s", "mod", "Y", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.825631019351605, "m", 0.00849682382656624, 0.220308347692318
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0910081224725078, 0.860751929259853, 0.475880025866181, "sm",
			 "<unicode>", 0.0153749805220957, "M", 0.196366824303657, 2.42342375069574,
			 -1.79290884127227, 2.94034877890532, 0.573719968816522, "jasp",
			 "<unicode>", 0.634690061553928, "M", 1.20748586645289, 0.475135970329726,
			 -0.367051095396393, 0.14350331678753, -0.111773889304432, "Z",
			 "<unicode>", 0.390795230450944, "M", 0.130245865794247, -0.858176101197744,
			 0.00343201054080372, 0.0181440175053956, 0.0107880140230996,
			 "mod", "<unicode>", 0.00404792007154309, "M", 0.00375313196585199,
			 2.8744030642287, 0.0358514443861678, 0.542472331293712, 0.28916188783994,
			 "Y", "<unicode>", 0.0252627608038503, "M", 0.129242397029666,
			 2.23736091627553, -0.0407263673121724, 0.0232049257195319, -0.00876072079632024,
			 "sm", "<unicode>", 0.591156438387134, "jasp", 0.0163093030116845,
			 -0.537160955930723, -0.641306843553368, 0.135597595765052, -0.252854623894158,
			 "sm", "<unicode>", 0.202027488900194, "Z", 0.198193549842381,
			 -1.27579643280646, -1.77925887403205, 2.97744968035564, 0.599095403161793,
			 "jasp", "<unicode>", 0.621514529069439, "Z", 1.21346835755861,
			 0.493705006339943, -11.6494093208209, 9.25548197715544, -1.19696367183275,
			 "sm", "<unicode>", 0.822410573160282, "mod", 5.33297842788732,
			 -0.22444562415133, -0.471868158437157, 0.309105404407237, -0.0813813770149599,
			 "sm", "<unicode>", 0.682924078848467, "Y", 0.199231610632801,
			 -0.408476229030502, -0.0127958409040199, 0.00197912205577032,
			 -0.00540835942412481, "mod", "<unicode>", 0.151319742569027,
			 "Y", 0.00376919246382415, -1.43488544987634))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0625107978025213, 0.867748570150353, 0.465129683976437, "Total",
			 "s", "M", "<unicode>", 0.0235575802096637, "m", 0.205421573737947,
			 2.26426891544407, -0.156837434248426, 0.135336750468939, -0.0107503418897435,
			 "Total indirect", "s", "M", "<unicode>", 0.885318086689426,
			 "m", 0.0745356004043945, -0.144230969247143))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - continuous works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "W", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "jasp", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "Z", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "W", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "Z", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "Y"), list(processDependent = "M", 
        processIndependent = "Z", processType = "moderators", 
        processVariable = "Y")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(986.941725745175, 1054.67615058086, 9, "Model 1", 100, -467.470862872587,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.544848154908371, 0.0642088874559028, -0.240319633726234, "Y",
			 "<unicode>", 0.121932780398569, "W", 0.155374549524491, -1.54671170060805,
			 1.68041101229712, 2.96919155192839, 2.32480128211275, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776587171247, 7.07106701883809,
			 0.738695301349352, 1.30523287699718, 1.02196408917327, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.144527547474496, 7.07106781393081,
			 0.00465468804678076, 0.00822457486027282, 0.00643963145352679,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.00091070214597076,
			 7.07106212719251, 0.377829126178927, 0.667602699268776, 0.522715912723851,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.0739231882257904,
			 7.07106829763987, 0.732634683050944, 1.2945242673154, 1.01357947518317,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341813598762,
			 7.07106635346718))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.246043807106894, 0.136943718131252, -0.0545500444878208,
			 "W", "M", "", "", "<unicode>", "", "", 0.576621166182257, 0.0977026946053864,
			 -0.558326919315217, 50, -0.167680850687269, 0.106698238541471,
			 -0.0304913060728988, "W", "M", "", "", "<unicode>", "", "",
			 0.663115883417523, 0.0699959518116167, -0.435615278937294, 84,
			 -0.223665123381296, 0.215196621621735, -0.00423425087978045,
			 "W", "M", "", "", "<unicode>", "", "", 0.969830821547304, 0.111956584014991,
			 -0.0378204722574733, 16, -0.0261686808451281, 0.0522775472204037,
			 0.0130544331876378, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.514191518879688, 0.0200121606020074, 0.652325026130778,
			 50, -0.0226271139765208, 0.0237490088342545, 0.000560947428866841,
			 "W", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.962183339432162,
			 0.011830860969024, 0.0474139143664636, 84, -0.100775460348496,
			 0.0326690126956969, -0.0340532238263998, "W", "jasp", "M", "",
			 "<unicode>", "<unicode>", "", 0.317159263273409, 0.0340425829496833,
			 -1.00031257548031, 16, -0.0235749020717812, 0.0866019727867806,
			 0.0315135353574997, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.262200898994999, 0.0281068620973709, 1.12120432541801,
			 50, -0.0277464258540413, 0.0130459711150737, -0.00735022736948379,
			 "W", "Z", "M", "", "<unicode>", "<unicode>", "", 0.479991048260995,
			 0.0104064149369275, -0.706316960647156, 84, -0.0686530165516955,
			 0.0611294647895621, -0.0037617758810667, "W", "Z", "M", "",
			 "<unicode>", "<unicode>", "", 0.909539002019165, 0.0331083842266912,
			 -0.113620038214793, 16, -0.00562941900712908, 0.00394968604711449,
			 -0.000839866480007298, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.731081513971716, 0.00244369415198502, -0.343687232432534,
			 50, -0.00253985384118539, 0.00523203565398857, 0.00134609090640159,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.497181363494306, 0.00198266130308456, 0.6789313456148, 84,
			 -0.00960598897700551, 0.0107835661714757, 0.000588788597235089,
			 "W", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.909875446558147, 0.00520151270873124, 0.113195647152174))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167723683880604, 0.106561274564317, -0.0305812046581436, "W",
			 "<unicode>", 0.662075408840601, "M", 0.0699719384153091, -0.437049556589856,
			 -2.55829522921172, 2.42017062831178, -0.0690623004499703, "jasp",
			 "<unicode>", 0.956633970087279, "M", 1.27004013767421, -0.0543780455446408,
			 -0.450845357049376, 0.102063203374137, -0.174391076837619, "Z",
			 "<unicode>", 0.216320455484938, "M", 0.141050693988457, -1.23637163282508,
			 -3.31235430238288, 0.504649047120089, -1.4038526276314, "Y",
			 "<unicode>", 0.149384993965793, "M", 0.973743237021448, -1.44170719164695,
			 -0.125417922250807, 0.174812749308359, 0.0246974135287762, "W:Y",
			 "<unicode>", 0.747104993675179, "M", 0.0765908644055062, 0.3224589997838,
			 -0.267222707989377, 5.1020357645099, 2.41740652826026, "jasp:Y",
			 "<unicode>", 0.0775851075324328, "M", 1.36973396318792, 1.76487302879895,
			 -0.0582252630972621, 0.349436015661485, 0.145605376282112, "Z:Y",
			 "<unicode>", 0.161486290515706, "M", 0.103997135144913, 1.40009026286369,
			 -0.0197475104653727, 0.00116001647290274, -0.009293746996235,
			 "W", "<unicode>", 0.0814255647751581, "jasp", 0.00533365079746143,
			 -1.74247384186801, -0.0185476290743692, 0.0350787521960096,
			 0.00826556156082018, "Y", "<unicode>", 0.545718783418848, "jasp",
			 0.0136804506851597, 0.604187811574547, -0.014556317500975, 0.0065428558408942,
			 -0.00400673083004039, "W:Y", "<unicode>", 0.456638199263088,
			 "jasp", 0.00538254108450379, -0.744393914906786, -0.0543795752568664,
			 0.137870527437828, 0.0417454760904808, "W", "<unicode>", 0.394669899945897,
			 "Z", 0.0490442947449899, 0.851179047584231, -0.945916696157829,
			 2.59955082318933, 0.82681706351575, "jasp", "<unicode>", 0.360641855953755,
			 "Z", 0.904472619730096, 0.914142723040617, -1.86915949969758,
			 0.793983756801112, -0.537587871448236, "Y", "<unicode>", 0.428777607282752,
			 "Z", 0.679385763591891, -0.79128515823768, 0.0432005951528221,
			 0.248538250058472, 0.145869422605647, "W:Y", "<unicode>", 0.00535822071307335,
			 "Z", 0.0523830173731068, 2.78467010723472, -0.508959227412777,
			 3.22713324976084, 1.35908701117403, "jasp:Y", "<unicode>", 0.153879520827264,
			 "Z", 0.953102329084472, 1.42596127372759))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.201038587035553, 0.179394702190172, -0.0108219424226907,
			 "Total", "W", "M", "<unicode>", 0.911213773100032, 0.097051091812537,
			 -0.111507683433322, 50, -0.171680288323717, 0.0998112981094883,
			 -0.0359344951071142, "Total", "W", "M", "<unicode>", 0.603872481419492,
			 0.069259330420022, -0.51883977060116, 84, -0.245856020771816,
			 0.162935096791792, -0.0414604619900118, "Total", "W", "M", "<unicode>",
			 0.690949089809269, 0.104285364626111, -0.397567406880708, 16,
			 -0.0231396470811391, 0.110595851211399, 0.0437281020651302,
			 "Total indirect", "W", "M", "<unicode>", 0.199942073943119,
			 0.0341168254486886, 1.28171661606959, 50, -0.0361509904937216,
			 0.0252646124252908, -0.00544318903421536, "Total indirect",
			 "W", "M", "<unicode>", 0.728277031155632, 0.0156675335372106,
			 -0.347418374518728, 84, -0.125314793686276, 0.0508623714658135,
			 -0.0372262111102314, "Total indirect", "W", "M", "<unicode>",
			 0.407511806032452, 0.0449439802317167, -0.828280248396003))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - factor works with bad variable names", {
 
options <- jaspTools::analysisOptions("ClassicProcess")
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50, 
    value = "50"), list(probePercentile = 84, value = "84"))
options$pathPlotsLegend <- TRUE
options$pathPlotsColorPalette <- "colorblind"
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE, 
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE, 
    modelNumber = 1, modelNumberCovariates = list(), modelNumberIndependent = "", 
    modelNumberMediators = list(), modelNumberModeratorW = "", 
    modelNumberModeratorZ = "", name = "Model 1", pathCoefficients = TRUE, 
    intercepts = FALSE, processRelationships = list(list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "jasp"), list(processDependent = "M", 
        processIndependent = "s", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "mediators", 
        processVariable = "Z"), list(processDependent = "jasp", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "Z", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "s", processType = "moderators", 
        processVariable = "med"), list(processDependent = "Z", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "jasp", processType = "moderators", 
        processVariable = "med"), list(processDependent = "M", 
        processIndependent = "Z", processType = "moderators", 
        processVariable = "med")), residualCovariances = TRUE, 
    statisticalPathPlot = TRUE, totalEffects = TRUE, localTests = FALSE, 
    localTestType = "cis", localTestBootstrap = FALSE, localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(686.27945882928, 754.013883664971, 9, "Model 1", 100, -317.13972941464,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00962101519297737, 0.0896233795304517, 0.0400011821687372,
			 "medexperimental", "<unicode>", 0.114116998933161, "sm", 0.0253179128561178,
			 1.57995575686134, 0.180704577930326, 0.319294386031354, 0.24999948198084,
			 "sm", "<unicode>", 1.53721479989599e-12, "sm", 0.0353551925428749,
			 7.07108246342226, 0.748461126014971, 1.32248853790218, 1.03547483195858,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.146438255094243,
			 7.07106781142796, 0.00474535175892798, 0.00838476522121181,
			 0.0065650584900699, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000928438861884976, 7.07107248477416, 0.682814779059117,
			 1.20649515041125, 0.944654964735185, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.13359438629558, 7.07106781152556, 0.180704577929838,
			 0.319294386031677, 0.249999481980758, "medexperimental", "<unicode>",
			 1.53721479989599e-12, "medexperimental", 0.0353551925430817,
			 7.07108246337856))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0345966305912411, 1.17847272948493, 0.606534680038084, "s",
			 "M", "", "", 0, "<unicode>", "", "", 0.0376612569140802, "m",
			 0.291810489355017, 2.07852254173143, -0.307634496929552, 0.879612205914955,
			 0.285988854492701, "s", "M", "", "", 1, "<unicode>", "", "",
			 0.345042766142353, "m", 0.302874622240347, 0.9442483241985,
			 -0.0184734105633442, 0.0173911757573791, -0.000541117402982525,
			 "s", "jasp", "M", "", 0, "<unicode>", "<unicode>", "", 0.952838164794348,
			 "m", 0.00914929728393445, -0.0591430561484422, -0.0660890431193974,
			 0.0606472374505618, -0.00272090283441779, "s", "jasp", "M",
			 "", 1, "<unicode>", "<unicode>", "", 0.932931618694912, "m",
			 0.0323312779136859, -0.0841569838866787, -0.0749810317667527,
			 0.0919666897276172, 0.00849282898043228, "s", "Z", "M", "",
			 0, "<unicode>", "<unicode>", "", 0.841940948397, "m", 0.0425894870546684,
			 0.199411393932281, -0.120557020161143, 0.184345738410603, 0.0318943591247298,
			 "s", "Z", "M", "", 1, "<unicode>", "<unicode>", "", 0.681773566026669,
			 "m", 0.0777827452383767, 0.410044143170632, -0.00321803002828389,
			 0.00284053566234824, -0.000188747182967827, "s", "jasp", "Z",
			 "M", 0, "<unicode>", "<unicode>", "<unicode>", 0.902803548807875,
			 "m", 0.00154558087251126, -0.122120547895466, -0.00627242069612763,
			 0.00864050552455318, 0.00118404241421277, "s", "jasp", "Z",
			 "M", 1, "<unicode>", "<unicode>", "<unicode>", 0.75562521998595,
			 "m", 0.00380438781995794, 0.311230734154192))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0345966305912411, 1.17847272948493, 0.606534680038084, "sm",
			 "<unicode>", 0.0376612569140802, "M", 0.291810489355017, 2.07852254173143,
			 -3.54941874925754, 3.33345905108052, -0.107979849088507, "jasp",
			 "<unicode>", 0.950963762864093, "M", 1.75586843805022, -0.0614965488008953,
			 -0.121894548053843, 0.422376825394256, 0.150241138670206, "Z",
			 "<unicode>", 0.27922573810993, "M", 0.138847289476042, 1.0820602925499,
			 -3.31646427251841, 3.35029188419875, 0.0169138058401676, "medexperimental",
			 "<unicode>", 0.992065167571192, "M", 1.70073435259619, 0.00994500158966534,
			 -1.14486482669612, 0.50377317560535, -0.320545825545382, "sm:medexperimental",
			 "<unicode>", 0.445967916252882, "M", 0.420578647185793, -0.762154302626256,
			 -4.67371876991243, 5.19520574776413, 0.260743488925848, "jasp:medexperimental",
			 "<unicode>", 0.917512913491784, "M", 2.51762904714612, 0.103567079995926,
			 -0.631934803241064, 0.196704100549512, -0.217615351345776, "Z:medexperimental",
			 "<unicode>", 0.303271561233771, "M", 0.211391359822623, -1.02944297973378,
			 -0.0404921080239768, 0.0505146707067416, 0.00501128134138242,
			 "sm", "<unicode>", 0.82910425534528, "jasp", 0.0232164415898884,
			 0.215850535146825, -0.0488494817889746, 0.0421572969415332,
			 -0.00334609242372071, "medexperimental", "<unicode>", 0.885400988889124,
			 "jasp", 0.0232164415898347, -0.144125981183343, -0.0871739857750427,
			 0.0415290349727626, -0.02282247540114, "sm:medexperimental",
			 "<unicode>", 0.486987814901539, "jasp", 0.0328330065661916,
			 -0.695107691558181, -0.48955503441516, 0.602611006376007, 0.0565279859804234,
			 "sm", "<unicode>", 0.839223826547605, "Z", 0.278618905603887,
			 0.202886397309985, -3.53710185281456, 3.03571513795216, -0.2506933574312,
			 "jasp", "<unicode>", 0.881151455059004, "Z", 1.67676983929609,
			 -0.149509701066928, -3.98113053357938, 2.37831979126833, -0.801405371155528,
			 "medexperimental", "<unicode>", 0.621319187303543, "Z", 1.62233856719058,
			 -0.493981581503871, -1.30434387580501, 0.244505511645759, -0.529919182079624,
			 "sm:medexperimental", "<unicode>", 0.179870568572785, "Z", 0.395121900113444,
			 -1.34115365897835, -3.46606045552387, 5.9408262364401, 1.23738289045811,
			 "jasp:medexperimental", "<unicode>", 0.606114426392958, "Z",
			 2.39976008900273, 0.515627748010566))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.036934519396096, 1.19166076946903, 0.614297644432566, "Total",
			 "s", "M", 0, "<unicode>", 0.0370380028373576, "m", 0.294578435925678,
			 2.08534491841606, -0.256320189893575, 0.889012896288027, 0.316346353197226,
			 "Total", "s", "M", 1, "<unicode>", 0.278940524224185, "m", 0.292182176615449,
			 1.08270243196107, -0.0776945793311695, 0.0932205081201334, 0.00776296439448192,
			 "Total indirect", "s", "M", 0, "<unicode>", 0.858689085054856,
			 "m", 0.0436015888045544, 0.178043154098803, -0.134498779696414,
			 0.195213777105463, 0.0303574987045248, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.718160720759704, "m", 0.084111891698676,
			 0.360918035386459))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

