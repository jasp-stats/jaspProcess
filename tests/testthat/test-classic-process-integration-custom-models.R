# This code is automatically generated by 'generate-tests.R'


test_that("Test that model number one_confounder - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(960.194063205136, 983.640594879029, 0, "Model 1", 100, -471.097031602568,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.63922475925008, 2.89641756877381, 2.26782116401194, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.320718344683959,
			 7.07106781262134, 0.779896467881489, 1.37803301156572, 1.0789647397236,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.152588656833048, 7.07106781144378, 0.732634590394826, 1.29452394334508,
			 1.01357926686995, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341754588952, 7.07106781116569))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0420059521826613, 0.367482204548676, 0.162738126183007, 0.155576915751074,
			 "contcor1", "contNormal", "", "<unicode>", "", 0.11926845840203,
			 0.1044631840078, 1.55785148355095, -0.027115002941041, 0.0385272160356765,
			 0.00570610654731776, 0.00545501216218012, "contcor1", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.733292476299653, 0.0167457717321581,
			 0.34074909407489))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.159257084876543, 0.111124625427091, -0.0240662297247261, -0.0348439947065884,
			 "contGamma", "<unicode>", 0.72715964179294, "contNormal", 0.0689761935516088,
			 -0.348906318043188, -0.0420059521826613, 0.367482204548676,
			 0.162738126183007, 0.155576915751074, "contcor1", "<unicode>",
			 0.11926845840203, "contNormal", 0.1044631840078, 1.55785148355095,
			 -0.530272916905354, 0.0560726277378983, -0.237100144583728,
			 -0.156555303377677, "contcor1", "<unicode>", 0.112943938943514,
			 "contGamma", 0.149580693642401, -1.58509857662886))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0338982352403213, 0.370786700700972, 0.168444232730325, 0.161031927913254,
			 "Total", "contcor1", "contNormal", "<unicode>", 0.102761008338914,
			 0.10323785006597, 1.63161314016795, -0.027115002941041, 0.0385272160356765,
			 0.00570610654731776, 0.00545501216218012, "Total indirect",
			 "contcor1", "contNormal", "<unicode>", 0.733292476299653, 0.0167457717321581,
			 0.34074909407489))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-one_confounder")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-one_confounder")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0245095630156765, "contNormal", 0.0271156286168829
			))

})
test_that("Test that model number one_confounder - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(824.37336567829, 847.819897352183, 0, "Model 1", 100, -403.186682839145,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.67091881606353, 2.95241917713298, 2.31166899659826, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.326919364635719,
			 7.07106781262135, 0.797583248451353, 1.40928455391441, 1.10343390118288,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156049118832815, 7.07106781144378, 0.180704818055353, 0.319295223563333,
			 0.250000020809343, "facExperimexperimental", "<unicode>", 1.53743684450092e-12,
			 "facExperimexperimental", 0.0353553449454082, 7.07106722322652
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.329844405685614, 0.496024877188678, 0.0830902357515322,
			 0.0788999955022769, "experimental", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.693299245993837, 0.210684810891589, 0.394381708865987,
			 1, -0.0500653809891558, 0.0303840547660915, -0.00984066311153218,
			 -0.00934439851104879, "experimental", "facExperim", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.63159016355888, 0.0205231923621613,
			 -0.479489883341709))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.178349084221068, 0.0924757112770427, -0.0429366864720126, -0.0621653534242012,
			 "contGamma", "<unicode>", 0.534292291302094, "contNormal", 0.0690892275660017,
			 -0.621467166223485, 1, -0.329844405685614, 0.496024877188678,
			 0.0830902357515322, 0.0788999955022769, "facExperimexperimental",
			 "<unicode>", 0.693299245993837, "contNormal", 0.210684810891589,
			 0.394381708865987, 1, -0.366802567861926, 0.825182751341926,
			 0.22919009174, 0.150315215732546, "facExperimexperimental",
			 "<unicode>", 0.451024688010575, "contGamma", 0.304083475157217,
			 0.753707815334274))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.339311551617825, 0.485810696897825, 0.07324957264, 0.0695555969912281,
			 "experimental", "Total", "facExperim", "contNormal", "<unicode>",
			 0.727848824673947, 0.210494237400306, 0.347988493864076, 1,
			 -0.0500653809891558, 0.0303840547660915, -0.00984066311153218,
			 -0.00934439851104879, "experimental", "Total indirect", "facExperim",
			 "contNormal", "<unicode>", 0.63159016355888, 0.0205231923621613,
			 -0.479489883341709))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-one_confounder")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-one_confounder")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.00564866649036067, "contNormal", 0.00505219708753224
			))

})
test_that("Test that model number one_direct - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "directs", processVariable = "")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(671.93697925528, 684.96283018522, 0, "Model 1", 100, -330.96848962764
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.6804108956973, 2.96919114523388, 2.32480102046559, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.328776513166141,
			 7.07106781466107, 0.798823784968434, 1.41147651187677, 1.1051501484226,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156291832845109, 7.07106781144378))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "contGamma", "contNormal", "<unicode>", 0.553151714317508, 0.0689473770915618,
			 -0.593043987835877))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "contGamma", "<unicode>", 0.553151714317508, "contNormal", 0.0689473770915618,
			 -0.593043987835877))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "Total", "contGamma", "contNormal", "<unicode>", 0.553151714317508,
			 0.0689473770915618, -0.593043987835877))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-one_direct")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-one_direct")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.00350468569342344))

})
test_that("Test that model number one_direct - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "directs", processVariable = "")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(671.93697925528, 684.96283018522, 0, "Model 1", 100, -330.96848962764
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.6804108956973, 2.96919114523388, 2.32480102046559, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.328776513166141,
			 7.07106781466107, 0.798823784968434, 1.41147651187677, 1.1051501484226,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156291832845109, 7.07106781144378))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "contGamma", "contNormal", "<unicode>", 0.553151714317508, 0.0689473770915618,
			 -0.593043987835877))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "contGamma", "<unicode>", 0.553151714317508, "contNormal", 0.0689473770915618,
			 -0.593043987835877))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203389167, 0.0942455484667592, -0.0408888274612038, -0.0592003859229269,
			 "Total", "contGamma", "contNormal", "<unicode>", 0.553151714317508,
			 0.0689473770915618, -0.593043987835877))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-one_direct")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-one_direct")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.00350468569342344))

})
test_that("Test that model number two_confounder - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1196.12854848421, 1232.60093108804, 0, "Model 1", 100, -584.064274242105
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.63577445794209, 2.89032108123016, 2.26304776958613, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.320043284770477,
			 7.07106781262135, 0.772432177868598, 1.36484403268291, 1.06863810527576,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.151128250183979, 7.07106781144378, 0.424979180919744, 0.896763104121614,
			 0.660871142520679, "contcor2", "<unicode>", 3.99655943894572e-08,
			 "contcor1", 0.120355253189151, 5.4910037161573, 0.732634592963226,
			 1.29452395230351, 1.01357927263337, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341756219093, 7.07106777095817,
			 0.721541823114584, 1.27492365300028, 0.998232738057432, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171428212636,
			 7.07106778401271))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0183967830162192, 0.521461905534409, 0.251532561259095, 0.240463996484239,
			 "contcor1", "contNormal", "", "<unicode>", "", 0.067792370251071,
			 0.137721583868113, 1.8263844649069, -0.404335782858585, 0.134221360435661,
			 -0.135057211211462, -0.128132904112833, "contcor2", "contNormal",
			 "", "<unicode>", "", 0.325595679387153, 0.137389550915812, -0.983023893092285,
			 -0.0345845435803312, 0.0470351073738792, 0.00622528189677404,
			 0.00595134147502003, "contcor1", "contGamma", "contNormal",
			 "<unicode>", "<unicode>", 0.7649551805981, 0.0208217221331657,
			 0.298980163934575, -0.0167552188968918, 0.0129087470860217,
			 -0.00192323590543502, -0.00182463268452673, "contcor2", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.799383602350585, 0.00756747731511882,
			 -0.254144918491219))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.155651256626207, 0.113717085937514, -0.0209670853443464, -0.0303569366341009,
			 "contGamma", "<unicode>", 0.760275337196381, "contNormal", 0.0687176766227503,
			 -0.305119241144496, -0.0183967830162192, 0.521461905534409,
			 0.251532561259095, 0.240463996484239, "contcor1", "<unicode>",
			 0.067792370251071, "contNormal", 0.137721583868113, 1.8263844649069,
			 -0.404335782858585, 0.134221360435661, -0.135057211211462, -0.128132904112833,
			 "contcor2", "<unicode>", 0.325595679387153, "contNormal", 0.137389550915812,
			 -0.983023893092285, -0.685382138339048, 0.0915674240346943,
			 -0.296907357152177, -0.196045521547609, "contcor1", "<unicode>",
			 0.134138263509527, "contGamma", 0.198205061037402, -1.49798070542785,
			 -0.299723108402101, 0.483175970242395, 0.091726430920147, 0.0601059555685557,
			 "contcor2", "<unicode>", 0.646041258390023, "contGamma", 0.199722822669167,
			 0.45926864889191))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00931723446549082, 0.524832920777229, 0.257757843155869, 0.246415337959259,
			 "Total", "contcor1", "contNormal", "<unicode>", 0.0585458573430464,
			 0.136265298611614, 1.89158828977093, -0.406100660732333, 0.132139766498539,
			 -0.136980447116897, -0.12995753679736, "Total", "contcor2",
			 "contNormal", "<unicode>", 0.318469002843721, 0.137308754517033,
			 -0.997608984210142, -0.0345845435803312, 0.0470351073738792,
			 0.00622528189677404, 0.00595134147502003, "Total indirect",
			 "contcor1", "contNormal", "<unicode>", 0.7649551805981, 0.0208217221331657,
			 0.298980163934575, -0.0167552188968918, 0.0129087470860217,
			 -0.00192323590543502, -0.00182463268452673, "Total indirect",
			 "contcor2", "contNormal", "<unicode>", 0.799383602350585, 0.00756747731511882,
			 -0.254144918491219))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-two_confounder")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-two_confounder")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0265628117028629, "contNormal", 0.0364269813654711
			))

})
test_that("Test that model number two_confounder - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facGender")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(969.933634417418, 1006.40601702125, 0, "Model 1", 100, -470.966817208709
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.6436585661041, 2.90425185507047, 2.27395521058729, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.321585829869774,
			 7.07106781262135, 0.755960143301373, 1.33573887791417, 1.04584951060777,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147905456219098, 7.07106781144378, -0.00962232469041584, 0.0896223218018369,
			 0.0399999985557105, "facGenderm", "<unicode>", 0.114128624284983,
			 "facExperimexperimental", 0.0253179770840388, 1.57990499884478,
			 0.180704807310708, 0.319295186083387, 0.249999996697048, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553381250528, 7.07106790529879, 0.180704807218812, 0.319295185762859,
			 0.249999996490836, "facGenderm", "<unicode>", 1.53743684450092e-12,
			 "facGenderm", 0.0353553380667272, 7.07106791113135))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.397396510584462, 0.416025502052742, 0.0093144957341401,
			 0.0088447657561088, "experimental", "", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.964197302009531, 0.207509428503119, 0.0448870964627041,
			 1, 0.0807497114696924, 0.899678077647834, 0.490213894558763,
			 0.465492410058241, "", "m", "facGender", "contNormal", "", "<unicode>",
			 "", 0.0189514272255094, 0.208914136340704, 2.34648503516921,
			 1, -0.0543727189027194, 0.0333398342079703, -0.0105164423473746,
			 -0.00998609820703707, "experimental", "", "facExperim", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.63836482029219, 0.0223760624691461,
			 -0.469986279394574, 1, -0.0894709002623381, 0.0396871047364398,
			 -0.0248918977629491, -0.0236365994705798, "", "m", "facGender",
			 "contGamma", "contNormal", "<unicode>", "<unicode>", 0.449969588604478,
			 0.0329490761099591, -0.75546572777576))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.196182963799885, 0.0696578956403529, -0.0632625340797659, -0.0915938818938449,
			 "contGamma", "<unicode>", 0.350907267674392, "contNormal", 0.0678177919434123,
			 -0.932830932221335, 1, -0.397396510584462, 0.416025502052742,
			 0.0093144957341401, 0.0088447657561088, "facExperimexperimental",
			 "<unicode>", 0.964197302009531, "contNormal", 0.207509428503119,
			 0.0448870964627041, 1, 0.0807497114696924, 0.899678077647834,
			 0.490213894558763, 0.465492410058241, "facGenderm", "<unicode>",
			 0.0189514272255094, "contNormal", 0.208914136340704, 2.34648503516921,
			 1, -0.43259073960758, 0.765060581366201, 0.16623492087931, 0.109025821381942,
			 "facExperimexperimental", "<unicode>", 0.586380226077632, "contGamma",
			 0.305528910332206, 0.544089005189594, 1, -0.205355842611306,
			 0.992295478369927, 0.39346981787931, 0.258058715078525, "facGenderm",
			 "<unicode>", 0.197804552739381, "contGamma", 0.305528910334107,
			 1.28783170616829))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.409075392315575, 0.406671499089106, -0.00120194661323445,
			 -0.00114133245092827, "experimental", "", "Total", "facExperim",
			 "contNormal", "<unicode>", 0.995391649700707, 0.208102520719562,
			 -0.005775742692008, 1, 0.0574485510919578, 0.873195442499671,
			 0.465321996795814, 0.441855810587661, "", "m", "Total", "facGender",
			 "contNormal", "<unicode>", 0.0253502727477093, 0.208102520720335,
			 2.23602287557656, 1, -0.0543727189027194, 0.0333398342079703,
			 -0.0105164423473746, -0.00998609820703707, "experimental", "",
			 "Total indirect", "facExperim", "contNormal", "<unicode>", 0.63836482029219,
			 0.0223760624691461, -0.469986279394574, 1, -0.0894709002623381,
			 0.0396871047364398, -0.0248918977629491, -0.0236365994705798,
			 "", "m", "Total indirect", "facGender", "contNormal", "<unicode>",
			 0.449969588604478, 0.0329490761099591, -0.75546572777576))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-two_confounder")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-two_confounder")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0218710372548713, "contNormal", 0.0569750734268599
			))

})
test_that("Test that model number confounder_X_Y - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(750.763478122517, 784.630690540363, 1, "Model 1", 100, -362.381739061259
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.67248035662979, 2.95517833112014, 2.31382934387497, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.327224883877485,
			 7.07106781262173, 0.797840916249275, 1.40973983836071, 1.10379037730499,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156099532169474, 7.07106781144376, 0.00468047953048243, 0.00827014285615362,
			 0.00647531119331802, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000915747267293175, 7.07106799505738, 0.721541837469943,
			 1.27492370307092, 0.998232770270433, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.141171437323845, 7.07106755582931
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176275917663335, 0.237313209387059, 0.030518645861862, 0.0289531808283303,
			 "contcor2", "contNormal", "", "", "<unicode>", "", "", 0.772389630562595,
			 0.105509369129416, 0.289250576642425, -0.0146865201084523, 0.0235011252667924,
			 0.00440730257917005, 0.00418122839124197, "contcor2", "contGamma",
			 "contNormal", "", "<unicode>", "<unicode>", "", 0.650976737432931,
			 0.00974192527935819, 0.452405705523992, -0.00284650474713867,
			 0.0023172825914881, -0.000264611077825287, -0.000251037756397605,
			 "contcor2", "contGamma", "debCollin1", "contNormal", "<unicode>",
			 "<unicode>", "<unicode>", 0.840799256633918, 0.00131731689443226,
			 -0.200871239823679))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.179344122981311, 0.0952661457426463, -0.0420389886193323, -0.0608639682897902,
			 "contGamma", "<unicode>", 0.548448850604066, "contNormal", 0.0700549272563292,
			 -0.600086107655393, -2.83802376961287, 2.28501281085489, -0.276505479378988,
			 -0.0214412409906946, "debCollin1", "<unicode>", 0.832442407449482,
			 "contNormal", 1.30692110183596, -0.211570139154196, -0.176275917663335,
			 0.237313209387059, 0.030518645861862, 0.0289531808283303, "contcor2",
			 "<unicode>", 0.772389630562595, "contNormal", 0.105509369129416,
			 0.289250576642425, -0.0194720977150903, 0.00121575974341409,
			 -0.00912816898583811, -0.170429786787995, "contGamma", "<unicode>",
			 0.0837013628652572, "debCollin1", 0.00527761163513401, -1.72960225513189,
			 -0.403237788228969, 0.193560880010331, -0.104838454109319, -0.0686979260263476,
			 "contcor2", "<unicode>", 0.491071197053125, "contGamma", 0.152247355805201,
			 -0.688606074994554))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.171980601989964, 0.241303276716377, 0.0346613373632068, 0.0328833714631746,
			 "Total", "contcor2", "contNormal", "<unicode>", 0.742339407866267,
			 0.105431498222996, 0.32875694595457, -0.0143110559607141, 0.0225964389634036,
			 0.00414269150134476, 0.00393019063484436, "Total indirect",
			 "contcor2", "contNormal", "<unicode>", 0.659941924671553, 0.00941535028583161,
			 0.439993348689189))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-confounder_X_Y")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-confounder_X_Y")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.00471940504032153, "contNormal", 0.00478519776489772,
			 "debCollin1", 0.0290463122246015))

})
test_that("Test that model number confounder_X_Y - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facGender")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(605.461069409392, 639.328281827238, 1, "Model 1", 100, -289.730534704696
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.64852433532874, 2.91284939447953, 2.28068686490414, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.322537829552897,
			 7.07106781262102, 0.755846181346441, 1.33553751357618, 1.04569184746131,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.147883159283097, 7.07106781144373, 0.0046804796044756, 0.0082701431142376,
			 0.0064753113593566, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000915747314255978, 7.07106781374252, 0.180704808778136,
			 0.319295191204925, 0.24999999999153, "facGenderm", "<unicode>",
			 1.53743684450092e-12, "facGenderm", 0.0353553390572408, 7.07106781204322
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0859003151311874, 0.895699802245711, 0.490800058688449, 0.466091240783872,
			 "m", "facGender", "contNormal", "", "", "<unicode>", "", "",
			 0.0175121668939648, 0.206585297868256, 2.37577438352579, 1,
			 -0.0953627091989635, 0.0411095528715116, -0.0271265781637259,
			 -0.0257609188318732, "m", "facGender", "contGamma", "contNormal",
			 "", "<unicode>", "<unicode>", "", 0.43588329121238, 0.0348149923026522,
			 -0.779163698440899, 1, -0.00898687888768311, 0.0102615994314883,
			 0.000637360271902571, 0.000605273032670904, "m", "facGender",
			 "contGamma", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 "<unicode>", 0.896726559031952, 0.00491041633188184, 0.129797603466815
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.199131680444033, 0.0699782263714942, -0.0645767270362695, -0.0935050913764749,
			 "contGamma", "<unicode>", 0.346888279479809, "contNormal", 0.0686517479245109,
			 -0.940642139327286, -2.65809965640618, 2.32566023375436, -0.166219711325909,
			 -0.0128908015786111, "debCollin1", "<unicode>", 0.895982174640983,
			 "contNormal", 1.27139068102062, -0.130738500609801, 1, 0.0859003151311874,
			 0.895699802245711, 0.490800058688449, 0.466091240783872, "facGenderm",
			 "<unicode>", 0.0175121668939648, "contNormal", 0.206585297868256,
			 2.37577438352579, -0.0194720938579656, 0.00121576386577283,
			 -0.0091281649960964, -0.170429712324421, "contGamma", "<unicode>",
			 0.0837015019893399, "debCollin1", 0.00527761170279701, -1.72960147698223,
			 1, -0.171917887663247, 1.01205269810325, 0.42006740522, 0.27550284645093,
			 "facGenderm", "<unicode>", 0.164294363424204, "contGamma", 0.302038862730515,
			 1.39077270197111))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0615403730485783, 0.867081308544673, 0.464310840796626, 0.44093559498467,
			 "m", "Total", "facGender", "contNormal", "<unicode>", 0.0238565192493443,
			 0.205498912696891, 2.25943210454587, 1, -0.0935866374626978,
			 0.040608201679051, -0.0264892178918234, -0.0251556457992022,
			 "m", "Total indirect", "facGender", "contNormal", "<unicode>",
			 0.439067321348252, 0.0342340063899798, -0.773769146096109))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-confounder_X_Y")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-confounder_X_Y")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0189754545999984, "contNormal", 0.0569463661699144,
			 "debCollin1", 0.0290462868429846))

})
test_that("Test that model number confounder_X_M - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(750.646141055907, 784.513353473752, 1, "Model 1", 100, -362.323070527954
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.67248035662982, 2.95517833112011, 2.31382934387497, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.327224883877473,
			 7.07106781262198, 0.798508437001207, 1.41091930982899, 1.1047138734151,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156230134241854, 7.07106781144369, 0.00467108278239273, 0.00825353945668376,
			 0.00646231111953824, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000913908802036415, 7.07106781895373, 0.721541820949962,
			 1.27492364545022, 0.998232733200092, "contcor2", "<unicode>",
			 1.53743684450092e-12, "contcor2", 0.141171426838775, 7.07106781841997
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0147847276314074, 0.0238549732318986, 0.00453512280024564,
			 0.00430260959990706, "contcor2", "contGamma", "contNormal",
			 "", "<unicode>", "<unicode>", "", 0.645458778032951, 0.00985724767600095,
			 0.460080029366323, -0.0110675944813265, 0.00918971910876603,
			 -0.000938937686280258, -0.000890798878143971, "contcor2", "debCollin1",
			 "contNormal", "", "<unicode>", "<unicode>", "", 0.855825363648231,
			 0.00516777699740395, -0.181690828909981, -0.00276416611518341,
			 0.0022762259116187, -0.000243970101782358, -0.000231461891607922,
			 "contcor2", "contGamma", "debCollin1", "contNormal", "<unicode>",
			 "<unicode>", "<unicode>", 0.849515790983618, 0.00128583792012508,
			 -0.189736278549496))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371895865524, 0.0938554961575184, -0.0432581998540029, -0.0626308526078449,
			 "contGamma", "<unicode>", 0.53634340051376, "contNormal", 0.0699572528337545,
			 -0.618351894932198, -2.81958314194943, 2.30044870967762, -0.259567216135903,
			 -0.0201283367908163, "debCollin1", "<unicode>", 0.842476879750588,
			 "contNormal", 1.30615457529149, -0.198726261842307, -0.019323338331808,
			 0.00139268329860133, -0.00896532751660334, -0.167389414216435,
			 "contGamma", "<unicode>", 0.0898030374720025, "debCollin1",
			 0.00528479650488853, -1.69643760328525, -0.0121898218286524,
			 0.019424461859531, 0.00361732001543929, 0.044255960509882, "contcor2",
			 "<unicode>", 0.653778060839133, "debCollin1", 0.00806501648437238,
			 0.448519853920768, -0.403237788229239, 0.193560880010601, -0.104838454109319,
			 -0.0686979247567855, "contcor2", "<unicode>", 0.491071197053518,
			 "contGamma", 0.152247355805339, -0.68860607499393))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0178966078683174, 0.0246010378926834, 0.00335221501218302,
			 0.00318034883015516, "Total", "contcor2", "contNormal", "<unicode>",
			 0.757166363425402, 0.0108414353774398, 0.309203984110695, -0.0178966078683174,
			 0.0246010378926834, 0.00335221501218302, 0.00318034883015516,
			 "Total indirect", "contcor2", "contNormal", "<unicode>", 0.757166363425402,
			 0.0108414353774398, 0.309203984110695))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-confounder_X_M")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-confounder_X_M")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.00471940486588895, "contNormal", 0.00389806755200572,
			 "debCollin1", 0.0309956316422091))

})
test_that("Test that model number confounder_X_M - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "debCollin1", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facGender")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(610.856280580538, 644.723492998383, 1, "Model 1", 100, -292.428140290269
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.64852433532772, 2.91284939448055, 2.28068686490414, "contGamma",
			 "<unicode>", 1.53743684450092e-12, "contGamma", 0.322537829553417,
			 7.07106781260964, 0.798508437001258, 1.41091930982894, 1.1047138734151,
			 "contNormal", "<unicode>", 1.53743684450092e-12, "contNormal",
			 0.156230134241827, 7.07106781144488, 0.00467600749098505, 0.00826223785611214,
			 0.00646912267354859, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000914871495959829, 7.07107249719434, 0.180704819751814,
			 0.319295229480489, 0.250000024616151, "facGenderm", "<unicode>",
			 1.53743684450092e-12, "facGenderm", 0.0353553460221357, 7.07106711555384
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.0812046415361243, 0.044861922001809, -0.0181713597671576,
			 -0.0172549781652963, "m", "facGender", "contGamma", "contNormal",
			 "", "<unicode>", "<unicode>", "", 0.572058587158497, 0.0321604285926502,
			 -0.565022313518248, 1, -0.0139781290115479, 0.016584988340512,
			 0.00130342966448204, 0.00123769771160913, "m", "facGender",
			 "debCollin1", "contNormal", "", "<unicode>", "<unicode>", "",
			 0.867233352161147, 0.00779685687929416, 0.167173732269412, 1,
			 -0.00876570770142378, 0.010706830067015, 0.000970561182795629,
			 0.000921615786149961, "m", "facGender", "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", "<unicode>", 0.84509605560591,
			 0.00496757540496553, 0.195379255204756))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371895863627, 0.0938554961556288, -0.0432581998539992, -0.0626308526525328,
			 "contGamma", "<unicode>", 0.536343400508167, "contNormal", 0.0699572528327885,
			 -0.618351894940683, -2.81958314187766, 2.30044870960586, -0.259567216135902,
			 -0.0201283292718616, "debCollin1", "<unicode>", 0.84247687974623,
			 "contNormal", 1.30615457525487, -0.198726261847877, -0.0193398100393157,
			 0.00153718314197897, -0.00890131344866836, -0.166194285576155,
			 "contGamma", "<unicode>", 0.0946549770314036, "debCollin1",
			 0.00532586143061039, -1.67133778537835, 1, -0.0368533236902607,
			 0.0268102243814512, -0.00502154965440475, -0.0614903350840632,
			 "facGenderm", "<unicode>", 0.757177233186677, "debCollin1",
			 0.0162409994708785, -0.309189693861441, 1, -0.171917887658684,
			 1.01205269809868, 0.42006740522, 0.275502846193465, "facGenderm",
			 "<unicode>", 0.164294363420952, "contGamma", 0.302038862728187,
			 1.39077270198183))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.0794164391530521, 0.0476217013132922, -0.01589736891988,
			 -0.0150956646675372, "m", "Total", "facGender", "contNormal",
			 "<unicode>", 0.623755999445009, 0.0324082844043067, -0.490534109166464,
			 1, -0.0794164391530521, 0.0476217013132922, -0.01589736891988,
			 -0.0150956646675372, "m", "Total indirect", "facGender", "contNormal",
			 "<unicode>", 0.623755999445009, 0.0324082844043067, -0.490534109166464
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-confounder_X_M")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-confounder_X_M")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0189754564335856, "contNormal", 0.00389806799574866,
			 "debCollin1", 0.0299735350632386))

})
test_that("Test that model number confounder_M_Y - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "confounders", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(752.56251014022, 789.034892744054, 0, "Model 1", 100, -362.28125507011
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.403934216602846, 0.194627973308215, -0.104653121647315, "contcor2",
			 "<unicode>", 0.493114548288139, "contGamma", 0.152697242049457,
			 -0.685363535337588, 1.68041089749268, 2.96919115149608, 2.32480102449438,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776514305655, 7.07106780240718, 0.797840916249276, 1.40973983836072,
			 1.103790377305, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.156099532169474, 7.07106781144376, 0.00467108280299761,
			 0.00825353952855242, 0.00646231116577502, "debCollin1", "<unicode>",
			 1.53743684450092e-12, "debCollin1", 0.000913908815114149, 7.0710677683614,
			 0.721541823491683, 1.27492365431558, 0.998232738903633, "contcor2",
			 "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171428451978,
			 7.07106777801856))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.179344124936921, 0.0952661437880555, -0.0420389905744326, -0.0608656354866836,
			 "contGamma", "contNormal", "", "<unicode>", "", 0.548448832007176,
			 0.0700549272565891, -0.600086135561272, -0.176275917684869,
			 0.237313209364953, 0.0305186458400417, 0.0289539720785311, "contcor2",
			 "contNormal", "", "<unicode>", "", 0.772389630720537, 0.10550936912927,
			 0.289250576436017, -0.020663796033847, 0.0256217211442374, 0.00247896255519518,
			 0.00358913544801936, "contGamma", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.833711582126616, 0.011807746862488,
			 0.209943741516902, -0.0112451663636773, 0.00924474906985262,
			 -0.00100020864691232, -0.000948928513643551, "contcor2", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.848251370059927, 0.00522711529271755,
			 -0.191350025951373))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.179344124936921, 0.0952661437880555, -0.0420389905744326, -0.0608656354866836,
			 "contGamma", "<unicode>", 0.548448832007176, "contNormal", 0.0700549272565891,
			 -0.600086135561272, -2.83802377009357, 2.28501281046962, -0.276505479811975,
			 -0.021441827453737, "debCollin1", "<unicode>", 0.832442407194066,
			 "contNormal", 1.3069211018603, -0.211570139481558, -0.176275917684869,
			 0.237313209364953, 0.0305186458400417, 0.0289539720785311, "contcor2",
			 "<unicode>", 0.772389630720537, "contNormal", 0.10550936912927,
			 0.289250576436017, -0.0193233397017338, 0.00139268200279131,
			 -0.00896532884947124, -0.167389438039426, "contGamma", "<unicode>",
			 0.0898029908928475, "debCollin1", 0.00528479652379596, -1.69643784942389,
			 -0.012189822462367, 0.0194244613389091, 0.00361731943827106,
			 0.0442559532619579, "contcor2", "<unicode>", 0.653778113632947,
			 "debCollin1", 0.0080650165132231, 0.448519780751873))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.174961351109489, 0.0958412950710138, -0.0395600280192374, -0.0572765000386643,
			 "Total", "contGamma", "contNormal", "<unicode>", 0.566888387870401,
			 0.069083577126049, -0.572640121791271, -0.177114666223163, 0.236151540609422,
			 0.0295184371931294, 0.0280050435648876, "Total", "contcor2",
			 "contNormal", "<unicode>", 0.779485655425546, 0.105426990009096,
			 0.279989376445088, -0.020663796033847, 0.0256217211442374, 0.00247896255519518,
			 0.00358913544801936, "Total indirect", "contGamma", "contNormal",
			 "<unicode>", 0.833711582126616, 0.011807746862488, 0.209943741516902,
			 -0.0112451663636773, 0.00924474906985262, -0.00100020864691232,
			 -0.000948928513643551, "Total indirect", "contcor2", "contNormal",
			 "<unicode>", 0.848251370059927, 0.00522711529271755, -0.191350025951373
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-confounder_M_Y")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-confounder_M_Y")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.00473076864940203, "debCollin1", 0.0309956384162788
			))

})
test_that("Test that model number confounder_M_Y - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "confounders", processVariable = "facGender")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(607.365516379342, 643.837898983176, 0, "Model 1", 100, -289.682758189671
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0458149245496739, 0.255848631149462, 0.105016853299894, "facGenderm",
			 "<unicode>", 0.172370035376538, "contGamma", 0.0769564027907196,
			 1.36462788659033, 1.68041089310602, 2.96919113619567, 2.32480101465085,
			 "contGamma", "<unicode>", 1.53743684450092e-12, "contGamma",
			 0.328776511521484, 7.07106783234707, 0.755846181346482, 1.33553751357631,
			 1.0456918474614, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.14788315928312, 7.07106781144319, 0.00467600939573319,
			 0.00826224449975957, 0.00646912694774638, "debCollin1", "<unicode>",
			 1.53743684450092e-12, "debCollin1", 0.000914872704884922, 7.07106782528844,
			 0.180704808888485, 0.319295191589819, 0.250000000239152, "facGenderm",
			 "<unicode>", 1.53743684450092e-12, "facGenderm", 0.0353553391272791,
			 7.07106780503936))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.199131680433643, 0.0699782263807102, -0.0645767270264666, -0.0934966198437019,
			 "", "contGamma", "contNormal", "", "<unicode>", "", 0.346888279550906,
			 0.0686517479242114, -0.940642139188598, 1, 0.0859003151283558,
			 0.895699802252282, 0.490800058690319, 0.466049013781975, "m",
			 "facGender", "contNormal", "", "<unicode>", "", 0.0175121668948446,
			 0.206585297870655, 2.37577438350726, -0.0207692258847186, 0.0237283785708711,
			 0.00147957634307626, 0.0021421864075217, "", "contGamma", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.896297169201029, 0.0113516382970762,
			 0.130340335408445, 1, -0.0127511137442109, 0.0144204790678225,
			 0.000834682661805813, 0.000792589618659689, "m", "facGender",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.904153576898372,
			 0.00693165614938833, 0.120416051202925))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.199131680433643, 0.0699782263807102, -0.0645767270264666, -0.0934966198437019,
			 "contGamma", "<unicode>", 0.346888279550906, "contNormal", 0.0686517479242114,
			 -0.940642139188598, -2.65809965634259, 2.32566023369516, -0.166219711323718,
			 -0.0128896336885157, "debCollin1", "<unicode>", 0.895982174639798,
			 "contNormal", 1.2713906809893, -0.130738500611298, 1, 0.0859003151283558,
			 0.895699802252282, 0.490800058690319, 0.466049013781975, "facGenderm",
			 "<unicode>", 0.0175121668948446, "contNormal", 0.206585297870655,
			 2.37577438350726, -0.0193398290769307, 0.0015371710011417, -0.00890132903789453,
			 -0.166194514079196, "contGamma", "<unicode>", 0.0946545081955734,
			 "debCollin1", 0.00532586319002481, -1.67134016032677, 1, -0.0368533470074346,
			 0.0268102220957298, -0.00502156245585243, -0.0614904688382157,
			 "facGenderm", "<unicode>", 0.757176711327508, "debCollin1",
			 0.0162410048361436, -0.309190379937403))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.195822609174617, 0.0696283078078361, -0.0630971506833903, -0.0913544334361802,
			 "", "Total", "contGamma", "contNormal", "<unicode>", 0.351461078416551,
			 0.0677183149987183, -0.931759017993648, 1, 0.0868938127220651,
			 0.896375669982184, 0.491634741352124, 0.466841603400635, "m",
			 "Total", "facGender", "contNormal", "<unicode>", 0.0172775001236745,
			 0.206504268355237, 2.38074856886926, -0.0207692258847186, 0.0237283785708711,
			 0.00147957634307626, 0.0021421864075217, "", "Total indirect",
			 "contGamma", "contNormal", "<unicode>", 0.896297169201029, 0.0113516382970762,
			 0.130340335408445, 1, -0.0127511137442109, 0.0144204790678225,
			 0.000834682661805813, 0.000792589618659689, "m", "Total indirect",
			 "facGender", "contNormal", "<unicode>", 0.904153576898372, 0.00693165614938833,
			 0.120416051202925))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-confounder_M_Y")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-confounder_M_Y")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.0571172362564628, "debCollin1", 0.0299736199242384
			))

})
test_that("Test that model number confounder_moderator - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "contcor1"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "contcor2")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1566.22297465271, 1618.32637837247, 0, "Model 1", 100, -763.111487326356,
			 5))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.636776615725984, 0.244353492314904, -0.19621156170554, "contGamma:contcor1",
			 "<unicode>", 0.382719617146233, "contGamma", 0.224782219211968,
			 -0.872896274418014, -0.399784516426047, 0.0577143650541489,
			 -0.171035075685949, "contcor1", "<unicode>", 0.142796133715996,
			 "contGamma", 0.116711042929587, -1.46545752135157, 1.67248034253246,
			 2.9551782819496, 2.31382931224103, "contGamma", "<unicode>",
			 1.53743684450092e-12, "contGamma", 0.327224874930075, 7.07106790929472,
			 0.770797942052738, 1.36195643029505, 1.0663771861739, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.150808507938232,
			 7.07106781144378, 0.424979178622068, 0.896763085449989, 0.660871132036028,
			 "contcor2", "<unicode>", 3.99655710747737e-08, "contcor1", 0.120355249012046,
			 5.49100381961639, -0.253361710021776, 0.338176432307602, 0.042407361142913,
			 "contGamma:contcor1", "<unicode>", 0.778695381120262, "contcor1",
			 0.15090536025033, 0.28101958123002, 0.732634584304492, 1.29452392248119,
			 1.01357925339284, "contcor1", "<unicode>", 1.53743684450092e-12,
			 "contcor1", 0.143341750820119, 7.07106790306191, -0.0195935307984836,
			 0.577311814317444, 0.27885914175948, "contcor2", "<unicode>",
			 0.0670570295778621, "contGamma:contcor1", 0.1522745697942, 1.83129160789197,
			 1.62269996825472, 2.86721917664156, 2.24495957244814, "contGamma:contcor1",
			 "<unicode>", 1.53743684450092e-12, "contGamma:contcor1", 0.317485223760091,
			 7.07106789368109, 0.721541815314739, 1.27492362579487, 0.998232720554804,
			 "contcor2", "<unicode>", 1.53743684450092e-12, "contcor2", 0.141171423262145,
			 7.07106790799408))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.39652857379909, 0.156057761969868, "", -0.120235405914611,
			 -0.114071003470815, "contcor2", "contNormal", "", "<unicode>",
			 "", 0.393701468866851, 0.140968492311004, -0.852923968636539,
			 -0.0206086696970371, 0.0187012485763109, 16, -0.000953710560363106,
			 -0.000904814349931115, "contcor2", "contGamma", "contNormal",
			 "<unicode>", "<unicode>", 0.924233307349072, 0.0100282246468352,
			 -0.0951026322155719, -0.0132920498643952, 0.0180761726160158,
			 50, 0.00239206137581031, 0.00226942171839336, "contcor2", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.764998186455682, 0.00800224461465607,
			 0.298923800883225, -0.0215734142602395, 0.0336597134547793,
			 84, 0.00604314959726993, 0.00573332067572836, "contcor2", "contGamma",
			 "contNormal", "<unicode>", "<unicode>", 0.668006242876163, 0.0140903425141203,
			 0.42888592603153))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.159759911841737, 0.110922820683369, -0.0244185455791842, -0.0353540906525322,
			 "contGamma", "<unicode>", 0.723623373927385, "contNormal", 0.0690529863457229,
			 -0.353620413416003, -0.0299980227414991, 0.514839519987163,
			 0.242420748622832, 0.231753142517883, "contcor1", "<unicode>",
			 0.0811350258499262, "contNormal", 0.138991723068962, 1.74413801966145,
			 -0.172199170911231, 0.106681627197621, -0.032758771856805, -0.0477503265617624,
			 "contGamma:contcor1", "<unicode>", 0.645189746503624, "contNormal",
			 0.0711443680365122, -0.4604548857612, -0.39652857379909, 0.156057761969868,
			 -0.120235405914611, -0.114071003470815, "contcor2", "<unicode>",
			 0.393701468866851, "contNormal", 0.140968492311004, -0.852923968636539,
			 -0.403237783441557, 0.193560880588295, -0.104838451426631, -0.0686979230415097,
			 "contcor2", "<unicode>", 0.491071205087393, "contGamma", 0.152247354731343,
			 -0.688606062230966))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.395742418487865, 0.153364185537917, 16, -0.121189116474974,
			 -0.114975817820746, "Total", "contcor2", "contNormal", "<unicode>",
			 0.38696343178117, 0.140080789330076, -0.865137304369502, -0.395397294622644,
			 0.159710605545042, 50, -0.117843344538801, -0.111801581752421,
			 "Total", "contcor2", "contNormal", "<unicode>", 0.40531982598309,
			 0.14161176035537, -0.832157895947881, -0.396174292445415, 0.167789779810733,
			 84, -0.114192256317341, -0.108337682795086, "Total", "contcor2",
			 "contNormal", "<unicode>", 0.42736273307696, 0.143871029443557,
			 -0.793712651942483, -0.0206086696970371, 0.0187012485763109,
			 16, -0.000953710560363106, -0.000904814349931115, "Total indirect",
			 "contcor2", "contNormal", "<unicode>", 0.924233307349072, 0.0100282246468352,
			 -0.0951026322155719, -0.0132920498643952, 0.0180761726160158,
			 50, 0.00239206137581031, 0.00226942171839336, "Total indirect",
			 "contcor2", "contNormal", "<unicode>", 0.764998186455682, 0.00800224461465607,
			 0.298923800883225, -0.0215734142602395, 0.0336597134547793,
			 84, 0.00604314959726993, 0.00573332067572836, "Total indirect",
			 "contcor2", "contNormal", "<unicode>", 0.668006242876163, 0.0140903425141203,
			 0.42888592603153))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-confounder_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-confounder_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.00471940463021714, "contNormal", 0.0384656132585373
			))

})
test_that("Test that model number confounder_moderator - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "moderators", processVariable = "facExperim"),
        list(processDependent = "contNormal", processIndependent = "contGamma",
            processType = "confounders", processVariable = "facGender")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1204.64162296854, 1256.7450266883, 0, "Model 1", 100, -582.320811484271,
			 5))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.627274027846072, 1.32814769192849, 0.977710859887279, "contGamma:facExperimexperimental",
			 "<unicode>", 4.54486885903549e-08, "contGamma", 0.178797587509469,
			 5.46825532439301, -0.10581029933316, 0.186799957411387, 0.0404948290391136,
			 "facExperimexperimental", "<unicode>", 0.587484113658187, "contGamma",
			 0.0746468453126231, 0.542485471013813, 1.64852433860403, 2.91284940590342,
			 2.28068687225372, "contGamma", "<unicode>", 1.53743684450092e-12,
			 "contGamma", 0.322537831631659, 7.07106778983462, 0.728706145776807,
			 1.28758260354611, 1.00814437466146, "contNormal", "<unicode>",
			 1.53743684450092e-12, "contNormal", 0.14257314475614, 7.07106781144378,
			 -0.00962232415901605, 0.0896223241711077, 0.0400000000060458,
			 "facGenderm", "<unicode>", 0.114128617865525, "facExperimexperimental",
			 0.025317977552892, 1.57990502687197, -0.0687837206856414, 0.12608124230925,
			 0.0286487608118045, "contGamma:facExperimexperimental", "<unicode>",
			 0.564411033525641, "facExperimexperimental", 0.0497113632015593,
			 0.576302055842756, 0.180704808439051, 0.319295190017036, 0.249999999228044,
			 "facExperimexperimental", "<unicode>", 1.53743684450092e-12,
			 "facExperimexperimental", 0.0353553388407053, 7.07106783375568,
			 -0.07174504012197, 0.123055822638848, 0.0256553912584389, "facGenderm",
			 "<unicode>", 0.60567500780368, "contGamma:facExperimexperimental",
			 0.049695010800551, 0.516256880623406, 0.712125014905553, 1.25828468417248,
			 0.985204849539017, "contGamma:facExperimexperimental", "<unicode>",
			 1.53743684450092e-12, "contGamma:facExperimexperimental", 0.139329006444752,
			 7.07106778895805, 0.180704808040152, 0.319295188630881, 0.249999998335517,
			 "facGenderm", "<unicode>", 1.53743684450092e-12, "facGenderm",
			 0.0353553385888498, 7.07106785888229))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.108832959967675, 0.914012149352829, 0.511422554660252, 0.485631517514309,
			 "", "m", "facGender", "contNormal", "", "<unicode>", "", 0.0127813019126344,
			 0.205406628829995, 2.48980550225344, 1, -0.198988493720655,
			 0.052766950706554, -0.0731107715070505, -0.0694237956266858,
			 0, "m", "facGender", "contGamma", "contNormal", "<unicode>",
			 "<unicode>", 0.254969144385525, 0.0642245078004045, -1.13836250383207,
			 1, -0.0618215487830906, 0.13297466632052, 0.0355765587687149,
			 0.0337824330690021, 1, "m", "facGender", "contGamma", "contNormal",
			 "<unicode>", "<unicode>", 0.474043786848412, 0.0496938251519259,
			 0.715915079186374))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.346197781237816, -0.00189289147640892, -0.174045336357112,
			 -0.251989399974165, "contGamma", "<unicode>", 0.0475335885183712,
			 "contNormal", 0.0878344940206147, -1.98151464635595, 1, -0.397726268417947,
			 0.401048980587723, 0.00166135608488765, 0.00157757390495145,
			 "facExperimexperimental", "<unicode>", 0.993494937643073, "contNormal",
			 0.203772940550517, 0.00815297693795505, 1, -0.00348417438464865,
			 0.520959850421741, 0.258737838018546, 0.374610397023958, "contGamma:facExperimexperimental",
			 "<unicode>", 0.0531227537886132, "contNormal", 0.133789199429973,
			 1.93392171506319, 1, 0.108832959967675, 0.914012149352829, 0.511422554660252,
			 0.485631517514309, "facGenderm", "<unicode>", 0.0127813019126344,
			 "contNormal", 0.205406628829995, 2.48980550225344, 1, -0.171917897354241,
			 1.01205269254392, 0.420067397594838, 0.275502841126664, "facGenderm",
			 "<unicode>", 0.164294372554291, "contGamma", 0.302038863784531,
			 1.39077267187214))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0256784566759989, 0.850945109630404, 0.438311783153201, 0.416207721887624,
			 0, "m", "Total", "facGender", "contNormal", "<unicode>", 0.0373485081635496,
			 0.210531075944253, 2.08193389592168, 1, 0.136337845713019, 0.957660381144914,
			 0.546999113428967, 0.519413950583312, 1, "m", "Total", "facGender",
			 "contNormal", "<unicode>", 0.00903666479885734, 0.209524905026415,
			 2.61066393687188, 1, -0.198988493720655, 0.052766950706554,
			 -0.0731107715070505, -0.0694237956266858, 0, "m", "Total indirect",
			 "facGender", "contNormal", "<unicode>", 0.254969144385525, 0.0642245078004045,
			 -1.13836250383207, 1, -0.0618215487830906, 0.13297466632052,
			 0.0355765587687149, 0.0337824330690021, 1, "m", "Total indirect",
			 "facGender", "contNormal", "<unicode>", 0.474043786848412, 0.0496938251519259,
			 0.715915079186374))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-confounder_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-confounder_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contGamma", 0.0189754537408786, "contNormal", 0.0909731608597582
			))

})
test_that("Test that model number mediator_is_moderator - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contcor1",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "contcor1",
            processType = "moderators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(168.380208743122, 204.852591346956, 0, "Model 1", 100, -70.1901043715611
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0184428305116763, 0.0140671942071194, -0.00218781815227847,
			 "contcor1:debCollin1", "<unicode>", 0.791935337182283, "contcor1",
			 0.00829352604824137, -0.263798309615533, 0.732634593743467,
			 1.29452395502494, 1.01357927438421, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341756714304, 7.07106775874373,
			 0.762161580987908, 1.34669646805998, 1.05442902452394, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.149118782713053,
			 7.07106781144378, -0.00195555065754508, 0.000690341776359646,
			 -0.000632604440592717, "contcor1:debCollin1", "<unicode>", 0.348649187835511,
			 "debCollin1", 0.000674984962676658, -0.937212642610761, 0.00481693209720317,
			 0.00851124685733955, 0.00666408947727136, "debCollin1", "<unicode>",
			 1.53743684450092e-12, "debCollin1", 0.000942444552368477, 7.07106795887747,
			 0.00490171539581329, 0.00866105410021154, 0.00678138474801242,
			 "contcor1:debCollin1", "<unicode>", 1.53743684450092e-12, "contcor1:debCollin1",
			 0.00095903259806084, 7.07106803431328))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.288727992942804, 0.291732486116143, 16, 0.00150224658666961,
			 0.00143614097788978, "contcor1", "contNormal", "", "<unicode>",
			 "", 0.991905700520919, 0.148079373814403, 0.0101448739819259,
			 -0.00882848543291906, 0.395929561520052, 50, 0.193550538043566,
			 0.185033443539527, "contcor1", "contNormal", "", "<unicode>",
			 "", 0.0608665744050871, 0.103256501176973, 1.87446345593132,
			 0.0456710843647719, 0.620808482854978, 84, 0.333239783609875,
			 0.318575733805622, "contcor1", "contNormal", "", "<unicode>",
			 "", 0.0231323602770435, 0.14672142014517, 2.27124153569505,
			 -0.00544847529211446, 0.00547908099583981, "", 1.53028518626735e-05,
			 1.46294575295286e-05, "contcor1", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.995620088967547, 0.00278769313470794,
			 0.00548943198666548))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0273921980532263, 0.372684185257576, 0.172645993602175, 0.165048793108098,
			 "contcor1", "<unicode>", 0.0907267260600841, "contNormal", 0.102062177281459,
			 1.69157662711884, -2.46945355954407, 2.4833280463329, 0.00693724339441402,
			 0.00053795380009999, "debCollin1", "<unicode>", 0.995619197037879,
			 "contNormal", 1.26348791226366, 0.00549054987157357, -0.502040201235133,
			 4.4094316856074, 1.95369574218613, 0.152525985042835, "contcor1:debCollin1",
			 "<unicode>", 0.118930763958128, "contNormal", 1.25294952498709,
			 1.55927729188154, -0.0136865075667799, 0.0180983037205651, 0.00220589807689257,
			 0.0271946355371212, "contcor1", "<unicode>", 0.785585904772424,
			 "debCollin1", 0.00810851922230704, 0.27204696892424))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.288289230204442, 0.291324329081507, 16, 0.00151754943853229,
			 0.0014507704354193, "Total", "contcor1", "contNormal", "<unicode>",
			 0.991811302356649, 0.147863318881844, 0.0102631906953539, -0.0088197229437017,
			 0.39595140473456, 50, 0.193565840895429, 0.185048072997057,
			 "Total", "contcor1", "contNormal", "<unicode>", 0.0608545089234469,
			 0.103259838158008, 1.87455107763422, 0.0453679786442012, 0.621142194279274,
			 84, 0.333255086461738, 0.318590363263151, "Total", "contcor1",
			 "contNormal", "<unicode>", 0.0232784418070981, 0.146883876483626,
			 2.26883368304136, -0.00544847529211446, 0.00547908099583981,
			 "", 1.53028518626735e-05, 1.46294575295286e-05, "Total indirect",
			 "contcor1", "contNormal", "<unicode>", 0.995620088967547, 0.00278769313470794,
			 0.00548943198666548))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-mediator_is_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-mediator_is_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.0492390693455049, "debCollin1", 0.000739548201996842
			))

})
test_that("Test that model number mediator_is_moderator - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facExperim",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "facExperim",
            processType = "moderators", processVariable = "debCollin1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-107.849818404747, -71.3774358009133, 0, "Model 1", 100, 67.9249092023733
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00758080459604633, 0.00363548509922643, -0.00197265974840995,
			 "facExperimexperimental:debCollin1", "<unicode>", 0.490561823492429,
			 "facExperimexperimental", 0.00286135096964674, -0.689415513628337,
			 0.180704809012174, 0.319295192021241, 0.250000000516707, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553392057837, 7.0710677971889, 0.800623470732841, 1.41465645497939,
			 1.10763996285612, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.156643945779097, 7.07106781144378, 0.00213588775134652,
			 0.0043517136280209, 0.00324380068968371, "facExperimexperimental:debCollin1",
			 "<unicode>", 9.55319334750016e-09, "debCollin1", 0.000565272090240568,
			 5.73847664812748, 0.00477549282399899, 0.00843802607595791,
			 0.00660675944997845, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000934336875791728, 7.0710678569548, 0.00235593261017279,
			 0.00416279986027401, 0.0032593662352234, "facExperimexperimental:debCollin1",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental:debCollin1",
			 0.000460943992939043, 7.07106781984777))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.527309947797386, 0.687448899983207, 16, 0.0800694760929103,
			 0.0760315727446278, "experimental", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.796115436910172, 0.309893155527973, 0.258377684903991,
			 1, -0.347131442420519, 0.489125566268363, 50, 0.0709970619239218,
			 0.0674166803846675, "experimental", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.739287933641676, 0.213334789640313, 0.332796455953689,
			 1, -0.524266951599659, 0.653063158599432, 84, 0.0643981034998865,
			 0.0611505074066699, "experimental", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.830224311989085, 0.300344832733081, 0.214413888575595,
			 1, -0.0556081007378933, 0.0566815458385459, "", 0.000536722550326274,
			 0.000509655634332639, "experimental", "facExperim", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.985051319283472, 0.0286458443783063,
			 0.0187364890780716))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.342506177791424, 0.486475374510237, 0.0719845983594068,
			 0.0683544153617944, "facExperimexperimental", "<unicode>", 0.733565201074971,
			 "contNormal", 0.211478771763298, 0.340386875520428, -3.59103269068267,
			 3.52301253058178, -0.0340100800504474, -0.00263733746791564,
			 "debCollin1", "<unicode>", 0.985048534548136, "contNormal",
			 1.81484080252983, -0.0187399798390242, 1, -5.1686692562786,
			 4.98408300665524, -0.0922931248116832, -0.00715694040519214,
			 "facExperimexperimental:debCollin1", "<unicode>", 0.971574258146437,
			 "contNormal", 2.59003541468554, -0.0356339238793338, 1, -0.0476432272503267,
			 0.016080669942014, -0.0157812786541563, -0.193246272247228,
			 "facExperimexperimental", "<unicode>", 0.331661043500685, "debCollin1",
			 0.0162563949376077, -0.970773576474065))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.497259307921941, 0.658471705208414, 16, 0.0806061986432366,
			 0.0765412283789604, "experimental", "Total", "facExperim", "contNormal",
			 "<unicode>", 0.784549986772019, 0.294834757742136, 0.273394491411136,
			 1, -0.351674892498154, 0.49474246144665, 50, 0.0715337844742481,
			 0.0679263360190001, "experimental", "Total", "facExperim", "contNormal",
			 "<unicode>", 0.740427516682327, 0.215926762078599, 0.331287255853026,
			 1, -0.550982106340292, 0.680851758440717, 84, 0.0649348260502128,
			 0.0616601630410025, "experimental", "Total", "facExperim", "contNormal",
			 "<unicode>", 0.836295019087192, 0.314249107253388, 0.206634878354178,
			 1, -0.0556081007378933, 0.0566815458385459, "", 0.000536722550326274,
			 0.000509655634332639, "experimental", "Total indirect", "facExperim",
			 "contNormal", "<unicode>", 0.985051319283472, 0.0286458443783063,
			 0.0187364890780716))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-mediator_is_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-mediator_is_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.00125966187125981, "debCollin1", 0.00933603045365838
			))

})
test_that("Test that model number independent_is_moderator - continuous works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "contcor1",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "contcor1")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(168.380208743122, 204.852591346956, 0, "Model 1", 100, -70.1901043715611
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0184428305116763, 0.0140671942071194, -0.00218781815227847,
			 "debCollin1:contcor1", "<unicode>", 0.791935337182283, "contcor1",
			 0.00829352604824137, -0.263798309615533, 0.732634593743467,
			 1.29452395502494, 1.01357927438421, "contcor1", "<unicode>",
			 1.53743684450092e-12, "contcor1", 0.143341756714304, 7.07106775874373,
			 0.762161580987908, 1.34669646805998, 1.05442902452394, "contNormal",
			 "<unicode>", 1.53743684450092e-12, "contNormal", 0.149118782713053,
			 7.07106781144378, -0.00195555065754508, 0.000690341776359646,
			 -0.000632604440592717, "debCollin1:contcor1", "<unicode>", 0.348649187835511,
			 "debCollin1", 0.000674984962676658, -0.937212642610761, 0.00481693209720317,
			 0.00851124685733955, 0.00666408947727136, "debCollin1", "<unicode>",
			 1.53743684450092e-12, "debCollin1", 0.000942444552368477, 7.07106795887747,
			 0.00490171539581329, 0.00866105410021154, 0.00678138474801242,
			 "debCollin1:contcor1", "<unicode>", 1.53743684450092e-12, "debCollin1:contcor1",
			 0.00095903259806084, 7.07106803431328))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0273921980532263, 0.372684185257576, "", 0.172645993602175,
			 0.165048793108098, "contcor1", "contNormal", "", "<unicode>",
			 "", 0.0907267260600841, 0.102062177281459, 1.69157662711884,
			 -0.0369047253530818, 0.0281169176957239, 16, -0.00439390382867896,
			 -0.00420055229099378, "contcor1", "debCollin1", "contNormal",
			 "<unicode>", "<unicode>", 0.791091791213998, 0.016587458637426,
			 -0.264893129485493, -0.00581869767059396, 0.00542781924436429,
			 50, -0.000195439213114832, -0.000186839008410057, "contcor1",
			 "debCollin1", "contNormal", "<unicode>", "<unicode>", 0.945690470230134,
			 0.00286906213677122, -0.0681195470150308, -0.0282365352728287,
			 0.037008842502124, 84, 0.00438615361464766, 0.00419314312124992,
			 "contcor1", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.792150468534131, 0.0166445348714568, 0.263519145985229))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0273921980532263, 0.372684185257576, 0.172645993602175, 0.165048793108098,
			 "contcor1", "<unicode>", 0.0907267260600841, "contNormal", 0.102062177281459,
			 1.69157662711884, -2.46945355954407, 2.4833280463329, 0.00693724339441402,
			 0.00053795380009999, "debCollin1", "<unicode>", 0.995619197037879,
			 "contNormal", 1.26348791226366, 0.00549054987157357, -0.502040201235133,
			 4.4094316856074, 1.95369574218613, 0.152525985042835, "debCollin1:contcor1",
			 "<unicode>", 0.118930763958128, "contNormal", 1.25294952498709,
			 1.55927729188154, -0.0136865075667799, 0.0180983037205651, 0.00220589807689257,
			 0.0271946355371212, "contcor1", "<unicode>", 0.785585904772424,
			 "debCollin1", 0.00810851922230704, 0.27204696892424))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.034145899529816, 0.370650079076808, 16, 0.168252089773496,
			 0.160848240817104, "Total", "contcor1", "contNormal", "<unicode>",
			 0.103248488791673, 0.103266177797042, 1.62930490275506, -0.02752477777138,
			 0.3724258865495, 50, 0.17245055438906, 0.164861954099688, "Total",
			 "contcor1", "contNormal", "<unicode>", 0.0909910666678602, 0.102030105521234,
			 1.69019284561232, -0.0256446454995221, 0.379708939933167, 84,
			 0.177032147216822, 0.169241936229348, "Total", "contcor1", "contNormal",
			 "<unicode>", 0.0869021573495061, 0.103408427050208, 1.71197021622685,
			 -0.0369047253530818, 0.0281169176957239, 16, -0.00439390382867896,
			 -0.00420055229099378, "Total indirect", "contcor1", "contNormal",
			 "<unicode>", 0.791091791213998, 0.016587458637426, -0.264893129485493,
			 -0.00581869767059396, 0.00542781924436429, 50, -0.000195439213114832,
			 -0.000186839008410057, "Total indirect", "contcor1", "contNormal",
			 "<unicode>", 0.945690470230134, 0.00286906213677122, -0.0681195470150308,
			 -0.0282365352728287, 0.037008842502124, 84, 0.00438615361464766,
			 0.00419314312124992, "Total indirect", "contcor1", "contNormal",
			 "<unicode>", 0.792150468534131, 0.0166445348714568, 0.263519145985229
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-independent_is_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-independent_is_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.0492390693455049, "debCollin1", 0.000739548201996842
			))

})
test_that("Test that model number independent_is_moderator - factor works", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "contNormal"
options$covariates <- list("contGamma", "contcor1", "contcor2", "debCollin1")
options$factors <- list("facGender", "facExperim")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "contNormal", processIndependent = "facExperim",
            processType = "mediators", processVariable = "debCollin1"),
        list(processDependent = "contNormal", processIndependent = "debCollin1",
            processType = "moderators", processVariable = "facExperim")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "debug.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-107.849818404747, -71.3774358009133, 0, "Model 1", 100, 67.9249092023733
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.00758080459604633, 0.00363548509922643, -0.00197265974840995,
			 "debCollin1:facExperimexperimental", "<unicode>", 0.490561823492429,
			 "facExperimexperimental", 0.00286135096964674, -0.689415513628337,
			 0.180704809012174, 0.319295192021241, 0.250000000516707, "facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "facExperimexperimental",
			 0.0353553392057837, 7.0710677971889, 0.800623470732841, 1.41465645497939,
			 1.10763996285612, "contNormal", "<unicode>", 1.53743684450092e-12,
			 "contNormal", 0.156643945779097, 7.07106781144378, 0.00213588775134652,
			 0.0043517136280209, 0.00324380068968371, "debCollin1:facExperimexperimental",
			 "<unicode>", 9.55319334750016e-09, "debCollin1", 0.000565272090240568,
			 5.73847664812748, 0.00477549282399899, 0.00843802607595791,
			 0.00660675944997845, "debCollin1", "<unicode>", 1.53743684450092e-12,
			 "debCollin1", 0.000934336875791728, 7.0710678569548, 0.00235593261017279,
			 0.00416279986027401, 0.0032593662352234, "debCollin1:facExperimexperimental",
			 "<unicode>", 1.53743684450092e-12, "debCollin1:facExperimexperimental",
			 0.000460943992939043, 7.07106781984777))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.342506177791424, 0.486475374510237, 0.0719845983594068,
			 0.0683544153617944, "experimental", "", "facExperim", "contNormal",
			 "", "<unicode>", "", 0.733565201074971, 0.211478771763298, 0.340386875520428,
			 1, -0.0556081007378933, 0.0566815458385459, 0.000536722550326274,
			 0.000509655634332639, "experimental", 0, "facExperim", "debCollin1",
			 "contNormal", "<unicode>", "<unicode>", 0.985051319283472, 0.0286458443783063,
			 0.0187364890780716, 1, -0.0553043591200881, 0.0592908112617727,
			 0.00199322607084228, 0.00189270768833158, "experimental", 1,
			 "facExperim", "debCollin1", "contNormal", "<unicode>", "<unicode>",
			 0.945640931171354, 0.0292339990136995, 0.0681817793695698))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.342506177791424, 0.486475374510237, 0.0719845983594068,
			 0.0683544153617944, "facExperimexperimental", "<unicode>", 0.733565201074971,
			 "contNormal", 0.211478771763298, 0.340386875520428, -3.59103269068267,
			 3.52301253058178, -0.0340100800504474, -0.00263733746791564,
			 "debCollin1", "<unicode>", 0.985048534548136, "contNormal",
			 1.81484080252983, -0.0187399798390242, 1, -5.1686692562786,
			 4.98408300665524, -0.0922931248116832, -0.00715694040519214,
			 "debCollin1:facExperimexperimental", "<unicode>", 0.971574258146437,
			 "contNormal", 2.59003541468554, -0.0356339238793338, 1, -0.0476432272503267,
			 0.016080669942014, -0.0157812786541563, -0.193246272247228,
			 "facExperimexperimental", "<unicode>", 0.331661043500685, "debCollin1",
			 0.0162563949376077, -0.970773576474065))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.341970871821591, 0.487013513641057, 0.0725213209097331,
			 0.068864070996127, "experimental", 0, "Total", "facExperim",
			 "contNormal", "<unicode>", 0.731655896594548, 0.211479494521729,
			 0.342923653537869, 1, -0.340532487034183, 0.488488135894681,
			 0.0739778244302491, 0.070247123050126, "experimental", 1, "Total",
			 "facExperim", "contNormal", "<unicode>", 0.726492122332474,
			 0.211488738943183, 0.34979557209485, 1, -0.0556081007378933,
			 0.0566815458385459, 0.000536722550326274, 0.000509655634332639,
			 "experimental", 0, "Total indirect", "facExperim", "contNormal",
			 "<unicode>", 0.985051319283472, 0.0286458443783063, 0.0187364890780716,
			 1, -0.0553043591200881, 0.0592908112617727, 0.00199322607084228,
			 0.00189270768833158, "experimental", 1, "Total indirect", "facExperim",
			 "contNormal", "<unicode>", 0.945640931171354, 0.0292339990136995,
			 0.0681817793695698))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-independent_is_moderator")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-independent_is_moderator")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("contNormal", 0.00125966187125981, "debCollin1", 0.00933603045365838
			))

})
