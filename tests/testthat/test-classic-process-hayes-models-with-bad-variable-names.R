### This code was automatically generated by 'generate-tests.R'

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1333.40664843794, 1369.87903104177, 0, "Model 1", 100, -652.70332421897,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-1.36470935762989, 0.181024988924722, -0.591842184352583, "W:Y",
			 "<unicode>", 0.133383762637137, "W", 0.394327232221399, -1.50089097579821,
			 -0.544848201083654, 0.0642086602672606, -0.240319770408196,
			 "Y", "<unicode>", 0.121932457282503, "W", 0.155374503346765,
			 -1.54671303998862, 1.68041088576919, 2.96919111060524, 2.32480099818722,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776506864865,
			 7.07106788242252, 0.776405338662407, 1.37186438540011, 1.07413486203126,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.151905609346553,
			 7.07106779434829, 1.44041331974756, 2.74027817314781, 2.09034574644769,
			 "W:Y", "<unicode>", 2.90555357551625e-10, "Y", 0.3316042701941,
			 6.30373591155545, 0.732634588338446, 1.29452393617254, 1.01357926225549,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341753283786,
			 7.07106784335769, 4.72565884954309, 8.34997216277411, 6.5378155061586,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.924586712260823,
			 7.07106799120244))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.165693740655515, 0.204085227783945, 0.019195743564215,
			 0.0277923210519804, "W", "M", "<unicode>", 0.838752885723831,
			 0.0943331028927647, 0.203488944766676, 50, -0.161247618736304,
			 0.108820171629359, -0.0262137235534726, -0.0379532169998421,
			 "W", "M", "<unicode>", 0.703587723971046, 0.0688961104632338,
			 -0.380481907864182, 84, -0.278343666741386, 0.126798895705294,
			 -0.075772385518046, -0.109706115741086, "W", "M", "<unicode>",
			 0.463478953863378, 0.103354593666616, -0.733130312160674))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161055795969551, 0.108967705547084, -0.026044045211234, -0.0377075503004882,
			 "W", "<unicode>", 0.705370351467774, "M", 0.0688848120798509,
			 -0.378081095453143, -0.087890884229107, 0.604700988873177, 0.258405052322035,
			 0.247034065445924, "Y", "<unicode>", 0.143598876260223, "M",
			 0.176684846906719, 1.46251960395031, -0.182864249385561, 0.0896343910126624,
			 -0.0466149291864492, -0.067947544296776, "W:Y", "<unicode>",
			 0.502499757546065, "M", 0.0695162366624228, -0.670561748226037
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.165693740655515, 0.204085227783945, 0.019195743564215,
			 0.0277923210519804, "Total", "W", "M", "<unicode>", 0.838752885723831,
			 0.0943331028927647, 0.203488944766676, 50, -0.161247618736304,
			 0.108820171629359, -0.0262137235534726, -0.0379532169998421,
			 "Total", "W", "M", "<unicode>", 0.703587723971046, 0.0688961104632338,
			 -0.380481907864182, 84, -0.278343666741386, 0.126798895705294,
			 -0.075772385518046, -0.109706115741086, "Total", "W", "M", "<unicode>",
			 0.463478953863378, 0.103354593666616, -0.733130312160674))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(608.281967358097, 644.75434996193, 0, "Model 1", 100, -290.140983679048,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0922263538721806, 0.197773641622861, 0.144999997747521, "sm:medexperimental",
			 "<unicode>", 7.23782711542498e-08, "sm", 0.0269258232761479,
			 5.38516487538445, -0.00962232589632599, 0.0896223214078034,
			 0.0399999977557387, "medexperimental", "<unicode>", 0.114128634482363,
			 "sm", 0.025317977291154, 1.57990495432329, 0.180704807176402,
			 0.319295185614934, 0.249999996395668, "sm", "<unicode>", 1.53743684450092e-12,
			 "sm", 0.0353553380398097, 7.07106791382311, 0.758630464113866,
			 1.34045718397482, 1.04954382404434, "M", "<unicode>", 1.53743684450092e-12,
			 "M", 0.148427911035695, 7.07106781144378, 0.0922263529382155,
			 0.197773641233986, 0.144999997086101, "sm:medexperimental",
			 "<unicode>", 7.23782922484872e-08, "medexperimental", 0.0269258234152041,
			 5.38516482300868, 0.180704808401201, 0.319295189890202, 0.249999999145701,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553388180047, 7.07106783596679, 0.148828479355192, 0.262971515447246,
			 0.205899997401219, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186565142012, 7.07106790111698
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "s", "M", 0, "<unicode>", 0.0363780103764788, "m", 0.293546322885821,
			 2.0926768587866, 0, -0.258993824576918, 0.891686616757542, 0.316346396090312,
			 0.300393048770642, "s", "M", 1, "<unicode>", 0.281180548783797,
			 "m", 0.293546322894421, 1.07767112519441))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "sm", "<unicode>", 0.0363780103764788, "M", 0.293546322885821,
			 2.0926768587866, 0, -0.42756656705304, 0.723113874251726, 0.147773653599343,
			 0.140321428918731, "medexperimental", "<unicode>", 0.614677241563612,
			 "M", 0.293546322886846, 0.50340829394857, 0, -1.1116051438429,
			 0.515702742253405, -0.297951200794745, -0.282925523090377, "sm:medexperimental",
			 "<unicode>", 0.472931529520476, "M", 0.415137191022972, -0.717717437121305
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "Total", "s", "M", 0, "<unicode>", 0.0363780103764788, "m",
			 0.293546322885821, 2.0926768587866, 0, -0.258993824576918, 0.891686616757542,
			 0.316346396090312, 0.300393048770642, "Total", "s", "M", 1,
			 "<unicode>", 0.281180548783797, "m", 0.293546322894421, 1.07767112519441
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1837.46300634853, 1907.80260137021, 0, "Model 1", 100, -891.731503174267,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-1.19395389142269, 0.48152892055058, -0.356212485436053, "W:Z",
			 "<unicode>", 0.404625935253322, "W", 0.42742693875736, -0.833388008887915,
			 -0.403934289479784, 0.194627955591598, -0.104653166944093, "Z",
			 "<unicode>", 0.493114400989172, "W", 0.152697256121226, -0.685363768822469,
			 -1.36470935316382, 0.181025034468085, -0.591842159347869, "W:Y",
			 "<unicode>", 0.133383789358866, "W", 0.394327242700494, -1.50089087250153,
			 -0.544848207005167, 0.0642086648426673, -0.24031977108125, "Y",
			 "<unicode>", 0.121932462668327, "W", 0.1553745060246, -1.54671301766328,
			 1.68041089916111, 2.96919115731547, 2.32480102823829, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776515364592, 7.07106779101979,
			 0.770361909024812, 1.36118604158902, 1.06577397530691, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.150723211555046, 7.07106731810634,
			 0.97090108876452, 2.24037272186856, 1.60563690531654, "W:Z",
			 "<unicode>", 7.12396981850105e-07, "Y", 0.3238507551969, 4.95795325331362,
			 0.424979196493213, 0.896763162712112, 0.660871179602663, "Z",
			 "<unicode>", 3.99656379101998e-08, "Y", 0.120355264163084, 5.49100352359466,
			 1.44041333986376, 2.74027822811119, 2.09034578398748, "W:Y",
			 "<unicode>", 2.9055557959623e-10, "Y", 0.331604279083851, 6.30373585576953,
			 0.732634590413271, 1.29452394340955, 1.01357926691141, "Y",
			 "<unicode>", 1.53743684450092e-12, "Y", 0.143341754600693, 7.07106781087571,
			 3.9011735208987, 7.48120855935845, 5.69119104012858, "W:Z",
			 "<unicode>", 4.61931826123418e-10, "W:Y", 0.913291026441967,
			 6.23151971863835, 1.02432138651747, 2.20944858801231, 1.61688498726489,
			 "Z", "<unicode>", 8.89263214176594e-08, "W:Y", 0.30233392318506,
			 5.34801047210037, 4.72565889676504, 8.34997232748297, 6.53781561212401,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.924586742232525,
			 7.07106787659281, 1.62861555176371, 3.05704964127475, 2.34283259651923,
			 "W:Z", "<unicode>", 1.28249855180229e-10, "Z", 0.364403147399224,
			 6.42923260471329, 0.721541862146438, 1.27492378914134, 0.998232825643887,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171452985847,
			 7.07106716358558, 5.64080143478928, 9.96697781939227, 7.80388962709078,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 1.10363670422705,
			 7.07106749639717))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175157162119448, 0.198980034236542, 0.0119114360585467,
			 0.0172458256508299, "W", "M", "<unicode>", 0.900682629593827,
			 0.0954449161584438, 0.124799062516573, 50, 16, -0.250367557096525,
			 0.256906008537089, 0.00326922572028214, 0.00473330810055774,
			 "W", "M", "<unicode>", 0.979845379239081, 0.129408899764211,
			 0.0252627580192616, 84, 16, -0.477660966411211, 0.465335669476539,
			 -0.00616264846733562, -0.00892251450560961, "W", "M", "<unicode>",
			 0.979562493838243, 0.240564786732304, -0.0256174170419767, 16,
			 50, -0.285600509736188, 0.255933293948127, -0.0148336078940304,
			 -0.0214766560686583, "W", "M", "<unicode>", 0.914492245326939,
			 0.138148917009666, -0.10737404400349, 50, 50, -0.158318868738093,
			 0.111367232273503, -0.023475818232295, -0.0339891736189305,
			 "W", "M", "<unicode>", 0.732934548448976, 0.0687987389408289,
			 -0.341224542683632, 84, 50, -0.322691215926178, 0.256875831086353,
			 -0.0329076924199127, -0.0476449962250978, "W", "M", "<unicode>",
			 0.823868110668377, 0.147851453287938, -0.222572667959005, 16,
			 84, -0.537941498831445, 0.445575689755522, -0.0461829045379612,
			 -0.0668653482078781, "W", "M", "<unicode>", 0.853960415058156,
			 0.250901852366887, -0.184067610909581, 50, 84, -0.350939597410702,
			 0.241289367658251, -0.0548251148762257, -0.0793778657581502,
			 "W", "M", "<unicode>", 0.716691431597992, 0.15108159377937,
			 -0.362884144287548, 84, 84, -0.27737215973635, 0.148858181608663,
			 -0.0642569890638435, -0.0930336883643176, "W", "M", "<unicode>",
			 0.554550859992439, 0.108734227951907, -0.590954571289772))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.157312131826207, 0.112101903676919, -0.0226051140746439, -0.0327285353531079,
			 "W", "<unicode>", 0.74223087415126, "M", 0.0687293331990358,
			 -0.328900529402503, -0.219434319615661, 0.758255143277842, 0.269410411831091,
			 0.257555131942984, "Y", "<unicode>", 0.280067130963419, "M",
			 0.249415160330851, 1.08016854899163, -0.250026030231082, 0.232282768814316,
			 -0.00887163070838336, -0.0129315976058156, "W:Y", "<unicode>",
			 0.942519539472918, "M", 0.123040219833065, -0.0721035017689331,
			 -0.585977078647244, 0.452208126129091, -0.0668844762590762,
			 -0.0634553475485147, "Z", "<unicode>", 0.800624416685612, "M",
			 0.264848031128482, -0.252539072969848, -0.259036967059406, 0.202955935496024,
			 -0.0280405157816912, -0.0405622267791334, "W:Z", "<unicode>",
			 0.811944065291223, "M", 0.11785749794373, -0.237918811029561
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175157162119448, 0.198980034236542, 0.0119114360585467,
			 0.0172458256508299, "Total", "W", "M", "<unicode>", 0.900682629593827,
			 0.0954449161584438, 0.124799062516573, 50, 16, -0.250367557096525,
			 0.256906008537089, 0.00326922572028214, 0.00473330810055774,
			 "Total", "W", "M", "<unicode>", 0.979845379239081, 0.129408899764211,
			 0.0252627580192616, 84, 16, -0.477660966411211, 0.465335669476539,
			 -0.00616264846733562, -0.00892251450560961, "Total", "W", "M",
			 "<unicode>", 0.979562493838243, 0.240564786732304, -0.0256174170419767,
			 16, 50, -0.285600509736188, 0.255933293948127, -0.0148336078940304,
			 -0.0214766560686583, "Total", "W", "M", "<unicode>", 0.914492245326939,
			 0.138148917009666, -0.10737404400349, 50, 50, -0.158318868738093,
			 0.111367232273503, -0.023475818232295, -0.0339891736189305,
			 "Total", "W", "M", "<unicode>", 0.732934548448976, 0.0687987389408289,
			 -0.341224542683632, 84, 50, -0.322691215926178, 0.256875831086353,
			 -0.0329076924199127, -0.0476449962250978, "Total", "W", "M",
			 "<unicode>", 0.823868110668377, 0.147851453287938, -0.222572667959005,
			 16, 84, -0.537941498831445, 0.445575689755522, -0.0461829045379612,
			 -0.0668653482078781, "Total", "W", "M", "<unicode>", 0.853960415058156,
			 0.250901852366887, -0.184067610909581, 50, 84, -0.350939597410702,
			 0.241289367658251, -0.0548251148762257, -0.0793778657581502,
			 "Total", "W", "M", "<unicode>", 0.716691431597992, 0.15108159377937,
			 -0.362884144287548, 84, 84, -0.27737215973635, 0.148858181608663,
			 -0.0642569890638435, -0.0930336883643176, "Total", "W", "M",
			 "<unicode>", 0.554550859992439, 0.108734227951907, -0.590954571289772
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1050.43314292912, 1120.7727379508, 0, "Model 1", 100, -498.21657146456,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0802724497517619, 0.0505906962870957, -0.0148408767323331,
			 "sm:Z", "<unicode>", 0.656645229598872, "sm", 0.0333840690622607,
			 -0.444549665430392, -0.163250745183943, 0.034199168913581, -0.0645257881351808,
			 "Z", "<unicode>", 0.200188148556023, "sm", 0.0503708016205867,
			 -1.28101570868804, 0.0922263567582703, 0.197773653213661, 0.145000004985966,
			 "sm:medexperimental", "<unicode>", 7.23783417644341e-08, "sm",
			 0.0269258254967782, 5.38516470008749, -0.00962232478005574,
			 0.0896223270306973, 0.0400000011253208, "medexperimental", "<unicode>",
			 0.114128620430924, "sm", 0.025317978440824, 1.5799050156715,
			 0.180704810184224, 0.319295196109283, 0.250000003146754, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553399496732,
			 7.07106772279995, 0.756348936486646, 1.33642585351419, 1.04638739500042,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.14798152455941,
			 7.07106781144378, -0.132931063274448, 0.000359825343500778,
			 -0.0662856189654738, "sm:Z", "<unicode>", 0.0512498290366865,
			 "medexperimental", 0.0340034025291614, -1.9493819451929, -0.170527224808512,
			 0.027297854415408, -0.0716146851965522, "Z", "<unicode>", 0.155883365472337,
			 "medexperimental", 0.050466508768615, -1.4190536841948, 0.0922263558399976,
			 0.197773651732733, 0.145000003786366, "sm:medexperimental",
			 "<unicode>", 7.23783482037277e-08, "medexperimental", 0.026925825353241,
			 5.38516468424289, 0.180704810100677, 0.319295195817876, 0.250000002959276,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553398966465, 7.07106772810262, -0.133519805300059, -0.0115177692388515,
			 -0.0725187872694555, "sm:Z", "<unicode>", 0.0198045576064083,
			 "sm:medexperimental", 0.0311235402853176, -2.33003015096152,
			 -0.192385830232627, -0.0102862416090631, -0.101336035920845,
			 "Z", "<unicode>", 0.0291546882202969, "sm:medexperimental",
			 0.0464548303080929, -2.18138857140957, 0.148828483793808, 0.262971530928887,
			 0.205900007361347, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186593313511, 7.07106755906381,
			 0.290493138829685, 0.605240620148156, 0.447866879488921, "sm:Z",
			 "<unicode>", 2.43546536271566e-08, "Z", 0.0802942002509126,
			 5.5778235300853, 0.721541819353743, 1.27492363988268, 0.998232729618212,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171425825664,
			 7.07106784379265, 0.321594861453973, 0.568239956814311, 0.444917409134142,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0629208233686547,
			 7.07106781688726))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.161065462178253, 1.33098043661391, 0.584957487217831,
			 0.555458083617865, "s", "M", 0, "<unicode>", 0.124339818085183,
			 "m", 0.380630947956502, 1.53681010532196, 0, 16, -0.358875044012759,
			 1.00789206257014, 0.32450850927869, 0.308143546531798, "s",
			 "M", 1, "<unicode>", 0.352008831927596, "m", 0.348671485130284,
			 0.930699879737613, 0, 50, 0.0267424852053748, 1.18684632301203,
			 0.606794404108703, 0.576193764882527, "s", "M", 0, "<unicode>",
			 0.0403326883237147, "m", 0.295950294739446, 2.05032539211668,
			 0, 50, -0.23834961544646, 0.931040467785585, 0.346345426169562,
			 0.32887922779646, "s", "M", 1, "<unicode>", 0.245646338190441,
			 "m", 0.298319278429615, 1.16098908522695, 0, 84, -0.0593588649020024,
			 1.32414010986505, 0.632390622481523, 0.600499166071342, "s",
			 "M", 0, "<unicode>", 0.0731682258577115, "m", 0.352939897283806,
			 1.79177992442437, 0, 84, -0.399560650463074, 1.14344393954784,
			 0.371941644542382, 0.353184628985275, "s", "M", 1, "<unicode>",
			 0.344710124056659, "m", 0.393630852960038, 0.944899622947346
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0242260928890965, 1.18799361527581, 0.606109854082454, 0.575543736711198,
			 "sm", "<unicode>", 0.0411947062626221, "M", 0.296884925326783,
			 2.04156493771216, 0, -0.42773484444062, 0.721274257587655, 0.146769706573517,
			 0.139368110893371, "medexperimental", "<unicode>", 0.616571355513221,
			 "M", 0.29311995299187, 0.500715509385976, 0, -1.08932599518802,
			 0.568428039309736, -0.260448977939141, -0.247314537086067, "sm:medexperimental",
			 "<unicode>", 0.537988184214992, "M", 0.422904208335946, -0.615858089859078,
			 -0.226807989824383, 0.320133541187586, 0.0466627756816015, 0.0442704012906359,
			 "Z", "<unicode>", 0.738053637806822, "M", 0.13952846463664,
			 0.334431944070486, 0, -0.39268563820737, 0.438474937622074,
			 0.022894649707352, 0.0217208538315187, "sm:Z", "<unicode>",
			 0.914014745959561, "M", 0.212034655326713, 0.107975980021166
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.161065462178253, 1.33098043661391, 0.584957487217831,
			 0.555458083617865, "Total", "s", "M", 0, "<unicode>", 0.124339818085183,
			 "m", 0.380630947956502, 1.53681010532196, 0, 16, -0.358875044012759,
			 1.00789206257014, 0.32450850927869, 0.308143546531798, "Total",
			 "s", "M", 1, "<unicode>", 0.352008831927596, "m", 0.348671485130284,
			 0.930699879737613, 0, 50, 0.0267424852053748, 1.18684632301203,
			 0.606794404108703, 0.576193764882527, "Total", "s", "M", 0,
			 "<unicode>", 0.0403326883237147, "m", 0.295950294739446, 2.05032539211668,
			 0, 50, -0.23834961544646, 0.931040467785585, 0.346345426169562,
			 0.32887922779646, "Total", "s", "M", 1, "<unicode>", 0.245646338190441,
			 "m", 0.298319278429615, 1.16098908522695, 0, 84, -0.0593588649020024,
			 1.32414010986505, 0.632390622481523, 0.600499166071342, "Total",
			 "s", "M", 0, "<unicode>", 0.0731682258577115, "m", 0.352939897283806,
			 1.79177992442437, 0, 84, -0.399560650463074, 1.14344393954784,
			 0.371941644542382, 0.353184628985275, "Total", "s", "M", 1,
			 "<unicode>", 0.344710124056659, "m", 0.393630852960038, 0.944899622947346
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "Y",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(2490.08046840291, 2604.70795658639, 0, "Model 1", 100, -1201.04023420146,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.058756261459876, 0.571980961791781, 0.256612350165953, "Y:Z",
			 "<unicode>", 0.110756185064392, "W", 0.160905309543143, 1.59480349588556,
			 1.37708908286603, 3.45910610609037, 2.4180975944782, "W:Y:Z",
			 "<unicode>", 5.29654618230957e-06, "W", 0.531136551397636, 4.55268534638635,
			 -1.19395388272959, 0.481528860447865, -0.356212511140863, "W:Z",
			 "<unicode>", 0.404625882054666, "W", 0.427426921207086, -0.833388103245561,
			 -0.403934273686011, 0.194627916546013, -0.104653178569999, "Z",
			 "<unicode>", 0.493114313342857, "W", 0.152697242131337, -0.685363907751428,
			 -1.3647093580101, 0.181025069036634, -0.591842144486733, "W:Y",
			 "<unicode>", 0.133383809008553, "W", 0.394327252755482, -1.50089079654286,
			 -0.544848181829487, 0.0642086875879516, -0.240319747120768,
			 "Y", "<unicode>", 0.121932498381682, "W", 0.155374505404589,
			 -1.54671286962416, 1.6804108995111, 2.96919115853624, 2.32480102902367,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776515586732,
			 7.07106778863097, 0.7609539205603, 1.3445626012435, 1.0527582609019,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.148882501231307,
			 7.07106780310143, 0.0176094245587382, 0.438350094270136, 0.227979759414437,
			 "Y:Z", "<unicode>", 0.0336679469545318, "Y", 0.107333775781123,
			 2.12402626997244, -0.374371886996541, 0.853225640168302, 0.239426876585881,
			 "W:Y:Z", "<unicode>", 0.444550993985574, "Y", 0.313168389023466,
			 0.764530792307842, 0.970901045262218, 2.2403726071884, 1.60563682622531,
			 "W:Z", "<unicode>", 7.1239685817126e-07, "Y", 0.323850737038948,
			 4.95795328707931, 0.424979177787254, 0.896763094702095, 0.660871136244674,
			 "Z", "<unicode>", 3.99655897265205e-08, "Y", 0.120355251585287,
			 5.49100373718517, 1.44041333623003, 2.74027825056593, 2.09034579339798,
			 "W:Y", "<unicode>", 2.90555801640835e-10, "Y", 0.331604285739193,
			 6.30373575763143, 0.732634590621657, 1.29452394413622, 1.01357926737894,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341754732913,
			 7.07106780761496, -0.11570679096557, 0.940930753944743, 0.412611981489586,
			 "Y:Z", "<unicode>", 0.12584024107367, "W:Y", 0.269555347252535,
			 1.53071339780556, -0.371146654786418, 2.7729342184286, 1.20089378182109,
			 "W:Y:Z", "<unicode>", 0.134333015002496, "W:Y", 0.802076185586861,
			 1.49723156403456, 3.90117350592687, 7.48120848895758, 5.69119099744223,
			 "W:Z", "<unicode>", 4.61931604078814e-10, "W:Y", 0.913291012301647,
			 6.2315197683808, 1.02432134764329, 2.20944845728703, 1.61688490246516,
			 "Z", "<unicode>", 8.89262556924564e-08, "W:Y", 0.302333899753227,
			 5.34801060610439, 4.72565897515685, 8.3499726009077, 6.53781578803227,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.924586791986733,
			 7.07106768633797, 0.0200790711902491, 0.437849923163758, 0.228964497177003,
			 "Y:Z", "<unicode>", 0.0316847595359591, "Z", 0.106576155293881,
			 2.14836514364437, -0.164891349412064, 1.06248507486388, 0.448796862725909,
			 "W:Y:Z", "<unicode>", 0.151759846473871, "Z", 0.313111984188825,
			 1.43334297436299, 1.62861545830457, 3.05704933232158, 2.34283239531308,
			 "W:Z", "<unicode>", 1.28249411091019e-10, "Z", 0.364403092425247,
			 6.42923302247684, 0.721541820580846, 1.27492364416269, 0.998232732371767,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.14117142660448,
			 7.07106782428794, -0.0437856763571529, 1.11623611119578, 0.536225217419313,
			 "Y:Z", "<unicode>", 0.0699855640128657, "W:Z", 0.295929363167649,
			 1.8120040934077, 0.401630762383616, 3.90109290414095, 2.15136183326228,
			 "W:Y:Z", "<unicode>", 0.0159590231769888, "W:Z", 0.892736338361481,
			 2.40985130863035, 5.64080128630988, 9.9669773015026, 7.80388929390624,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 1.103636609988,
			 7.07106779829557, 1.70114282137157, 3.30309568271392, 2.50211925204274,
			 "Y:Z", "<unicode>", 9.2056762213133e-10, "W:Y:Z", 0.408668953607912,
			 6.12260664763721, 6.95315459373132, 12.2858314978805, 9.61949304580591,
			 "W:Y:Z", "<unicode>", 1.53743684450092e-12, "W:Y:Z", 1.3604017589641,
			 7.07106778010255, 0.784505376755058, 1.38617669274422, 1.08534103474964,
			 "Y:Z", "<unicode>", 1.53743684450092e-12, "Y:Z", 0.153490401031617,
			 7.07106781567449))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220183009804512, 0.191149616695446, -0.0145166965545329,
			 -0.0210178205871115, "W", "M", "<unicode>", 0.889970466507288,
			 0.10493372065622, -0.138341578510229, 50, 16, -0.253451178241105,
			 0.257888072927508, 0.00221844734320106, 0.00321195170445267,
			 "W", "M", "<unicode>", 0.986431332273551, 0.130446083500001,
			 0.0170066228412373, 84, 16, -0.480404930727425, 0.521370390578744,
			 0.0204827299256593, 0.029655668636081, "W", "M", "<unicode>",
			 0.936119120324807, 0.255559624872713, 0.0801485365141742, 16,
			 50, -0.338190153291592, 0.282578069889074, -0.0278060417012589,
			 -0.0402586355318085, "W", "M", "<unicode>", 0.860619870952519,
			 0.158362150548991, -0.175585148375822, 50, 50, -0.212793596062429,
			 0.16154047218914, -0.0256265619366448, -0.0371031025568083,
			 "W", "M", "<unicode>", 0.788426366238054, 0.0954951395036513,
			 -0.268354620662813, 84, 50, -0.330684916659169, 0.284189043102568,
			 -0.0232479367783004, -0.0336592393724903, "W", "M", "<unicode>",
			 0.882177337852129, 0.156858484291493, -0.148209622726548, 16,
			 84, -0.687596833680705, 0.60083044565659, -0.0433831940120575,
			 -0.0628118239446531, "W", "M", "<unicode>", 0.894992521233756,
			 0.328686468093354, -0.131989595628061, 50, 84, -0.434125866745729,
			 0.317595493187249, -0.0582651867792403, -0.0843585341610122,
			 "W", "M", "<unicode>", 0.761257577559741, 0.191769176847753,
			 -0.303829779826908, 84, 84, -0.289302212452234, 0.140288231587965,
			 -0.0745069904321345, -0.107874029845947, "W", "M", "<unicode>",
			 0.496592114078181, 0.109591412757773, -0.679861574526966))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.209965760360974, 0.160438725570339, -0.0247635173953173, -0.035853554130955,
			 "W", "<unicode>", 0.793268930440038, "M", 0.0944926766137072,
			 -0.262068112395126, -0.264231136646215, 0.718915906229822, 0.227342384791804,
			 0.217338296009512, "Y", "<unicode>", 0.364701950430575, "M",
			 0.250807425705517, 0.906442000878935, -0.238546065373657, 0.243957556453444,
			 0.00270574553989365, 0.00394398897463009, "W:Y", "<unicode>",
			 0.982462424748507, "M", 0.123089920435536, 0.0219818611493107,
			 -0.628303716883604, 0.464182037778917, -0.0820608395523433,
			 -0.0778536263080578, "Z", "<unicode>", 0.768420953764523, "M",
			 0.278700466763652, -0.294440983559363, -0.276762977253281, 0.218489502395332,
			 -0.0291367374289743, -0.0421479741646843, "W:Z", "<unicode>",
			 0.817611934541444, "M", 0.126342239846013, -0.230617546946188,
			 -0.168390700471225, 0.137059046122693, -0.0156658271742658,
			 -0.022814868780085, "W:Y:Z", "<unicode>", 0.840663976741677,
			 "M", 0.0779222855632213, -0.201044246341511, -0.234142222930411,
			 0.527680796542467, 0.146769286806028, 0.140186739027765, "Y:Z",
			 "<unicode>", 0.45013191177204, "M", 0.194346178165018, 0.755195127538898
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220183009804512, 0.191149616695446, -0.0145166965545329,
			 -0.0210178205871115, "Total", "W", "M", "<unicode>", 0.889970466507288,
			 0.10493372065622, -0.138341578510229, 50, 16, -0.253451178241105,
			 0.257888072927508, 0.00221844734320106, 0.00321195170445267,
			 "Total", "W", "M", "<unicode>", 0.986431332273551, 0.130446083500001,
			 0.0170066228412373, 84, 16, -0.480404930727425, 0.521370390578744,
			 0.0204827299256593, 0.029655668636081, "Total", "W", "M", "<unicode>",
			 0.936119120324807, 0.255559624872713, 0.0801485365141742, 16,
			 50, -0.338190153291592, 0.282578069889074, -0.0278060417012589,
			 -0.0402586355318085, "Total", "W", "M", "<unicode>", 0.860619870952519,
			 0.158362150548991, -0.175585148375822, 50, 50, -0.212793596062429,
			 0.16154047218914, -0.0256265619366448, -0.0371031025568083,
			 "Total", "W", "M", "<unicode>", 0.788426366238054, 0.0954951395036513,
			 -0.268354620662813, 84, 50, -0.330684916659169, 0.284189043102568,
			 -0.0232479367783004, -0.0336592393724903, "Total", "W", "M",
			 "<unicode>", 0.882177337852129, 0.156858484291493, -0.148209622726548,
			 16, 84, -0.687596833680705, 0.60083044565659, -0.0433831940120575,
			 -0.0628118239446531, "Total", "W", "M", "<unicode>", 0.894992521233756,
			 0.328686468093354, -0.131989595628061, 50, 84, -0.434125866745729,
			 0.317595493187249, -0.0582651867792403, -0.0843585341610122,
			 "Total", "W", "M", "<unicode>", 0.761257577559741, 0.191769176847753,
			 -0.303829779826908, 84, 84, -0.289302212452234, 0.140288231587965,
			 -0.0745069904321345, -0.107874029845947, "Total", "W", "M",
			 "<unicode>", 0.496592114078181, 0.109591412757773, -0.679861574526966
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "med",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1189.15287476073, 1303.7803629442, 0, "Model 1", 100, -550.576437380364,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.128998455426997, 0.00351611356103049, -0.0627411709329834,
			 "medexperimental:Z", "<unicode>", 0.0634601941938917, "sm",
			 0.0338053581681311, -1.85595344444925, -0.0927522831482912,
			 0.0116257804872849, -0.0405632513305032, "sm:medexperimental:Z",
			 "<unicode>", 0.127669486783073, "sm", 0.0266275463373044, -1.52335670799961,
			 -0.0802724489881538, 0.0505906993697664, -0.0148408748091937,
			 "sm:Z", "<unicode>", 0.656645276931968, "sm", 0.0333840696538692,
			 -0.444549599945904, -0.16325074320067, 0.0341991729754812, -0.0645257851125946,
			 "Z", "<unicode>", 0.20018817436934, "sm", 0.0503708021508587,
			 -1.28101563519561, 0.0922263540377829, 0.197773646114886, 0.145000000076335,
			 "sm:medexperimental", "<unicode>", 7.23783253331334e-08, "sm",
			 0.0269258243798475, 5.3851647411345, -0.00962232880782866, 0.0896223239188219,
			 0.0399999975554966, "medexperimental", "<unicode>", 0.114128656065593,
			 "sm", 0.0253179786744756, 1.57990486009149, 0.180704809437853,
			 0.319295193505983, 0.250000001471918, "sm", "<unicode>", 1.53743684450092e-12,
			 "sm", 0.0353553394759581, 7.07106777017145, 0.719380656934463,
			 1.27110499138534, 0.995242824159901, "M", "<unicode>", 1.53743684450092e-12,
			 "M", 0.140748589974817, 7.07106781203256, -0.0835911066654469,
			 0.0468204810302419, -0.0183853128176025, "medexperimental:Z",
			 "<unicode>", 0.580518127776503, "medexperimental", 0.033268873490625,
			 -0.552628054051285, -0.092752271472186, 0.0116257934147006,
			 -0.0405632390287427, "sm:medexperimental:Z", "<unicode>", 0.127669606870589,
			 "medexperimental", 0.0266275466565221, -1.52335622774347, -0.132931059526368,
			 0.000359834003657522, -0.0662856127613553, "sm:Z", "<unicode>",
			 0.0512498593825135, "medexperimental", 0.0340034037822652, -1.94938169089787,
			 -0.170527225378453, 0.0272978611953512, -0.071614682091551,
			 "Z", "<unicode>", 0.155883398778078, "medexperimental", 0.0504665106436199,
			 -1.41905356994609, 0.0922263561477284, 0.197773651888628, 0.145000004018178,
			 "sm:medexperimental", "<unicode>", 7.23783415423895e-08, "medexperimental",
			 0.0269258253145067, 5.38516470059908, 0.180704812410606, 0.319295203874776,
			 0.250000008142691, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.0353553413627376, 7.07106758149351, -0.131140956868213,
			 -0.00978504900354775, -0.0704630029358803, "medexperimental:Z",
			 "<unicode>", 0.0228441110351592, "sm:medexperimental", 0.0309587086349303,
			 -2.27603172234315, -0.105751943294947, -0.00944767693629799,
			 -0.0575998101156223, "sm:medexperimental:Z", "<unicode>", 0.0190516798945521,
			 "sm:medexperimental", 0.0245678663277194, -2.3445182152686,
			 -0.133519802842324, -0.0115177670970185, -0.0725187849696715,
			 "sm:Z", "<unicode>", 0.0198045611927022, "sm:medexperimental",
			 0.0311235402047289, -2.3300300831026, -0.19238583291392, -0.0102862446828309,
			 -0.101336038798376, "Z", "<unicode>", 0.0291546832951894, "sm:medexperimental",
			 0.0464548302079701, -2.18138863805361, 0.148828481585606, 0.262971523226802,
			 0.205900002406204, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186579298245, 7.07106772923462,
			 0.288630007066604, 0.601949211685144, 0.445289609375874, "medexperimental:Z",
			 "<unicode>", 2.53272487427125e-08, "Z", 0.0799298372546544,
			 5.57100608071042, 0.171631379703829, 0.406896647687159, 0.289264013695494,
			 "sm:medexperimental:Z", "<unicode>", 1.43816883135806e-06, "Z",
			 0.0600177528360402, 4.81964085669321, 0.290493137782409, 0.605240630706386,
			 0.447866884244398, "sm:Z", "<unicode>", 2.43546740552603e-08,
			 "Z", 0.0802942032115551, 5.57782338364303, 0.721541827790508,
			 1.27492366930965, 0.998232748550081, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.141171431180407, 7.07106770968702, 0.17951507670834,
			 0.385523043685595, 0.282519060196968, "medexperimental:Z", "<unicode>",
			 7.62500909079478e-08, "sm:Z", 0.0525540184927427, 5.37578416074845,
			 0.193041177663049, 0.369363819943787, 0.281202498803418, "sm:medexperimental:Z",
			 "<unicode>", 4.06343847458857e-10, "sm:Z", 0.0449810924260721,
			 6.25157112992717, 0.321594866404612, 0.568239974081873, 0.444917420243242,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0629208265107843,
			 7.07106764033027, 0.192750731678976, 0.368504068374593, 0.280627400026785,
			 "medexperimental:Z", "<unicode>", 3.87467169460365e-10, "sm:medexperimental:Z",
			 0.0448358587407567, 6.25899465089733, 0.200241865838288, 0.353816072185426,
			 0.277028969011857, "sm:medexperimental:Z", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental:Z", 0.0391778133574168, 7.07106765976289,
			 0.319034385178944, 0.563715744866289, 0.441375065022616, "medexperimental:Z",
			 "<unicode>", 1.53743684450092e-12, "medexperimental:Z", 0.0624198611855525,
			 7.07106771209506))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.879096135774682, 0.89332247564239, 0.00711316993385358,
			 0.00675445278155882, "s", "M", 0, "<unicode>", 0.987448457028864,
			 "m", 0.45215591342435, 0.0157316751206079, 0, 16, -0.226236100936548,
			 1.45144461325701, 0.61260425616023, 0.581710624165359, "s",
			 "M", 1, "<unicode>", 0.152327153100168, "m", 0.427987638402258,
			 1.43135969638556, 0, 50, -0.0706048608402873, 1.07522417215346,
			 0.502309655656585, 0.476978180249294, "s", "M", 0, "<unicode>",
			 0.0857196942759413, "m", 0.292308695984186, 1.7184218689264,
			 0, 50, -0.2953099389912, 0.864575094383991, 0.284632577696396,
			 0.270278557102056, "s", "M", 1, "<unicode>", 0.336080006942509,
			 "m", 0.295894476256762, 0.961939476860684, 0, 84, 0.299944751960184,
			 1.86556713858975, 1.08275594527497, 1.02815256409174, "s", "M",
			 0, "<unicode>", 0.00670905737161731, "m", 0.39940080506045,
			 2.71095083323904, 0, 84, -1.01442802681335, 0.814826886289663,
			 -0.0998005702618414, -0.0947676276083364, "s", "M", 1, "<unicode>",
			 0.83065342406293, "m", 0.466655236405347, -0.213863603097239
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, -0.0900823230784404, 1.06365450727249, 0.486786092097024, 0.462237469983741,
			 "sm", "<unicode>", 0.0981476435529907, "M", 0.29432602829732,
			 1.65390093058737, 0, -0.45671063003918, 0.690161425614402, 0.116725397787611,
			 0.110838936099754, "medexperimental", "<unicode>", 0.689923271431653,
			 "M", 0.292574778082649, 0.398959194475189, 0, -1.01011707327836,
			 0.626372747739981, -0.191872162769187, -0.18219604980222, "sm:medexperimental",
			 "<unicode>", 0.64580584406829, "M", 0.417479564401887, -0.459596538681068,
			 -0.308134865872421, 0.319885281065385, 0.00587520759648162,
			 0.00557398902562851, "Z", "<unicode>", 0.970746996839309, "M",
			 0.160212165093734, 0.0366714200076147, 0, -0.0759541812938296,
			 1.11431963678289, 0.519182727744529, 0.492564522907567, "sm:Z",
			 "<unicode>", 0.0872983994995475, "M", 0.303646859703914, 1.70982413007921,
			 0, -1.7325379166461, 0.00645663296699694, -0.863040641839553,
			 -0.818793036209628, "sm:medexperimental:Z", "<unicode>", 0.0517256684947216,
			 "M", 0.443629210365616, -1.94540986408059, 0, -0.448506068282122,
			 0.741301251590506, 0.146397591654192, 0.138891869922619, "medexperimental:Z",
			 "<unicode>", 0.629578553656749, "M", 0.303527852873235, 0.482320124062332
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.879096135774682, 0.89332247564239, 0.00711316993385358,
			 0.00675445278155882, "Total", "s", "M", 0, "<unicode>", 0.987448457028864,
			 "m", 0.45215591342435, 0.0157316751206079, 0, 16, -0.226236100936548,
			 1.45144461325701, 0.61260425616023, 0.581710624165359, "Total",
			 "s", "M", 1, "<unicode>", 0.152327153100168, "m", 0.427987638402258,
			 1.43135969638556, 0, 50, -0.0706048608402873, 1.07522417215346,
			 0.502309655656585, 0.476978180249294, "Total", "s", "M", 0,
			 "<unicode>", 0.0857196942759413, "m", 0.292308695984186, 1.7184218689264,
			 0, 50, -0.2953099389912, 0.864575094383991, 0.284632577696396,
			 0.270278557102056, "Total", "s", "M", 1, "<unicode>", 0.336080006942509,
			 "m", 0.295894476256762, 0.961939476860684, 0, 84, 0.299944751960184,
			 1.86556713858975, 1.08275594527497, 1.02815256409174, "Total",
			 "s", "M", 0, "<unicode>", 0.00670905737161731, "m", 0.39940080506045,
			 2.71095083323904, 0, 84, -1.01442802681335, 0.814826886289663,
			 -0.0998005702618414, -0.0947676276083364, "Total", "s", "M",
			 1, "<unicode>", 0.83065342406293, "m", 0.466655236405347, -0.213863603097239
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(459.709342975141, 483.155874649034, 0, "Model 1", 100, -220.854671487571,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089500486, 2.96919114281872, 2.32480101891179, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512726659, 7.07106781938708,
			 0.79850843700121, 1.41091930982898, 1.1047138734151, "M", "<unicode>",
			 1.53743684450092e-12, "M", 0.156230134241852, 7.07106781144378,
			 0.00468047959390449, 0.00827014307736615, 0.00647531133563532,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000915747307546586,
			 7.07106783964627))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, -0.0626308455874648,
			 "W", "M", "", "<unicode>", "", 0.536343446165773, 0.0699572528327317,
			 -0.618351825661737, 0, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, 0.00343046661545098, "W", "jasp", "M",
			 "<unicode>", "<unicode>", 0.843493105517029, 0.0120012348671278,
			 0.197427379485498))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.180371891016916, 0.0938555010021174, -0.0432581950073993, -0.0626308455874648,
			 "W", "<unicode>", 0.536343446165773, "M", 0.0699572528327317,
			 -0.618351825661737, 0, -2.81958314086857, 2.30044871074282,
			 -0.259567215062877, -0.246477241583621, "jasp", "<unicode>",
			 0.842476880392771, "M", 1.30615457528749, -0.198726261021399,
			 -0.0194720937763586, 0.00121576390948324, -0.00912816493343769,
			 -0.170429711412506, "W", "<unicode>", 0.0837015035455533, "jasp",
			 0.00527761169312933, -1.72960146827801))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023198584645, 0.0942455532706607, -0.0408888226569923, -0.0592003789720138,
			 "Total", "W", "M", "<unicode>", 0.553151760947466, 0.0689473770914036,
			 -0.593043918157843, -0.0211526157591698, 0.0258913604599839,
			 0.00236937235040704, 0.00343046661545098, "Total indirect",
			 "W", "M", "<unicode>", 0.843493105517029, 0.0120012348671278,
			 0.197427379485498))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(234.766135212086, 258.212666885979, 0, "Model 1", 100, -108.383067606043,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704810207797, 0.319295196191503, 0.25000000319965, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553399646345,
			 7.07106772130382, 0.762533966062566, 1.34735445145525, 1.05494420875891,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.149191640766277,
			 7.07106781144378, 0.0048066281871781, 0.00849304083605079, 0.00664983451161445,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000940428670616055,
			 7.07106739659296))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0622024991965639, 0.868598726146002, 0.465400612671283, 0.441930461562619,
			 "s", "M", "", "<unicode>", "", 0.0236768306591097, "m", 0.205717103301435,
			 2.26233310309321, 0, -0.0219205602251843, 0.0213787048213383,
			 -0.000270927701922977, -0.000257264818956068, "s", "jasp", "M",
			 "<unicode>", "<unicode>", 0.980431952510507, "m", 0.0110459338508416,
			 -0.0245273695806476))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0622024991965639, 0.868598726146002, 0.465400612671283, 0.441930461562619,
			 "sm", "<unicode>", 0.0236768306591097, "M", 0.205717103301435,
			 2.26233310309321, 0, -2.43771284938872, 2.49956339312939, 0.0309252718703352,
			 0.0293657105287477, "jasp", "<unicode>", 0.980411525583682,
			 "M", 1.25953238974357, 0.0245529786468067, 0, -0.0407263692122695,
			 0.0232049257107259, -0.0087607217507718, -0.107277540846067,
			 "sm", "<unicode>", 0.591156408942288, "jasp", 0.0163093034941655,
			 -0.537160998561702))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0625107998260226, 0.867748570112698, 0.46512968496936, 0.441673196743663,
			 "Total", "s", "M", "<unicode>", 0.0235575795563017, "m", 0.205421573212132,
			 2.26426892607348, 0, -0.0219205602251843, 0.0213787048213383,
			 -0.000270927701922977, -0.000257264818956068, "Total indirect",
			 "s", "M", "<unicode>", 0.980431952510507, "m", 0.0110459338508416,
			 -0.0245273695806476))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1632.07305708222, 1723.2540135918, 0, "Model 1", 100, -781.036528541108,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-1.19395393375284, 0.48152882031157, -0.356212556720635, "W:Z",
			 "<unicode>", 0.404625824985688, "W", 0.427426923984421, -0.833388204467947,
			 -0.403934283027048, 0.194627913037681, -0.104653184994683, "Z",
			 "<unicode>", 0.493114291012462, "W", 0.152697243619299, -0.68536394314754,
			 -1.36470946580472, 0.181024960241772, -0.591842252781475, "W:Y",
			 "<unicode>", 0.133383737713083, "W", 0.394327252500314, -1.50089107214573,
			 -0.544848241964211, 0.0642086396410309, -0.24031980116159, "Y",
			 "<unicode>", 0.121932421941795, "W", 0.15537450851378, -1.54671318648307,
			 1.68041090411616, 2.96919117459841, 2.32480103935729, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.32877651850952, 7.07106775720046,
			 0.770087770257876, 1.36070160450225, 1.06539468738006, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.150669563038674, 7.07106774515965,
			 0.00462621245980734, 0.00817425610087679, 0.00640023428034207,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000905129805714792,
			 7.07106786223631, 0.970901063197047, 2.2403726401243, 1.60563685166067,
			 "W:Z", "<unicode>", 7.12396784896541e-07, "Y", 0.323850740865823,
			 4.95795330703263, 0.42497917972322, 0.896763101815117, 0.660871140769168,
			 "Z", "<unicode>", 3.99655948335464e-08, "Y", 0.120355252905989,
			 5.49100371452322, 1.44041334249256, 2.74027825208788, 2.09034579729022,
			 "W:Y", "<unicode>", 2.9055557959623e-10, "Y", 0.331604284529841,
			 6.3037357923586, 0.732634592895254, 1.29452395206636, 1.01357927248081,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341756175934,
			 7.07106777202286, 3.90117348427805, 7.48120841497076, 5.6911909496244,
			 "W:Z", "<unicode>", 4.61931604078814e-10, "W:Y", 0.913290998949872,
			 6.23151980712423, 1.02432133640967, 2.20944843069985, 1.61688488355476,
			 "Z", "<unicode>", 8.89262523617873e-08, "W:Y", 0.302333895836431,
			 5.34801061284088, 4.72565893570596, 8.34997246330444, 6.5378156995052,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.924586766947404,
			 7.07106778208638, 1.62861545961634, 3.05704934020254, 2.34283239990944,
			 "W:Z", "<unicode>", 1.28249411091019e-10, "Z", 0.364403094101093,
			 6.42923300552297, 0.721541822701059, 1.27492365155788, 0.998232737129469,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171427950163,
			 7.07106779058629, 5.64080128738274, 9.96697730524424, 7.80388929631349,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 1.10363661066883,
			 7.07106779611469))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17662588894338, 0.198183935996446, 0.010779023526533,
			 0.0156062766261644, "W", "M", "", "<unicode>", "", 0.910243168929329,
			 0.0956165082359363, 0.112731825553967, 50, 16, -0.253642871290399,
			 0.255685938208114, 0.00102153345885706, 0.00147901465309571,
			 "W", "M", "", "<unicode>", "", 0.993727104858095, 0.129933206302777,
			 0.00786198915523276, 84, 16, -0.482414154461754, 0.463159100851721,
			 -0.00962752680501644, -0.0139390962618323, "W", "M", "", "<unicode>",
			 "", 0.968163712568229, 0.241222099684493, -0.0399114625799575,
			 16, 50, -0.287055976365074, 0.254966093070865, -0.0160449416471047,
			 -0.0232304714039269, "W", "M", "", "<unicode>", "", 0.907622632260273,
			 0.138273476888183, -0.116037739183196, 50, 50, -0.162770945937189,
			 0.111166082507627, -0.0258024317147807, -0.0373577333769955,
			 "W", "M", "", "<unicode>", "", 0.711961997143735, 0.0698831791312484,
			 -0.369222351294591, 84, 50, -0.328513040232256, 0.255610056274948,
			 -0.0364514919786541, -0.0527758442919235, "W", "M", "", "<unicode>",
			 "", 0.806751961225523, 0.149013732169237, -0.244618341195936,
			 16, 84, -0.539344369061799, 0.444370876910121, -0.0474867460758392,
			 -0.0687531011980577, "W", "M", "", "<unicode>", "", 0.849915592742984,
			 0.25095237813841, -0.189226125004675, 50, 84, -0.354370737268138,
			 0.239882264981108, -0.0572442361435151, -0.0828803631711263,
			 "W", "M", "", "<unicode>", "", 0.70572357790725, 0.151597939282721,
			 -0.377605635105356, 84, 84, -0.284293245524966, 0.148506652710189,
			 -0.0678932964073886, -0.0982984740860543, "W", "M", "", "<unicode>",
			 "", 0.53860828942283, 0.110410166117598, -0.614918886500679,
			 0, 16, 16, -0.0111495478048379, 0.0134143696622825, 0.00113241092872227,
			 0.00163954723399845, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.856594450313717, 0.00626642062325569, 0.180710966723126, 0,
			 50, 16, -0.0215877095299274, 0.0260830903224546, 0.00224769039626359,
			 0.00325429089265055, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.853365823523186, 0.0121611417935236, 0.184825605557909, 0,
			 84, 16, -0.0336127449930606, 0.0405424973665033, 0.00346487618672138,
			 0.00501657836744472, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.854674691355604, 0.0189175012766793, 0.183157180012602, 0,
			 16, 50, -0.012369680520992, 0.0147923435026224, 0.00121133149081521,
			 0.00175381139906711, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.861224915880427, 0.0069292150870794, 0.174815109011975, 0,
			 50, 50, -0.0219770149631678, 0.0266302368798809, 0.00232661095835653,
			 0.00336855505771922, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.851167212030527, 0.0124000369972246, 0.187629356176702, 0,
			 84, 50, -0.033674775929202, 0.0407623694268307, 0.00354379674881432,
			 0.00513084253251338, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.85195892236276, 0.0189894166278522, 0.186619569113911, 0,
			 16, 84, -0.0151130467126735, 0.0177207237190888, 0.00130383850320765,
			 0.00188774653908259, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.876299868289086, 0.00837611575792999, 0.155661471365561, 0,
			 50, 84, -0.0233253077640383, 0.0281635437055362, 0.00241911797074896,
			 0.0035024901977347, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.853879081492175, 0.0131351524506858, 0.184171289966463, 0,
			 84, 84, -0.0343529852708465, 0.0416255927932601, 0.00363630376120675,
			 0.00526477767252886, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.851185401706461, 0.0193826464831538, 0.187606154008288))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161747558078898, 0.111897385829132, -0.0249250861248833, -0.036087479356399,
			 "W", "<unicode>", 0.721055427992308, "M", 0.0698086664006346,
			 -0.357048593105006, 0, -2.77216354617057, 2.28533087925998,
			 -0.2434163334553, -0.231140847695317, "jasp", "<unicode>", 0.850355027175064,
			 "M", 1.29020085708804, -0.188665456326455, -0.218443590334605,
			 0.759300770740238, 0.270428590202816, 0.258528513895675, "Y",
			 "<unicode>", 0.27828059380401, "M", 0.249429165226292, 1.08418993407396,
			 -0.251421175056423, 0.231388140651356, -0.0100165172025335,
			 -0.0146004244849676, "W:Y", "<unicode>", 0.935184220191466,
			 "M", 0.123167905001346, -0.0813240852186617, -0.584165791574911,
			 0.454878098160403, -0.0646438467072539, -0.061329592809154,
			 "Z", "<unicode>", 0.80732584720015, "M", 0.265067087439147,
			 -0.243877304163968, -0.259080203509256, 0.202833683958747, -0.0281232597752545,
			 -0.0406819201963953, "W:Z", "<unicode>", 0.811367919344933,
			 "M", 0.117837340663278, -0.238661697700877, -0.0199697912619316,
			 0.000908050294805169, -0.00953087048356323, -0.177948528107149,
			 "W", "<unicode>", 0.0735387335502806, "jasp", 0.00532607785689394,
			 -1.78947261749595, -0.0336994295804919, 0.0420651669541132,
			 0.00418286868681066, 0.0515670191950902, "Y", "<unicode>", 0.82866480173416,
			 "jasp", 0.0193280583552113, 0.216414324188072, -0.0233913105034784,
			 0.0139844953643575, -0.00470340756956045, -0.0884103899992071,
			 "W:Y", "<unicode>", 0.621809439630435, "jasp", 0.00953481955858665,
			 -0.493287527955866, -0.0310213844833691, 0.0494312399478556,
			 0.00920492773224322, 0.112617329353047, "Z", "<unicode>", 0.653795510682505,
			 "jasp", 0.020524005814858, 0.448495669669878, -0.0182406528059259,
			 0.0175608027605156, -0.000339925022705153, -0.00634104553244973,
			 "W:Z", "<unicode>", 0.970310673716672, "jasp", 0.00913319220374427,
			 -0.0372186432872612))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175157158075021, 0.198980026985532, 0.0119114344552553,
			 0.0172458238601628, "Total", "W", "M", "<unicode>", 0.900682639909869,
			 0.0954449132769019, 0.124799049486254, 50, 16, -0.250367551322938,
			 0.25690599903318, 0.00326922385512064, 0.00473330554574626,
			 "Total", "W", "M", "<unicode>", 0.979845390128402, 0.129408895866819,
			 0.025262744367166, 84, 16, -0.47766095438701, 0.46533565315042,
			 -0.00616265061829506, -0.00892251789438756, "Total", "W", "M",
			 "<unicode>", 0.979562486092166, 0.240564779499947, -0.0256174267534306,
			 16, 50, -0.285600503857102, 0.255933283544523, -0.0148336101562895,
			 -0.0214766600048598, "Total", "W", "M", "<unicode>", 0.914492229775115,
			 0.138148912855842, -0.107374063607495, 50, 50, -0.15831886719086,
			 0.111367225678012, -0.0234758207564241, -0.0339891783192763,
			 "Total", "W", "M", "<unicode>", 0.732934513075787, 0.0687987368635653,
			 -0.341224589674938, 84, 50, -0.322691210015915, 0.256875819556235,
			 -0.0329076952298398, -0.0476450017594101, "Total", "W", "M",
			 "<unicode>", 0.823868090662278, 0.14785144883878, -0.222572693661751,
			 16, 84, -0.537941487089372, 0.445575671944109, -0.0461829075726315,
			 -0.0668653546589751, "Total", "W", "M", "<unicode>", 0.853960401230834,
			 0.250901844827594, -0.184067628535637, 50, 84, -0.35093959179797,
			 0.241289355452437, -0.0548251181727662, -0.0793778729733916,
			 "Total", "W", "M", "<unicode>", 0.716691407141484, 0.151081589233739,
			 -0.362884177025341, 84, 84, -0.277372156883336, 0.148858171590972,
			 -0.0642569926461819, -0.0930336964135254, "Total", "W", "M",
			 "<unicode>", 0.554550825960244, 0.108734224668504, -0.590954622080409,
			 16, 16, -0.0111495478048379, 0.0134143696622825, 0.00113241092872227,
			 0.00163954723399845, "Total indirect", "W", "M", "<unicode>",
			 0.856594450313717, 0.00626642062325569, 0.180710966723126, 50,
			 16, -0.0215877095299274, 0.0260830903224546, 0.00224769039626359,
			 0.00325429089265055, "Total indirect", "W", "M", "<unicode>",
			 0.853365823523186, 0.0121611417935236, 0.184825605557909, 84,
			 16, -0.0336127449930606, 0.0405424973665033, 0.00346487618672138,
			 0.00501657836744472, "Total indirect", "W", "M", "<unicode>",
			 0.854674691355604, 0.0189175012766793, 0.183157180012602, 16,
			 50, -0.012369680520992, 0.0147923435026224, 0.00121133149081521,
			 0.00175381139906711, "Total indirect", "W", "M", "<unicode>",
			 0.861224915880427, 0.0069292150870794, 0.174815109011975, 50,
			 50, -0.0219770149631678, 0.0266302368798809, 0.00232661095835653,
			 0.00336855505771922, "Total indirect", "W", "M", "<unicode>",
			 0.851167212030527, 0.0124000369972246, 0.187629356176702, 84,
			 50, -0.033674775929202, 0.0407623694268307, 0.00354379674881432,
			 0.00513084253251338, "Total indirect", "W", "M", "<unicode>",
			 0.85195892236276, 0.0189894166278522, 0.186619569113911, 16,
			 84, -0.0151130467126735, 0.0177207237190888, 0.00130383850320765,
			 0.00188774653908259, "Total indirect", "W", "M", "<unicode>",
			 0.876299868289086, 0.00837611575792999, 0.155661471365561, 50,
			 84, -0.0233253077640383, 0.0281635437055362, 0.00241911797074896,
			 0.0035024901977347, "Total indirect", "W", "M", "<unicode>",
			 0.853879081492175, 0.0131351524506858, 0.184171289966463, 84,
			 84, -0.0343529852708465, 0.0416255927932601, 0.00363630376120675,
			 0.00526477767252886, "Total indirect", "W", "M", "<unicode>",
			 0.851185401706461, 0.0193826464831538, 0.187606154008288))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(847.472979995417, 938.653936505, 0, "Model 1", 100, -388.736489997709,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0802724438561429, 0.0505906986763384, -0.0148408725899022,
			 "sm:Z", "<unicode>", 0.656645310678856, "sm", 0.0333840681677605,
			 -0.444549553257691, -0.163250736619917, 0.0341991748147377,
			 -0.0645257809025895, "Z", "<unicode>", 0.200188192921152, "sm",
			 0.0503708009412709, -1.28101558237723, 0.0922263537069776, 0.197773642760945,
			 0.144999998233962, "sm:medexperimental", "<unicode>", 7.2378290694175e-08,
			 "sm", 0.0269258236086253, 5.38516482695492, -0.00962232580684182,
			 0.0896223216973334, 0.0399999979452458, "medexperimental", "<unicode>",
			 0.114128633497362, "sm", 0.025317977342187, 1.57990495862378,
			 0.180704808328294, 0.31929518963267, 0.249999998980482, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553387709057,
			 7.07106784071349, 0.75633749987223, 1.33640564566244, 1.04637157276733,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147979286957748,
			 7.07106781144378, 0.00473838138152975, 0.00837245229505595,
			 0.00655541683829285, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000927075941749771, 7.07106779830798, -0.132931056735514,
			 0.000359827041371705, -0.0662856148470712, "sm:Z", "<unicode>",
			 0.0512498350411381, "medexperimental", 0.0340034012941736, -1.94938189487618,
			 -0.170527216921111, 0.0272978583361399, -0.0716146792924856,
			 "Z", "<unicode>", 0.155883391282257, "medexperimental", 0.0504665077566909,
			 -1.41905359565901, 0.0922263537552404, 0.197773642089012, 0.144999997922126,
			 "sm:medexperimental", "<unicode>", 7.23782807021678e-08, "medexperimental",
			 0.0269258234248985, 5.38516485211902, 0.180704807452599, 0.319295186581532,
			 0.249999997017066, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.0353553382159356, 7.07106789617371, -0.133519796662461,
			 -0.0115177676649923, -0.0725187821637268, "sm:Z", "<unicode>",
			 0.019804559146533, "sm:medexperimental", 0.0311235384833103,
			 -2.33003012181968, -0.19238581769264, -0.0102862370150947, -0.101336027353867,
			 "Z", "<unicode>", 0.0291546948144799, "sm:medexperimental",
			 0.0464548282810101, -2.18138848218047, 0.148828479750815, 0.262971516827155,
			 0.205899998288985, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186567652993, 7.07106787062911,
			 0.290493136098297, 0.605240615226875, 0.447866875662586, "sm:Z",
			 "<unicode>", 2.43546547373796e-08, "Z", 0.0802941996922562,
			 5.57782352123972, 0.721541822331531, 1.27492365026903, 0.998232736300283,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171427715639,
			 7.07106779645963, 0.321594859654299, 0.568239950537152, 0.444917405095726,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0629208222264181,
			 7.07106788106977))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.160966936931888, 1.33182551372547, 0.58542928839679,
			 0.555906091838316, "s", "M", "", 0, "<unicode>", "", 0.12422464825483,
			 "m", 0.380821398360458, 1.53728044410641, 0, 16, -0.360278235718318,
			 1.00801085611418, 0.323866310197934, 0.307533733532994, "s",
			 "M", "", 1, "<unicode>", "", 0.353498436741143, "m", 0.349059753808078,
			 0.927824839915527, 0, 50, 0.026855579052343, 1.18728990325929,
			 0.607072741155815, 0.576458065365479, "s", "M", "", 0, "<unicode>",
			 "", 0.0402979555308127, "m", 0.296034604043825, 2.05068168674614,
			 0, 50, -0.240696017889007, 0.931715543802924, 0.345509762956959,
			 0.328085707060157, "s", "M", "", 1, "<unicode>", "", 0.248007295992505,
			 "m", 0.299090077914636, 1.155203025677, 0, 84, -0.0593069505696294,
			 1.32419133031173, 0.632442189871049, 0.600548132888407, "s",
			 "M", "", 0, "<unicode>", "", 0.0731446713179715, "m", 0.352939720268897,
			 1.79192693128789, 0, 84, -0.402473478163284, 1.14423190150767,
			 0.370879211672192, 0.352175774583085, "s", "M", "", 1, "<unicode>",
			 "", 0.347245173989385, "m", 0.394574949302938, 0.939946168218213,
			 0, 16, -0.024428328569724, 0.0234847262049974, -0.000471801182363297,
			 -0.000448008250715519, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.969209589568503, "m", 0.0122229426542154, -0.0385996396866497,
			 0, 16, -0.031835516224148, 0.0331199143598944, 0.0006421990678732,
			 0.00060981297157383, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969085398913164, "m", 0.0165705673921568, 0.0387554060567151,
			 0, 50, -0.0144875496805365, 0.0139308755892561, -0.000278337045640185,
			 -0.000264300509595937, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.969374550550848, "m", 0.00724973149862792, -0.0383927385025036,
			 0, 50, -0.0413456647557022, 0.0430169911648948, 0.000835663204596311,
			 0.000793520712693412, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969026515676399, "m", 0.0215214811562965, 0.0388292607988937,
			 0, 84, -0.00379204632943545, 0.00368891156475696, -5.15673823392428e-05,
			 -4.89668394641559e-05, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.978443255260002, "m", 0.00190844269415184, -0.0270206606136322,
			 0, 84, -0.052571436689766, 0.0546963024255606, 0.00106243286789725,
			 0.00100885438282519, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969029984517652, "m", 0.0273647219952614, 0.0388249099728194
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0243383511438906, 1.18845016065507, 0.606394255899478, 0.575813796117773,
			 "sm", "<unicode>", 0.0411595853209008, "M", 0.296972755288755,
			 2.04191881275393, 0, -2.52535807348667, 2.42710102170066, -0.0491285258930036,
			 -0.0466509745382716, "jasp", "<unicode>", 0.968981446200649,
			 "M", 1.26340563761674, -0.0388857896705913, 0, -0.427962420430357,
			 0.72116409252918, 0.146600836049411, 0.139207756502305, "medexperimental",
			 "<unicode>", 0.617012908272905, "M", 0.293149905310429, 0.50008829405614,
			 0, -1.09233336621597, 0.569207409818258, -0.261562978198857,
			 -0.248372358305322, "sm:medexperimental", "<unicode>", 0.537180192588634,
			 "M", 0.423870231580849, -0.617082679345852, -0.226798874976816,
			 0.320540575343867, 0.0468708501835257, 0.044467808075978, "Z",
			 "<unicode>", 0.737112947254171, "M", 0.139629976529678, 0.335678994929599,
			 0, -0.393011065511166, 0.43839469469763, 0.0226918145932323,
			 0.0215284180311753, "sm:Z", "<unicode>", 0.914798653140302,
			 "M", 0.2120972035116, 0.106987806616655, 0, -0.0402674820489425,
			 0.0518453509361387, 0.00578893444359811, 0.0708871582764629,
			 "sm", "<unicode>", 0.805409546297133, "jasp", 0.0234986034722208,
			 0.246352275804032, 0, -0.04890966892482, 0.0420350270544081,
			 -0.00343732093520597, -0.0420909781506348, "medexperimental",
			 "<unicode>", 0.882219238083173, "jasp", 0.0232006038622618,
			 -0.148156528839197, 0, -0.0882812895641232, 0.0429308447873895,
			 -0.0226752223883668, -0.277664584745079, "sm:medexperimental",
			 "<unicode>", 0.498141859832878, "jasp", 0.0334730983289737,
			 -0.677416299068425, -0.0174100508807428, 0.0258806690689275,
			 0.00423530909409238, 0.0518167237479763, "Z", "<unicode>", 0.701347092842276,
			 "jasp", 0.0110437539391392, 0.383502667429269, 0, -0.0370220688817718,
			 0.028764743202049, -0.00412866283986139, -0.0505119643144909,
			 "sm:Z", "<unicode>", 0.805676288266536, "jasp", 0.0167826584066694,
			 -0.246007678868126))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.161065462141733, 1.33098043657059, 0.584957487214427,
			 0.5554580835876, "Total", "s", "M", 0, "<unicode>", 0.124339818067228,
			 "m", 0.380630947936133, 1.53681010539526, 0, 16, -0.358875044029001,
			 1.00789206256061, 0.324508509265807, 0.308143546504568, "Total",
			 "s", "M", 1, "<unicode>", 0.352008831949082, "m", 0.348671485131997,
			 0.93069987969609, 0, 50, 0.0267424852482577, 1.18684632297209,
			 0.606794404110175, 0.576193764855883, "Total", "s", "M", 0,
			 "<unicode>", 0.0403326883089552, "m", 0.295950294718318, 2.05032539226803,
			 0, 50, -0.23834961545185, 0.931040467774959, 0.346345426161555,
			 0.328879227772851, "Total", "s", "M", 1, "<unicode>", 0.245646338199243,
			 "m", 0.29831927842828, 1.1609890852053, 0, 84, -0.0593588648709685,
			 1.32414010984839, 0.63239062248871, 0.600499166048942, "Total",
			 "s", "M", 0, "<unicode>", 0.0731682258445499, "m", 0.352939897271639,
			 1.7917799245065, 0, 84, -0.399560650458566, 1.14344393953874,
			 0.37194164454009, 0.35318462896591, "Total", "s", "M", 1, "<unicode>",
			 0.34471012405538, "m", 0.393630852956568, 0.944899622949851,
			 0, 16, -0.024428328569724, 0.0234847262049974, -0.000471801182363297,
			 -0.000448008250715519, "Total indirect", "s", "M", 0, "<unicode>",
			 0.969209589568503, "m", 0.0122229426542154, -0.0385996396866497,
			 0, 16, -0.031835516224148, 0.0331199143598944, 0.0006421990678732,
			 0.00060981297157383, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969085398913164, "m", 0.0165705673921568, 0.0387554060567151,
			 0, 50, -0.0144875496805365, 0.0139308755892561, -0.000278337045640185,
			 -0.000264300509595937, "Total indirect", "s", "M", 0, "<unicode>",
			 0.969374550550848, "m", 0.00724973149862792, -0.0383927385025036,
			 0, 50, -0.0413456647557022, 0.0430169911648948, 0.000835663204596311,
			 0.000793520712693412, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969026515676399, "m", 0.0215214811562965, 0.0388292607988937,
			 0, 84, -0.00379204632943545, 0.00368891156475696, -5.15673823392428e-05,
			 -4.89668394641559e-05, "Total indirect", "s", "M", 0, "<unicode>",
			 0.978443255260002, "m", 0.00190844269415184, -0.0270206606136322,
			 0, 84, -0.052571436689766, 0.0546963024255606, 0.00106243286789725,
			 0.00100885438282519, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969029984517652, "m", 0.0273647219952614, 0.0388249099728194
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1434.42423460798, 1546.44655260547, 1, "Model 1", 100, -674.212117303992,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-1.19395391961689, 0.481528913208037, -0.356212503204428, "W:Z",
			 "<unicode>", 0.404625917663442, "W", 0.42742694407676, -0.833388040086816,
			 -0.274980586989152, 0.122449619695636, -0.0762654836467581,
			 "jasp:Z", "<unicode>", 0.451918386348996, "W", 0.101387119819463,
			 -0.752220634954045, -0.403726754358366, 0.194420388919497, -0.104653182719434,
			 "Z", "<unicode>", 0.492814324346237, "W", 0.152591360860702,
			 -0.685839500540073, -1.36470935967507, 0.18102501456879, -0.591842172553141,
			 "W:Y", "<unicode>", 0.13338377733299, "W", 0.394327239285114,
			 -1.50089091898928, -0.54484821666781, 0.0642086530625025, -0.240319781802654,
			 "Y", "<unicode>", 0.12193244472443, "W", 0.155374505484406,
			 -1.54671309204439, 1.68041092041859, 2.96919123147413, 2.32480107594636,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776528860039,
			 7.07106764587821, 0.769964638250223, 1.36048404277336, 1.06522434051179,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.15064547338142,
			 7.07106769690151, -0.00273874888085101, 0.00587013722533477,
			 0.00156569417224188, "jasp:Z", "<unicode>", 0.475898044729338,
			 "jasp", 0.00219618477025384, 0.712915503945015, -0.0047452061024128,
			 0.00755396242832215, 0.00140437816295468, "Z", "<unicode>",
			 0.654444637745552, "jasp", 0.0031376006466826, 0.447596211595485,
			 0.00465468574623835, 0.00822456683610512, 0.00643962629117174,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000910700685835438,
			 7.07106779574268, 0.970901031624366, 2.24037259921914, 1.60563681542175,
			 "W:Z", "<unicode>", 7.12397061564118e-07, "Y", 0.323850738485044,
			 4.9579532315808, 0.281613359565848, 0.594612028429646, 0.438112693997747,
			 "jasp:Z", "<unicode>", 4.09212692620287e-08, "Y", 0.0798480664269067,
			 5.48682909433752, 0.425093968932107, 0.89664831702822, 0.660871142980163,
			 "Z", "<unicode>", 3.9365017689974e-08, "Y", 0.120296687034985,
			 5.49367700199399, 1.44041328975299, 2.74027808942645, 2.09034568958972,
			 "W:Y", "<unicode>", 2.9055513550702e-10, "Y", 0.331604256488034,
			 6.30373600064194, 0.732634578115736, 1.29452390231031, 1.01357924021302,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341747253185,
			 7.07106798707242, 3.90117347305443, 7.48120837633754, 5.69119092469598,
			 "W:Z", "<unicode>", 4.61931604078814e-10, "W:Y", 0.913290991957498,
			 6.23151982753908, 0.652774854267686, 1.4330329542228, 1.04290390424524,
			 "jasp:Z", "<unicode>", 1.61072784221616e-07, "W:Y", 0.19904909123578,
			 5.23943062372432, 1.02461610768955, 2.20915370696752, 1.61688490732853,
			 "Z", "<unicode>", 8.76281369688314e-08, "W:Y", 0.302183511692422,
			 5.35067217358398, 4.72565880438022, 8.34997202074369, 6.53781541256196,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.92458668754926,
			 7.0710680789611, 1.62726830521113, 3.05469930582298, 2.34098380551705,
			 "W:Z", "<unicode>", 1.28722144054905e-10, "Z", 0.364147252671796,
			 6.42867353341526, 0.47378573174956, 0.839155524840971, 0.656470628295266,
			 "jasp:Z", "<unicode>", 1.88071780371502e-12, "Z", 0.0932082925945071,
			 7.04304960451505, 0.720561363892347, 1.2731230973506, 0.996842230621475,
			 "Z", "<unicode>", 1.53055346174824e-12, "Z", 0.140962216096008,
			 7.07169806370337, 1.04799010945056, 1.98656278749403, 1.5172764484723,
			 "W:Z", "<unicode>", 2.34477548488599e-10, "jasp:Z", 0.239436205319796,
			 6.33687142863708, 0.317849214564737, 0.561467573262525, 0.439658393913631,
			 "jasp:Z", "<unicode>", 1.50213175231784e-12, "jasp:Z", 0.0621486824807545,
			 7.07429950827645, 5.64080140274014, 9.96697771506144, 7.80388955890079,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 1.1036366857875,
			 7.07106755275385))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.179641357531065, 0.198135288938523, 0.00924696570372895,
			 0.013389487612585, "W", "M", "", "<unicode>", "", 0.923560766467017,
			 0.0963733643703259, 0.0959493918692762, 50, 16, -0.253470995886078,
			 0.255842537297138, 0.00118577070552972, 0.00171698075690428,
			 "W", "M", "", "<unicode>", "", 0.992718386551033, 0.129929309211959,
			 0.00912627576273285, 84, 16, -0.481391756077139, 0.466167757910036,
			 -0.00761199908355142, -0.0110220769387216, "W", "M", "", "<unicode>",
			 "", 0.974878902526264, 0.241728807636621, -0.0314898301033039,
			 16, 50, -0.289015144018309, 0.254388150998643, -0.017313496509833,
			 -0.0250697206496029, "W", "M", "", "<unicode>", "", 0.900607689812634,
			 0.138625836827424, -0.124893720435295, 50, 50, -0.162492607216239,
			 0.111743224200174, -0.0253746915080322, -0.0367422275052836,
			 "W", "M", "", "<unicode>", "", 0.716824567627688, 0.0699594057797873,
			 -0.362705932464674, 84, 50, -0.328338972936946, 0.259994050342719,
			 -0.0341724612971134, -0.0494812852009094, "W", "M", "", "<unicode>",
			 "", 0.819892479181125, 0.150087712815225, -0.227683270376593,
			 16, 84, -0.540489594466754, 0.443596724418859, -0.0484464350239473,
			 -0.0701498158866819, "W", "M", "", "<unicode>", "", 0.846976574905091,
			 0.251047041335443, -0.192977518341729, 50, 84, -0.353829635660567,
			 0.240814375616274, -0.0565076300221466, -0.0818223227423627,
			 "W", "M", "", "<unicode>", "", 0.709519428757821, 0.15169768831655,
			 -0.372501589504984, 84, 84, -0.285373940744688, 0.154763141122233,
			 -0.0653053998112277, -0.0945613804379885, "W", "M", "", "<unicode>",
			 "", 0.560822769826942, 0.112281931030026, -0.581619849357277,
			 0, 16, 16, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 0,
			 50, 16, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 0, 84,
			 16, -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704, 0,
			 16, 50, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 0,
			 50, 50, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 0, 84,
			 50, -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704, 0,
			 16, 84, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 0,
			 50, 84, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 0, 84,
			 84, -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.161473236346539, 0.112449346923816, -0.0245119447113615, -0.0354929812209418,
			 "W", "<unicode>", 0.725757527908865, "M", 0.0698794940700496,
			 -0.350774501698451, 0, -2.79872514246547, 2.28099169713142,
			 -0.258866722667027, -0.245837447131877, "jasp", "<unicode>",
			 0.841666027294335, "M", 1.29586994446455, -0.199762888068208,
			 -0.225570707073824, 0.758946802388995, 0.266688047657586, 0.254978884878349,
			 "Y", "<unicode>", 0.288309312096509, "M", 0.251157040952938,
			 1.06183783120601, -0.25116456661392, 0.234614183715775, -0.00827519144907223,
			 -0.0120634523879262, "W:Y", "<unicode>", 0.946760369906947,
			 "M", 0.123925427753126, -0.0667755730128071, -1.87023507907759,
			 1.5319198708425, -0.169157604117545, -0.160389728213163, "Z",
			 "<unicode>", 0.845469940088794, "M", 0.867912618996027, -0.194901653018044,
			 0, -2.28051659597697, 2.5951011222398, 0.157292263131414, 0.14913939852299,
			 "jasp:Z", "<unicode>", 0.899367205448007, "M", 1.24380288532724,
			 0.126460763989972, -0.258825162006311, 0.203131175397878, -0.0278469933042168,
			 -0.0402583744959421, "W:Z", "<unicode>", 0.813203371538515,
			 "M", 0.117848169927622, -0.236295509054739, -0.019747514664297,
			 0.00116000389411311, -0.00929375538509195, -0.173521411737263,
			 "W", "<unicode>", 0.0814251676831153, "jasp", 0.00533364865970139,
			 -1.74247611308021, -0.0185476055801812, 0.0350787541956856,
			 0.00826557430775218, 0.101899211604699, "Y", "<unicode>", 0.54571800302233,
			 "jasp", 0.0136804452017651, 0.604188985507995, -0.0145563045368629,
			 0.0065428603484539, -0.00400672209420451, -0.0753147275113655,
			 "W:Y", "<unicode>", 0.456639000410969, "jasp", 0.00538253892718038,
			 -0.744392590264723))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175969796378319, 0.198833198572061, 0.0114317010968708,
			 0.0165529564109447, "Total", "W", "M", "<unicode>", 0.904831710298619,
			 0.0956147658596736, 0.119559996765021, 50, 16, -0.25006683037504,
			 0.257170055684275, 0.00355161265461747, 0.00514268952295606,
			 "Total", "W", "M", "<unicode>", 0.97810331403004, 0.12939954255801,
			 0.0274468717926517, 84, 16, -0.477943660532695, 0.464844721405333,
			 -0.0065494695636812, -0.00948354783629709, "Total", "W", "M",
			 "<unicode>", 0.978275170240158, 0.240511659748501, -0.027231401465234,
			 16, 50, -0.285960641224877, 0.255703118991494, -0.0151287611166912,
			 -0.0219062518512432, "Total", "W", "M", "<unicode>", 0.912818408517956,
			 0.138182069795401, -0.109484256091196, 50, 50, -0.158092682500818,
			 0.112074983382929, -0.0230088495589445, -0.0333165187392318,
			 "Total", "W", "M", "<unicode>", 0.738499573261442, 0.0689215893799058,
			 -0.333840959936608, 84, 50, -0.322832778331335, 0.256612914776848,
			 -0.0331099317772431, -0.047942756098485, "Total", "W", "M",
			 "<unicode>", 0.822767089534868, 0.147820495090414, -0.22398742310389,
			 16, 84, -0.537929547621333, 0.445406148359722, -0.0462616996308055,
			 -0.0669863470883223, "Total", "W", "M", "<unicode>", 0.853687362544704,
			 0.250855552381952, -0.184415689393901, 50, 84, -0.350479946279107,
			 0.24219637013299, -0.0541417880730588, -0.0783966139763109,
			 "Total", "W", "M", "<unicode>", 0.720275397707697, 0.151195716116993,
			 -0.358090754576437, 84, 84, -0.277402942688549, 0.148917202105834,
			 -0.0642428702913575, -0.093022851335564, "Total", "W", "M",
			 "<unicode>", 0.554721267914356, 0.108757137416081, -0.590700268669067,
			 16, 16, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "Total indirect", "W", "M", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 50,
			 16, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "Total indirect", "W", "M", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 84, 16,
			 -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "Total indirect", "W", "M", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704, 16,
			 50, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "Total indirect", "W", "M", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 50,
			 50, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "Total indirect", "W", "M", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 84, 50,
			 -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "Total indirect", "W", "M", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704, 16,
			 84, -0.017857171973494, 0.0222266427597777, 0.00218473539314182,
			 0.00316346879835967, "Total indirect", "W", "M", "<unicode>",
			 0.830818091545538, 0.010225650840895, 0.213652453729841, 50,
			 84, -0.021370949455335, 0.0261026333535105, 0.00236584194908775,
			 0.00342570876605178, "Total indirect", "W", "M", "<unicode>",
			 0.845119523468928, 0.01211083039875, 0.19534927591191, 84, 84,
			 -0.0477631908408938, 0.0498882498806343, 0.00106252951987022,
			 0.00153852910242449, "Total indirect", "W", "M", "<unicode>",
			 0.965978862082291, 0.0249115395721019, 0.0426521017215704))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(652.227166421852, 764.24948441934, 1, "Model 1", 100, -283.113583210926,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0802724464188035, 0.050590697327478, -0.0148408745456628, "sm:Z",
			 "<unicode>", 0.656645271314195, "sm", 0.0333840684774091, -0.444549607717991,
			 -0.108740645545809, 0.0224606707223747, -0.0431399874117173,
			 "jasp:Z", "<unicode>", 0.197432147279942, "sm", 0.0334703385631275,
			 -1.28890203277604, -0.163249261914677, 0.0341976963424996, -0.0645257827860887,
			 "Z", "<unicode>", 0.200181450184912, "sm", 0.050370047565826,
			 -1.28103477968257, 0.0922263548045653, 0.19777364640395, 0.145000000604257,
			 "sm:medexperimental", "<unicode>", 7.2378307569565e-08, "sm",
			 0.0269258242579782, 5.38516478511493, -0.00962232374538015,
			 0.0896223268551444, 0.0400000015548821, "medexperimental", "<unicode>",
			 0.114128612132057, "sm", 0.0253179781320865, 1.57990505190414,
			 0.180704809163077, 0.319295192547526, 0.250000000855302, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553393015464,
			 7.07106778761325, 0.755519568410766, 1.33496040696536, 1.04523998768806,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.14781925666113,
			 7.07106781144378, -0.00558361459533465, 0.0102321816327854,
			 0.00232428351872537, "jasp:Z", "<unicode>", 0.564567088598096,
			 "jasp", 0.00403471603378251, 0.57607115327677, -0.00937475716820434,
			 0.0139275961870865, 0.0022764195094411, "Z", "<unicode>", 0.70176433768658,
			 "jasp", 0.00594458712994138, 0.382939884584305, 0.00474535368471362,
			 0.00838477193823674, 0.00656506281147518, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.00092844008416236, 7.07106783029321,
			 -0.132931061816646, 0.000359825201227321, -0.0662856183077093,
			 "sm:Z", "<unicode>", 0.0512498285525445, "medexperimental",
			 0.0340034021209713, -1.94938194924996, -0.110813775998541, 0.0204919950018419,
			 -0.0451608904983494, "jasp:Z", "<unicode>", 0.177591622387334,
			 "medexperimental", 0.0334969856681311, -1.34820759532746, -0.170525748386849,
			 0.0272963819398802, -0.0716146832234843, "Z", "<unicode>", 0.155877210283108,
			 "medexperimental", 0.0504657564850999, -1.4190747986633, 0.0922263555128192,
			 0.197773647921128, 0.145000001716974, "sm:medexperimental",
			 "<unicode>", 7.2378307569565e-08, "medexperimental", 0.0269258244643403,
			 5.38516478516775, 0.180704809667256, 0.319295194306099, 0.250000001986677,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.035355339621551, 7.07106775561247, -0.133519799595376, -0.0115177685861311,
			 -0.0725187840907533, "sm:Z", "<unicode>", 0.019804557904896,
			 "sm:medexperimental", 0.0311235389965277, -2.33003014531361,
			 -0.127663198215863, -0.00668742433054432, -0.0671753112732036,
			 "jasp:Z", "<unicode>", 0.0295064056060932, "sm:medexperimental",
			 0.0308617338990818, -2.17665382939492, -0.192384503225878, -0.010287558414545,
			 -0.101336030820211, "Z", "<unicode>", 0.0291523558783782, "sm:medexperimental",
			 0.0464541558538041, -2.18142013255232, 0.14882848095417, 0.262971521024247,
			 0.205900000989209, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186575290214, 7.07106777790137,
			 0.290520797238643, 0.605182590602939, 0.447851693920791, "sm:Z",
			 "<unicode>", 2.4169217294201e-08, "Z", 0.0802723406772542, 5.57915329417687,
			 0.474711055739055, 0.840647257096859, 0.657679156417957, "jasp:Z",
			 "<unicode>", 1.85340631730924e-12, "Z", 0.0933527871543206,
			 7.04509395451422, 0.721614340420875, 1.27479039792237, 0.998202369171624,
			 "Z", "<unicode>", 1.51101353651484e-12, "Z", 0.141118934292895,
			 7.07348290414265, 0.1862377443807, 0.393573962549433, 0.289905853465067,
			 "sm:Z", "<unicode>", 4.229255812227e-08, "jasp:Z", 0.0528928643087768,
			 5.48100121355994, 0.318610202839305, 0.562712179582677, 0.440661191210991,
			 "jasp:Z", "<unicode>", 1.47970524722041e-12, "jasp:Z", 0.0622720566981885,
			 7.07638730075556, 0.321594859907501, 0.568239951417077, 0.444917405662289,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0629208223862992,
			 7.07106787210665))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.175482581196613, 1.32297873647751, 0.57374807764045,
			 0.54481391522178, "s", "M", "", 0, "<unicode>", "", 0.133379607763428,
			 "m", 0.382267564479194, 1.50090703725316, 0, 16, -0.363072059127495,
			 1.0049253440935, 0.320926642483002, 0.304742285689565, "s",
			 "M", "", 1, "<unicode>", "", 0.357782243303698, "m", 0.348985342080667,
			 0.9195992031345, 0, 50, 0.023315006493739, 1.18386387731734,
			 0.60358944190554, 0.573150377049564, "s", "M", "", 0, "<unicode>",
			 "", 0.041478587896681, "m", 0.296063825656457, 2.03871391774126,
			 0, 50, -0.235957380415337, 0.937493393911521, 0.350768006748092,
			 0.333078747517348, "s", "M", "", 1, "<unicode>", "", 0.241299367227008,
			 "m", 0.299355188050109, 1.17174520686569, 0, 84, -0.0537692188738751,
			 1.33090542130179, 0.63856810121396, 0.606365059712032, "s",
			 "M", "", 0, "<unicode>", "", 0.0706459384423321, "m", 0.353239817439965,
			 1.80774666299472, 0, 84, -0.392244909694818, 1.16373824180784,
			 0.385746666056511, 0.366293430179817, "s", "M", "", 1, "<unicode>",
			 "", 0.331151744803156, "m", 0.396941771322344, 0.971796605762759,
			 0, 16, -0.0299389708778428, 0.0252559084265412, -0.00234153122565076,
			 -0.00222344761468689, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.867924782322242, "m", 0.0140805850872144, -0.166295023335141,
			 0, 16, -0.0428931056828376, 0.045961542084333, 0.00153421820074773,
			 0.00145684745157036, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.946037304006755, "m", 0.0226674185005553, 0.0676838520765012,
			 0, 50, -0.0221215502697802, 0.0257353759225786, 0.0018069128263992,
			 0.00171579006497676, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.882340409258855, "m", 0.0122086238751957, 0.148002989105948,
			 0, 50, -0.0299389708778428, 0.0252559084265412, -0.00234153122565076,
			 -0.00222344761468689, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.867924782322242, "m", 0.0140805850872144, -0.166295023335141,
			 0, 84, -0.0428931056828376, 0.045961542084333, 0.00153421820074773,
			 0.00145684745157036, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.946037304006755, "m", 0.0226674185005553, 0.0676838520765012,
			 0, 84, -0.0221215502697802, 0.0257353759225786, 0.0018069128263992,
			 0.00171579006497676, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.882340409258855, "m", 0.0122086238751957, 0.148002989105948
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0204863773582062, 1.18482155490847, 0.602653966133338, 0.572262077396963,
			 "sm", "<unicode>", 0.0424649336724487, "M", 0.297029737978451,
			 2.02893478018373, 0, -2.59010002664981, 2.39392698208297, -0.0980865222834209,
			 -0.0931400109530429, "jasp", "<unicode>", 0.938508300400734,
			 "M", 1.2714588247657, -0.077144867275978, 0, -0.436456167494931,
			 0.715250741158519, 0.139397286831794, 0.132367470271013, "medexperimental",
			 "<unicode>", 0.635179057064248, "M", 0.293808181614042, 0.474449983203368,
			 0, -1.08477365691365, 0.579130786598753, -0.252821435157448,
			 -0.240071629532215, "sm:medexperimental", "<unicode>", 0.551434313093389,
			 "M", 0.424473219058378, -0.595612217228427, -1.83221550726131,
			 1.392459507886, -0.219877999687654, -0.20860178653909, "Z",
			 "<unicode>", 0.789250055123197, "M", 0.822636293468434, -0.267284584248763,
			 0, -1.98043775731435, 2.77951806660531, 0.399540154645482, 0.379050155866194,
			 "jasp:Z", "<unicode>", 0.742132955116876, "M", 1.21429675786534,
			 0.329030076097583, 0, -0.387333899876674, 0.449907530124294,
			 0.0312868151238099, 0.0296823035465855, "sm:Z", "<unicode>",
			 0.883539708233407, "M", 0.213585922140667, 0.146483507949576,
			 0, -0.040491797710668, 0.0505150109740227, 0.00501160663167739,
			 0.0613685569620563, "sm", "<unicode>", 0.829093388842896, "jasp",
			 0.0232164492313483, 0.215864475301003, 0, -0.0488496045411398,
			 0.0421572041435141, -0.00334620019881287, -0.0409751787399484,
			 "medexperimental", "<unicode>", 0.88539736069057, "jasp", 0.023216449231339,
			 -0.14413057593217, 0, -0.0871738342895774, 0.0415292288204515,
			 -0.0228223027345629, -0.279465626156406, "sm:medexperimental",
			 "<unicode>", 0.48699125375029, "jasp", 0.0328330173730799, -0.695102203834459
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 16, -0.179097010596835, 1.32191010342643, 0.5714065464148,
			 0.542590467607093, "Total", "s", "M", 0, "<unicode>", 0.135634555366057,
			 "m", 0.382917014257155, 1.49224642713593, 0, 16, -0.360794895247508,
			 1.00571661661501, 0.32246086068375, 0.306199133141135, "Total",
			 "s", "M", 1, "<unicode>", 0.354965831979934, "m", 0.348606281197355,
			 0.925000145081139, 0, 50, 0.0253656305818313, 1.18542707888205,
			 0.60539635473194, 0.57486616711454, "Total", "s", "M", 0, "<unicode>",
			 0.0407882381754474, "m", 0.295939480891137, 2.04567620686825,
			 0, 50, -0.239170909749329, 0.936023860794211, 0.348426475522441,
			 0.330855299902661, "Total", "s", "M", 1, "<unicode>", 0.245155850448419,
			 "m", 0.299800093219398, 1.16219602129162, 0, 84, -0.0540304828779161,
			 1.33423512170733, 0.640102319414708, 0.607821907163602, "Total",
			 "s", "M", 0, "<unicode>", 0.0706995152048211, "m", 0.354155896622517,
			 1.80740268768409, 0, 84, -0.393047065055844, 1.16815422282167,
			 0.387553578882911, 0.368009220244793, "Total", "s", "M", 1,
			 "<unicode>", 0.330510880772561, "m", 0.398272953021603, 0.973085357523359,
			 0, 16, -0.0299389708778428, 0.0252559084265412, -0.00234153122565076,
			 -0.00222344761468689, "Total indirect", "s", "M", 0, "<unicode>",
			 0.867924782322242, "m", 0.0140805850872144, -0.166295023335141,
			 0, 16, -0.0428931056828376, 0.045961542084333, 0.00153421820074773,
			 0.00145684745157036, "Total indirect", "s", "M", 1, "<unicode>",
			 0.946037304006755, "m", 0.0226674185005553, 0.0676838520765012,
			 0, 50, -0.0221215502697802, 0.0257353759225786, 0.0018069128263992,
			 0.00171579006497676, "Total indirect", "s", "M", 0, "<unicode>",
			 0.882340409258855, "m", 0.0122086238751957, 0.148002989105948,
			 0, 50, -0.0299389708778428, 0.0252559084265412, -0.00234153122565076,
			 -0.00222344761468689, "Total indirect", "s", "M", 1, "<unicode>",
			 0.867924782322242, "m", 0.0140805850872144, -0.166295023335141,
			 0, 84, -0.0428931056828376, 0.045961542084333, 0.00153421820074773,
			 0.00145684745157036, "Total indirect", "s", "M", 0, "<unicode>",
			 0.946037304006755, "m", 0.0226674185005553, 0.0676838520765012,
			 0, 84, -0.0221215502697802, 0.0257353759225786, 0.0018069128263992,
			 0.00171579006497676, "Total indirect", "s", "M", 1, "<unicode>",
			 0.882340409258855, "m", 0.0122086238751957, 0.148002989105948
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "mod"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "mod",
            processType = "mediators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1919.79936103679, 1990.13895605847, 0, "Model 1", 100, -932.899680518397,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089480192, 2.96919114210622, 2.32480101845407, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512596666, 7.07106782079068,
			 0.719243095446917, 1.27101851286767, 0.995130804157296, "M",
			 "<unicode>", 1.55364610066044e-12, "M", 0.140761621584144, 7.06961736415084,
			 -0.017063829424213, 0.0136234316300662, -0.00172019889707342,
			 "Y", "<unicode>", 0.826077786806031, "jasp", 0.00782852677302654,
			 -0.219734689162772, -0.762343306344135, 0.0887543315059579,
			 -0.336794487419088, "mod", "<unicode>", 0.120857287748549, "jasp",
			 0.217120733993952, -1.55118528398338, 0.00468047960484189, 0.00827014311556882,
			 0.00647531136020536, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000915747314502139, 7.07106781276859, 0.413197536866249,
			 0.872209472692487, 0.642703504779368, "Y", "<unicode>", 4.05039308759569e-08,
			 "Z", 0.117097033273791, 5.4886403763674, -6.53655165917213,
			 3.73651368195567, -1.40001898860823, "mod", "<unicode>", 0.593196294728594,
			 "Z", 2.62072809045483, -0.534209937195452, 0.71669479817852,
			 1.2663592308511, 0.991527014514812, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.140223095171204, 7.07106781022211, 507.563085651454,
			 899.790692619836, 703.676889135645, "mod", "<unicode>", 2.02793337678031e-12,
			 "mod", 100.059901626312, 7.03255627577598, 0.700714207950775,
			 1.23822336162219, 0.969468784786483, "Y", "<unicode>", 1.54809498553732e-12,
			 "Y", 0.137122201711669, 7.0701080691879))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, -0.0230302535341328,
			 "W", "M", "", "", "<unicode>", "", "", 0.813347598335086, 0.0673697800718175,
			 -0.236109634089419, 0, -0.0261961165104945, 0.0194967930965771,
			 -0.00334966170695873, -0.00484976650500305, "W", "jasp", "M",
			 "", "<unicode>", "<unicode>", "", 0.773834706557657, 0.0116565686837849,
			 -0.287362584807512, -0.0163077605876651, 0.0285137534820108,
			 0.00610299644717284, 0.00883614834541743, "W", "Z", "M", "",
			 "<unicode>", "<unicode>", "", 0.593517238385026, 0.0114342698190432,
			 0.533746058450414, -0.0332675922356836, 0.038704162906655, 0.0027182853354857,
			 0.00393563599085021, "W", "mod", "M", "", "<unicode>", "<unicode>",
			 "", 0.882302602912406, 0.0183604789960537, 0.148050894318713,
			 -0.0775466819567461, 0.0159133084692364, -0.0308166867437548,
			 -0.0446175608881794, "W", "Y", "M", "", "<unicode>", "<unicode>",
			 "", 0.196176067287806, 0.0238422723996928, -1.29252305431054,
			 0, -0.00296122904246256, 0.00450914197709736, 0.000773956467317395,
			 0.00112056335233158, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.684655756514328, 0.00190574191119971, 0.406118196157092,
			 -0.00589119861695775, 0.00506907909285442, -0.000411059762051665,
			 -0.00059514782087135, "W", "mod", "Y", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.883120221676967, 0.00279604058958875, -0.147014948059866
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, -0.0230302535341328,
			 "W", "<unicode>", 0.813347598335086, "M", 0.0673697800718175,
			 -0.236109634089419, 0, -2.10110820470282, 2.83502607382475,
			 0.366958934560965, 0.348453197312996, "jasp", "<unicode>", 0.77073564479617,
			 "M", 1.25924106704592, 0.291412775650513, -0.413433882620032,
			 0.107899969914886, -0.152766956352573, -0.144934680465498, "Z",
			 "<unicode>", 0.250696109315949, "M", 0.132995773556844, -1.14866023383276,
			 0.0028905648879694, 0.0180163398795304, 0.0104534523837499,
			 0.263343062694822, "mod", "<unicode>", 0.00674721413960322,
			 "M", 0.00385868697355441, 2.70906980934003, 0.0387464898678602,
			 0.565434272654561, 0.302090381261211, 0.288797044296207, "Y",
			 "<unicode>", 0.024554599581468, "M", 0.134361597187792, 2.24833871868158,
			 -0.0194720938734558, 0.00121576385131691, -0.00912816501106944,
			 -0.170429712489609, "W", "<unicode>", 0.0837015014975608, "jasp",
			 0.00527761170306084, -1.72960147973285, -0.169849433838636,
			 0.0899500027982267, -0.0399497155202047, -0.0609664182308724,
			 "W", "<unicode>", 0.546659912050572, "Z", 0.0662765843367857,
			 -0.602772697476375, 0, -1.87031193110395, 2.98033913143301,
			 0.555013600164534, 0.555504679381811, "jasp", "<unicode>", 0.653778056597516,
			 "Z", 1.23743372347611, 0.448519859799382, -3.17623798796469,
			 3.69631216742168, 0.260037089728493, 0.0149449009614165, "W",
			 "<unicode>", 0.882091377958021, "mod", 1.75323378633387, 0.148318548133987,
			 -0.228615253195251, 0.0245922941384487, -0.102011479528401,
			 -0.154494520527077, "W", "<unicode>", 0.11427905810986, "Y",
			 0.0645949490222699, -1.57924854918968, -0.012530212645152, 0.0020646455096896,
			 -0.0052327835677312, -0.13789199733451, "mod", "<unicode>",
			 0.159891757636204, "Y", 0.00372324651625335, -1.40543569835845
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023199935095, 0.0942455517666334, -0.0408888240842308, -0.0592003810595874,
			 "Total", "W", "M", "<unicode>", 0.553151746868814, 0.0689473770522249,
			 -0.593043939195237, -0.0779893376489408, 0.0280249977233621,
			 -0.0249821699627893, -0.0361701275254546, "Total indirect",
			 "W", "M", "<unicode>", 0.355628457145996, 0.0270449702669362,
			 -0.923727026364354))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "mod"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "mod",
            processType = "mediators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1694.56540701386, 1764.90500203554, 0, "Model 1", 100, -820.282703506932,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704808730328, 0.319295191038147, 0.249999999884237, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553390268909,
			 7.0710678150785, 0.679351239017548, 1.20070868331726, 0.940029961167402,
			 "M", "<unicode>", 1.57407420431355e-12, "M", 0.133001791974778,
			 7.06779921691328, -0.0155310360409273, 0.015901321346984, 0.000185142653028361,
			 "Y", "<unicode>", 0.981579174401771, "jasp", 0.0080186058610887,
			 0.0230891324795984, -0.781706195292346, 0.0840275744384795,
			 -0.348839310426933, "mod", "<unicode>", 0.114221818813752, "jasp",
			 0.220854509715388, -1.57949824468822, 0.00480662801191764, 0.0084930402246428,
			 0.00664983411828022, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000940428559351885, 7.07106781493651, 0.415818962568938,
			 0.877332208264479, 0.646575585416708, "Y", "<unicode>", 3.97900377091531e-08,
			 "Z", 0.11773513425142, 5.49178110279271, -6.63530159455768,
			 3.59524109747847, -1.5200302485396, "mod", "<unicode>", 0.560287998937135,
			 "Z", 2.60988027655951, -0.582413784337798, 0.707778596528062,
			 1.25060480683957, 0.979191701683816, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.138478618636172, 7.07106780330087, 507.892714690368,
			 901.011119528301, 704.451917109335, "mod", "<unicode>", 2.15072404330385e-12,
			 "mod", 100.287150156534, 7.02434874268325, 0.716666293529629,
			 1.26647572327931, 0.99157100840447, "Y", "<unicode>", 1.55475632368507e-12,
			 "Y", 0.140260084901179, 7.06951667042756))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0910081224725078, 0.860751929259853, 0.475880025866181, 0.451881397144094,
			 "s", "M", "", "", "<unicode>", "", "", 0.0153749805220957, "m",
			 0.196366824303657, 2.42342375069574, 0, -0.0327065874144014,
			 0.0226541864902512, -0.0050262004620751, -0.00477272918314809,
			 "s", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.721922972814061,
			 "m", 0.0141229059159585, -0.355889962871992, 0, -0.04952974707603,
			 0.106054836558549, 0.0282625447412593, 0.0268372646682991, "s",
			 "Z", "M", "", "<unicode>", "<unicode>", "", 0.476421330290286,
			 "m", 0.0396906741301907, 0.712070161583914, 0, -0.126072868172848,
			 0.100247146419103, -0.0129128608768725, -0.0122616653295074,
			 "s", "mod", "M", "", "<unicode>", "<unicode>", "", 0.823026170644271,
			 "m", 0.0577357585080989, -0.223654477061406, 0, -0.138320655423621,
			 0.0912558701983019, -0.0235323926126597, -0.0223456541017805,
			 "s", "Y", "M", "", "<unicode>", "<unicode>", "", 0.687826618468944,
			 "m", 0.0585665163831564, -0.401806254937635, 0, -0.00284859619040834,
			 0.00402188839589021, 0.000586646102740937, 0.000557061540990707,
			 "s", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.73784489268874, "m", 0.00175270684576147, 0.334708627492162,
			 0, -0.0147815474651881, 0.0185253899009152, 0.00187192121786353,
			 0.00177752023471082, "s", "mod", "Y", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.825631019351605, "m", 0.00849682382656624, 0.220308347692318
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0910081224725078, 0.860751929259853, 0.475880025866181, 0.451881397144094,
			 "sm", "<unicode>", 0.0153749805220957, "M", 0.196366824303657,
			 2.42342375069574, 0, -1.79290884127227, 2.94034877890532, 0.573719968816522,
			 0.544787271973417, "jasp", "<unicode>", 0.634690061553928, "M",
			 1.20748586645289, 0.475135970329726, -0.367051095396393, 0.14350331678753,
			 -0.111773889304432, -0.106043304632345, "Z", "<unicode>", 0.390795230450944,
			 "M", 0.130245865794247, -0.858176101197744, 0.00343201054080372,
			 0.0181440175053956, 0.0107880140230996, 0.271959696209718, "mod",
			 "<unicode>", 0.00404792007154309, "M", 0.00375313196585199,
			 2.8744030642287, 0.0358514443861678, 0.542472331293712, 0.28916188783994,
			 0.276437462120014, "Y", "<unicode>", 0.0252627608038503, "M",
			 0.129242397029666, 2.23736091627553, 0, -0.0407263673121724,
			 0.0232049257195319, -0.00876072079632024, -0.107277532357785,
			 "sm", "<unicode>", 0.591156438387134, "jasp", 0.0163093030116845,
			 -0.537160955930723, 0, -0.641306843553368, 0.135597595765052,
			 -0.252854623894158, -0.253078350975052, "sm", "<unicode>", 0.202027488900194,
			 "Z", 0.198193549842381, -1.27579643280646, 0, -1.77925887403205,
			 2.97744968035564, 0.599095403161793, 0.599625485877554, "jasp",
			 "<unicode>", 0.621514529069439, "Z", 1.21346835755861, 0.493705006339943,
			 0, -11.6494093208209, 9.25548197715544, -1.19696367183275, -0.0450863326455992,
			 "sm", "<unicode>", 0.822410573160282, "mod", 5.33297842788732,
			 -0.22444562415133, 0, -0.471868158437157, 0.309105404407237,
			 -0.0813813770149599, -0.0808343917297258, "sm", "<unicode>",
			 0.682924078848467, "Y", 0.199231610632801, -0.408476229030502,
			 -0.0127958409040199, 0.00197912205577032, -0.00540835942412481,
			 -0.142617475672555, "mod", "<unicode>", 0.151319742569027, "Y",
			 0.00376919246382415, -1.43488544987634))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0625107978025213, 0.867748570150353, 0.465129683976437, 0.441673194973658,
			 "Total", "s", "M", "<unicode>", 0.0235575802096637, "m", 0.205421573737947,
			 2.26426891544407, 0, -0.156837434248426, 0.135336750468939,
			 -0.0107503418897435, -0.0102082021704354, "Total indirect",
			 "s", "M", "<unicode>", 0.885318086689426, "m", 0.0745356004043945,
			 -0.144230969247143))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "Z", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "Z", processIndependent = "jasp",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "Z",
            processType = "moderators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1430.87654939867, 1542.89886739616, 1, "Model 1", 100, -672.438274699334,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.058756259025553, 0.5719809367999, 0.256612338887173, "Z:Y",
			 "<unicode>", 0.110756185231998, "W", 0.160905302546533, 1.59480349513629,
			 -0.369741655001597, 0.0356667082308438, -0.167037473385376,
			 "jasp:Y", "<unicode>", 0.106289139055419, "W", 0.103422401235495,
			 -1.61509954700268, -1.36470926308715, 0.181025073906507, -0.591842094590322,
			 "W:Y", "<unicode>", 0.133383819122011, "W", 0.394327229782336,
			 -1.50089075744785, -0.544848123217783, 0.0642086785857168, -0.240319722316033,
			 "Y", "<unicode>", 0.12193249547176, "W", 0.155374488155819,
			 -1.54671288168638, 1.68041085583204, 2.96919100619339, 2.32480093101272,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.32877648786587,
			 7.07106808672145, 0.738695301327335, 1.30523287715429, 1.02196408924081,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.144527547520191,
			 7.0710678121625, -0.00168489916059455, 0.000685683672323403,
			 -0.000499607744135574, "jasp:Y", "<unicode>", 0.408726337889388,
			 "jasp", 0.000604751631054654, -0.826137075917074, 0.00465468573718834,
			 0.00822456680453867, 0.00643962627086351, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.000910700680091344, 7.0710678180427,
			 -0.0469589023026416, 0.233740331160084, 0.0933907144287213,
			 "Z:Y", "<unicode>", 0.192169124026737, "Z", 0.0716082631305589,
			 1.3041890746386, 0.377834932996914, 0.667622705598703, 0.522728819297808,
			 "Z", "<unicode>", 1.53943524594524e-12, "Z", 0.0739268106168273,
			 7.07089640329789, 0.0176094250720112, 0.438350065552954, 0.227979745312483,
			 "Z:Y", "<unicode>", 0.03366794560164, "Y", 0.107333768324237,
			 2.1240262861525, 0.482752857869879, 0.854946581514406, 0.668849719692143,
			 "jasp:Y", "<unicode>", 1.86406445834564e-12, "Y", 0.0949491231931667,
			 7.04429590499134, 1.44041329388529, 2.74027809713898, 2.09034569551214,
			 "W:Y", "<unicode>", 2.9055513550702e-10, "Y", 0.331604257401376,
			 6.30373600113936, 0.732634560560441, 1.29452383933078, 1.01357919994561,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341735665158,
			 7.07106827779247, -0.115706795179497, 0.940930733959947, 0.412611969390225,
			 "Z:Y", "<unicode>", 0.1258402465231, "W:Y", 0.26955534322928,
			 1.53071337576589, 0.909631855075643, 1.76053338082057, 1.33508261794811,
			 "jasp:Y", "<unicode>", 7.72631736367657e-10, "W:Y", 0.217070704476392,
			 6.15045047726977, 4.72565893559722, 8.34997246303521, 6.53781569931622,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.924586766906463,
			 7.0710677821951, -0.0017611455526679, 0.276862565911951, 0.137550710179642,
			 "Z:Y", "<unicode>", 0.052967400120371, "jasp:Y", 0.0710787835037703,
			 1.93518661123886, 0.323887440903829, 0.572290725846207, 0.448089083375018,
			 "jasp:Y", "<unicode>", 1.53743684450092e-12, "jasp:Y", 0.0633693493609452,
			 7.07106965581656, 0.784505377602601, 1.38617669518646, 1.08534103639453,
			 "Z:Y", "<unicode>", 1.53743684450092e-12, "Z:Y", 0.153490401438435,
			 7.07106780764957))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.246044834214907, 0.136942694251765, -0.0545510699815714,
			 -0.0789728356864833, "W", "M", "", "", "<unicode>", "", "",
			 0.576614003438866, 0.0977026954290051, -0.558337410672672, 50,
			 -0.167681938414702, 0.106697150910375, -0.0304923937521636,
			 -0.0441434201435585, "W", "M", "", "", "<unicode>", "", "",
			 0.663104607387166, 0.069995951836193, -0.435630817958201, 84,
			 -0.223666281568663, 0.215195468715402, -0.00423540642663046,
			 -0.00613153978297326, "W", "M", "", "", "<unicode>", "", "",
			 0.969822592526969, 0.111956585362219, -0.0378307931858358, 0,
			 16, -0.0261686553943585, 0.0522776031392599, 0.0130544738724507,
			 0.018898782745248, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.514190371067555, 0.0200121683746213, 0.652326805775125,
			 0, 50, -0.0226271334175904, 0.0237490340183579, 0.000560950300383777,
			 0.000812080054808403, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.962183182353643, 0.0118308723532059, 0.0474141114566056,
			 0, 84, -0.100775442404301, 0.0326690080235148, -0.0340532171903933,
			 -0.0492983753880825, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.317159275560708, 0.0340425771800934, -1.00031255008232,
			 16, -0.0235551318122127, 0.0867319597005798, 0.0315884139441835,
			 0.0457301135404561, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.261545707160029, 0.0281349791074538, 1.12274524262273,
			 50, -0.0276049089442943, 0.0130497117777039, -0.00727759858329519,
			 -0.0105356796357049, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.482861441924613, 0.0103712672892657, -0.701707745091821,
			 84, -0.0684396425303291, 0.0609393456860465, -0.00375014842214129,
			 -0.00542903842659252, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.909537371512915, 0.0330054504156455, -0.113622094984761,
			 0, 16, -0.00580562173859469, 0.00397421003105186, -0.000915705853771415,
			 -0.00132565480294834, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.713595928653206, 0.00249490088766646, -0.367030954334982,
			 0, 50, -0.00250199874237635, 0.0050493828680841, 0.00127369206285388,
			 0.00184390652701987, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.508500397158382, 0.00192640825801514, 0.661174523912295,
			 0, 84, -0.00941670822155683, 0.0105710069323353, 0.000577149355389233,
			 0.00083553120452287, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.909880938072264, 0.0050990006223463, 0.113188720326859
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167724771373194, 0.106560187163106, -0.0305822921050441, -0.0442735647558075,
			 "W", "<unicode>", 0.662064138400507, "M", 0.0699719384386203,
			 -0.437065097630117, 0, -2.55829548063896, 2.42017038036213,
			 -0.0690625501384134, -0.0655728687998259, "jasp", "<unicode>",
			 0.956633813486096, "M", 1.27004013856137, -0.054378242105516,
			 -0.450845436935898, 0.102063123318548, -0.174391156808675, -0.165406559021809,
			 "Z", "<unicode>", 0.21632024469372, "M", 0.141050693945327,
			 -1.2363722001699, -3.31235460476084, 0.504649067267509, -1.40385276874666,
			 -1.3419365487158, "Y", "<unicode>", 0.14938498744627, "M", 0.973743319299841,
			 -1.4417072147474, -0.125417988864249, 0.174812688249158, 0.0246973496924546,
			 0.0359959512511045, "W:Y", "<unicode>", 0.747105629517456, "M",
			 0.0765908658224306, 0.322458160346605, 0, -0.267223198615974,
			 5.10203571529411, 2.41740625833907, 2.3107877716092, "jasp:Y",
			 "<unicode>", 0.0775851650492427, "M", 1.36973407579479, 1.7648726866464,
			 -0.0582256178281398, 0.349435662191279, 0.14560502218157, 0.139037985961446,
			 "Z:Y", "<unicode>", 0.161487311301786, "M", 0.103997135466519,
			 1.4000868536273, -0.0197475152189273, 0.00116000330583087, -0.00929375595654823,
			 -0.173521417114771, "W", "<unicode>", 0.0814251484604616, "jasp",
			 0.00533364865111656, -1.74247622302655, -0.0185476061003881,
			 0.0350787535897586, 0.00826557374468525, 0.101899202707629,
			 "Y", "<unicode>", 0.54571802974128, "jasp", 0.0136804451798973,
			 0.604188945315248, -0.0145563051023398, 0.00654285974885901,
			 -0.00400672267674039, -0.0753147346683682, "W:Y", "<unicode>",
			 0.456638934226905, "jasp", 0.00538253891847665, -0.7443926996954,
			 -0.0547758699327568, 0.137432651160341, 0.0413283906137922,
			 0.0630804356795265, "W", "<unicode>", 0.39930837583896, "Z",
			 0.0490336869986424, 0.842857087514885, 0, -0.977008914700122,
			 2.54117094346879, 0.782081014384332, 0.782897756256386, "jasp",
			 "<unicode>", 0.38354209800818, "Z", 0.897511353759524, 0.871388435487001,
			 -1.86860394649157, 0.794592138563953, -0.537005903963806, -0.541204265081335,
			 "Y", "<unicode>", 0.429286688112329, "Z", 0.679399240512191,
			 -0.790412870581021, 0.0430181937427995, 0.248350079596133, 0.145684136669466,
			 0.223865567367468, "W:Y", "<unicode>", 0.00541565072792127,
			 "Z", 0.0523815456490438, 2.78121110907168, 0, -0.509305831875311,
			 3.22687390392131, 1.358784036023, 1.36940713350079, "jasp:Y",
			 "<unicode>", 0.15398092077286, "Z", 0.953124589346318, 1.42561009464135
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.201006634210193, 0.179358858172776, -0.0108238880187085,
			 -0.0156695942037275, "Total", "W", "M", "<unicode>", 0.911182114283134,
			 0.0970337963817813, -0.111547609413546, 50, -0.171679900805627,
			 0.0998092008611849, -0.0359353499722211, -0.0520231131974351,
			 "Total", "W", "M", "<unicode>", 0.603860561644973, 0.0692586965393965,
			 -0.518856862282702, 84, -0.245859672355592, 0.16293642698804,
			 -0.0414616226837759, -0.0600234223931254, "Total", "W", "M",
			 "<unicode>", 0.690944456240335, 0.104286635511714, -0.397573691780655,
			 16, -0.0230433390984425, 0.110497703024168, 0.0437271819628628,
			 0.0633032414827558, "Total indirect", "W", "M", "<unicode>",
			 0.199297359495295, 0.034067218371349, 1.2835559829457, 50, -0.036145183363044,
			 0.025259270922929, -0.00544295622005754, -0.00787969305387664,
			 "Total indirect", "W", "M", "<unicode>", 0.728240814327192,
			 0.0156646894459091, -0.347466589673056, 84, -0.125319972164542,
			 0.0508675396502516, -0.0372262162571454, -0.0538918826101521,
			 "Total indirect", "W", "M", "<unicode>", 0.407539282074054,
			 0.0449466197349897, -0.82823172191002))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "Z", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "Z", processIndependent = "jasp",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "Z",
            processType = "moderators", processVariable = "med")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(504.655507907653, 616.677825905141, 1, "Model 1", 100, -209.327753953827,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.12899845157813, 0.00351611484165393, -0.0627411683682382, "Z:medexperimental",
			 "<unicode>", 0.0634601998813027, "sm", 0.0338053575129549, -1.85595340455117,
			 -0.00887387323411995, 0.0568584608951052, 0.0239922938304926,
			 "jasp:medexperimental", "<unicode>", 0.152495219392458, "sm",
			 0.0167687607138992, 1.43077322408245, 0.0922263568005168, 0.197773653947587,
			 0.145000005374052, "sm:medexperimental", "<unicode>", 7.23783502021291e-08,
			 "sm", 0.0269258256732303, 5.38516467921025, -0.00962232483175935,
			 0.0896223252684406, 0.0400000002183406, "medexperimental", "<unicode>",
			 0.114128622399044, "sm", 0.0253179780044504, 1.57990500707874,
			 0.180704812905931, 0.319295205602483, 0.250000009254207, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553416771266,
			 7.07106755005416, 0.748461126015617, 1.32248853790153, 1.03547483195858,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.146438255093913,
			 7.07106781144388, 0.00209870130274031, 0.00428660395784604,
			 0.00319265263029317, "jasp:medexperimental", "<unicode>", 1.06476738537253e-08,
			 "jasp", 0.00055814868853806, 5.72007548500308, 0.0047453536917451,
			 0.00838477196275474, 0.00656506282724992, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.000928440088623288, 7.07106781330903,
			 0.263016394771261, 0.555092861078419, 0.40905462792484, "Z:medexperimental",
			 "<unicode>", 4.02207485095118e-08, "Z", 0.074510671780456, 5.48987974675776,
			 0.683668012755212, 1.20866493434364, 0.946166473549428, "Z",
			 "<unicode>", 1.61048951952125e-12, "Z", 0.133930247119217, 7.06462127787461,
			 -0.0835911022909237, 0.0468204711570409, -0.0183853155669414,
			 "Z:medexperimental", "<unicode>", 0.580518029825818, "medexperimental",
			 0.0332688698559347, -0.552628197066986, 0.117847229386512, 0.209173215699139,
			 0.163510222542825, "jasp:medexperimental", "<unicode>", 2.24664731263147e-12,
			 "medexperimental", 0.0232978735918094, 7.01824661802221, 0.0922263543968417,
			 0.197773643977238, 0.14499999918704, "sm:medexperimental", "<unicode>",
			 7.23782873635059e-08, "medexperimental", 0.0269258237429208,
			 5.38516483549227, 0.180704805539811, 0.31929517991013, 0.24999999272497,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553370019811, 7.07106801756583, -0.131140952887006, -0.00978505035967756,
			 -0.070463001623342, "Z:medexperimental", "<unicode>", 0.0228441075816215,
			 "sm:medexperimental", 0.0309587072733399, -2.27603178004856,
			 0.0580068405629892, 0.127326336556466, 0.0926665885597278, "jasp:medexperimental",
			 "<unicode>", 1.60423607065141e-07, "sm:medexperimental", 0.0176838698415533,
			 5.24017589984637, 0.148828482199258, 0.262971525365631, 0.205900003782444,
			 "sm:medexperimental", "<unicode>", 1.53743684450092e-12, "sm:medexperimental",
			 0.0291186583189077, 7.07106768201428, -0.0523116014663778, 0.0336413397143894,
			 -0.0093351308759942, "Z:medexperimental", "<unicode>", 0.670302098306412,
			 "jasp:medexperimental", 0.0219271736263404, -0.425733431726022,
			 0.0796359436510858, 0.140712070923571, 0.110174007287329, "jasp:medexperimental",
			 "<unicode>", 1.53743684450092e-12, "jasp:medexperimental", 0.0155809310156325,
			 7.07107984604965, 0.319034374565936, 0.563715708312758, 0.441375041439347,
			 "Z:medexperimental", "<unicode>", 1.53743684450092e-12, "Z:medexperimental",
			 0.0624198545679505, 7.07106808393577))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0345966282182075, 1.17847272730419, 0.606534677761199, 0.57594719342334,
			 "s", "M", "", "", 0, "<unicode>", "", "", 0.0376612576641029,
			 "m", 0.291810489404074, 2.0785225335794, 0, -0.307634500840346,
			 0.879612202103832, 0.285988850631743, 0.271566460931307, "s",
			 "M", "", "", 1, "<unicode>", "", "", 0.345042772695577, "m",
			 0.302874622265773, 0.944248311371519, 0, -0.0184745294575053,
			 0.0173922239582716, -0.000541152749616829, -0.000513862469505572,
			 "s", "jasp", "M", "", 0, "<unicode>", "<unicode>", "", 0.952837934116891,
			 "m", 0.00914985012446383, -0.0591433457658456, 0, -0.066087221623922,
			 0.0606455678550871, -0.00272082688441747, -0.00258361585137261,
			 "s", "jasp", "M", "", 1, "<unicode>", "<unicode>", "", 0.932931643279973,
			 "m", 0.0323303873128948, -0.0841569529645654, 0, -0.0747982019566223,
			 0.0925091303272461, 0.00885546418531188, 0.0084088839945922,
			 "s", "Z", "M", "", 0, "<unicode>", "<unicode>", "", 0.835635680597596,
			 "m", 0.0426812261866972, 0.207479141920059, 0, -0.122561092661514,
			 0.1874968904843, 0.0324678989113932, 0.0308305459522827, "s",
			 "Z", "M", "", 1, "<unicode>", "<unicode>", "", 0.681455707098389,
			 "m", 0.0790978777139558, 0.410477497623993, 0, -0.00610425951706358,
			 0.00500147457317779, -0.000551392471942893, -0.000523585803638584,
			 "s", "jasp", "Z", "M", 0, "<unicode>", "<unicode>", "<unicode>",
			 0.845688978091378, "m", 0.00283314749093401, -0.194621873272511,
			 0, -0.00422952621844741, 0.00545046701457217, 0.000610470398062378,
			 0.000579684435735569, "s", "jasp", "Z", "M", 1, "<unicode>",
			 "<unicode>", "<unicode>", 0.804744998206189, "m", 0.00246943140521309,
			 0.247210915344174))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0345966282182075, 1.17847272730419, 0.606534677761199, 0.57594719342334,
			 "sm", "<unicode>", 0.0376612576641029, "M", 0.291810489404074,
			 2.0785225335794, 0, -3.54941875760483, 3.33345905448903, -0.107979851557897,
			 -0.102534438229639, "jasp", "<unicode>", 0.950963761827744,
			 "M", 1.7558684410492, -0.0614965501022244, -0.121894547986997,
			 0.422376825449602, 0.150241138731303, 0.142596571443891, "Z",
			 "<unicode>", 0.279225737904262, "M", 0.138847289473108, 1.08206029301278,
			 0, -3.31646428678463, 3.35029189372423, 0.0169138034697976,
			 0.0160608420189607, "medexperimental", "<unicode>", 0.992065168711491,
			 "M", 1.70073435866561, 0.00994500016044129, 0, -1.14486482845729,
			 0.503773174198381, -0.320545827129456, -0.304380732492034, "sm:medexperimental",
			 "<unicode>", 0.445967914102935, "M", 0.420578647276154, -0.762154306228923,
			 0, -4.67371878929309, 5.1952057640416, 0.260743487374255, 0.247594218867964,
			 "jasp:medexperimental", "<unicode>", 0.917512914277859, "M",
			 2.51762905624274, 0.103567079005429, 0, -0.631934802902563,
			 0.196704100897198, -0.217615351002683, -0.206542650092921, "Z:medexperimental",
			 "<unicode>", 0.30327156200146, "M", 0.211391359824966, -1.02944297809934,
			 0, -0.0404917957018769, 0.0505150128448765, 0.00501160857149976,
			 0.061368580646868, "sm", "<unicode>", 0.82909332345686, "jasp",
			 0.0232164491961596, 0.215864559181977, 0, -0.048849601823763,
			 0.0421572067231642, -0.00334619755029936, -0.0409751462621602,
			 "medexperimental", "<unicode>", 0.885397450599814, "jasp", 0.0232164491962039,
			 -0.144130462071112, 0, -0.0871738373841078, 0.0415292255305469,
			 -0.0228223059267805, -0.279465664932405, "sm:medexperimental",
			 "<unicode>", 0.486991192162972, "jasp", 0.0328330173232386,
			 -0.695102302115476, 0, -0.487522911704519, 0.60540625923624,
			 0.0589416737658609, 0.058969748777592, "sm", "<unicode>", 0.832573808307123,
			 "Z", 0.27881358523974, 0.211401728201943, 0, -3.63372130967659,
			 2.1691017890337, -0.732309760321447, -0.732658573034054, "jasp",
			 "<unicode>", 0.620818602196822, "Z", 1.48033921655761, -0.494690508858076,
			 0, -3.99012330099324, 2.37922626788325, -0.805448516554993,
			 -0.805832166612861, "medexperimental", "<unicode>", 0.620104581901224,
			 "Z", 1.62486393094902, -0.495702133091578, 0, -1.31510022497457,
			 0.233408980717787, -0.540845622128389, -0.541103236923081, "sm:medexperimental",
			 "<unicode>", 0.17096561092389, "Z", 0.395035117457973, -1.36910770264856,
			 0, -3.46987523308687, 5.95196092986676, 1.24104284838995, 1.24163398010205,
			 "jasp:medexperimental", "<unicode>", 0.605622323115641, "Z",
			 2.40357379963914, 0.516332325047091))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0, 0.0368779733262666, 1.19171722012364, 0.614297596724951, 0.583318629144788,
			 "Total", "s", "M", 0, "<unicode>", 0.0370565295778811, "m",
			 0.294607262150375, 2.08514071323672, 0, -0.256333960291747,
			 0.889026746405309, 0.316346393056781, 0.300393075467952, "Total",
			 "s", "M", 1, "<unicode>", 0.278952056633762, "m", 0.292189222794785,
			 1.08267645887461, 0, -0.0780757318196151, 0.0936015697471194,
			 0.00776291896375215, 0.00737143572144804, "Total indirect",
			 "s", "M", 0, "<unicode>", 0.859310735311572, "m", 0.04379603475393,
			 0.177251639500436, 0, -0.13454604084107, 0.195261125691146,
			 0.0303575424250381, 0.0288266145366457, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.718237733258907, "m", 0.0841360272774634,
			 0.360815020715503))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")

})

###--------------------------------------------------------------------------------------------------------------------------###

