### This code was automatically generated by 'generate-tests.R'

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1333.40664843794, 1369.87903104177, 0, "Model 1", 100, -652.70332421897,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.675381722998741, 0.224488197110962, -0.22544676294389, "W:Y",
			 "<unicode>", 0.326065462792994, "W", 0.229562871360842, -0.982069799037832,
			 -0.544848205701879, 0.0642086466981471, -0.240319779501866,
			 "Y", "<unicode>", 0.121932437679512, "W", 0.155374501063333,
			 -1.54671312124702, 1.68041092063189, 2.96919123220434, 2.32480107641811,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776528991905,
			 7.071067644477, 0.776405337505128, 1.37186438136359, 1.07413485943436,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.151905608612038,
			 7.07106781144377, -0.253361698606692, 0.338176443789414, 0.0424073725913608,
			 "W:Y", "<unicode>", 0.778695322956574, "Y", 0.150905360267353,
			 0.281019657063403, 0.732634565500116, 1.29452385651376, 1.01357921100694,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341738788506,
			 7.07106820088477, 1.62270000963932, 2.86721932104458, 2.24495966534195,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.317485250040783,
			 7.07106760094703))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.165696130355591, 0.204092403438177, 0.0191981365412929,
			 0.0277957862185037, "W", "M", "<unicode>", 0.83873717456654,
			 0.0943355430790087, 0.20350904775323, 50, -0.161248077722542,
			 0.108819822183453, -0.0262141277695441, -0.037953802954759,
			 "W", "M", "<unicode>", 0.70358348416319, 0.0688961384077096,
			 -0.380487620574838, 84, -0.278337539417184, 0.126796620792793,
			 -0.0757704593121953, -0.109703328976208, "W", "M", "<unicode>",
			 0.463481047245213, 0.103352450199499, -0.733126879584731))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.16400084337535, 0.107013647731971, -0.0284935978216894, -0.0412541056755274,
			 "W", "<unicode>", 0.680245090621713, "M", 0.0691376201922709,
			 -0.412128704205453, -0.0406635365555035, 0.367940993270762,
			 0.163638728357629, 0.156437883189401, "Y", "<unicode>", 0.116447616301428,
			 "M", 0.104237764838866, 1.56986029593581, -0.182864249528364,
			 0.0896343905449168, -0.0466149294917235, -0.0679475443051858,
			 "W:Y", "<unicode>", 0.502499754238166, "M", 0.0695162365795278,
			 -0.670561753417062))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.165696130355591, 0.204092403438177, 0.0191981365412929,
			 0.0277957862185037, "Total", "W", "M", "<unicode>", 0.83873717456654,
			 0.0943355430790087, 0.20350904775323, 50, -0.161248077722542,
			 0.108819822183453, -0.0262141277695441, -0.037953802954759,
			 "Total", "W", "M", "<unicode>", 0.70358348416319, 0.0688961384077096,
			 -0.380487620574838, 84, -0.278337539417184, 0.126796620792793,
			 -0.0757704593121953, -0.109703328976208, "Total", "W", "M",
			 "<unicode>", 0.463481047245213, 0.103352450199499, -0.733126879584731
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-1")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0314706489341492))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 1 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(608.281967358097, 644.75434996193, 0, "Model 1", 100, -290.140983679048,
			 1))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.0922263538721806, 0.197773641622861, 0.144999997747521, "sm:medexperimental",
			 "<unicode>", 7.23782711542498e-08, "sm", 0.0269258232761479,
			 5.38516487538445, -0.00962232589632599, 0.0896223214078034,
			 0.0399999977557387, "medexperimental", "<unicode>", 0.114128634482363,
			 "sm", 0.025317977291154, 1.57990495432329, 0.180704807176402,
			 0.319295185614934, 0.249999996395668, "sm", "<unicode>", 1.53743684450092e-12,
			 "sm", 0.0353553380398097, 7.07106791382311, 0.758630464113866,
			 1.34045718397482, 1.04954382404434, "M", "<unicode>", 1.53743684450092e-12,
			 "M", 0.148427911035695, 7.07106781144378, 0.0922263529382155,
			 0.197773641233986, 0.144999997086101, "sm:medexperimental",
			 "<unicode>", 7.23782922484872e-08, "medexperimental", 0.0269258234152041,
			 5.38516482300868, 0.180704808401201, 0.319295189890202, 0.249999999145701,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553388180047, 7.07106783596679, 0.148828479355192, 0.262971515447246,
			 0.205899997401219, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186565142012, 7.07106790111698
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "s", "M", 0, "<unicode>", 0.0363780103764788, "m", 0.293546322885821,
			 2.0926768587866, 1, -0.258993824576918, 0.891686616757542, 0.316346396090312,
			 0.300393048770642, "s", "M", 1, "<unicode>", 0.281180548783797,
			 "m", 0.293546322894421, 1.07767112519441))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "sm", "<unicode>", 0.0363780103764788, "M", 0.293546322885821,
			 2.0926768587866, 1, -0.42756656705304, 0.723113874251726, 0.147773653599343,
			 0.140321428918731, "medexperimental", "<unicode>", 0.614677241563612,
			 "M", 0.293546322886846, 0.50340829394857, 1, -1.1116051438429,
			 0.515702742253405, -0.297951200794745, -0.282925523090377, "sm:medexperimental",
			 "<unicode>", 0.472931529520476, "M", 0.415137191022972, -0.717717437121305
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0389573762346829, 1.18963781753543, 0.614297596885057, 0.583318571861019,
			 "Total", "s", "M", 0, "<unicode>", 0.0363780103764788, "m",
			 0.293546322885821, 2.0926768587866, 1, -0.258993824576918, 0.891686616757542,
			 0.316346396090312, 0.300393048770642, "Total", "s", "M", 1,
			 "<unicode>", 0.281180548783797, "m", 0.293546322894421, 1.07767112519441
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-1")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-1")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0536439730009107))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1837.46300634853, 1907.80260137021, 0, "Model 1", 100, -891.731503174267,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.775624689733015, 0.164689400409525, -0.305467644661745, "W:Z",
			 "<unicode>", 0.202870403667573, "W", 0.239880451263293, -1.27341616648229,
			 -0.403934247331162, 0.194627962768759, -0.104653142281202, "Z",
			 "<unicode>", 0.493114477622437, "W", 0.152697247199771, -0.685363647350407,
			 -0.675381680947338, 0.224488185135068, -0.225446747906135, "W:Y",
			 "<unicode>", 0.326065466016459, "W", 0.229562857578115, -0.982069792494287,
			 -0.544848197898397, 0.0642086879685395, -0.240319754964929,
			 "Y", "<unicode>", 0.121932496280058, "W", 0.155374509600967,
			 -1.54671287833582, 1.68041090560237, 2.96919117978223, 2.3248010426923,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776519452804,
			 7.07106774705676, 0.770361875844511, 1.36118592585801, 1.06577390085126,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150723190495805,
			 7.0710678120957, -0.0338674905423157, 0.591585868307589, 0.278859188882637,
			 "W:Z", "<unicode>", 0.0805151305015546, "Y", 0.159557360181973,
			 1.74770495428479, 0.424979192222742, 0.89676313844437, 0.660871165333556,
			 "Z", "<unicode>", 3.99656121530256e-08, "Y", 0.120355259061646,
			 5.49100363778086, -0.253361685174955, 0.338176476041579, 0.0424073954333115,
			 "W:Y", "<unicode>", 0.778695213717484, "Y", 0.150905365068571,
			 0.281019799488519, 0.73263459974155, 1.29452397594592, 1.01357928784373,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341760521234,
			 7.07106766484555, 1.30470736512547, 2.48432038123702, 1.89451387318124,
			 "W:Z", "<unicode>", 3.06236147551431e-10, "W:Y", 0.300927217391796,
			 6.29558831401633, -0.0195935056357645, 0.577311867854198, 0.278859181109217,
			 "Z", "<unicode>", 0.0670570040141643, "W:Y", 0.152274577032608,
			 1.83129177925415, 1.62269996480201, 2.86721916465461, 2.24495956472831,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.317485221582948,
			 7.07106791785514, 0.00878386518034341, 0.632731109564669, 0.320757487372506,
			 "W:Z", "<unicode>", 0.043889109808332, "Z", 0.159173140247969,
			 2.01514832761866, 0.721541834256799, 1.27492369186369, 0.998232763060245,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171435284499,
			 7.07106760690312, 1.76008415582767, 3.10996926585283, 2.43502671084025,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 0.344364774218529,
			 7.07106792896017))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175160351579504, 0.198984796441373, 0.0119122224309348,
			 0.0172469648213625, "W", "M", "<unicode>", 0.900678206787937,
			 0.095446944681659, 0.124804649019046, 50, 16, -0.250371111510101,
			 0.256910072711928, 0.00326948060091355, 0.00473367729951449,
			 "W", "M", "<unicode>", 0.97984411089723, 0.129410843317377,
			 0.0252643481574047, 84, 16, -0.47765350739004, 0.465329609138992,
			 -0.0061619491255241, -0.00892150229859335, "W", "M", "<unicode>",
			 0.979564519682945, 0.240561337852931, -0.025614877188999, 16,
			 50, -0.285608440931021, 0.255942799081704, -0.014832820924658,
			 -0.0214755174504471, "W", "M", "<unicode>", 0.914499506761818,
			 0.138153365134363, -0.107364890534749, 50, 50, -0.158318499408918,
			 0.111367373899559, -0.0234755627546792, -0.0339888049722951,
			 "W", "M", "<unicode>", 0.732937126882906, 0.0687986808522311,
			 -0.341221117380159, 84, 50, -0.322683622136872, 0.256869637174638,
			 -0.0329069924811169, -0.047643984570403, "W", "M", "<unicode>",
			 0.823867674104949, 0.147847935952638, -0.222573228831943, 16,
			 84, -0.537949356676081, 0.445585122938418, -0.0461821168688316,
			 -0.0668642102370723, "W", "M", "<unicode>", 0.853965416366082,
			 0.250906263424352, -0.184061235612619, 50, 84, -0.350935389475088,
			 0.241285672077382, -0.0548248586988528, -0.0793774977589204,
			 "W", "M", "<unicode>", 0.716689080475998, 0.151079577539137,
			 -0.362887291531183, 84, 84, -0.277368607196611, 0.148856030346031,
			 -0.0642562884252905, -0.0930326773570282, "W", "M", "<unicode>",
			 0.554549878660378, 0.108732772873545, -0.590956035858849))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.160420800120978, 0.110370004202862, -0.0250253979590581, -0.0362327148223511,
			 "W", "<unicode>", 0.717154764569864, "M", 0.069080556188737,
			 -0.362263990618221, -0.0307793197461954, 0.533528787603149,
			 0.251374733928477, 0.240313116185541, "Y", "<unicode>", 0.0807835825430443,
			 "M", 0.143958795110659, 1.74615752886268, -0.250026021008778,
			 0.232282761246879, -0.00887162988094972, -0.0129315970063515,
			 "W:Y", "<unicode>", 0.942519542827187, "M", 0.123040215549889,
			 -0.0721034975540376, -0.401740418227149, 0.153960925114664,
			 -0.123889746556243, -0.11753799060502, "Z", "<unicode>", 0.38216146476789,
			 "M", 0.14176315170205, -0.87392065617042, -0.259036958393976,
			 0.202955928082395, -0.0280405151557903, -0.0405622260861832,
			 "W:Z", "<unicode>", 0.811944062987794, "M", 0.117857493841854,
			 -0.237918813999355))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175160351579504, 0.198984796441373, 0.0119122224309348,
			 0.0172469648213625, "Total", "W", "M", "<unicode>", 0.900678206787937,
			 0.095446944681659, 0.124804649019046, 50, 16, -0.250371111510101,
			 0.256910072711928, 0.00326948060091355, 0.00473367729951449,
			 "Total", "W", "M", "<unicode>", 0.97984411089723, 0.129410843317377,
			 0.0252643481574047, 84, 16, -0.47765350739004, 0.465329609138992,
			 -0.0061619491255241, -0.00892150229859335, "Total", "W", "M",
			 "<unicode>", 0.979564519682945, 0.240561337852931, -0.025614877188999,
			 16, 50, -0.285608440931021, 0.255942799081704, -0.014832820924658,
			 -0.0214755174504471, "Total", "W", "M", "<unicode>", 0.914499506761818,
			 0.138153365134363, -0.107364890534749, 50, 50, -0.158318499408918,
			 0.111367373899559, -0.0234755627546792, -0.0339888049722951,
			 "Total", "W", "M", "<unicode>", 0.732937126882906, 0.0687986808522311,
			 -0.341221117380159, 84, 50, -0.322683622136872, 0.256869637174638,
			 -0.0329069924811169, -0.047643984570403, "Total", "W", "M",
			 "<unicode>", 0.823867674104949, 0.147847935952638, -0.222573228831943,
			 16, 84, -0.537949356676081, 0.445585122938418, -0.0461821168688316,
			 -0.0668642102370723, "Total", "W", "M", "<unicode>", 0.853965416366082,
			 0.250906263424352, -0.184061235612619, 50, 84, -0.350935389475088,
			 0.241285672077382, -0.0548248586988528, -0.0793774977589204,
			 "Total", "W", "M", "<unicode>", 0.716689080475998, 0.151079577539137,
			 -0.362887291531183, 84, 84, -0.277368607196611, 0.148856030346031,
			 -0.0642562884252905, -0.0930326773570282, "Total", "W", "M",
			 "<unicode>", 0.554549878660378, 0.108732772873545, -0.590956035858849
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-2")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0390095854286633))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 2 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1050.43314292912, 1120.7727379508, 0, "Model 1", 100, -498.21657146456,
			 2))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0981744991413525, 0.0336487149153186, -0.0322628921130169,
			 "sm:Z", "<unicode>", 0.337368653068427, "sm", 0.0336289888733864,
			 -0.959377406037605, -0.163250739174581, 0.0341991730101249,
			 -0.0645257830822279, "Z", "<unicode>", 0.200188179431626, "sm",
			 0.050370801132614, -1.28101562078291, 0.0922263543227194, 0.197773644838652,
			 0.144999999580685, "sm:medexperimental", "<unicode>", 7.23783006861822e-08,
			 "sm", 0.0269258239815822, 5.38516480237961, -0.00962232422271023,
			 0.0896223247520133, 0.0400000002646515, "medexperimental", "<unicode>",
			 0.11412861787635, "sm", 0.0253179777173337, 1.57990502682471,
			 0.180704808647907, 0.319295190750696, 0.249999999699302, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553389745864,
			 7.07106782030863, 0.756348936486646, 1.33642585351419, 1.04638739500042,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.14798152455941,
			 7.07106781144378, -0.136062947076753, -0.00208333370350043,
			 -0.0690731403901267, "sm:Z", "<unicode>", 0.0432883140450078,
			 "medexperimental", 0.0341791008482979, -2.0209174225122, -0.170527221528211,
			 0.0272978559062019, -0.0716146828110045, "Z", "<unicode>", 0.155883375510316,
			 "medexperimental", 0.0504665083120996, -1.41905364976151, 0.0922263550607143,
			 0.197773645840852, 0.145000000450783, "sm:medexperimental",
			 "<unicode>", 7.23782931366657e-08, "medexperimental", 0.0269258240489829,
			 5.38516482121409, 0.180704808494571, 0.319295190215869, 0.24999999935522,
			 "medexperimental", "<unicode>", 1.53743684450092e-12, "medexperimental",
			 0.0353553388772654, 7.07106783004073, -0.144326952733985, -0.02092015663679,
			 -0.0826235546853873, "sm:Z", "<unicode>", 0.00867819782481938,
			 "sm:medexperimental", 0.0314819040223728, -2.62447768809251,
			 -0.192385822151482, -0.0102862393485235, -0.101336030750003,
			 "Z", "<unicode>", 0.0291546912933842, "sm:medexperimental",
			 0.0464548288232173, -2.18138852982613, 0.148828480580883, 0.262971519722387,
			 0.205900000151635, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186572921363, 7.07106780666153,
			 0.29409835469706, 0.610628759725269, 0.452363557211165, "sm:Z",
			 "<unicode>", 2.11779667136369e-08, "Z", 0.0807490360856017,
			 5.60209234858997, 0.721541822269099, 1.27492365005128, 0.998232736160188,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171427676014,
			 7.071067797452, 0.323967566964574, 0.572432394133148, 0.448199980548861,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0633850491969325,
			 7.07106780269805))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.16106889717011, 1.33098332537789, 0.584957214103892,
			 0.555457824221092, "s", "M", 0, "<unicode>", 0.124341589353832,
			 "m", 0.380632561189165, 1.53680287434259, 1, 16, -0.358877900054352,
			 1.00789437238385, 0.324508236164751, 0.308143287159944, "s",
			 "M", 1, "<unicode>", 0.352011057357969, "m", 0.348672802974731,
			 0.930695578766631, 1, 50, 0.0267415332094524, 1.18684672878008,
			 0.606794130994764, 0.576193505483665, "s", "M", 0, "<unicode>",
			 0.0403330123311754, "m", 0.29595064111417, 2.05032206962065,
			 1, 50, -0.238349546614714, 0.931039852725959, 0.346345153055623,
			 0.328878968422517, "s", "M", 1, "<unicode>", 0.245646434381766,
			 "m", 0.298319103964325, 1.1609888486962, 1, 84, -0.0593563775318314,
			 1.324137076267, 0.632390349367584, 0.600498906670031, "s", "M",
			 0, "<unicode>", 0.0731672040468849, "m", 0.352938488847665,
			 1.79178630087164, 1, 84, -0.399557678862569, 1.14344042171945,
			 0.371941371428442, 0.353184369608883, "s", "M", 1, "<unicode>",
			 0.344708449279814, "m", 0.393629197463064, 0.944902903101702
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0296856841708171, 1.18572499193542, 0.607705338053117, 0.577058760373841,
			 "sm", "<unicode>", 0.0393390236354538, "M", 0.29491340577768,
			 2.06062296981926, 1, -0.427734844432079, 0.721274257579114,
			 0.146769706573517, 0.139368110879328, "medexperimental", "<unicode>",
			 0.616571355507981, "M", 0.293119952987512, 0.500715509393421,
			 1, -1.08932599513214, 0.568428039253857, -0.260448977939141,
			 -0.247314537061147, "sm:medexperimental", "<unicode>", 0.537988184187588,
			 "M", 0.422904208307436, -0.615858089900596, -0.226807989820654,
			 0.320133541183857, 0.0466627756816015, 0.0442704014312395, "Z",
			 "<unicode>", 0.738053637803381, "M", 0.139528464634737, 0.334431944075046,
			 1, -0.392685638202431, 0.438474937617135, 0.022894649707352,
			 0.0217208539005045, "sm:Z", "<unicode>", 0.914014745958543,
			 "M", 0.212034655324193, 0.107975980022449))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.16106889717011, 1.33098332537789, 0.584957214103892,
			 0.555457824221092, "Total", "s", "M", 0, "<unicode>", 0.124341589353832,
			 "m", 0.380632561189165, 1.53680287434259, 1, 16, -0.358877900054352,
			 1.00789437238385, 0.324508236164751, 0.308143287159944, "Total",
			 "s", "M", 1, "<unicode>", 0.352011057357969, "m", 0.348672802974731,
			 0.930695578766631, 1, 50, 0.0267415332094524, 1.18684672878008,
			 0.606794130994764, 0.576193505483665, "Total", "s", "M", 0,
			 "<unicode>", 0.0403330123311754, "m", 0.29595064111417, 2.05032206962065,
			 1, 50, -0.238349546614714, 0.931039852725959, 0.346345153055623,
			 0.328878968422517, "Total", "s", "M", 1, "<unicode>", 0.245646434381766,
			 "m", 0.298319103964325, 1.1609888486962, 1, 84, -0.0593563775318314,
			 1.324137076267, 0.632390349367584, 0.600498906670031, "Total",
			 "s", "M", 0, "<unicode>", 0.0731672040468849, "m", 0.352938488847665,
			 1.79178630087164, 1, 84, -0.399557678862569, 1.14344042171945,
			 0.371941371428442, 0.353184369608883, "Total", "s", "M", 1,
			 "<unicode>", 0.344708449279814, "m", 0.393629197463064, 0.944902903101702
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-2")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-2")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0564900728003538))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "Y",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(2490.08046840291, 2604.70795658639, 0, "Model 1", 100, -1201.04023420145,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0310541992647796, 0.588772501561123, 0.278859151148172, "Y:Z",
			 "<unicode>", 0.0778043992224959, "W", 0.158121961861294, 1.76357001814074,
			 1.22954160081509, 2.60978668580103, 1.91966414330806, "W:Y:Z",
			 "<unicode>", 4.98371213186743e-08, "W", 0.35210980810697, 5.45189057251388,
			 -0.775624663938189, 0.164689438162457, -0.305467612887866, "W:Z",
			 "<unicode>", 0.202870456388791, "W", 0.239880454313886, -1.27341601783094,
			 -0.403934275954708, 0.194627924115918, -0.104653175919395, "Z",
			 "<unicode>", 0.493114331400875, "W", 0.15269724464123, -0.685363879127501,
			 -0.675381611815105, 0.224488242814218, -0.225446684500444, "W:Y",
			 "<unicode>", 0.326065595921039, "W", 0.229562854656357, -0.982069528791691,
			 -0.544848252372841, 0.0642086385304569, -0.240319806921192,
			 "Y", "<unicode>", 0.121932418695504, "W", 0.155374510885777,
			 -1.54671319993961, 1.68041090541622, 2.96919117913294, 2.32480104227458,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776519334655,
			 7.07106774832729, 0.760953920006849, 1.3445625993131, 1.05275825965997,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.148882500880037,
			 7.07106781144308, -0.0802370640463923, 0.325472001899913, 0.12261746892676,
			 "Y:Z", "<unicode>", 0.236128170825779, "Y", 0.103499112521068,
			 1.18472000329278, -0.62568429882036, 0.144132376334061, -0.240775961243149,
			 "W:Y:Z", "<unicode>", 0.220184410604674, "Y", 0.19638541351439,
			 -1.2260379064533, -0.0338675234686014, 0.591585840034788, 0.278859158283093,
			 "W:Z", "<unicode>", 0.0805151659795733, "Y", 0.159557361369108,
			 1.74770474950385, 0.424979185421517, 0.896763118827185, 0.660871152124351,
			 "Z", "<unicode>", 3.99656032712414e-08, "Y", 0.120355255792208,
			 5.49100367719159, -0.253361719195485, 0.33817643580048, 0.0424073583024978,
			 "W:Y", "<unicode>", 0.778695400172339, "Y", 0.150905363481662,
			 0.281019556390063, 0.732634598862432, 1.29452397287961, 1.01357928587102,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341759963266,
			 7.07106767860787, -0.382157333089835, 0.218246291168601, -0.0819555209606172,
			 "Y:Z", "<unicode>", 0.592599413461752, "W:Y", 0.153167004341494,
			 -0.535072950685208, -0.112986616650646, 1.03842478121499, 0.462719082282173,
			 "W:Y:Z", "<unicode>", 0.115185791857752, "W:Y", 0.293732794823738,
			 1.57530616409325, 1.30470737054231, 2.48432039903475, 1.89451388478853,
			 "W:Z", "<unicode>", 3.06236147551431e-10, "W:Y", 0.300927220550245,
			 6.29558828651132, -0.0195935361702901, 0.577311815889032, 0.278859139859371,
			 "Z", "<unicode>", 0.0670570346171937, "W:Y", 0.152274571565507,
			 1.83129157411162, 1.62269995760492, 2.86721913955153, 2.24495954857822,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.317485217015011,
			 7.07106796872396, -0.0710699446862795, 0.331977642448249, 0.130453848880985,
			 "Y:Z", "<unicode>", 0.204527530394373, "Z", 0.102820151368524,
			 1.26875760388075, -0.431825817642772, 0.326657293693125, -0.0525842619748237,
			 "W:Y:Z", "<unicode>", 0.785805398617907, "Z", 0.193494145126828,
			 -0.271761514749486, 0.00878383523275877, 0.632731072430478,
			 0.320757453831618, "W:Z", "<unicode>", 0.0438891294494426, "Z",
			 0.159173138414618, 2.01514814010956, 0.721541825498169, 1.27492366131409,
			 0.998232743406129, "Z", "<unicode>", 1.53743684450092e-12, "Z",
			 0.141171429725476, 7.07106774612475, -0.29564279620027, 0.328798830591744,
			 0.0165780171957369, "Y:Z", "<unicode>", 0.917115077613209, "W:Z",
			 0.159299260526604, 0.104068387643069, 0.096157831233314, 1.312088975663,
			 0.704123403448158, "W:Y:Z", "<unicode>", 0.0232101118020964,
			 "W:Z", 0.310192216290911, 2.26995832412443, 1.76008417377103,
			 3.10996932843826, 2.43502675110465, "W:Z", "<unicode>", 1.53743684450092e-12,
			 "W:Z", 0.344364785607018, 7.07106781203652, -0.0762745224375123,
			 0.708219160819034, 0.315972319190761, "Y:Z", "<unicode>", 0.114373134148656,
			 "W:Y:Z", 0.200129617034939, 1.57883837421024, 2.70902294589772,
			 4.78669052145376, 3.74785673367574, "W:Y:Z", "<unicode>", 1.53743684450092e-12,
			 "W:Y:Z", 0.530026978032356, 7.07106786826038, 0.753193285443269,
			 1.33085000510198, 1.04202164527262, "Y:Z", "<unicode>", 1.53743684450092e-12,
			 "Y:Z", 0.147364115926413, 7.07106773397239))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220191172868881, 0.191156353976921, -0.0145174094459799,
			 -0.0210188528071593, "W", "M", "<unicode>", 0.889969057978933,
			 0.104937521834702, -0.138343360812807, 50, 16, -0.253454408160212,
			 0.257892300706847, 0.0022189462733173, 0.00321267408482208,
			 "W", "M", "<unicode>", 0.98642847888311, 0.130447986009053,
			 0.0170101995531253, 84, 16, -0.4803972609044, 0.521362395834909,
			 0.0204825674652541, 0.0296554335170386, "W", "M", "<unicode>",
			 0.936118629153536, 0.255555628736309, 0.0801491540864817, 16,
			 50, -0.338196894672578, 0.282584917477004, -0.027805988597787,
			 -0.040258558778631, "W", "M", "<unicode>", 0.860623154226683,
			 0.158365617186395, -0.175580969479377, 50, 50, -0.212792238478888,
			 0.161539853207125, -0.0256261926358811, -0.0371025679909199,
			 "W", "M", "<unicode>", 0.788428252122745, 0.0954946352684786,
			 -0.268352170400298, 84, 50, -0.330678632811506, 0.284183671245559,
			 -0.0232474807829738, -0.0336585792756504, "W", "M", "<unicode>",
			 0.882177414837424, 0.156855510842806, -0.148209525174231, 16,
			 84, -0.687606944831184, 0.60084245874125, -0.0433822430449671,
			 -0.0628104473046378, "W", "M", "<unicode>", 0.894996602301238,
			 0.3286921121346, -0.131984436022006, 50, 84, -0.434120869583829,
			 0.317590930735879, -0.0582649694239747, -0.0843582197425236,
			 "W", "M", "<unicode>", 0.761255497280398, 0.191766738126087,
			 -0.303832510232642, 84, 84, -0.289299418680433, 0.140287799656908,
			 -0.0745058095117627, -0.107872320418685, "W", "M", "<unicode>",
			 0.49659570507576, 0.10959058985927, -0.679855903754497))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.215831969264593, 0.162413601362538, -0.0267091839510272, -0.0386705636535891,
			 "W", "<unicode>", 0.781934283615141, "M", 0.0964929900780536,
			 -0.276799215460336, -0.0417390627570132, 0.523442465305811,
			 0.240851701274399, 0.230253143926117, "Y", "<unicode>", 0.094825524117641,
			 "M", 0.144181610611446, 1.67047448182188, -0.240509127697856,
			 0.243737176098364, 0.00161402420025431, 0.00235265794054865,
			 "W:Y", "<unicode>", 0.989575637146163, "M", 0.123534490331428,
			 0.0130653730462164, -0.412302842510108, 0.141791394623524, -0.135255723943292,
			 -0.12832123955927, "Z", "<unicode>", 0.338636024876215, "M",
			 0.14135316809499, -0.956863760226439, -0.274754106234058, 0.214834194534698,
			 -0.0299599558496798, -0.0433388075561313, "W:Z", "<unicode>",
			 0.810425776280012, "M", 0.124897269702547, -0.239876787707465,
			 -0.168390699420641, 0.137059047008601, -0.0156658262060202,
			 -0.0228148677790248, "W:Y:Z", "<unicode>", 0.840663986372918,
			 "M", 0.0779222855212113, -0.201044234024113, -0.0892862785423073,
			 0.319128826401945, 0.114921273929819, 0.109767099307061, "Y:Z",
			 "<unicode>", 0.27002583053899, "M", 0.104189441276926, 1.10300307326122
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.220191172868881, 0.191156353976921, -0.0145174094459799,
			 -0.0210188528071593, "Total", "W", "M", "<unicode>", 0.889969057978933,
			 0.104937521834702, -0.138343360812807, 50, 16, -0.253454408160212,
			 0.257892300706847, 0.0022189462733173, 0.00321267408482208,
			 "Total", "W", "M", "<unicode>", 0.98642847888311, 0.130447986009053,
			 0.0170101995531253, 84, 16, -0.4803972609044, 0.521362395834909,
			 0.0204825674652541, 0.0296554335170386, "Total", "W", "M", "<unicode>",
			 0.936118629153536, 0.255555628736309, 0.0801491540864817, 16,
			 50, -0.338196894672578, 0.282584917477004, -0.027805988597787,
			 -0.040258558778631, "Total", "W", "M", "<unicode>", 0.860623154226683,
			 0.158365617186395, -0.175580969479377, 50, 50, -0.212792238478888,
			 0.161539853207125, -0.0256261926358811, -0.0371025679909199,
			 "Total", "W", "M", "<unicode>", 0.788428252122745, 0.0954946352684786,
			 -0.268352170400298, 84, 50, -0.330678632811506, 0.284183671245559,
			 -0.0232474807829738, -0.0336585792756504, "Total", "W", "M",
			 "<unicode>", 0.882177414837424, 0.156855510842806, -0.148209525174231,
			 16, 84, -0.687606944831184, 0.60084245874125, -0.0433822430449671,
			 -0.0628104473046378, "Total", "W", "M", "<unicode>", 0.894996602301238,
			 0.3286921121346, -0.131984436022006, 50, 84, -0.434120869583829,
			 0.317590930735879, -0.0582649694239747, -0.0843582197425236,
			 "Total", "W", "M", "<unicode>", 0.761255497280398, 0.191766738126087,
			 -0.303832510232642, 84, 84, -0.289299418680433, 0.140287799656908,
			 -0.0745058095117627, -0.107872320418685, "Total", "W", "M",
			 "<unicode>", 0.49659570507576, 0.10959058985927, -0.679855903754497
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-3")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0507455711611948))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 3 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "med",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1189.15287476073, 1303.7803629442, 0, "Model 1", 100, -550.576437380363,
			 3))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.132162252060028, 0.00110487515035852, -0.0655286884548349,
			 "medexperimental:Z", "<unicode>", 0.0539216915386194, "sm",
			 0.0339973408342146, -1.92746511482709, -0.104014145059652, 0.00267811654514293,
			 -0.0506680142572543, "sm:medexperimental:Z", "<unicode>", 0.0626639198679657,
			 "sm", 0.0272179138102459, -1.86156862022911, -0.0981744996535289,
			 0.0336487178150854, -0.0322628909192218, "sm:Z", "<unicode>",
			 0.337368683450125, "sm", 0.0336289897437961, -0.95937734570732,
			 -0.163250740113542, 0.0341991740110838, -0.0645257830512291,
			 "Z", "<unicode>", 0.200188184068395, "sm", 0.0503708016275007,
			 -1.28101560758168, 0.0922263558810982, 0.197773649663572, 0.145000002772335,
			 "sm:medexperimental", "<unicode>", 7.23783200040629e-08, "sm",
			 0.0269258248148989, 5.38516475425116, -0.00962232468024297,
			 0.0896223275209326, 0.0400000014203448, "medexperimental", "<unicode>",
			 0.114128619185499, "sm", 0.0253179785404234, 1.579905021109,
			 0.18070480979392, 0.319295194747925, 0.250000002270922, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553397019507,
			 7.0710677475722, 0.719380656934463, 1.27110499138534, 0.995242824159901,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.140748589974817,
			 7.07106781203256, -0.10156700017097, 0.0299523239475738, -0.0358073381116981,
			 "medexperimental:Z", "<unicode>", 0.285865181261787, "medexperimental",
			 0.0335514645054581, -1.06723621873117, -0.104014144746496, 0.00267811776732907,
			 -0.0506680134895834, "sm:medexperimental:Z", "<unicode>", 0.0626639260842026,
			 "medexperimental", 0.0272179140421456, -1.86156857616371, -0.136062947794497,
			 -0.00208332977903879, -0.0690731387867679, "sm:Z", "<unicode>",
			 0.0432883261516179, "medexperimental", 0.0341791020325558, -2.02091730557975,
			 -0.170527220694186, 0.0272978605626507, -0.0716146800657675,
			 "Z", "<unicode>", 0.155883399361431, "medexperimental", 0.0504665092872255,
			 -1.41905356794501, 0.0922263562767667, 0.197773651212699, 0.145000003744733,
			 "sm:medexperimental", "<unicode>", 7.23783291078917e-08, "medexperimental",
			 0.026925825109154, 5.3851647315141, 0.180704810898409, 0.319295198600317,
			 0.250000004749363, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.0353553404029595, 7.07106767747133, -0.141970627135782,
			 -0.0191649149301865, -0.0805677710329844, "medexperimental:Z",
			 "<unicode>", 0.0101199569922681, "sm:medexperimental", 0.0313285634772556,
			 -2.57170333045996, -0.12156150798086, -0.0223356538872879, -0.0719485809340739,
			 "sm:medexperimental:Z", "<unicode>", 0.00447842124214159, "sm:medexperimental",
			 0.0253131830166913, -2.84233637810905, -0.144326953854846, -0.0209201542305557,
			 -0.0826235540427008, "sm:Z", "<unicode>", 0.00867820025655619,
			 "sm:medexperimental", 0.0314819049221586, -2.62447759266772,
			 -0.192385821315982, -0.010286236241625, -0.101336028778803,
			 "Z", "<unicode>", 0.0291546964400404, "sm:medexperimental",
			 0.0464548294026663, -2.18138846018423, 0.148828481986781, 0.262971524626078,
			 0.205900003306429, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186581844469, 7.07106769831882,
			 0.292613742412889, 0.607946859933847, 0.450280301173368, "medexperimental:Z",
			 "<unicode>", 2.17507720723376e-08, "Z", 0.0804435999865982,
			 5.59746581764596, 0.176565802697346, 0.416086057991282, 0.296325930344314,
			 "sm:medexperimental:Z", "<unicode>", 1.23713626498656e-06, "Z",
			 0.0611032287284973, 4.84959529161695, 0.29409835516531, 0.610628764977457,
			 0.452363560071384, "sm:Z", "<unicode>", 2.11779727088413e-08,
			 "Z", 0.0807490373060165, 5.60209229934285, 0.721541822143798,
			 1.27492364961424, 0.998232735879018, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.141171427596488, 7.07106779944365, 0.18714334269484,
			 0.39626653250126, 0.29170493759805, "medexperimental:Z", "<unicode>",
			 4.55427482393134e-08, "sm:Z", 0.053348732797122, 5.46788878205158,
			 0.199503770483297, 0.380070524412694, 0.289787147447996, "sm:medexperimental:Z",
			 "<unicode>", 3.1543523348887e-10, "sm:Z", 0.0460637938639905,
			 6.29099609779496, 0.323967570265025, 0.572432405644934, 0.448199987954979,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0633850512916993,
			 7.07106768585473, 0.199059801728057, 0.379077759733557, 0.289068780730807,
			 "medexperimental:Z", "<unicode>", 3.08328695908244e-10, "sm:medexperimental:Z",
			 0.0459237923312515, 6.29453200741206, 0.206767458281118, 0.365346419796074,
			 0.286056939038596, "sm:medexperimental:Z", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental:Z", 0.0404545600750337, 7.07106784767965,
			 0.321764166308092, 0.568539105054067, 0.445151635681079, "medexperimental:Z",
			 "<unicode>", 1.53743684450092e-12, "medexperimental:Z", 0.0629539472899768,
			 7.07106789715081))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.879107828676405, 0.893321781716457, 0.00710697652002601,
			 0.00674857172663489, "s", "M", 0, "<unicode>", 0.987459462531521,
			 "m", 0.45215871933708, 0.015717880063102, 1, 16, -0.226237462684157,
			 1.45145417887676, 0.612608358096304, 0.581714521400136, "s",
			 "M", 1, "<unicode>", 0.15232707826413, "m", 0.427990426047198,
			 1.43135995763781, 1, 50, -0.070612527010772, 1.07521945149629,
			 0.502303462242757, 0.476972300939849, "s", "M", 0, "<unicode>",
			 0.0857243614003134, "m", 0.292309447404451, 1.71839626362726,
			 1, 50, -0.295305856059667, 0.864579215324608, 0.28463667963247,
			 0.270282453180792, "s", "M", 1, "<unicode>", 0.336073058808233,
			 "m", 0.295894485953135, 0.961953308171995, 1, 84, 0.299943515011945,
			 1.86555598871033, 1.08274975186114, 1.02814668682827, "s", "M",
			 0, "<unicode>", 0.0067090238253269, "m", 0.399398276205007,
			 2.71095249120548, 1, 84, -1.01441807738657, 0.814825140735038,
			 -0.0997964683257667, -0.0947637328846583, "s", "M", 1, "<unicode>",
			 0.830659212724649, "m", 0.466652252936903, -0.213856180266337
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, -0.0455078394976838, 1.09144170911166, 0.522966934806989, 0.4965937146772,
			 "sm", "<unicode>", 0.0713781760192134, "M", 0.29004347977245,
			 1.80306392413054, 1, -0.439133034050774, 0.692988161102001,
			 0.126927563525614, 0.120526607077699, "medexperimental", "<unicode>",
			 0.660312309499699, "M", 0.288811734318284, 0.439482016979731,
			 1, -1.0644564773762, 0.560424877065194, -0.252015800155501,
			 -0.239306644506609, "sm:medexperimental", "<unicode>", 0.543205466344686,
			 "M", 0.414518166470978, -0.607972871975795, -0.308134865875632,
			 0.319885281068596, 0.00587520759648194, 0.00557398901094286,
			 "Z", "<unicode>", 0.970746996839607, "M", 0.160212165095372,
			 0.0366714200072417, 1, -0.0759541812851811, 1.11431963677424,
			 0.519182727744528, 0.492564521609791, "sm:Z", "<unicode>", 0.0872983994949517,
			 "M", 0.303646859699501, 1.70982413010406, 1, -1.73253791660811,
			 0.00645663292900467, -0.863040641839552, -0.818793034052329,
			 "sm:medexperimental:Z", "<unicode>", 0.0517256684844991, "M",
			 0.443629210346231, -1.9454098641656, 1, -0.448506068293687,
			 0.74130125160207, 0.146397591654192, 0.138891869556676, "medexperimental:Z",
			 "<unicode>", 0.629578553663409, "M", 0.303527852879136, 0.482320124052954
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.879107828676405, 0.893321781716457, 0.00710697652002601,
			 0.00674857172663489, "Total", "s", "M", 0, "<unicode>", 0.987459462531521,
			 "m", 0.45215871933708, 0.015717880063102, 1, 16, -0.226237462684157,
			 1.45145417887676, 0.612608358096304, 0.581714521400136, "Total",
			 "s", "M", 1, "<unicode>", 0.15232707826413, "m", 0.427990426047198,
			 1.43135995763781, 1, 50, -0.070612527010772, 1.07521945149629,
			 0.502303462242757, 0.476972300939849, "Total", "s", "M", 0,
			 "<unicode>", 0.0857243614003134, "m", 0.292309447404451, 1.71839626362726,
			 1, 50, -0.295305856059667, 0.864579215324608, 0.28463667963247,
			 0.270282453180792, "Total", "s", "M", 1, "<unicode>", 0.336073058808233,
			 "m", 0.295894485953135, 0.961953308171995, 1, 84, 0.299943515011945,
			 1.86555598871033, 1.08274975186114, 1.02814668682827, "Total",
			 "s", "M", 0, "<unicode>", 0.0067090238253269, "m", 0.399398276205007,
			 2.71095249120548, 1, 84, -1.01441807738657, 0.814825140735038,
			 -0.0997964683257667, -0.0947637328846583, "Total", "s", "M",
			 1, "<unicode>", 0.830659212724649, "m", 0.466652252936903, -0.213856180266337
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-3")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-3")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.102606271915565))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(752.562510140221, 789.034892744054, 0, "Model 1", 100, -362.28125507011,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041090948925, 2.96919119333942, 2.32480105141434, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776521919768, 7.07106772052799,
			 0.797840916249275, 1.40973983836071, 1.10379037730499, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.156099532169473, 7.07106781144378,
			 -0.0121424137968223, 0.0193301860785469, 0.00359388614086233,
			 "Z", "<unicode>", 0.65442724539073, "jasp", 0.00802887199040927,
			 0.447620306458408, 0.00468047960561288, 0.00827014311820436,
			 0.00647531136190862, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000915747314977797, 7.07106781095571, 0.71813658599885,
			 1.26890681004607, 0.993521698022461, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.14050518999115, 7.07106761027861))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.179344122985565, 0.0952661457406548, -0.0420389886224553, -0.0608656330165494,
			 "W", "M", "", "<unicode>", "", 0.548448850577653, 0.0700549272569065,
			 -0.600086107695027, 1, -0.0210322557904551, 0.0260802310731064,
			 0.00252398764132562, 0.00365432448660699, "W", "jasp", "M",
			 "<unicode>", "<unicode>", 0.833663904059473, 0.0120187123934875,
			 0.210004829027547, -0.0114708037832485, 0.0087231507089643,
			 -0.00137382653714208, -0.00198907786743046, "W", "Z", "M", "<unicode>",
			 "<unicode>", 0.789716420289311, 0.00515161366522551, -0.266678875090285
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.179344122985565, 0.0952661457406548, -0.0420389886224553, -0.0608656330165494,
			 "W", "<unicode>", 0.548448850577653, "M", 0.0700549272569065,
			 -0.600086107695027, 1, -2.83802376964247, 2.28501281088312,
			 -0.27650547937968, -0.262561309188748, "jasp", "<unicode>",
			 0.832442407450932, "M", 1.30692110185071, -0.211570139152336,
			 -0.176275917663366, 0.237313209387021, 0.0305186458618272, 0.0289539724475132,
			 "Z", "<unicode>", 0.772389630562844, "M", 0.105509369129414,
			 0.2892505766421, -0.0194720938716615, 0.00121576385615511, -0.00912816500775321,
			 -0.170429713580783, "W", "<unicode>", 0.0837015016554032, "jasp",
			 0.00527761170383737, -1.72960147885, -0.173143922282752, 0.0831119763463519,
			 -0.0450159729681999, -0.0686979263738746, "W", "<unicode>",
			 0.491071189820954, "Z", 0.0653726039484443, -0.688606086483896
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023203447552, 0.0942455484110081, -0.0408888275182718, -0.0592003863973729,
			 "Total", "W", "M", "<unicode>", 0.55315171376746, 0.0689473770922336,
			 -0.593043988657802, -0.0240755715946421, 0.0263758938030092,
			 0.00115016110418354, 0.00166524661917653, "Total indirect",
			 "W", "M", "<unicode>", 0.928792570941724, 0.0128705082837251,
			 0.0893640778459331))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-4")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.00473076853113719, "jasp", 0.0290462872712278, "Z", 0.00471940508807034
			))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 4 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(526.059996537569, 562.532379141402, 0, "Model 1", 100, -249.029998268785,
			 4))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704808980374, 0.319295191910322, 0.250000000445348, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553391856002,
			 7.07106779920725, 0.759557816133643, 1.34209576261855, 1.0508267893761,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.148609349732928,
			 7.07106781144378, -0.0118702795224498, 0.0198380492378122, 0.00398388485768119,
			 "Z", "<unicode>", 0.62236169221471, "jasp", 0.00808900801503835,
			 0.492505984698583, 0.00480662801252419, 0.00849304022686789,
			 0.00664983411969604, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000940428559764784, 7.07106781333743, 0.709503768593746,
			 1.25365308817975, 0.98157842838675, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.138816152714588, 7.0710678058116))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.076124833544918, 0.887469273763213, 0.481797053654066, 0.457500030210376,
			 "s", "M", "", "<unicode>", "", 0.019925203998572, "m", 0.206979425800187,
			 2.3277533590183, 1, -0.021543163660255, 0.0216819906786552,
			 6.94135092001066e-05, 6.59129862152676e-05, "s", "jasp", "M",
			 "<unicode>", "<unicode>", 0.994977467819003, "m", 0.0110270277106785,
			 0.00629485215974263, 1, -0.0748789044359928, 0.0414053401103893,
			 -0.0167367821628017, -0.0158927463068384, "s", "Z", "M", "<unicode>",
			 "<unicode>", 0.572621481976697, "m", 0.0296648931979407, -0.564194923983868
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.076124833544918, 0.887469273763213, 0.481797053654066, 0.457500030210376,
			 "sm", "<unicode>", 0.019925203998572, "M", 0.206979425800187,
			 2.3277533590183, 1, -2.47474004315946, 2.45889351393993, -0.00792326460976673,
			 -0.00752369440792758, "jasp", "<unicode>", 0.994977122918426,
			 "M", 1.25860311618358, -0.00629528443707671, -0.138193827042656,
			 0.267884482770844, 0.0648453278640943, 0.0615207443560763, "Z",
			 "<unicode>", 0.531340797643182, "M", 0.103593309116033, 0.625960580055051,
			 1, -0.0407263673358594, 0.0232049257031912, -0.0087607208163341,
			 -0.107277532590422, "sm", "<unicode>", 0.591156437582189, "jasp",
			 0.0163093030135585, -0.537160957096143, 1, -0.646468583386574,
			 0.130262321067123, -0.258103131159725, -0.258331502214158, "sm",
			 "<unicode>", 0.192721909470704, "Z", 0.198149279930767, -1.30256910976364
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.062510799857417, 0.867748570143511, 0.465129685000464, 0.441673196889753,
			 "Total", "s", "M", "<unicode>", 0.0235575795468941, "m", 0.205421573211984,
			 2.26426892622653, 1, -0.0777843851887314, 0.0444496478815282,
			 -0.0166673686536016, -0.0158268333206231, "Total indirect",
			 "s", "M", "<unicode>", 0.59299115720012, "m", 0.0311827242833098,
			 -0.534506494755579))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-4")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-4")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0524871456084818, "jasp", 0.00287711725479745, "Z", 0.0166837912887763
			))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1632.07305708222, 1723.2540135918, 0, "Model 1", 100, -781.036528541108,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.775624681639219, 0.164689418589435, -0.305467631524892, "W:Z",
			 "<unicode>", 0.202870427934802, "W", 0.239880453836329, -1.27341609805905,
			 -0.403934266935277, 0.194627919522508, -0.104653173706385, "Z",
			 "<unicode>", 0.493114330710614, "W", 0.152697241168503, -0.68536388022164,
			 -0.675381645469622, 0.224488211854611, -0.225446716807506, "W:Y",
			 "<unicode>", 0.326065528042304, "W", 0.229562855343846, -0.982069666583581,
			 -0.544848227873033, 0.064208646255054, -0.24031979080899, "Y",
			 "<unicode>", 0.121932433434975, "W", 0.155374506606308, -1.54671313884149,
			 1.68041089306774, 2.96919113606215, 2.32480101456494, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776511497186, 7.07106783260836,
			 0.770087765807561, 1.36070158897981, 1.06539467739368, "M",
			 "<unicode>", 1.53743684450092e-12, "M", 0.150669560214099, 7.07106781143966,
			 0.00462621247917334, 0.00817425616842431, 0.00640023432379883,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.00090512981800622,
			 7.07106781422468, -0.0338675172826539, 0.591585843792492, 0.278859163254919,
			 "W:Z", "<unicode>", 0.0805151594055906, "Y", 0.159557360749647,
			 1.74770478744921, 0.42497917937352, 0.896763099491084, 0.660871139432302,
			 "Z", "<unicode>", 3.99655921690112e-08, "Y", 0.120355252402324,
			 5.49100372639444, -0.253361712053665, 0.338176442587176, 0.0424073652667557,
			 "W:Y", "<unicode>", 0.778695364646331, "Y", 0.150905363391067,
			 0.281019602708607, 0.732634592984875, 1.29452395237902, 1.01357927268195,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341756232833,
			 7.07106777061925, 1.3047073801261, 2.48432043384046, 1.89451390698328,
			 "W:Z", "<unicode>", 3.06236369596036e-10, "W:Y", 0.300927226984525,
			 6.29558822565665, -0.0195935309092111, 0.5773118228469, 0.278859145968844,
			 "Z", "<unicode>", 0.067057029408488, "W:Y", 0.152274571998369,
			 1.83129160902735, 1.62269996976224, 2.86721918195558, 2.24495957585891,
			 "W:Y", "<unicode>", 1.53743684450092e-12, "W:Y", 0.317485224731157,
			 7.07106788279649, 0.00878383976521929, 0.632731075890016, 0.320757457827618,
			 "W:Z", "<unicode>", 0.0438891264568135, "Z", 0.159173138140908,
			 2.01514816867949, 0.721541820724402, 1.27492364466346, 0.998232732693931,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171426695609,
			 7.07106782200553, 1.76008418232649, 3.10996935827922, 2.43502677030285,
			 "W:Z", "<unicode>", 1.53743684450092e-12, "W:Z", 0.344364791037094,
			 7.07106775628686))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.17662897078333, 0.198188722082243, 0.0107798756494563,
			 0.0156075103503007, "W", "M", "", "<unicode>", "", 0.91023797961525,
			 0.0956185153967336, 0.112738370855573, 50, 16, -0.253646429563072,
			 0.255689997310831, 0.00102178387387933, 0.00147937721231009,
			 "W", "M", "", "<unicode>", "", 0.993725661010209, 0.129935149546493,
			 0.00786379880614001, 84, 16, -0.482406641060446, 0.463153088367605,
			 -0.00962677634642022, -0.0139380097092644, "W", "M", "", "<unicode>",
			 "", 0.968165737736816, 0.241218649140113, -0.0399089223853022,
			 16, 50, -0.287063811396422, 0.254975631108205, -0.0160440901441088,
			 -0.0232292385485882, "W", "M", "", "<unicode>", "", 0.907630460149085,
			 0.138277908874899, -0.116027862112263, 50, 50, -0.162770604482548,
			 0.111166240643177, -0.0258021819196858, -0.0373573716865789,
			 "W", "M", "", "<unicode>", "", 0.711964477081129, 0.0698831323653148,
			 -0.36921902390987, 84, 50, -0.328505398120975, 0.255603913841005,
			 -0.0364507421399853, -0.0527747586081534, "W", "M", "", "<unicode>",
			 "", 0.8067513876668, 0.149010215639001, -0.24461908187753, 16,
			 84, -0.539352156680732, 0.444380366081745, -0.0474858952994934,
			 -0.0687518693610834, "W", "M", "", "<unicode>", "", 0.849920854228458,
			 0.250956785563927, -0.189219411592268, 50, 84, -0.354366568046264,
			 0.239878593896124, -0.0572439870750703, -0.082880002499074,
			 "W", "M", "", "<unicode>", "", 0.705721097057776, 0.151595939167688,
			 -0.377608974154312, 84, 84, -0.28428960751754, 0.1485045129268,
			 -0.0678925472953698, -0.0982973894206485, "W", "M", "", "<unicode>",
			 "", 0.538607348795464, 0.110408692164286, -0.614920310751866,
			 1, 16, 16, -0.0111490340445131, 0.0134137362877749, 0.00113235112163089,
			 0.00163946064182291, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.856595317626352, 0.0062661279814415, 0.180709861813322, 1,
			 50, 16, -0.0215878052216607, 0.0260832037353987, 0.00224769925686899,
			 0.00325430371895946, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.85336588793946, 0.0121611951375337, 0.184825523433285, 1,
			 84, 16, -0.0336122745291698, 0.0405419300795976, 0.00346482777521391,
			 0.00501650827172467, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.854674688161386, 0.0189172365394687, 0.183157184083677, 1,
			 16, 50, -0.0123692268004226, 0.0147917702348094, 0.00121127171719339,
			 0.00175372485526547, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.861226500563284, 0.00692895309543301, 0.174813092325846, 1,
			 50, 50, -0.0219770976570848, 0.0266303373619478, 0.00232661985243149,
			 0.00336856793240202, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.85116720404789, 0.0124000837266506, 0.187629366359121, 1,
			 84, 50, -0.0336743079787598, 0.0407618047203127, 0.00354374837077642,
			 0.00513077248516723, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.851958889964636, 0.0189891531901135, 0.186619610432204, 1,
			 16, 84, -0.0151126867571638, 0.0177202442947984, 0.00130377876881729,
			 0.00188766005198257, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.876302353081024, 0.00837590162649523, 0.15565831918239, 1,
			 50, 84, -0.0233253732080462, 0.028163627016157, 0.00241912690405539,
			 0.00350250312911912, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.853878965372579, 0.0131351903989925, 0.184171437990038, 1,
			 84, 84, -0.0343525284462597, 0.0416250392910604, 0.00363625542240032,
			 0.00526470768188434, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.851185401098879, 0.0193823887419926, 0.187606154783298))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.165033027124615, 0.110210436301023, -0.0274112954117962, -0.0396871068616029,
			 "W", "<unicode>", 0.696253532431748, "M", 0.0702164594851546,
			 -0.39038276228655, 1, -2.7721635341209, 2.28533086772921, -0.243416333195845,
			 -0.231140848510276, "jasp", "<unicode>", 0.850355026643209,
			 "M", 1.29020085107252, -0.188665457005007, -0.0323661796343282,
			 0.532496986397262, 0.250065403381467, 0.239061400156364, "Y",
			 "<unicode>", 0.0826778673327568, "M", 0.144100394315191, 1.73535544139108,
			 -0.251421174646128, 0.231388138769353, -0.0100165179383873,
			 -0.0146004255482116, "W:Y", "<unicode>", 0.935184215133268,
			 "M", 0.123167904416566, -0.0813240915791706, -0.400451576328441,
			 0.156816914157345, -0.121817331085548, -0.115571824865467, "Z",
			 "<unicode>", 0.391508291905907, "M", 0.142162941482968, -0.856885274142574,
			 -0.259080203075392, 0.202833682224973, -0.0281232604252098,
			 -0.0406819210160877, "W:Z", "<unicode>", 0.811367914199089,
			 "M", 0.117837340110299, -0.238661704336551, -0.0202939833513926,
			 0.000690549669768906, -0.00980171684081183, -0.183005432088637,
			 "W", "<unicode>", 0.0671052090209414, "jasp", 0.00535329556733818,
			 -1.83096874019335, -0.0272440856524356, 0.0164861368043032,
			 -0.00537897442406621, -0.066312786144825, "Y", "<unicode>",
			 0.629688582414847, "jasp", 0.0111558739858684, -0.482165219047828,
			 -0.0233913104645038, 0.0139844955302264, -0.00470340746713872,
			 -0.088410387387297, "W:Y", "<unicode>", 0.621809448402553, "jasp",
			 0.00953481959095825, -0.493287515539245, -0.0130177535260292,
			 0.0300455004801481, 0.00851387347705946, 0.104162652523365,
			 "Z", "<unicode>", 0.438343104942814, "jasp", 0.0109857258464581,
			 0.774994169347893, -0.018240653011238, 0.0175608026767843, -0.000339925167226897,
			 -0.00634104816442643, "W:Z", "<unicode>", 0.970310661200632,
			 "jasp", 0.00913319223476034, -0.0372186589846608))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175160347247986, 0.19898480079016, 0.0119122267710871,
			 0.0172469709921237, "Total", "W", "M", "<unicode>", 0.900678170792649,
			 0.0954469446860645, 0.124804694485169, 50, 16, -0.250371108990955,
			 0.256910075252451, 0.00326948313074832, 0.00473368093126956,
			 "Total", "W", "M", "<unicode>", 0.979844095305321, 0.12941084332283,
			 0.0252643677052024, 84, 16, -0.477653506855015, 0.465329609712603,
			 -0.00616194857120631, -0.00892150143753972, "Total", "W", "M",
			 "<unicode>", 0.979564521521718, 0.240561337862774, -0.0256148748836828,
			 16, 50, -0.285608438444605, 0.255942801590774, -0.0148328184269154,
			 -0.0214755136933228, "Total", "W", "M", "<unicode>", 0.914499521107825,
			 0.138153365140142, -0.107364872450766, 50, 50, -0.158318498727413,
			 0.111367374592904, -0.0234755620672543, -0.0339888037541769,
			 "Total", "W", "M", "<unicode>", 0.732937134415648, 0.0687986808552518,
			 -0.341221107373344, 84, 50, -0.322683623437084, 0.256869635898667,
			 -0.0329069937692089, -0.0476439861229861, "Total", "W", "M",
			 "<unicode>", 0.823867667330872, 0.147847935958822, -0.222573237534909,
			 16, 84, -0.537949356357774, 0.445585123296421, -0.0461821165306761,
			 -0.0668642093091008, "Total", "W", "M", "<unicode>", 0.853965417429186,
			 0.250906263434479, -0.184061234257454, 50, 84, -0.350935390959233,
			 0.241285670617203, -0.0548248601710149, -0.0793774993699549,
			 "Total", "W", "M", "<unicode>", 0.716689073207589, 0.151079577545251,
			 -0.36288730126078, 84, 84, -0.277368610653482, 0.148856026907543,
			 -0.0642562918729695, -0.0930326817387642, "Total", "W", "M",
			 "<unicode>", 0.554549857431694, 0.108732772878234, -0.59095606754118,
			 16, 16, -0.0111490340445131, 0.0134137362877749, 0.00113235112163089,
			 0.00163946064182291, "Total indirect", "W", "M", "<unicode>",
			 0.856595317626352, 0.0062661279814415, 0.180709861813322, 50,
			 16, -0.0215878052216607, 0.0260832037353987, 0.00224769925686899,
			 0.00325430371895946, "Total indirect", "W", "M", "<unicode>",
			 0.85336588793946, 0.0121611951375337, 0.184825523433285, 84,
			 16, -0.0336122745291698, 0.0405419300795976, 0.00346482777521391,
			 0.00501650827172467, "Total indirect", "W", "M", "<unicode>",
			 0.854674688161386, 0.0189172365394687, 0.183157184083677, 16,
			 50, -0.0123692268004226, 0.0147917702348094, 0.00121127171719339,
			 0.00175372485526547, "Total indirect", "W", "M", "<unicode>",
			 0.861226500563284, 0.00692895309543301, 0.174813092325846, 50,
			 50, -0.0219770976570848, 0.0266303373619478, 0.00232661985243149,
			 0.00336856793240202, "Total indirect", "W", "M", "<unicode>",
			 0.85116720404789, 0.0124000837266506, 0.187629366359121, 84,
			 50, -0.0336743079787598, 0.0407618047203127, 0.00354374837077642,
			 0.00513077248516723, "Total indirect", "W", "M", "<unicode>",
			 0.851958889964636, 0.0189891531901135, 0.186619610432204, 16,
			 84, -0.0151126867571638, 0.0177202442947984, 0.00130377876881729,
			 0.00188766005198257, "Total indirect", "W", "M", "<unicode>",
			 0.876302353081024, 0.00837590162649523, 0.15565831918239, 50,
			 84, -0.0233253732080462, 0.028163627016157, 0.00241912690405539,
			 0.00350250312911912, "Total indirect", "W", "M", "<unicode>",
			 0.853878965372579, 0.0131351903989925, 0.184171437990038, 84,
			 84, -0.0343525284462597, 0.0416250392910604, 0.00363625542240032,
			 0.00526470768188434, "Total indirect", "W", "M", "<unicode>",
			 0.851185401098879, 0.0193823887419926, 0.187606154783298))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-10")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0393515258207284, "jasp", 0.0403038652118407))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 10 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(847.472979995417, 938.653936505, 0, "Model 1", 100, -388.736489997708,
			 10))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0981744973512576, 0.0336487163693821, -0.0322628904909378,
			 "sm:Z", "<unicode>", 0.337368676127284, "sm", 0.0336289887876625,
			 -0.959377360248609, -0.163250738021748, 0.034199173449093, -0.0645257822863276,
			 "Z", "<unicode>", 0.200188183354747, "sm", 0.0503708009505024,
			 -1.28101560961349, 0.0922263539786436, 0.197773643560362, 0.144999998769503,
			 "sm:medexperimental", "<unicode>", 7.23782935807549e-08, "sm",
			 0.0269258237432579, 5.38516481991789, -0.00962232532592927,
			 0.0896223236031617, 0.0399999991386162, "medexperimental", "<unicode>",
			 0.11412862789686, "sm", 0.0253179777056926, 1.57990498307542,
			 0.180704808433171, 0.319295190001709, 0.24999999921744, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553388382953,
			 7.07106783393774, 0.75633749987223, 1.33640564566244, 1.04637157276733,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.147979286957748,
			 7.07106781144377, 0.00473838137954982, 0.00837245228815008,
			 0.00655541683384995, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.00092707594049313, 7.07106780310036, -0.136062946971184,
			 -0.00208333323406144, -0.0690731401026226, "sm:Z", "<unicode>",
			 0.0432883154841679, "medexperimental", 0.0341791009411235, -2.02091740861198,
			 -0.170527220567738, 0.0272978570519994, -0.0716146817578691,
			 "Z", "<unicode>", 0.15588338198129, "medexperimental", 0.050466508359377,
			 -1.41905362756412, 0.0922263544458194, 0.197773644605109, 0.144999999525464,
			 "sm:medexperimental", "<unicode>", 7.23782940248441e-08, "medexperimental",
			 0.0269258238906003, 5.38516481852513, 0.180704808817347, 0.319295191341695,
			 0.250000000079521, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.0353553390821287, 7.0710678095544, -0.14432695140717,
			 -0.0209201561493119, -0.0826235537782411, "sm:Z", "<unicode>",
			 0.00867819810423809, "sm:medexperimental", 0.0314819038082524,
			 -2.62447767712773, -0.192385821563388, -0.0102862400203185,
			 -0.101336030791853, "Z", "<unicode>", 0.0291546901114581, "sm:medexperimental",
			 0.0464548285018113, -2.18138854581935, 0.148828480033195, 0.262971517812081,
			 0.205899998922638, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186569445234, 7.07106784886807,
			 0.294098354644827, 0.610628759351986, 0.452363556998407, "sm:Z",
			 "<unicode>", 2.11779662695477e-08, "Z", 0.0807490360036995,
			 5.60209235163726, 0.721541821674459, 1.27492364797721, 0.998232734825833,
			 "Z", "<unicode>", 1.53743684450092e-12, "Z", 0.141171427298602,
			 7.07106780690401, 0.323967567022249, 0.572432394334317, 0.448199980678283,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.0633850492335386,
			 7.0710678006562))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.160970371830601, 1.33182840723561, 0.585429017702503,
			 0.55590583477186, "s", "M", "", 0, "<unicode>", "", 0.124226417463594,
			 "m", 0.380823012780137, 1.53727321631294, 1, 16, -0.360281080650791,
			 1.00801315965808, 0.323866039503647, 0.30753347647694, "s",
			 "M", "", 1, "<unicode>", "", 0.353500650301442, "m", 0.349061067219042,
			 0.927820573299327, 1, 50, 0.0268546266577371, 1.18729031426532,
			 0.607072470461528, 0.576457808298163, "s", "M", "", 0, "<unicode>",
			 "", 0.0402982794242386, "m", 0.296034951856501, 2.05067836299208,
			 1, 50, -0.240695938761411, 0.931714923286754, 0.345509492262672,
			 0.328085450003242, "s", "M", "", 1, "<unicode>", "", 0.248007384296122,
			 "m", 0.299089899430804, 1.15520280999194, 1, 84, -0.059304461321264,
			 1.32418829967479, 0.632441919176762, 0.600547875820081, "s",
			 "M", "", 0, "<unicode>", "", 0.07314364880816, "m", 0.352938312109015,
			 1.79193331377812, 1, 84, -0.402470503517213, 1.14422838547302,
			 0.370878940977905, 0.352175517525161, "s", "M", "", 1, "<unicode>",
			 "", 0.347243502527046, "m", 0.394573293486615, 0.939949426634184,
			 1, 16, -0.0244284537044584, 0.0234848464939296, -0.000471803605264419,
			 -0.000448010551410986, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.969209589163599, "m", 0.0122230052634441, -0.0385996401944997,
			 1, 16, -0.0318353987467585, 0.0331197920769247, 0.000642196665083111,
			 0.000609810689930898, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969085400468992, "m", 0.016570506227676, 0.0387554041053083,
			 1, 50, -0.0144876725439467, 0.0139309936286017, -0.000278339457672477,
			 -0.000264302799978382, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.969374544769296, "m", 0.00724979295454182, -0.0383927457539466,
			 1, 50, -0.0413455466910257, 0.0430168683163758, 0.000835660812675053,
			 0.000793518441363502, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969026515881269, "m", 0.0215214196977193, 0.038829260541934,
			 1, 84, -0.00379212504206655, 0.00368898547880336, -5.15697816315973e-05,
			 -4.89691177581562e-05, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.978442692232085, "m", 0.00190848163024422, -0.0270213665221384,
			 1, 84, -0.0525713186328948, 0.0546961796103267, 0.00106243048871593,
			 0.00100885212358373, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.969029984327239, "m", 0.0273646605471666, 0.0388249102116466
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0297998228625788, 1.1861513865021, 0.607975604682339, 0.57731539746397,
			 "sm", "<unicode>", 0.039304689788292, "M", 0.294993064352374,
			 2.06098270824463, 1, -2.52535807349122, 2.42710102170522, -0.0491285258930036,
			 -0.0466509745363179, "jasp", "<unicode>", 0.968981446200706,
			 "M", 1.26340563761906, -0.0388857896705197, 1, -0.427962420422615,
			 0.721164092521438, 0.146600836049411, 0.139207756496475, "medexperimental",
			 "<unicode>", 0.61701290826816, "M", 0.293149905306479, 0.500088294062878,
			 1, -1.0923333662571, 0.569207409859389, -0.261562978198857,
			 -0.24837235829492, "sm:medexperimental", "<unicode>", 0.537180192608784,
			 "M", 0.423870231601834, -0.617082679315301, -0.22679887497289,
			 0.320540575339942, 0.0468708501835258, 0.044467808041275, "Z",
			 "<unicode>", 0.73711294725054, "M", 0.139629976527675, 0.335678994934414,
			 1, -0.39301106550489, 0.438394694691354, 0.0226918145932323,
			 0.0215284180143744, "sm:Z", "<unicode>", 0.91479865313902, "M",
			 0.212097203508398, 0.10698780661827, 1, -0.040249354551929,
			 0.0512517860135257, 0.00550121573079837, 0.067363960297201,
			 "sm", "<unicode>", 0.813686243668003, "jasp", 0.0233425566202247,
			 0.235673230670541, 1, -0.0489096691730714, 0.0420350267752373,
			 -0.00343732119891705, -0.0420909813582191, "medexperimental",
			 "<unicode>", 0.882219229073211, "jasp", 0.0232006038543741,
			 -0.148156540256128, 1, -0.0882812899509356, 0.0429308443554908,
			 -0.0226752227977224, -0.277664589615045, "sm:medexperimental",
			 "<unicode>", 0.498141851928166, "jasp", 0.0334730983174719,
			 -0.677416311530584, -0.0174100503144989, 0.025880669620468,
			 0.00423530965298456, 0.0518167305208206, "Z", "<unicode>", 0.701347055229883,
			 "jasp", 0.0110437539353882, 0.383502718166607, 1, -0.037022069102573,
			 0.028764742958953, -0.00412866307181, -0.0505119670889911, "sm:Z",
			 "<unicode>", 0.805676277503339, "jasp", 0.0167826584009819,
			 -0.246007692772228))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.161068897204221, 1.3309833253987, 0.584957214097239,
			 0.555457824220449, "Total", "s", "M", 0, "<unicode>", 0.124341589371968,
			 "m", 0.380632561203175, 1.53680287426855, 1, 16, -0.358877900043338,
			 1.0078943723808, 0.32450823616873, 0.308143287166871, "Total",
			 "s", "M", 1, "<unicode>", 0.352011057347107, "m", 0.348672802971142,
			 0.930695578787623, 1, 50, 0.0267415331895947, 1.18684672881812,
			 0.606794131003856, 0.576193505498184, "Total", "s", "M", 0,
			 "<unicode>", 0.0403330123381584, "m", 0.29595064112894, 2.05032206954905,
			 1, 50, -0.238349546590267, 0.93103985274096, 0.346345153075347,
			 0.328878968444606, "Total", "s", "M", 1, "<unicode>", 0.245646434351064,
			 "m", 0.298319103961915, 1.16098884877169, 1, 84, -0.0593563775227115,
			 1.32413707631297, 0.632390349395131, 0.600498906702323, "Total",
			 "s", "M", 0, "<unicode>", 0.0731672040420261, "m", 0.352938488857067,
			 1.79178630090196, 1, 84, -0.399557678824285, 1.14344042175753,
			 0.371941371466621, 0.353184369648745, "Total", "s", "M", 1,
			 "<unicode>", 0.344708449230226, "m", 0.393629197463011, 0.944902903198822,
			 1, 16, -0.0244284537044584, 0.0234848464939296, -0.000471803605264419,
			 -0.000448010551410986, "Total indirect", "s", "M", 0, "<unicode>",
			 0.969209589163599, "m", 0.0122230052634441, -0.0385996401944997,
			 1, 16, -0.0318353987467585, 0.0331197920769247, 0.000642196665083111,
			 0.000609810689930898, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969085400468992, "m", 0.016570506227676, 0.0387554041053083,
			 1, 50, -0.0144876725439467, 0.0139309936286017, -0.000278339457672477,
			 -0.000264302799978382, "Total indirect", "s", "M", 0, "<unicode>",
			 0.969374544769296, "m", 0.00724979295454182, -0.0383927457539466,
			 1, 50, -0.0413455466910257, 0.0430168683163758, 0.000835660812675053,
			 0.000793518441363502, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969026515881269, "m", 0.0215214196977193, 0.038829260541934,
			 1, 84, -0.00379212504206655, 0.00368898547880336, -5.15697816315973e-05,
			 -4.89691177581562e-05, "Total indirect", "s", "M", 0, "<unicode>",
			 0.978442692232085, "m", 0.00190848163024422, -0.0270213665221384,
			 1, 84, -0.0525713186328948, 0.0546961796103267, 0.00106243048871593,
			 0.00100885212358373, "Total indirect", "s", "M", 1, "<unicode>",
			 0.969029984327239, "m", 0.0273646605471666, 0.0388249102116466
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-10")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-10")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0565043394227213, "jasp", 0.0170347109433766))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1434.02636149221, 1546.0486794897, 1, "Model 1", 100, -674.013180746104,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.775624662302785, 0.164689432187431, -0.305467615057677, "W:Z",
			 "<unicode>", 0.202870449525422, "W", 0.239880452372414, -1.27341603718271,
			 -0.0310152148109387, 0.0199884584568428, -0.00551337817704793,
			 "jasp:Z", "<unicode>", 0.671759032113327, "W", 0.0130113802269052,
			 -0.423735075057391, -0.403918217537883, 0.194611853044901, -0.104653182246491,
			 "Z", "<unicode>", 0.493091095297465, "W", 0.1526890481927, -0.685400711349084,
			 -0.675381636035011, 0.224488235462375, -0.225446700286318, "W:Y",
			 "<unicode>", 0.326065571114758, "W", 0.229562858959513, -0.982069579147729,
			 -0.544848238940661, 0.0642086341166157, -0.240319802412022,
			 "Y", "<unicode>", 0.121932414763476, "W", 0.155374506333137,
			 -1.54671321623868, 1.68041089966793, 2.96919115908335, 2.32480102937564,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776515686297,
			 7.07106778756016, 0.769964630560616, 1.36048401595245, 1.06522432325653,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.150645468500894,
			 7.07106781144372, -0.00112714878440715, 0.00148526163791923,
			 0.000179056426756036, "jasp:Z", "<unicode>", 0.788180108385991,
			 "jasp", 0.000666443476240569, 0.268674588527896, -0.00697298823873467,
			 0.0160044842162359, 0.00451574798875061, "Z", "<unicode>", 0.441073955862203,
			 "jasp", 0.00586170782632077, 0.770380940597822, 0.0046546857461111,
			 0.00822456683566075, 0.00643962629088593, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.000910700685754538, 7.07106779605699,
			 -0.0338675236060852, 0.591585822650797, 0.278859149522356, "W:Z",
			 "<unicode>", 0.0805151671428657, "Y", 0.159557356969408, 1.74770474278927,
			 -0.0163184015247272, 0.0173292458464965, 0.000505422160884631,
			 "jasp:Z", "<unicode>", 0.953046623161175, "Y", 0.00858374124132689,
			 0.0588813370155251, 0.424988056049049, 0.896754201195297, 0.660871128622173,
			 "Z", "<unicode>", 3.99188180288945e-08, "Y", 0.120350717887543,
			 5.49121052389317, -0.253361722346767, 0.338176432316814, 0.0424073549850233,
			 "W:Y", "<unicode>", 0.778695416912659, "Y", 0.150905363396868,
			 0.281019534564159, 0.732634588224665, 1.29452393577574, 1.0135792620002,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341753211587,
			 7.07106784513829, 1.3047073782396, 2.48432043086843, 1.89451390455401,
			 "W:Z", "<unicode>", 3.06236369596036e-10, "W:Y", 0.300927226707599,
			 6.2955882233775, -0.0534891326080097, -0.00223666243929077,
			 -0.0278628975236502, "jasp:Z", "<unicode>", 0.0330866710846101,
			 "W:Y", 0.0130748499903549, -2.13102999607676, -0.0195779778820605,
			 0.577296279820176, 0.278859150969058, "Z", "<unicode>", 0.0670427930070323,
			 "W:Y", 0.152266639185797, 1.83138704879925, 1.62269998072817,
			 2.86721922019938, 2.24495960046378, "W:Y", "<unicode>", 1.53743684450092e-12,
			 "W:Y", 0.317485231689926, 7.07106780530924, 0.00952642640517942,
			 0.633193678840973, 0.321360052623076, "W:Z", "<unicode>", 0.0433999540758709,
			 "Z", 0.159101712417984, 2.01984031308737, -0.0200843707899066,
			 0.0133295121645536, -0.00337742931267651, "jasp:Z", "<unicode>",
			 0.691942055618862, "Z", 0.00852410636573547, -0.396220925427776,
			 0.721485025425994, 1.2747651781714, 0.998125101798695, "Z",
			 "<unicode>", 1.53144164016794e-12, "Z", 0.141145489690017, 7.07160465411099,
			 -0.0508532962918328, 0.0021601962146246, -0.0243465500386041,
			 "W:Z", "<unicode>", 0.0718236056988122, "jasp:Z", 0.0135240986376844,
			 -1.80023458057037, 0.00525426402273594, 0.00928392974281942,
			 0.00726909688277768, "jasp:Z", "<unicode>", 1.53654866608122e-12,
			 "jasp:Z", 0.00102799483864728, 7.07114141968158, 1.76008417061176,
			 3.10996931741179, 2.43502674401177, "W:Z", "<unicode>", 1.53743684450092e-12,
			 "W:Z", 0.344364783600045, 7.07106783265004))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.179644683294671, 0.198140127866731, 0.00924772228602994,
			 0.0133891421613472, "W", "M", "", "<unicode>", "", 0.923556178493397,
			 0.0963754472381434, 0.0959551685729545, 50, 16, -0.253474544563311,
			 0.255846606943633, 0.00118603119016092, 0.00171717312887362,
			 "W", "M", "", "<unicode>", "", 0.992716895942065, 0.129931252697602,
			 0.00912814404184384, 84, 16, -0.4813842551792, 0.466161606403664,
			 -0.007611324387768, -0.0110199139974071, "W", "M", "", "<unicode>",
			 "", 0.974880766622116, 0.241725324816421, -0.0314874926470714,
			 16, 50, -0.289023152973276, 0.254397674163894, -0.0173127394046907,
			 -0.0250659267138606, "W", "M", "", "<unicode>", "", 0.900615203478054,
			 0.138630309389255, -0.124884229725542, 50, 50, -0.16249226304473,
			 0.11174340204361, -0.0253744305005597, -0.0367378957463342,
			 "W", "M", "", "<unicode>", "", 0.716827190557042, 0.0699593633483768,
			 -0.362702421607278, 84, 50, -0.328331314805474, 0.259987742648497,
			 -0.0341717860784887, -0.0494749828726149, "W", "M", "", "<unicode>",
			 "", 0.819891774847674, 0.150084150039122, -0.227684176307632,
			 16, 84, -0.540497512228109, 0.443606157616199, -0.0484456773059548,
			 -0.0701411699540392, "W", "M", "", "<unicode>", "", 0.846981603306297,
			 0.251051467681751, -0.192971097732707, 50, 84, -0.353825463091837,
			 0.24081072628819, -0.0565073684018239, -0.0818131389865128,
			 "W", "M", "", "<unicode>", "", 0.709517065065266, 0.151695692898043,
			 -0.372504764784608, 84, 84, -0.285370211291189, 0.154760763331683,
			 -0.0653047239797528, -0.0945502261127935, "W", "M", "", "<unicode>",
			 "", 0.560821387748359, 0.112280373030976, -0.581621900754964,
			 1, 16, 16, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 1,
			 50, 16, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 1,
			 84, 16, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835, 1,
			 16, 50, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 1,
			 50, 50, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 1,
			 84, 50, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835, 1,
			 16, 84, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 1,
			 50, 84, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 1,
			 84, 84, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "W", "jasp", "M", "<unicode>", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.164737467934188, 0.11096267262751, -0.0268873976533386, -0.038928417008484,
			 "W", "<unicode>", 0.70224827447829, "M", 0.0703329608952985,
			 -0.382287299028469, 1, -2.77740732400137, 2.28159666774801,
			 -0.247905328126682, -0.235402429081986, "jasp", "<unicode>",
			 0.847673728054132, "M", 1.29058595761304, -0.192087420961241,
			 -0.0325611890806855, 0.532291005200199, 0.249864908059757, 0.23886867667858,
			 "Y", "<unicode>", 0.0829184799938958, "M", 0.144097595347763,
			 1.73399776350699, -0.251164564214897, 0.234614182166305, -0.00827519102429585,
			 -0.0120621537394377, "W:Y", "<unicode>", 0.94676037220365, "M",
			 0.123925426745839, -0.0667755701278931, -0.400276384175706,
			 0.156970907384131, -0.121652738395788, -0.115408941331383, "Z",
			 "<unicode>", 0.392130515346892, "M", 0.142157533494323, -0.855760052988302,
			 1, -2.28051657788666, 2.59510110422671, 0.157292263170024, 0.149219276207417,
			 "jasp:Z", "<unicode>", 0.899367204682226, "M", 1.24380287611702,
			 0.126460764957442, -0.258825159584321, 0.20313117407222, -0.0278469927560502,
			 -0.0402799353032617, "W:Z", "<unicode>", 0.813203373660263,
			 "M", 0.117848168971571, -0.236295506320236, -0.0199964287313284,
			 0.00098782070335013, -0.00950430401398912, -0.177452511118554,
			 "W", "<unicode>", 0.0758259615681696, "jasp", 0.00535322322251827,
			 -1.77543577372402, -0.0156987571455337, 0.0159388845871341,
			 0.000120063720800222, 0.00148016316197046, "Y", "<unicode>",
			 0.988131117651024, "jasp", 0.00807097527868407, 0.0148759866874227,
			 -0.0145563049372739, 0.00654285994706036, -0.00400672249510675,
			 -0.0753147349760878, "W:Y", "<unicode>", 0.456638955343025,
			 "jasp", 0.00538253892692972, -0.744392664781386))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, 16, -0.175973189078316, 0.198837958707604, 0.0114323848146439,
			 0.0165521650404369, "Total", "W", "M", "<unicode>", 0.90482810582048,
			 0.0956168457028757, 0.119564546713551, 50, 16, -0.250070365434687,
			 0.257174164652233, 0.00355189960877302, 0.00514255157473071,
			 "Total", "W", "M", "<unicode>", 0.978101875242101, 0.129401492600885,
			 0.0274486757253119, 84, 16, -0.477936230435458, 0.464838665849724,
			 -0.00654878229286726, -0.00948153225095986, "Total", "W", "M",
			 "<unicode>", 0.978277138731985, 0.240508219467722, -0.0272289334117587,
			 16, 50, -0.285968720912943, 0.255712567160789, -0.0151280768760768,
			 -0.0219029038347709, "Total", "W", "M", "<unicode>", 0.912825145485946,
			 0.138186541269749, -0.109475761800462, 50, 50, -0.1580923132945,
			 0.112075189130605, -0.0230085620819476, -0.0333125173004771,
			 "Total", "W", "M", "<unicode>", 0.738502568494398, 0.0689215476805063,
			 -0.333836990843654, 84, 50, -0.322825205073562, 0.256606717106386,
			 -0.0331092439835879, -0.0479366011261677, "Total", "W", "M",
			 "<unicode>", 0.822766567935362, 0.147816982033964, -0.223988093438279,
			 16, 84, -0.537937525754283, 0.445415496199601, -0.0462610147773409,
			 -0.0669781470749494, "Total", "W", "M", "<unicode>", 0.853692052894846,
			 0.250859972354198, -0.184409710099239, 50, 84, -0.350475739668336,
			 0.242192739701912, -0.0541414999832118, -0.0783877605406557,
			 "Total", "W", "M", "<unicode>", 0.720273280139421, 0.151193716834886,
			 -0.358093584287884, 84, 84, -0.277399399924427, 0.148915036154723,
			 -0.064242181884852, -0.0930118443663463, "Total", "W", "M",
			 "<unicode>", 0.554720208986372, 0.108755681084414, -0.590701848807224,
			 16, 16, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "Total indirect", "W", "M", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 50,
			 16, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "Total indirect", "W", "M", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 84,
			 16, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "Total indirect", "W", "M", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835, 16,
			 50, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "Total indirect", "W", "M", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 50,
			 50, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "Total indirect", "W", "M", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 84,
			 50, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "Total indirect", "W", "M", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835, 16,
			 84, -0.0178567033072268, 0.0222260283644548, 0.00218466252861397,
			 0.00316302287908973, "Total indirect", "W", "M", "<unicode>",
			 0.830819146587293, 0.010225374544596, 0.213651100904518, 50,
			 84, -0.0213710320114569, 0.0261027688486811, 0.0023658684186121,
			 0.00342537844585709, "Total indirect", "W", "M", "<unicode>",
			 0.845118514949274, 0.0121108860251018, 0.195350564253387, 84,
			 84, -0.0477623059048368, 0.0498873900946382, 0.00106254209490074,
			 0.00153838174644723, "Total indirect", "W", "M", "<unicode>",
			 0.96597785218691, 0.0249110944817669, 0.0426533685895835))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-29")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0395135720961438, "jasp", 0.0343971585293659))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 29 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "Z")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(652.227166421852, 764.24948441934, 1, "Model 1", 100, -283.113583210926,
			 29))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.0981744972451254, 0.0336487171499382, -0.0322628900475936,
			 "sm:Z", "<unicode>", 0.337368685238068, "sm", 0.0336289889597126,
			 -0.959377342156922, -0.00863119912244669, 0.00807978537227618,
			 -0.000275706875085252, "jasp:Z", "<unicode>", 0.948434284892585,
			 "sm", 0.00426308458383342, -0.0646730951881168, -0.163249262730069,
			 0.0341976970053754, -0.0645257828623468, "Z", "<unicode>", 0.200181453021802,
			 "sm", 0.050370047942942, -1.28103477160554, 0.0922263543710785,
			 0.197773645445189, 0.144999999908134, "sm:medexperimental",
			 "<unicode>", 7.23783071254758e-08, "sm", 0.0269258241239774,
			 5.38516478606171, -0.0096223243808644, 0.0896223254292634, 0.0400000005241995,
			 "medexperimental", "<unicode>", 0.114128618574366, "sm", 0.025317977930451,
			 1.57990502377719, 0.180704809188958, 0.319295192637852, 0.250000000913405,
			 "sm", "<unicode>", 1.53743684450092e-12, "sm", 0.0353553393179868,
			 7.07106778596858, 0.755519568410766, 1.33496040696536, 1.04523998768806,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.14781925666113,
			 7.07106781144378, -0.000982477442488116, 0.00170236375719605,
			 0.000359943157353966, "jasp:Z", "<unicode>", 0.599218258543412,
			 "jasp", 0.000684921054892296, 0.525525029173715, -0.0093747570297292,
			 0.0139275961756185, 0.00227641957294467, "Z", "<unicode>", 0.701764327938634,
			 "jasp", 0.00594458709168988, 0.382939897730987, 0.00474535364586215,
			 0.00838477180272506, 0.0065650627242936, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.000928440059503688, 7.07106792419432,
			 -0.136062949897531, -0.00208333582815964, -0.0690731428628452,
			 "sm:Z", "<unicode>", 0.0432883076417965, "medexperimental",
			 0.0341791010258824, -2.02091748435803, -0.00585181161124396,
			 0.0108879499889184, 0.0025180691888372, "jasp:Z", "<unicode>",
			 0.555423343541886, "medexperimental", 0.0042704258170567, 0.589652951885892,
			 -0.170525749368396, 0.0272963811136476, -0.0716146841273744,
			 "Z", "<unicode>", 0.155877205386656, "medexperimental", 0.0504657565247218,
			 -1.41907481546011, 0.0922263550729107, 0.197773646257753, 0.145000000665332,
			 "sm:medexperimental", "<unicode>", 7.23782982436916e-08, "medexperimental",
			 0.0269258241522258, 5.38516480853365, 0.180704808878319, 0.319295191554361,
			 0.25000000021634, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.035355339120827, 7.07106780568458, -0.144326952294414,
			 -0.0209201563134906, -0.0826235543039524, "sm:Z", "<unicode>",
			 0.00867819807056192, "sm:medexperimental", 0.0314819039927113,
			 -2.62447767844923, -0.00736991900069918, 0.00779561455465568,
			 0.00021284777697825, "jasp:Z", "<unicode>", 0.956125666507604,
			 "sm:medexperimental", 0.00386882965069222, 0.0550160633048723,
			 -0.192384504477295, -0.0102875588310778, -0.101336031654186,
			 "Z", "<unicode>", 0.0291523552908117, "sm:medexperimental",
			 0.0464541560667885, -2.18142014050352, 0.148828480649452, 0.26297151996155,
			 0.205900000305501, "sm:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "sm:medexperimental", 0.0291186573356562, 7.07106780137743,
			 0.294125801988827, 0.610570947445308, 0.452348374717068, "sm:Z",
			 "<unicode>", 2.10170849612723e-08, "Z", 0.0807272857951882,
			 5.60341364460974, -0.0200774137418104, 0.0133245058366829, -0.00337645395256378,
			 "jasp:Z", "<unicode>", 0.691921809116618, "Z", 0.00852105442803117,
			 -0.396248372907522, 0.721614343764619, 1.2747904094733, 0.99820237661896,
			 "Z", "<unicode>", 1.51101353651484e-12, "Z", 0.141118936386603,
			 7.07348285197054, -0.0178968969693071, 0.0046014803702768, -0.00664770829951517,
			 "sm:Z", "<unicode>", 0.246765798479574, "jasp:Z", 0.00573948743881221,
			 -1.1582407611107, 0.005254411799105, 0.00928409228685175, 0.00726925204297837,
			 "jasp:Z", "<unicode>", 1.53521639845167e-12, "jasp:Z", 0.00102799860597755,
			 7.07126644015812, 0.323967566749629, 0.572432393383429, 0.448199980066529,
			 "sm:Z", "<unicode>", 1.53743684450092e-12, "sm:Z", 0.063385049060508,
			 7.07106781030765))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.175486159982751, 1.32298156881281, 0.573747704415027,
			 0.544813560789924, "s", "M", "", 0, "<unicode>", "", 0.133381521484162,
			 "m", 0.382269199999408, 1.50089963935341, 1, 16, -0.363075019999762,
			 1.00492755851492, 0.320926269257579, 0.304741931270145, "s",
			 "M", "", 1, "<unicode>", "", 0.357784621050398, "m", 0.348986662332908,
			 0.919594654741958, 1, 50, 0.0233139305392338, 1.183864206821,
			 0.603589068680117, 0.57315002261624, "s", "M", "", 0, "<unicode>",
			 "", 0.0414789603386496, "m", 0.296064184198291, 2.03871018817953,
			 1, 50, -0.235957371915921, 0.937492638961258, 0.350767633522668,
			 0.333078393096461, "s", "M", "", 1, "<unicode>", "", 0.241299561774771,
			 "m", 0.299354993288959, 1.1717447224409, 1, 84, -0.053766805264153,
			 1.33090226124123, 0.638567727988536, 0.606364705276988, "s",
			 "M", "", 0, "<unicode>", "", 0.0706449699226708, "m", 0.353238395559172,
			 1.80775288308535, 1, 84, -0.392241990909193, 1.16373457657137,
			 0.385746292831088, 0.366293075757208, "s", "M", "", 1, "<unicode>",
			 "", 0.331150166538973, "m", 0.396940091694007, 0.971799777605865,
			 1, 16, -0.0299392245689676, 0.0252561148682627, -0.00234155485035244,
			 -0.00222347004787776, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.86792455293434, "m", 0.0140807024701995, -0.166295314833058,
			 1, 16, -0.04289309088209, 0.0459616975126865, 0.00153430331529828,
			 0.00145692827371171, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.946034400141168, "m", 0.0226674543756038, 0.0676874998786629,
			 1, 50, -0.022121351438444, 0.0257351289152253, 0.00180688873839065,
			 0.00171576719163958, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.88234087822202, "m", 0.0122085101387462, 0.148002394875041,
			 1, 50, -0.0299392245689676, 0.0252561148682627, -0.00234155485035244,
			 -0.00222347004787776, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.86792455293434, "m", 0.0140807024701995, -0.166295314833058,
			 1, 84, -0.04289309088209, 0.0459616975126865, 0.00153430331529828,
			 0.00145692827371171, "s", "jasp", "M", 0, "<unicode>", "<unicode>",
			 0.946034400141168, "m", 0.0226674543756038, 0.0676874998786629,
			 1, 84, -0.022121351438444, 0.0257351289152253, 0.00180688873839065,
			 0.00171576719163958, "s", "jasp", "M", 1, "<unicode>", "<unicode>",
			 0.88234087822202, "m", 0.0122085101387462, 0.148002394875041
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0266683299225176, 1.18300023792157, 0.604834283922045, 0.574332441551748,
			 "sm", "<unicode>", 0.0403284588273707, "M", 0.294988050066239,
			 2.05036876506092, 1, -2.54832757074419, 2.40784089137807, -0.0702433396830621,
			 -0.0667009623219731, "jasp", "<unicode>", 0.95569488444959,
			 "M", 1.26435192208017, -0.0555567943199662, 1, -0.436456167523949,
			 0.715250741187537, 0.139397286831794, 0.132367470264157, "medexperimental",
			 "<unicode>", 0.635179057081293, "M", 0.293808181628847, 0.47444998317946,
			 1, -1.08477365694781, 0.57913078663291, -0.252821435157448,
			 -0.24007162951978, "sm:medexperimental", "<unicode>", 0.551434313109728,
			 "M", 0.424473219075805, -0.595612217203974, -0.229268637759232,
			 0.318449102891052, 0.0445902325659096, 0.0423034693005768, "Z",
			 "<unicode>", 0.749631621824297, "M", 0.139726480938071, 0.319125138388568,
			 1, -1.98043775630241, 2.77951806559338, 0.399540154645486, 0.379050157260562,
			 "jasp:Z", "<unicode>", 0.742132955011132, "M", 1.21429675734904,
			 0.329030076237485, 1, -0.387333899870584, 0.449907530118204,
			 0.0312868151238099, 0.0296823036557741, "sm:Z", "<unicode>",
			 0.883539708231725, "M", 0.21358592213756, 0.146483507951707,
			 1, -0.0404917979670217, 0.050515010110963, 0.00501160607197068,
			 0.0613685504418115, "sm", "<unicode>", 0.829093406513692, "jasp",
			 0.0232164490765736, 0.215864452631889, 1, -0.0488496035059556,
			 0.0421572045721462, -0.00334619946690469, -0.0409751700002139,
			 "medexperimental", "<unicode>", 0.885397384825755, "jasp", 0.0232164490766034,
			 -0.144130545367373, 1, -0.0871738359198841, 0.0415292263326109,
			 -0.0228223047936366, -0.279465652889183, "sm:medexperimental",
			 "<unicode>", 0.486991211548942, "jasp", 0.0328330171543172,
			 -0.695102271179353))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 16, -0.179100637290868, 1.32191293642022, 0.571406149564675,
			 0.542590090742047, "Total", "s", "M", 0, "<unicode>", 0.135636509891486,
			 "m", 0.382918662166981, 1.49223896879567, 1, 16, -0.360797769461749,
			 1.0057189146075, 0.322460572572877, 0.306198859543856, "Total",
			 "s", "M", 1, "<unicode>", 0.354968083034939, "m", 0.348607600662094,
			 0.924995817533647, 1, 50, 0.0253645497509777, 1.18542736508604,
			 0.605395957418507, 0.57486578980788, "Total", "s", "M", 0, "<unicode>",
			 0.0407886076868782, "m", 0.295939829630924, 2.04567245366572,
			 1, 50, -0.23917093903629, 0.936023096380922, 0.348426078672316,
			 0.330854923048583, "Total", "s", "M", 1, "<unicode>", 0.245156092780479,
			 "m", 0.299799905683725, 1.16219542457058, 1, 84, -0.0540280267647112,
			 1.33423208937238, 0.640102031303835, 0.6078216335507, "Total",
			 "s", "M", 0, "<unicode>", 0.0706985286469397, "m", 0.354154496482464,
			 1.80740901968339, 1, 84, -0.393044146627292, 1.16815050976625,
			 0.387553181569479, 0.368008842948848, "Total", "s", "M", 1,
			 "<unicode>", 0.330509322408042, "m", 0.398271261285423, 0.973088493301394,
			 1, 16, -0.0299392245689676, 0.0252561148682627, -0.00234155485035244,
			 -0.00222347004787776, "Total indirect", "s", "M", 0, "<unicode>",
			 0.86792455293434, "m", 0.0140807024701995, -0.166295314833058,
			 1, 16, -0.04289309088209, 0.0459616975126865, 0.00153430331529828,
			 0.00145692827371171, "Total indirect", "s", "M", 1, "<unicode>",
			 0.946034400141168, "m", 0.0226674543756038, 0.0676874998786629,
			 1, 50, -0.022121351438444, 0.0257351289152253, 0.00180688873839065,
			 0.00171576719163958, "Total indirect", "s", "M", 0, "<unicode>",
			 0.88234087822202, "m", 0.0122085101387462, 0.148002394875041,
			 1, 50, -0.0299392245689676, 0.0252561148682627, -0.00234155485035244,
			 -0.00222347004787776, "Total indirect", "s", "M", 1, "<unicode>",
			 0.86792455293434, "m", 0.0140807024701995, -0.166295314833058,
			 1, 84, -0.04289309088209, 0.0459616975126865, 0.00153430331529828,
			 0.00145692827371171, "Total indirect", "s", "M", 0, "<unicode>",
			 0.946034400141168, "m", 0.0226674543756038, 0.0676874998786629,
			 1, 84, -0.022121351438444, 0.0257351289152253, 0.00180688873839065,
			 0.00171576719163958, "Total indirect", "s", "M", 1, "<unicode>",
			 0.88234087822202, "m", 0.0122085101387462, 0.148002394875041
			))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-29")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-29")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0575248411520211, "jasp", 0.0155883230960112))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "mod"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "mod",
            processType = "mediators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1919.79936103679, 1990.13895605847, 0, "Model 1", 100, -932.899680518397,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1.68041089480192, 2.96919114210622, 2.32480101845407, "W", "<unicode>",
			 1.53743684450092e-12, "W", 0.328776512596666, 7.07106782079068,
			 0.719243095446917, 1.27101851286767, 0.995130804157296, "M",
			 "<unicode>", 1.55364610066044e-12, "M", 0.140761621584144, 7.06961736415084,
			 -0.017063829424213, 0.0136234316300662, -0.00172019889707342,
			 "Y", "<unicode>", 0.826077786806031, "jasp", 0.00782852677302654,
			 -0.219734689162772, -0.762343306344135, 0.0887543315059579,
			 -0.336794487419088, "mod", "<unicode>", 0.120857287748549, "jasp",
			 0.217120733993952, -1.55118528398338, 0.00468047960484189, 0.00827014311556882,
			 0.00647531136020536, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000915747314502139, 7.07106781276859, 0.413197536866249,
			 0.872209472692487, 0.642703504779368, "Y", "<unicode>", 4.05039308759569e-08,
			 "Z", 0.117097033273791, 5.4886403763674, -6.53655165917213,
			 3.73651368195567, -1.40001898860823, "mod", "<unicode>", 0.593196294728594,
			 "Z", 2.62072809045483, -0.534209937195452, 0.71669479817852,
			 1.2663592308511, 0.991527014514812, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.140223095171204, 7.07106781022211, 507.563085651454,
			 899.790692619836, 703.676889135645, "mod", "<unicode>", 2.02793337678031e-12,
			 "mod", 100.059901626312, 7.03255627577598, 0.700714207950775,
			 1.23822336162219, 0.969468784786483, "Y", "<unicode>", 1.54809498553732e-12,
			 "Y", 0.137122201711669, 7.0701080691879))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, -0.0230302535341328,
			 "W", "M", "", "", "<unicode>", "", "", 0.813347598335086, 0.0673697800718175,
			 -0.236109634089419, 1, -0.0261961165104945, 0.0194967930965771,
			 -0.00334966170695873, -0.00484976650500305, "W", "jasp", "M",
			 "", "<unicode>", "<unicode>", "", 0.773834706557657, 0.0116565686837849,
			 -0.287362584807512, -0.0163077605876651, 0.0285137534820108,
			 0.00610299644717284, 0.00883614834541743, "W", "Z", "M", "",
			 "<unicode>", "<unicode>", "", 0.593517238385026, 0.0114342698190432,
			 0.533746058450414, -0.0332675922356836, 0.038704162906655, 0.0027182853354857,
			 0.00393563599085021, "W", "mod", "M", "", "<unicode>", "<unicode>",
			 "", 0.882302602912406, 0.0183604789960537, 0.148050894318713,
			 -0.0775466819567461, 0.0159133084692364, -0.0308166867437548,
			 -0.0446175608881794, "W", "Y", "M", "", "<unicode>", "<unicode>",
			 "", 0.196176067287806, 0.0238422723996928, -1.29252305431054,
			 1, -0.00296122904246256, 0.00450914197709736, 0.000773956467317395,
			 0.00112056335233158, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.684655756514328, 0.00190574191119971, 0.406118196157092,
			 -0.00589119861695775, 0.00506907909285442, -0.000411059762051665,
			 -0.00059514782087135, "W", "mod", "Y", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.883120221676967, 0.00279604058958875, -0.147014948059866
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.147948996708588, 0.116135688465705, -0.0159066541214415, -0.0230302535341328,
			 "W", "<unicode>", 0.813347598335086, "M", 0.0673697800718175,
			 -0.236109634089419, 1, -2.10110820470282, 2.83502607382475,
			 0.366958934560965, 0.348453197312996, "jasp", "<unicode>", 0.77073564479617,
			 "M", 1.25924106704592, 0.291412775650513, -0.413433882620032,
			 0.107899969914886, -0.152766956352573, -0.144934680465498, "Z",
			 "<unicode>", 0.250696109315949, "M", 0.132995773556844, -1.14866023383276,
			 0.0028905648879694, 0.0180163398795304, 0.0104534523837499,
			 0.263343062694822, "mod", "<unicode>", 0.00674721413960322,
			 "M", 0.00385868697355441, 2.70906980934003, 0.0387464898678602,
			 0.565434272654561, 0.302090381261211, 0.288797044296207, "Y",
			 "<unicode>", 0.024554599581468, "M", 0.134361597187792, 2.24833871868158,
			 -0.0194720938734558, 0.00121576385131691, -0.00912816501106944,
			 -0.170429712489609, "W", "<unicode>", 0.0837015014975608, "jasp",
			 0.00527761170306084, -1.72960147973285, -0.169849433838636,
			 0.0899500027982267, -0.0399497155202047, -0.0609664182308724,
			 "W", "<unicode>", 0.546659912050572, "Z", 0.0662765843367857,
			 -0.602772697476375, 1, -1.87031193110395, 2.98033913143301,
			 0.555013600164534, 0.555504679381811, "jasp", "<unicode>", 0.653778056597516,
			 "Z", 1.23743372347611, 0.448519859799382, -3.17623798796469,
			 3.69631216742168, 0.260037089728493, 0.0149449009614165, "W",
			 "<unicode>", 0.882091377958021, "mod", 1.75323378633387, 0.148318548133987,
			 -0.228615253195251, 0.0245922941384487, -0.102011479528401,
			 -0.154494520527077, "W", "<unicode>", 0.11427905810986, "Y",
			 0.0645949490222699, -1.57924854918968, -0.012530212645152, 0.0020646455096896,
			 -0.0052327835677312, -0.13789199733451, "mod", "<unicode>",
			 0.159891757636204, "Y", 0.00372324651625335, -1.40543569835845
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.176023199935095, 0.0942455517666334, -0.0408888240842308, -0.0592003810595874,
			 "Total", "W", "M", "<unicode>", 0.553151746868814, 0.0689473770522249,
			 -0.593043939195237, -0.0779893376489408, 0.0280249977233621,
			 -0.0249821699627893, -0.0361701275254546, "Total indirect",
			 "W", "M", "<unicode>", 0.355628457145996, 0.0270449702669362,
			 -0.923727026364354))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-82")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.102707277732093, "jasp", 0.0290462868992908, "Z", 0.00671759165660502,
			 "mod", 0.000223350064746608, "Y", 0.0435195189310436))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 82 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "mod"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "mod",
            processType = "mediators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1694.56540701386, 1764.90500203554, 0, "Model 1", 100, -820.282703506932,
			 82))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(0.180704808730328, 0.319295191038147, 0.249999999884237, "sm",
			 "<unicode>", 1.53743684450092e-12, "sm", 0.0353553390268909,
			 7.0710678150785, 0.679351239017548, 1.20070868331726, 0.940029961167402,
			 "M", "<unicode>", 1.57407420431355e-12, "M", 0.133001791974778,
			 7.06779921691328, -0.0155310360409273, 0.015901321346984, 0.000185142653028361,
			 "Y", "<unicode>", 0.981579174401771, "jasp", 0.0080186058610887,
			 0.0230891324795984, -0.781706195292346, 0.0840275744384795,
			 -0.348839310426933, "mod", "<unicode>", 0.114221818813752, "jasp",
			 0.220854509715388, -1.57949824468822, 0.00480662801191764, 0.0084930402246428,
			 0.00664983411828022, "jasp", "<unicode>", 1.53743684450092e-12,
			 "jasp", 0.000940428559351885, 7.07106781493651, 0.415818962568938,
			 0.877332208264479, 0.646575585416708, "Y", "<unicode>", 3.97900377091531e-08,
			 "Z", 0.11773513425142, 5.49178110279271, -6.63530159455768,
			 3.59524109747847, -1.5200302485396, "mod", "<unicode>", 0.560287998937135,
			 "Z", 2.60988027655951, -0.582413784337798, 0.707778596528062,
			 1.25060480683957, 0.979191701683816, "Z", "<unicode>", 1.53743684450092e-12,
			 "Z", 0.138478618636172, 7.07106780330087, 507.892714690368,
			 901.011119528301, 704.451917109335, "mod", "<unicode>", 2.15072404330385e-12,
			 "mod", 100.287150156534, 7.02434874268325, 0.716666293529629,
			 1.26647572327931, 0.99157100840447, "Y", "<unicode>", 1.55475632368507e-12,
			 "Y", 0.140260084901179, 7.06951667042756))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0910081224725078, 0.860751929259853, 0.475880025866181, 0.451881397144094,
			 "s", "M", "", "", "<unicode>", "", "", 0.0153749805220957, "m",
			 0.196366824303657, 2.42342375069574, 1, -0.0327065874144014,
			 0.0226541864902512, -0.0050262004620751, -0.00477272918314809,
			 "s", "jasp", "M", "", "<unicode>", "<unicode>", "", 0.721922972814061,
			 "m", 0.0141229059159585, -0.355889962871992, 1, -0.04952974707603,
			 0.106054836558549, 0.0282625447412593, 0.0268372646682991, "s",
			 "Z", "M", "", "<unicode>", "<unicode>", "", 0.476421330290286,
			 "m", 0.0396906741301907, 0.712070161583914, 1, -0.126072868172848,
			 0.100247146419103, -0.0129128608768725, -0.0122616653295074,
			 "s", "mod", "M", "", "<unicode>", "<unicode>", "", 0.823026170644271,
			 "m", 0.0577357585080989, -0.223654477061406, 1, -0.138320655423621,
			 0.0912558701983019, -0.0235323926126597, -0.0223456541017805,
			 "s", "Y", "M", "", "<unicode>", "<unicode>", "", 0.687826618468944,
			 "m", 0.0585665163831564, -0.401806254937635, 1, -0.00284859619040834,
			 0.00402188839589021, 0.000586646102740937, 0.000557061540990707,
			 "s", "jasp", "Z", "M", "<unicode>", "<unicode>", "<unicode>",
			 0.73784489268874, "m", 0.00175270684576147, 0.334708627492162,
			 1, -0.0147815474651881, 0.0185253899009152, 0.00187192121786353,
			 0.00177752023471082, "s", "mod", "Y", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.825631019351605, "m", 0.00849682382656624, 0.220308347692318
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0910081224725078, 0.860751929259853, 0.475880025866181, 0.451881397144094,
			 "sm", "<unicode>", 0.0153749805220957, "M", 0.196366824303657,
			 2.42342375069574, 1, -1.79290884127227, 2.94034877890532, 0.573719968816522,
			 0.544787271973417, "jasp", "<unicode>", 0.634690061553928, "M",
			 1.20748586645289, 0.475135970329726, -0.367051095396393, 0.14350331678753,
			 -0.111773889304432, -0.106043304632345, "Z", "<unicode>", 0.390795230450944,
			 "M", 0.130245865794247, -0.858176101197744, 0.00343201054080372,
			 0.0181440175053956, 0.0107880140230996, 0.271959696209718, "mod",
			 "<unicode>", 0.00404792007154309, "M", 0.00375313196585199,
			 2.8744030642287, 0.0358514443861678, 0.542472331293712, 0.28916188783994,
			 0.276437462120014, "Y", "<unicode>", 0.0252627608038503, "M",
			 0.129242397029666, 2.23736091627553, 1, -0.0407263673121724,
			 0.0232049257195319, -0.00876072079632024, -0.107277532357785,
			 "sm", "<unicode>", 0.591156438387134, "jasp", 0.0163093030116845,
			 -0.537160955930723, 1, -0.641306843553368, 0.135597595765052,
			 -0.252854623894158, -0.253078350975052, "sm", "<unicode>", 0.202027488900194,
			 "Z", 0.198193549842381, -1.27579643280646, 1, -1.77925887403205,
			 2.97744968035564, 0.599095403161793, 0.599625485877554, "jasp",
			 "<unicode>", 0.621514529069439, "Z", 1.21346835755861, 0.493705006339943,
			 1, -11.6494093208209, 9.25548197715544, -1.19696367183275, -0.0450863326455992,
			 "sm", "<unicode>", 0.822410573160282, "mod", 5.33297842788732,
			 -0.22444562415133, 1, -0.471868158437157, 0.309105404407237,
			 -0.0813813770149599, -0.0808343917297258, "sm", "<unicode>",
			 0.682924078848467, "Y", 0.199231610632801, -0.408476229030502,
			 -0.0127958409040199, 0.00197912205577032, -0.00540835942412481,
			 -0.142617475672555, "mod", "<unicode>", 0.151319742569027, "Y",
			 0.00376919246382415, -1.43488544987634))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0625107978025213, 0.867748570150353, 0.465129683976437, 0.441673194973658,
			 "Total", "s", "M", "<unicode>", 0.0235575802096637, "m", 0.205421573737947,
			 2.26426891544407, 1, -0.156837434248426, 0.135336750468939,
			 -0.0107503418897435, -0.0102082021704354, "Total indirect",
			 "s", "M", "<unicode>", 0.885318086689426, "m", 0.0745356004043945,
			 -0.144230969247143))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-82")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-82")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.15239078702792, "jasp", 0.00287711723586159, "Z", 0.0190747439475411,
			 "mod", 0.00050819434762206, "Y", 0.021713407519492))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - continuous works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "W",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "jasp", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "Z", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "W",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "Z", processIndependent = "jasp",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "Y"),
        list(processDependent = "M", processIndependent = "Z",
            processType = "moderators", processVariable = "Y")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1430.85517689711, 1542.8774948946, 1, "Model 1", 100, -672.427588448554,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.031054182654645, 0.588772519858598, 0.278859168601977, "Z:Y",
			 "<unicode>", 0.0778043814331941, "W", 0.158121962291746, 1.76357012372173,
			 -0.0314754290819636, 0.0177811834917298, -0.00684712279511689,
			 "jasp:Y", "<unicode>", 0.585818107713644, "W", 0.0125656932888112,
			 -0.544906089758988, -0.675381645622852, 0.2244882430367, -0.225446701293076,
			 "W:Y", "<unicode>", 0.326065578181026, "W", 0.229562863337697,
			 -0.982069564803407, -0.54484820947102, 0.0642086573079608, -0.240319776081529,
			 "Y", "<unicode>", 0.121932451799242, "W", 0.155374504731501,
			 -1.54671306271785, 1.68041090534446, 2.96919117888309, 2.32480104211378,
			 "W", "<unicode>", 1.53743684450092e-12, "W", 0.328776519289221,
			 7.07106774881534, 0.738695301374869, 1.30523287732007, 1.02196408934747,
			 "M", "<unicode>", 1.53743684450092e-12, "M", 0.144527547550357,
			 7.07106781142461, -0.00203828314664171, 0.000358957801668553,
			 -0.000839662672486581, "jasp:Y", "<unicode>", 0.169751649994788,
			 "jasp", 0.000611552295659359, -1.37300224109416, 0.00465468573351061,
			 0.00822456679171098, 0.00643962626261079, "jasp", "<unicode>",
			 1.53743684450092e-12, "jasp", 0.000910700677757125, 7.07106782710463,
			 -0.0732461996187064, 0.204985660064946, 0.0658697302231199,
			 "Z:Y", "<unicode>", 0.353397442456731, "Z", 0.0709788194778858,
			 0.928019523396585, 0.377831608335292, 0.66761130730426, 0.522721457819776,
			 "Z", "<unicode>", 1.53832502292062e-12, "Z", 0.0739247509787714,
			 7.07099382681564, -0.0802370535241582, 0.325471998594874, 0.122617472535358,
			 "Z:Y", "<unicode>", 0.236128141066089, "Y", 0.103499108993638,
			 1.18472007853609, -0.0184311889365843, 0.0140555530740054, -0.00218781793128943,
			 "jasp:Y", "<unicode>", 0.791789671871789, "Y", 0.00828758647272117,
			 -0.263987342815752, -0.253361709274831, 0.338176447485766, 0.0424073691054672,
			 "W:Y", "<unicode>", 0.778695345908037, "Y", 0.150905363931831,
			 0.281019627139456, 0.732634583405442, 1.29452391896651, 1.01357925118598,
			 "Y", "<unicode>", 1.53743684450092e-12, "Y", 0.143341750152856,
			 7.07106792058228, -0.382157413108089, 0.218246235359302, -0.0819555888743933,
			 "Z:Y", "<unicode>", 0.592599121786578, "W:Y", 0.153167010517361,
			 -0.53507337250735, -0.0692279341985296, -0.0179641237642334,
			 -0.0435960289813815, "jasp:Y", "<unicode>", 0.000857283160555555,
			 "W:Y", 0.0130777429684062, -3.33360497195141, 1.6226999944245,
			 2.86721926797579, 2.24495963120014, "W:Y", "<unicode>", 1.53743684450092e-12,
			 "W:Y", 0.317485240383982, 7.07106770848617, -0.0296956307501333,
			 0.00339989102393425, -0.0131478698630995, "Z:Y", "<unicode>",
			 0.11940611084056, "jasp:Y", 0.00844289028653608, -1.5572711970528,
			 0.00489761033845794, 0.00864572639156059, 0.00677166836500927,
			 "jasp:Y", "<unicode>", 1.41997524849558e-12, "jasp:Y", 0.000956169624204147,
			 7.08207852832133, 0.753193284742336, 1.33085000273074, 1.04202164373654,
			 "Z:Y", "<unicode>", 1.53743684450092e-12, "Z:Y", 0.147364115500307,
			 7.07106774399475))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.246051488919606, 0.136946834670581, -0.0545523271245121,
			 -0.0789750495465024, "W", "M", "", "", "<unicode>", "", "",
			 0.576615963231862, 0.0977054493376484, -0.558334540133902, 50,
			 -0.167681831779048, 0.106697487029615, -0.0304921723747166,
			 -0.0441433198363354, "W", "M", "", "", "<unicode>", "", "",
			 0.663107166827128, 0.0699960103789997, -0.435627290892923, 84,
			 -0.223662444870801, 0.21518959779024, -0.00423642354028043,
			 -0.00613304283481763, "W", "M", "", "", "<unicode>", "", "",
			 0.969814681636494, 0.111954108882268, -0.037840715116008, 1,
			 16, -0.02617074550978, 0.0522800429125744, 0.0130546487013972,
			 0.0188991301077194, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.514209030704999, 0.020013323979717, 0.652297874887135,
			 1, 50, -0.0226274287861929, 0.0237489432502052, 0.000560757232006149,
			 0.000811804601482274, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.962196355089898, 0.0118309245481573, 0.0473975833184982,
			 1, 84, -0.10077078311816, 0.0326678922649206, -0.0340514454266195,
			 -0.0492960563086401, "W", "jasp", "M", "", "<unicode>", "<unicode>",
			 "", 0.31716351145622, 0.034041103927324, -1.00030379447498,
			 16, -0.0235627937204136, 0.0866940853068529, 0.0315656457932197,
			 0.0456973803298435, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.261758952638146, 0.0281272716991125, 1.12224342733589,
			 50, -0.0276546689203294, 0.0130488553495269, -0.00730290678540124,
			 -0.010572370705546, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.48186758695854, 0.01038374291337, -0.703301964072909,
			 84, -0.0685118166986682, 0.0610012613099561, -0.00375527769435609,
			 -0.00543649111972325, "W", "Z", "M", "", "<unicode>", "<unicode>",
			 "", 0.909507557273645, 0.0330396576238663, -0.113659703653934,
			 1, 16, -0.00574680023355742, 0.00396762439775286, -0.000889587917902283,
			 -0.00128785064900989, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.719622649318644, 0.00247821508658741, -0.358963159701879,
			 1, 50, -0.00251794175166093, 0.00511545475288314, 0.00129875650061111,
			 0.00188020134779029, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.50480924879718, 0.00194733080933, 0.666941895228351,
			 1, 84, -0.00948161489412559, 0.0106443059324208, 0.000581345519147609,
			 0.000841610131012906, "W", "jasp", "Z", "M", "<unicode>", "<unicode>",
			 "<unicode>", 0.909849214750852, 0.00513425781935206, 0.113228735213958
			))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.167314803501713, 0.108745859218847, -0.0292844721414328, -0.0423949400551537,
			 "W", "<unicode>", 0.677537808380871, "M", 0.070424932523784,
			 -0.415825348949292, 1, -2.44872019205925, 2.5646580748573, 0.0579689413990266,
			 0.0550400854012691, "jasp", "<unicode>", 0.963847830766619,
			 "M", 1.27894652821721, 0.0453255395124552, -0.441990003843973,
			 0.108510390422134, -0.16673980671092, -0.158160302581677, "Z",
			 "<unicode>", 0.235110086137741, "M", 0.140436354598448, -1.18729802683701,
			 -0.0126098987768805, 0.525930639295538, 0.256660370259329, 0.245341717818706,
			 "Y", "<unicode>", 0.0617371145197585, "M", 0.137385314811996,
			 1.86817907438327, -0.125417992266295, 0.174812684834136, 0.0246973462839207,
			 0.0359961267344277, "W:Y", "<unicode>", 0.747105663216367, "M",
			 0.0765908658191202, 0.322458115857404, 1, -0.267223192933636,
			 5.10203571149693, 2.41740625928165, 2.31079930149947, "jasp:Y",
			 "<unicode>", 0.0775851644097694, "M", 1.3697340733765, 1.76487269045046,
			 -0.0582256148997298, 0.349435665116295, 0.145605025108283, 0.139047572977482,
			 "Z:Y", "<unicode>", 0.161487302871986, "M", 0.103997135465653,
			 1.4000868817812, -0.0199964286470305, 0.000987820740046105,
			 -0.00950430395349218, -0.177452510871392, "W", "<unicode>",
			 0.0758259627682201, "jasp", 0.00535322321037469, -1.7754357664505,
			 -0.0156987568018804, 0.0159388848590211, 0.000120064028570368,
			 0.00148016695161461, "Y", "<unicode>", 0.988131087201773, "jasp",
			 0.008070975260376, 0.0148760248541234, -0.0145563047813346,
			 0.00654286005513335, -0.00400672236310061, -0.0753147324674699,
			 "W:Y", "<unicode>", 0.456638969154397, "jasp", 0.0053825389147187,
			 -0.744392641945257, -0.0476143612546109, 0.145877661227691,
			 0.0491316499865398, 0.0749859298371018, "W", "<unicode>", 0.319565453556594,
			 "Z", 0.0493611168390189, 0.995351262954048, 1, -0.908751497193613,
			 2.64668645358226, 0.868967478194323, 0.869819338484187, "jasp",
			 "<unicode>", 0.33803717864298, "Z", 0.907016143873233, 0.958050729376843,
			 0.515985277337612, 0.801184084439717, 0.658584680888665, 0.663691134429253,
			 "Y", "<unicode>", 0, "Z", 0.0727561346411763, 9.05194708510447,
			 0.0430810148873367, 0.248415860509208, 0.145748437698272, 0.223950066562918,
			 "W:Y", "<unicode>", 0.00539587315761736, "Z", 0.0523823007059126,
			 2.7823985532163, 1, -0.509167170547942, 3.22696265234419, 1.35889774089812,
			 1.36943419639378, "jasp:Y", "<unicode>", 0.153940969060858,
			 "Z", 0.953111856228545, 1.42574843867253))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(16, -0.201021460732574, 0.179378219636978, -0.0108216205477976,
			 -0.0156663897579494, "Total", "W", "M", "<unicode>", 0.911208591226793,
			 0.0970425179671913, -0.111514218452743, 50, -0.171680566664871,
			 0.09980943580987, -0.0359355654275005, -0.0520236845926088,
			 "Total", "W", "M", "<unicode>", 0.603859592754693, 0.0692589263415603,
			 -0.518858251574377, 84, -0.245854281966373, 0.162930679682156,
			 -0.0414618011421084, -0.060023980132168, "Total", "W", "M",
			 "<unicode>", 0.690935208519209, 0.104283794210754, -0.397586235290936,
			 16, -0.0230775247652702, 0.110538937918699, 0.0437307065767145,
			 0.063308659788553, "Total indirect", "W", "M", "<unicode>",
			 0.199514893360599, 0.034086458664016, 1.28293487474777, 50,
			 -0.0361476519436325, 0.0252608658380645, -0.00544339305278399,
			 -0.0078803647562734, "Total indirect", "W", "M", "<unicode>",
			 0.728237139570426, 0.0156657260710093, -0.347471481890483, 84,
			 -0.125313677207976, 0.0508629220043199, -0.037225377601828,
			 -0.0538909372973504, "Total indirect", "W", "M", "<unicode>",
			 0.407520800017268, 0.0449438358566674, -0.828264363561342))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-continuous-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-continuous-92")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0786957077444094, "jasp", 0.0343971584572194, "Z", 0.476253178346806
			))

})

###--------------------------------------------------------------------------------------------------------------------------###

test_that("Test that model number 92 - factor works with bad variable names", {

options <- jaspTools::analysisOptions("ClassicProcess")
options$hayesNumber <- TRUE
options$standardizedModelEstimates <- TRUE
options$errorCalculationMethod <- "standard"
options$naAction <- "fiml"
options$emulation <- "lavaan"
options$estimator <- "default"
options$dependent <- "M"
options$covariates <- list("W", "Y", "Z", "jasp", "mod")
options$factors <- list("s", "med")
options$moderationProbes <- list(list(probePercentile = 16, value = "16"), list(probePercentile = 50,
    value = "50"), list(probePercentile = 84, value = "84"))
options$statisticalPathPlotsParameterEstimates <- FALSE
options$statisticalPathPlotsCovariances <- TRUE
options$statisticalPathPlotsResidualVariances <- TRUE
options$pathPlotsLegend <- FALSE
options$pathPlotsLegendLabels <- FALSE
options$pathPlotsLegendColor <- FALSE
options$pathPlotsColor <- TRUE
options$colorPalette <- "colorblind"
options$pathPlotsColorPalette <- "colorblind"
options$pathPlotsLabelLength <- 3
options$processModels <- list(list(conceptualPathPlot = TRUE, independentCovariances = TRUE,
    inputType = "inputVariables", mediationEffects = TRUE, mediatorCovariances = TRUE,
    dependentCovariances = TRUE, modelNumber = 1, modelNumberCovariates = list(),
    modelNumberIndependent = "", modelNumberMediators = list(),
    modelNumberModeratorW = "", modelNumberModeratorZ = "", name = "Model 1",
    pathCoefficients = TRUE, intercepts = FALSE, processRelationships = list(
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "jasp"),
        list(processDependent = "M", processIndependent = "s",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "mediators", processVariable = "Z"),
        list(processDependent = "jasp", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "Z", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "s",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "Z", processIndependent = "jasp",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "jasp",
            processType = "moderators", processVariable = "med"),
        list(processDependent = "M", processIndependent = "Z",
            processType = "moderators", processVariable = "med")),
    residualCovariances = TRUE, statisticalPathPlot = TRUE, totalEffects = TRUE,
    localTests = FALSE, localTestType = "cis", localTestBootstrap = FALSE,
    localTestBootstrapSamples = 1000))
set.seed(1)
results <- jaspTools::runAnalysis("ClassicProcess", "data/badVarNames.csv", options)



	table <- results[["results"]][["modelSummaryTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(504.655507907652, 616.67782590514, 1, "Model 1", 100, -209.327753953826,
			 92))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_covariancesTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(-0.132162243635336, 0.00110487816185023, -0.0655286827367427,
			 "Z:medexperimental", "<unicode>", 0.0539217027322965, "sm",
			 0.0339973394532706, -1.92746502492679, -0.00809051533365547,
			 0.00312057865026881, -0.00248496834169333, "jasp:medexperimental",
			 "<unicode>", 0.384922452227631, "sm", 0.0028600255087226, -0.868862300044037,
			 0.0922263505865238, 0.197773633399271, 0.144999991992897, "sm:medexperimental",
			 "<unicode>", 7.2378255833172e-08, "sm", 0.0269258220164479,
			 5.38516491360311, -0.00962233045533177, 0.0896223126233599,
			 0.0399999910840141, "medexperimental", "<unicode>", 0.114128679432551,
			 "sm", 0.0253179762132164, 1.57990475807199, 0.180704805838334,
			 0.319295180947901, 0.249999993393117, "sm", "<unicode>", 1.53743684450092e-12,
			 "sm", 0.0353553371905684, 7.07106799874641, 0.748461126015611,
			 1.32248853790154, 1.03547483195858, "M", "<unicode>", 1.53743684450092e-12,
			 "M", 0.146438255093916, 7.07106781144374, 0.00209870132077307,
			 0.00428660403109907, 0.00319265267593607, "jasp:medexperimental",
			 "<unicode>", 1.06476778505282e-08, "jasp", 0.000558148702625123,
			 5.72007542241014, 0.00474535372806117, 0.0083847720894234, 0.00656506290874229,
			 "jasp", "<unicode>", 1.53743684450092e-12, "jasp", 0.000928440111672843,
			 7.07106772553536, 0.263016412043752, 0.555092919046792, 0.409054665545272,
			 "Z:medexperimental", "<unicode>", 4.02208075733768e-08, "Z",
			 0.0745106821622493, 5.48987948673645, 0.683668041411474, 1.20866503443951,
			 0.946166537925492, "Z", "<unicode>", 1.61048951952125e-12, "Z",
			 0.133930265343941, 7.06462079721621, -0.101566996638401, 0.0299523215015227,
			 -0.0358073375684393, "Z:medexperimental", "<unicode>", 0.285865166669648,
			 "medexperimental", 0.033551462980272, -1.0672362510539, -0.00757037629078561,
			 0.00362505678342446, -0.00197265975368057, "jasp:medexperimental",
			 "<unicode>", 0.489754172586672, "medexperimental", 0.00285603030528066,
			 -0.690699867586566, 0.0922263515083516, 0.19777363480432, 0.144999993156336,
			 "sm:medexperimental", "<unicode>", 7.23782485057001e-08, "medexperimental",
			 0.0269258221397209, 5.38516493215753, 0.180704805825834, 0.319295180907466,
			 0.24999999336665, "medexperimental", "<unicode>", 1.53743684450092e-12,
			 "medexperimental", 0.0353553371834418, 7.07106799942312, -0.141970623378853,
			 -0.0191649172531609, -0.080567770316007, "Z:medexperimental",
			 "<unicode>", 0.01011995393982, "sm:medexperimental", 0.0313285619262313,
			 -2.57170343489491, -0.00842285740400191, 0.00179588630916955,
			 -0.00331348554741618, "jasp:medexperimental", "<unicode>", 0.203707711813691,
			 "sm:medexperimental", 0.00260687027766214, -1.27105885390958,
			 0.148828477385756, 0.26297150857812, 0.205899992981938, "sm:medexperimental",
			 "<unicode>", 1.53743684450092e-12, "sm:medexperimental", 0.0291186552642573,
			 7.07106805288077, -0.00263766765641854, 0.0085819885986533,
			 0.00297216047111738, "Z:medexperimental", "<unicode>", 0.299077071234964,
			 "jasp:medexperimental", 0.00286220980170326, 1.03841460865262,
			 0.00234888455393216, 0.004145511972967, 0.00324719826344958,
			 "jasp:medexperimental", "<unicode>", 1.39221967287995e-12, "jasp:medexperimental",
			 0.000458331743135691, 7.08482079210524, 0.32176416975378, 0.568539115739565,
			 0.445151642746672, "Z:medexperimental", "<unicode>", 1.53743684450092e-12,
			 "Z:medexperimental", 0.062953949136901, 7.07106780193624))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_mediationEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0345966305301646, 1.17847272954598, 0.606534680038075, 0.575947196299481,
			 "s", "M", "", "", 0, "<unicode>", "", "", 0.0376612569345014,
			 "m", 0.291810489386175, 2.07852254150947, 1, -0.30763449696441,
			 0.879612205949782, 0.285988854492686, 0.271566464934244, "s",
			 "M", "", "", 1, "<unicode>", "", "", 0.345042766170694, "m",
			 0.302874622258124, 0.944248324143028, 1, -0.0184745280283097,
			 0.0173922226424977, -0.00054115269290599, -0.000513862416291767,
			 "s", "jasp", "M", "", 0, "<unicode>", "<unicode>", "", 0.952837935448324,
			 "m", 0.00914984942420364, -0.0591433440942215, 1, -0.0660872214254745,
			 0.0606455675363312, -0.0027208269445717, -0.00258361591169656,
			 "s", "jasp", "M", "", 1, "<unicode>", "<unicode>", "", 0.932931641527606,
			 "m", 0.0323303871809528, -0.084156955168624, 1, -0.0747982028314841,
			 0.0925091371673744, 0.00885546716794517, 0.00840888683723733,
			 "s", "Z", "M", "", 0, "<unicode>", "<unicode>", "", 0.835635633498567,
			 "m", 0.042681228154843, 0.207479202234258, 1, -0.122561092897031,
			 0.187496891150044, 0.0324678991265069, 0.0308305461947734, "s",
			 "Z", "M", "", 1, "<unicode>", "<unicode>", "", 0.681455705978873,
			 "m", 0.0790978779438737, 0.410477499150425, 1, -0.00610425770896581,
			 0.00500147322094188, -0.000551392244011967, -0.000523585587851359,
			 "s", "jasp", "Z", "M", 0, "<unicode>", "<unicode>", "<unicode>",
			 0.845688997717813, "m", 0.00283314668471163, -0.194621848204125,
			 1, -0.00422952543368368, 0.00545046555714282, 0.000610470061729567,
			 0.000579684117082709, "s", "jasp", "Z", "M", 1, "<unicode>",
			 "<unicode>", "<unicode>", 0.804745059293082, "m", 0.00246943083321455,
			 0.247210836407552))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_pathCoefficientsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0345966305301646, 1.17847272954598, 0.606534680038075, 0.575947196299481,
			 "sm", "<unicode>", 0.0376612569345014, "M", 0.291810489386175,
			 2.07852254150947, 1, -3.54941875636986, 3.33345905819285, -0.107979849088506,
			 -0.102534436011906, "jasp", "<unicode>", 0.950963762965308,
			 "M", 1.75586844167902, -0.0614965486738014, -0.121894548040853,
			 0.422376825381274, 0.150241138670211, 0.142596575947402, "Z",
			 "<unicode>", 0.279225738086974, "M", 0.138847289469416, 1.08206029260156,
			 1, -0.400140359809734, 0.74882626491738, 0.174342952553823,
			 0.165550854753506, "medexperimental", "<unicode>", 0.551973404466303,
			 "M", 0.293109116746536, 0.594805629006022, 1, -1.14486482680427,
			 0.503773175713493, -0.320545825545389, -0.304380731365237, "sm:medexperimental",
			 "<unicode>", 0.445967916312546, "M", 0.420578647240972, -0.762154302526278,
			 1, -4.67371878797698, 5.19520576582867, 0.260743488925845, 0.247594220648287,
			 "jasp:medexperimental", "<unicode>", 0.917512913792683, "M",
			 2.51762905636289, 0.103567079616776, 1, -0.631934803232522,
			 0.196704100540977, -0.217615351345772, -0.206542657025607, "Z:medexperimental",
			 "<unicode>", 0.303271561223815, "M", 0.211391359818266, -1.02944297975497,
			 1, -0.0404917965057887, 0.0505150128276125, 0.00501160816091189,
			 0.0613685752465893, "sm", "<unicode>", 0.829093338697142, "jasp",
			 0.0232164493968387, 0.215864539630866, 1, -0.0488496029230871,
			 0.0421572064101505, -0.00334619825646826, -0.0409751546606775,
			 "medexperimental", "<unicode>", 0.885397427564876, "jasp", 0.023216449396797,
			 -0.144130491242554, 1, -0.0871738374547366, 0.0415292265724166,
			 -0.02282230544116, -0.279465657289462, "sm:medexperimental",
			 "<unicode>", 0.486991205196575, "jasp", 0.0328330176070444,
			 -0.695102281316457, 1, -0.487522911188144, 0.605406298472415,
			 0.0589416936421356, 0.0589697668500751, "sm", "<unicode>", 0.8325737585275,
			 "Z", 0.278813595117422, 0.211401792001256, 1, -3.63372114040035,
			 2.16910210460413, -0.732309517898109, -0.732658307966763, "jasp",
			 "<unicode>", 0.620818726616415, "Z", 1.48033925387824, -0.494690332624487,
			 1, -0.530602629647264, 0.562676421224623, 0.0160368957886797,
			 0.0160445339660439, "medexperimental", "<unicode>", 0.954146956446408,
			 "Z", 0.278902841964325, 0.0574999368085716, 1, -1.31510027247852,
			 0.233408987865493, -0.540845642306515, -0.541103240472456, "sm:medexperimental",
			 "<unicode>", 0.170965610061498, "Z", 0.39503513139998, -1.36910770540785,
			 1, -3.46987591719204, 5.95196056674456, 1.24104232477626, 1.24163341806002,
			 "jasp:medexperimental", "<unicode>", 0.605622487524827, "Z",
			 2.40357388152406, 0.51633208960872))



	table <- results[["results"]][["parEstContainer"]][["collection"]][["parEstContainer_Model 1"]][["collection"]][["parEstContainer_Model 1_totalEffectsTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list(1, 0.0368779785318392, 1.19171722600636, 0.614297602269102, 0.583318635132575,
			 "Total", "s", "M", 0, "<unicode>", 0.0370565279811126, "m",
			 0.294607262323122, 2.08514073083286, 1, -0.256333956688915,
			 0.889026750161617, 0.316346396736351, 0.300393079334403, "Total",
			 "s", "M", 1, "<unicode>", 0.278952051106587, "m", 0.292189222833938,
			 1.08267647132264, 1, -0.0780757317152694, 0.0936015761773238,
			 0.00776292223102721, 0.0073714388330942, "Total indirect", "s",
			 "M", 0, "<unicode>", 0.859310681845455, "m", 0.0437960363676991,
			 0.17725170757125, 1, -0.134546039973661, 0.195261124460991,
			 0.0303575422436647, 0.0288266144001596, "Total indirect", "s",
			 "M", 1, "<unicode>", 0.718237733154948, "m", 0.0841360267423608,
			 0.36081502085456))



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_conceptPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "conceptual-path-plot-factor-92")



	plotName <- results[["results"]][["pathPlotContainer"]][["collection"]][["pathPlotContainer_Model 1"]][["collection"]][["pathPlotContainer_Model 1_statPathPlot"]][["data"]]
	testPlot <- results[["state"]][["figures"]][[plotName]][["obj"]]
	jaspTools::expect_equal_plots(testPlot, "statistical-path-plot-factor-92")



	table <- results[["results"]][["rSquaredTable"]][["data"]]
	jaspTools::expect_equal_tables(table,
		list("M", 0.0663295605335603, "jasp", 0.0155883202989389, "Z", 0.0529319523321141
			))

})

###--------------------------------------------------------------------------------------------------------------------------###

